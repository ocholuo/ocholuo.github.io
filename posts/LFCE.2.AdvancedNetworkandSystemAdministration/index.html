<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="pv-proxy-endpoint" content="https://myochosite-291718.appspot.com/query?id=ahNwfm15b2Nob3NpdGUtMjkxNzE4chULEghBcGlRdWVyeRiAgIDo14eBCgw"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="LFCE.2 Advanced Network and System Administration" /><meta property="og:locale" content="en" /><meta name="description" content="LFCE: Advanced Network and System Administration" /><meta property="og:description" content="LFCE: Advanced Network and System Administration" /><link rel="canonical" href="https://ocholuo.github.io//posts/LFCE.2.AdvancedNetworkandSystemAdministration/" /><meta property="og:url" content="https://ocholuo.github.io//posts/LFCE.2.AdvancedNetworkandSystemAdministration/" /><meta property="og:site_name" content="Grace" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-07-16T11:11:11-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="LFCE.2 Advanced Network and System Administration" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-02T18:51:01-05:00","datePublished":"2020-07-16T11:11:11-04:00","description":"LFCE: Advanced Network and System Administration","headline":"LFCE.2 Advanced Network and System Administration","mainEntityOfPage":{"@type":"WebPage","@id":"https://ocholuo.github.io//posts/LFCE.2.AdvancedNetworkandSystemAdministration/"},"url":"https://ocholuo.github.io//posts/LFCE.2.AdvancedNetworkandSystemAdministration/"}</script><title>LFCE.2 Advanced Network and System Administration | Grace</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Grace"><meta name="application-name" content="Grace"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://myochosite-291718.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://myochosite-291718.appspot.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/huoye.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Grace</a></div><div class="site-subtitle font-italic">2023 Mar 14 updated</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/ocholuo" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>LFCE.2 Advanced Network and System Administration</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>LFCE.2 Advanced Network and System Administration</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Grace JyL </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Jul 16, 2020, 11:11 AM -0400" >Jul 16, 2020<i class="unloaded">2020-07-16T11:11:11-04:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Jan 2, 2023, 3:51 PM -0800" >Jan 2<i class="unloaded">2023-01-02T18:51:01-05:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="14362 words">79 min read</span> <span id="pv" class="pageviews"> <i class="fas fa-spinner fa-spin fa-fw"></i> </span> views</div></div><div class="post-content"><h1 id="lfce-advanced-network-and-system-administration">LFCE: Advanced Network and System Administration</h1><p>[toc]</p><h2 id="check-the-init-daemons-starting-and-stopping-services">check the init daemons, Starting and Stopping Services</h2><p>server0:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre><td class="rouge-code"><pre>
<span class="mi">1</span><span class="p">.</span> <span class="n">command</span> <span class="n">to</span> <span class="k">switch</span> <span class="n">between</span> <span class="n">runlevels</span> <span class="n">on</span> <span class="n">initd</span><span class="o">-</span><span class="n">base</span> <span class="n">Systems</span>

<span class="err">$</span> <span class="n">ls</span> <span class="o">-</span><span class="n">la</span> <span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">init</span>
<span class="n">lrwxrwxrwx</span><span class="p">.</span> <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span> <span class="mi">22</span> <span class="n">Apr</span>  <span class="mi">9</span> <span class="mi">17</span><span class="o">:</span><span class="mi">52</span> <span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">init</span> <span class="o">-&gt;</span> <span class="p">..</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">systemd</span>
<span class="c1">// centos:</span>
<span class="c1">// init is a symbolic link back to systemd.</span>


<span class="mi">2</span><span class="p">.</span> <span class="n">initialization</span> <span class="n">is</span> <span class="n">the</span> <span class="n">first</span> <span class="n">process</span> <span class="n">in</span> <span class="n">user</span> <span class="n">space</span><span class="p">.</span>
   <span class="n">check</span> <span class="n">the</span> <span class="n">process</span> <span class="n">ID</span><span class="p">.</span>

<span class="err">$</span> <span class="n">pstree</span> <span class="o">-</span><span class="n">np</span>
<span class="c1">// systemd is the UID 1.</span>
<span class="n">systemd</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="err">─┬─</span><span class="n">systemd</span><span class="o">-</span><span class="n">journal</span><span class="p">(</span><span class="mi">735</span><span class="p">)</span>
           <span class="err">├─</span><span class="n">systemd</span><span class="o">-</span><span class="n">udevd</span><span class="p">(</span><span class="mi">764</span><span class="p">)</span>
           <span class="err">├─</span><span class="n">alsactl</span><span class="p">(</span><span class="mi">986</span><span class="p">)</span>
           <span class="err">├─</span><span class="n">dbus</span><span class="o">-</span><span class="n">daemon</span><span class="p">(</span><span class="mi">989</span><span class="p">)</span><span class="err">───</span><span class="p">{</span><span class="n">dbus</span><span class="o">-</span><span class="n">daemon</span><span class="p">}(</span><span class="mi">1022</span><span class="p">)</span>
           <span class="err">├─</span><span class="n">systemd</span><span class="o">-</span><span class="n">machine</span><span class="p">(</span><span class="mi">990</span><span class="p">)</span>
           <span class="err">├─</span><span class="n">chronyd</span><span class="p">(</span><span class="mi">992</span><span class="p">)</span>
           <span class="err">├─</span><span class="n">firewalld</span><span class="p">(</span><span class="mi">1036</span><span class="p">)</span><span class="err">─┬─</span><span class="p">{</span><span class="n">firewalld</span><span class="p">}(</span><span class="mi">1907</span><span class="p">)</span>
           <span class="err">│</span>                 <span class="err">└─</span><span class="p">{</span><span class="n">firewalld</span><span class="p">}(</span><span class="mi">4293</span><span class="p">)</span>
           <span class="err">├─</span><span class="n">systemd</span><span class="o">-</span><span class="n">logind</span><span class="p">(</span><span class="mi">1095</span><span class="p">)</span>
           <span class="err">├─</span><span class="n">accounts</span><span class="o">-</span><span class="n">daemon</span><span class="p">(</span><span class="mi">1096</span><span class="p">)</span><span class="err">─┬─</span><span class="p">{</span><span class="n">accounts</span><span class="o">-</span><span class="n">daemon</span><span class="p">}(</span><span class="mi">1097</span><span class="p">)</span>
           <span class="err">│</span>                       <span class="err">└─</span><span class="p">{</span><span class="n">accounts</span><span class="o">-</span><span class="n">daemon</span><span class="p">}(</span><span class="mi">1100</span><span class="p">)</span>
           <span class="err">├─</span><span class="n">NetworkManager</span><span class="p">(</span><span class="mi">1110</span><span class="p">)</span><span class="err">─┬─</span><span class="p">{</span><span class="n">NetworkManager</span><span class="p">}(</span><span class="mi">1119</span><span class="p">)</span>
           <span class="err">│</span>                      <span class="err">└─</span><span class="p">{</span><span class="n">NetworkManager</span><span class="p">}(</span><span class="mi">1121</span><span class="p">)</span>
           <span class="err">├─</span><span class="n">sshd</span><span class="p">(</span><span class="mi">1123</span><span class="p">)</span>
           <span class="err">├─</span><span class="n">cupsd</span><span class="p">(</span><span class="mi">1125</span><span class="p">)</span>
           <span class="err">├─</span><span class="n">libvirtd</span><span class="p">(</span><span class="mi">1127</span><span class="p">)</span><span class="err">─┬─</span><span class="p">{</span><span class="n">libvirtd</span><span class="p">}(</span><span class="mi">1151</span><span class="p">)</span>
           <span class="err">│</span>                <span class="err">├─</span><span class="p">{</span><span class="n">libvirtd</span><span class="p">}(</span><span class="mi">1384</span><span class="p">)</span>
           <span class="err">│</span>                <span class="err">└─</span><span class="p">{</span><span class="n">libvirtd</span><span class="p">}(</span><span class="mi">2051</span><span class="p">)</span>
           <span class="err">├─</span><span class="n">httpd</span><span class="p">(</span><span class="mi">1128</span><span class="p">)</span><span class="err">─┬─</span><span class="n">httpd</span><span class="p">(</span><span class="mi">1165</span><span class="p">)</span>


<span class="mi">3</span><span class="p">.</span> <span class="n">manipulate</span> <span class="n">the</span> <span class="n">service</span> <span class="n">by</span> <span class="n">systemd</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="n">stop</span> <span class="n">httpd</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">httpd</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="n">status</span> <span class="n">httpd</span>
<span class="err">●</span> <span class="n">httpd</span><span class="p">.</span><span class="n">service</span> <span class="o">-</span> <span class="n">The</span> <span class="n">Apache</span> <span class="n">HTTP</span> <span class="n">Server</span>

   <span class="n">Loaded</span><span class="o">:</span> <span class="n">loaded</span> <span class="p">(</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span><span class="p">;</span> <span class="n">enabled</span><span class="p">;</span> <span class="n">vendor</span> <span class="n">prese</span><span class="o">&gt;</span><span class="p">...)</span>
   <span class="n">Active</span><span class="o">:</span> <span class="n">inactive</span> <span class="p">(</span><span class="n">dead</span><span class="p">)</span> <span class="n">since</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mi">14</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">47</span> <span class="n">EDT</span><span class="p">;</span> <span class="mi">4</span><span class="n">s</span> <span class="n">ago</span>
   <span class="c1">// or</span>
   <span class="n">Active</span><span class="o">:</span> <span class="n">reloading</span> <span class="p">(</span><span class="n">reload</span><span class="p">)</span> <span class="n">since</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mi">14</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mi">16</span> <span class="n">EDT</span><span class="p">;</span> <span class="mi">2</span><span class="n">s</span> <span class="n">ago</span>
     <span class="n">Docs</span><span class="o">:</span> <span class="n">man</span><span class="o">:</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
 <span class="n">Main</span> <span class="n">PID</span><span class="o">:</span> <span class="mi">8944</span> <span class="p">(</span><span class="n">httpd</span><span class="p">)</span>
   <span class="n">Status</span><span class="o">:</span> <span class="s">"Reading configuration..."</span>
    <span class="n">Tasks</span><span class="o">:</span> <span class="mi">1</span> <span class="p">(</span><span class="n">limit</span><span class="o">:</span> <span class="mi">14155</span><span class="p">)</span>
   <span class="n">Memory</span><span class="o">:</span> <span class="mi">4</span><span class="p">.</span><span class="mi">3</span><span class="n">M</span>
   <span class="n">CGroup</span><span class="o">:</span> <span class="o">/</span><span class="n">system</span><span class="p">.</span><span class="n">slice</span><span class="o">/</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span>
           <span class="err">└─</span><span class="mi">8944</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">httpd</span> <span class="o">-</span><span class="n">DFOREGROUND</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">14</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mo">06</span> <span class="n">server0</span> <span class="n">systemd</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">The</span> <span class="n">Apache</span> <span class="n">HTTP</span> <span class="n">Server</span><span class="p">...</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">14</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mi">16</span> <span class="n">server0</span> <span class="n">httpd</span><span class="p">[</span><span class="mi">8944</span><span class="p">]</span><span class="o">:</span> <span class="n">AH00558</span><span class="o">:</span> <span class="n">httpd</span><span class="o">:</span> <span class="n">Could</span> <span class="n">not</span> <span class="n">reliably</span> <span class="n">determi</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">14</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mi">16</span> <span class="n">server0</span> <span class="n">systemd</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span> <span class="n">Started</span> <span class="n">The</span> <span class="n">Apache</span> <span class="n">HTTP</span> <span class="n">Server</span><span class="p">.</span>
</pre></table></code></div></div><hr /><h2 id="check-the-unit-files-and-configure-the-unit-file-precedence">check the Unit Files and configure the unit file precedence</h2><p>server0:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>

<span class="mi">1</span><span class="p">.</span> <span class="n">startup</span> <span class="n">when</span> <span class="n">the</span> <span class="n">system</span> <span class="n">startup</span><span class="o">:</span> <span class="n">enable</span><span class="o">/</span><span class="n">disable</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="n">status</span> <span class="n">httpd</span>
<span class="err">●</span> <span class="n">httpd</span><span class="p">.</span><span class="n">service</span> <span class="o">-</span> <span class="n">The</span> <span class="n">Apache</span> <span class="n">HTTP</span> <span class="n">Server</span>
   <span class="c1">// (location, autostart, ...)</span>
   <span class="n">Loaded</span><span class="o">:</span> <span class="n">loaded</span> <span class="p">(</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span><span class="p">;</span> <span class="n">enabled</span><span class="p">;</span> <span class="n">vendor</span> <span class="n">prese</span><span class="o">&gt;</span><span class="p">)</span>
   <span class="n">Active</span><span class="o">:</span> <span class="n">reloading</span> <span class="p">(</span><span class="n">reload</span><span class="p">)</span> <span class="n">since</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mi">14</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mi">16</span> <span class="n">EDT</span><span class="p">;</span> <span class="mi">2</span><span class="n">s</span> <span class="n">ago</span>
     <span class="n">Docs</span><span class="o">:</span> <span class="n">man</span><span class="o">:</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
 <span class="n">Main</span> <span class="n">PID</span><span class="o">:</span> <span class="mi">8944</span> <span class="p">(</span><span class="n">httpd</span><span class="p">)</span>


<span class="err">$</span> <span class="n">systemctl</span> <span class="n">disable</span> <span class="n">httpd</span>
<span class="n">Removed</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">multi</span><span class="o">-</span><span class="n">user</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span><span class="o">/</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span><span class="p">.</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">httpd</span>
<span class="n">Created</span> <span class="n">symlink</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">multi</span><span class="o">-</span><span class="n">user</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span><span class="o">/</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span> <span class="err">→</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span><span class="p">.</span>
</pre></table></code></div></div><ol><li>list the 3 location of the units</ol><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">cd</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span>
<span class="p">[</span><span class="n">server1</span><span class="err">@</span><span class="n">server0</span> <span class="n">system</span><span class="p">]</span><span class="err">$</span> <span class="n">ls</span>
<span class="n">accounts</span><span class="o">-</span><span class="n">daemon</span><span class="p">.</span><span class="n">service</span>                  <span class="n">plymouth</span><span class="o">-</span><span class="n">kexec</span><span class="p">.</span><span class="n">service</span>
<span class="n">alsa</span><span class="o">-</span><span class="n">restore</span><span class="p">.</span><span class="n">service</span>                     <span class="n">plymouth</span><span class="o">-</span><span class="n">poweroff</span><span class="p">.</span><span class="n">service</span>
<span class="n">alsa</span><span class="o">-</span><span class="n">state</span><span class="p">.</span><span class="n">service</span>                       <span class="n">plymouth</span><span class="o">-</span><span class="n">quit</span><span class="p">.</span><span class="n">service</span>
<span class="n">anaconda</span><span class="o">-</span><span class="n">direct</span><span class="p">.</span><span class="n">service</span>                  <span class="n">plymouth</span><span class="o">-</span><span class="n">quit</span><span class="o">-</span><span class="n">wait</span><span class="p">.</span><span class="n">service</span>
<span class="n">anaconda</span><span class="o">-</span><span class="n">nm</span><span class="o">-</span><span class="n">config</span><span class="p">.</span><span class="n">service</span>               <span class="n">plymouth</span><span class="o">-</span><span class="n">read</span><span class="o">-</span><span class="n">write</span><span class="p">.</span><span class="n">service</span>
<span class="n">anaconda</span><span class="o">-</span><span class="n">noshell</span><span class="p">.</span><span class="n">service</span>                 <span class="n">plymouth</span><span class="o">-</span><span class="n">reboot</span><span class="p">.</span><span class="n">service</span>
<span class="n">anaconda</span><span class="o">-</span><span class="n">pre</span><span class="p">.</span><span class="n">service</span>                     <span class="n">plymouth</span><span class="o">-</span><span class="n">start</span><span class="p">.</span><span class="n">service</span>
<span class="n">anaconda</span><span class="p">.</span><span class="n">service</span>                         <span class="n">plymouth</span><span class="o">-</span><span class="k">switch</span><span class="o">-</span><span class="n">root</span><span class="p">.</span><span class="n">service</span>


<span class="err">$</span> <span class="n">cd</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span>
<span class="err">$</span> <span class="n">ls</span> <span class="o">-</span><span class="n">lat</span>
<span class="n">total</span> <span class="mi">4</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="p">.</span> <span class="mi">17</span> <span class="n">root</span> <span class="n">root</span> <span class="mi">420</span> <span class="n">Apr</span> <span class="mi">19</span> <span class="mi">16</span><span class="o">:</span><span class="mi">19</span> <span class="p">..</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="p">.</span>  <span class="mi">2</span> <span class="n">root</span> <span class="n">root</span>  <span class="mi">40</span> <span class="n">Apr</span> <span class="mi">18</span> <span class="mi">17</span><span class="o">:</span><span class="mi">17</span> <span class="p">.</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="p">.</span>  <span class="mi">2</span> <span class="n">root</span> <span class="n">root</span> <span class="mi">140</span> <span class="n">Apr</span> <span class="mi">18</span> <span class="mi">19</span><span class="o">:</span><span class="mi">17</span> <span class="n">session</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">scope</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="p">.</span>  <span class="mi">2</span> <span class="n">root</span> <span class="n">root</span>  <span class="mi">70</span> <span class="n">Apr</span> <span class="mi">18</span> <span class="mi">19</span><span class="o">:</span><span class="mi">17</span> <span class="n">session</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">scope</span><span class="p">.</span><span class="n">d</span>
<span class="c1">// the time that user login to the system</span>


<span class="c1">// check the time that user login to the system</span>
<span class="err">$</span> <span class="n">w</span>
 <span class="mi">16</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="mi">36</span> <span class="n">up</span>  <span class="mi">9</span><span class="o">:</span><span class="mo">05</span><span class="p">,</span>  <span class="mi">1</span> <span class="n">user</span><span class="p">,</span>  <span class="n">load</span> <span class="n">average</span><span class="o">:</span> <span class="mi">0</span><span class="p">.</span><span class="mo">02</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mo">02</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mo">00</span>
<span class="n">USER</span>     <span class="n">TTY</span>      <span class="n">FROM</span>             <span class="n">LOGIN</span><span class="err">@</span>   <span class="n">IDLE</span>   <span class="n">JCPU</span>   <span class="n">PCPU</span> <span class="n">WHAT</span>
<span class="n">server1</span>  <span class="n">tty2</span>     <span class="n">tty2</span>             <span class="n">Sat17</span>   <span class="mi">23</span><span class="o">:</span><span class="mo">05</span><span class="n">m</span>  <span class="mi">1</span><span class="o">:</span><span class="mi">26</span>   <span class="mi">0</span><span class="p">.</span><span class="mo">00</span><span class="n">s</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">libexec</span><span class="o">/</span><span class="n">gs</span>



<span class="c1">// when enable or disable Services</span>
<span class="c1">// the place where it wrote the symlink.</span>
<span class="err">$</span> <span class="n">cd</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span>
<span class="err">$</span> <span class="n">ls</span>
<span class="n">basic</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>                          <span class="n">nfs</span><span class="o">-</span><span class="n">blkmap</span><span class="p">.</span><span class="n">service</span><span class="p">.</span><span class="n">requires</span>
<span class="n">bluetooth</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>                      <span class="n">nfs</span><span class="o">-</span><span class="n">idmapd</span><span class="p">.</span><span class="n">service</span><span class="p">.</span><span class="n">requires</span>
<span class="n">dbus</span><span class="o">-</span><span class="n">org</span><span class="p">.</span><span class="n">bluez</span><span class="p">.</span><span class="n">service</span>                      <span class="n">nfs</span><span class="o">-</span><span class="n">mountd</span><span class="p">.</span><span class="n">service</span><span class="p">.</span><span class="n">requires</span>
<span class="n">dbus</span><span class="o">-</span><span class="n">org</span><span class="p">.</span><span class="n">fedoraproject</span><span class="p">.</span><span class="n">FirewallD1</span><span class="p">.</span><span class="n">service</span>   <span class="n">nfs</span><span class="o">-</span><span class="n">server</span><span class="p">.</span><span class="n">service</span><span class="p">.</span><span class="n">requires</span>
<span class="n">dbus</span><span class="o">-</span><span class="n">org</span><span class="p">.</span><span class="n">freedesktop</span><span class="p">.</span><span class="n">Avahi</span><span class="p">.</span><span class="n">service</span>          <span class="n">printer</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>
<span class="n">dbus</span><span class="o">-</span><span class="n">org</span><span class="p">.</span><span class="n">freedesktop</span><span class="p">.</span><span class="n">ModemManager1</span><span class="p">.</span><span class="n">service</span>  <span class="n">remote</span><span class="o">-</span><span class="n">fs</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>
<span class="n">dbus</span><span class="o">-</span><span class="n">org</span><span class="p">.</span><span class="n">freedesktop</span><span class="p">.</span><span class="n">nm</span><span class="o">-</span><span class="n">dispatcher</span><span class="p">.</span><span class="n">service</span>  <span class="n">rpc</span><span class="o">-</span><span class="n">gssd</span><span class="p">.</span><span class="n">service</span><span class="p">.</span><span class="n">requires</span>
<span class="n">dbus</span><span class="o">-</span><span class="n">org</span><span class="p">.</span><span class="n">freedesktop</span><span class="p">.</span><span class="n">resolve1</span><span class="p">.</span><span class="n">service</span>       <span class="n">rpc</span><span class="o">-</span><span class="n">statd</span><span class="o">-</span><span class="n">notify</span><span class="p">.</span><span class="n">service</span><span class="p">.</span><span class="n">requires</span>
<span class="n">dbus</span><span class="o">-</span><span class="n">org</span><span class="p">.</span><span class="n">freedesktop</span><span class="p">.</span><span class="n">timedate1</span><span class="p">.</span><span class="n">service</span>      <span class="n">rpc</span><span class="o">-</span><span class="n">statd</span><span class="p">.</span><span class="n">service</span><span class="p">.</span><span class="n">requires</span>
<span class="k">default</span><span class="p">.</span><span class="n">target</span>                              <span class="n">sockets</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>
<span class="n">display</span><span class="o">-</span><span class="n">manager</span><span class="p">.</span><span class="n">service</span>                     <span class="n">sysinit</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>
<span class="n">getty</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>                          <span class="n">syslog</span><span class="p">.</span><span class="n">service</span>
<span class="n">graphical</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>                      <span class="n">systemd</span><span class="o">-</span><span class="n">timedated</span><span class="p">.</span><span class="n">service</span>
<span class="n">multi</span><span class="o">-</span><span class="n">user</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>                     <span class="n">timers</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>
<span class="n">network</span><span class="o">-</span><span class="n">online</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>                 <span class="n">vmtoolsd</span><span class="p">.</span><span class="n">service</span><span class="p">.</span><span class="n">requires</span>
</pre></table></code></div></div><ol><li>ask systemctl about the Service</ol><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre><td class="rouge-code"><pre><span class="c1">// list of all of the loaded units on this system</span>
<span class="c1">// including the unloaded ones</span>
<span class="err">$</span> <span class="n">systemctl</span>


<span class="c1">// a quick status of the system,</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="o">-</span><span class="n">all</span>

  <span class="n">UNIT</span>                      <span class="n">LOAD</span>      <span class="n">ACTIVE</span>   <span class="n">SUB</span>       <span class="n">DESCRIPTION</span>
<span class="err">●</span> <span class="n">boot</span><span class="p">.</span><span class="n">automount</span>            <span class="n">not</span><span class="o">-</span><span class="n">found</span> <span class="n">inactive</span> <span class="n">dead</span>      <span class="n">boot</span><span class="p">.</span><span class="n">automount</span>
  <span class="n">proc</span><span class="o">-</span><span class="n">sys</span><span class="o">-</span><span class="n">fs</span><span class="o">-</span><span class="n">binfmt_misc</span><span class="p">.</span><span class="n">automount</span> <span class="n">loaded</span>    <span class="n">active</span>   <span class="n">waiting</span>   <span class="n">Arbitrary</span> <span class="n">Exec</span>
  <span class="n">dev</span><span class="o">-</span><span class="n">block</span><span class="o">-</span><span class="mi">8</span><span class="o">:</span><span class="mi">2</span><span class="p">.</span><span class="n">device</span>      <span class="n">loaded</span>    <span class="n">active</span>   <span class="n">plugged</span>   <span class="n">VBOX_HARDDISK</span> <span class="mi">2</span>
  <span class="n">dev</span><span class="o">-</span><span class="n">cdrom</span><span class="p">.</span><span class="n">device</span>          <span class="n">loaded</span>    <span class="n">active</span>   <span class="n">plugged</span>   <span class="n">VBOX_CD</span><span class="o">-</span><span class="n">ROM</span> <span class="n">VBox_GAs_6</span>
  <span class="n">dev</span><span class="o">-</span><span class="n">cl</span><span class="o">-</span><span class="n">root</span><span class="p">.</span><span class="n">device</span>        <span class="n">loaded</span>    <span class="n">active</span>   <span class="n">plugged</span>   <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">cl</span><span class="o">/</span><span class="n">root</span>
  <span class="n">dev</span><span class="o">-</span><span class="n">cl</span><span class="o">-</span><span class="n">swap</span><span class="p">.</span><span class="n">device</span>        <span class="n">loaded</span>    <span class="n">active</span>   <span class="n">plugged</span>   <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">cl</span><span class="o">/</span><span class="n">swap</span>


<span class="c1">// ask systemctl what it knows about particular unit types</span>
<span class="c1">// ask for socket</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="o">--</span><span class="n">type</span><span class="o">=</span><span class="n">socket</span>

<span class="n">UNIT</span>                          <span class="n">LOAD</span>   <span class="n">ACTIVE</span> <span class="n">SUB</span>       <span class="n">DESCRIPTION</span>
<span class="n">avahi</span><span class="o">-</span><span class="n">daemon</span><span class="p">.</span><span class="n">socket</span>           <span class="n">loaded</span> <span class="n">active</span> <span class="n">running</span>   <span class="n">Avahi</span> <span class="n">mDNS</span><span class="o">/</span><span class="n">DNS</span><span class="o">-</span><span class="n">SD</span> <span class="n">Stack</span> <span class="n">A</span><span class="o">&gt;</span>
<span class="n">cups</span><span class="p">.</span><span class="n">socket</span>                   <span class="n">loaded</span> <span class="n">active</span> <span class="n">running</span>   <span class="n">CUPS</span> <span class="n">Scheduler</span>

<span class="n">dbus</span><span class="p">.</span><span class="n">socket</span>                   <span class="n">loaded</span> <span class="n">active</span> <span class="n">running</span>   <span class="n">D</span><span class="o">-</span><span class="n">Bus</span> <span class="n">System</span> <span class="n">Message</span> <span class="n">Bus</span> <span class="o">&gt;</span>
<span class="n">dm</span><span class="o">-</span><span class="n">event</span><span class="p">.</span><span class="n">socket</span>               <span class="n">loaded</span> <span class="n">active</span> <span class="n">listening</span> <span class="n">Device</span><span class="o">-</span><span class="n">mapper</span> <span class="n">event</span> <span class="n">daemo</span><span class="o">&gt;</span>
<span class="n">iscsid</span><span class="p">.</span><span class="n">socket</span>                 <span class="n">loaded</span> <span class="n">active</span> <span class="n">listening</span> <span class="n">Open</span><span class="o">-</span><span class="n">iSCSI</span> <span class="n">iscsid</span> <span class="n">Socket</span>
<span class="n">iscsiuio</span><span class="p">.</span><span class="n">socket</span>               <span class="n">loaded</span> <span class="n">active</span> <span class="n">listening</span> <span class="n">Open</span><span class="o">-</span><span class="n">iSCSI</span> <span class="n">iscsiuio</span> <span class="n">Socket</span>
<span class="n">lvm2</span><span class="o">-</span><span class="n">lvmpolld</span><span class="p">.</span><span class="n">socket</span>          <span class="n">loaded</span> <span class="n">active</span> <span class="n">listening</span> <span class="n">LVM2</span> <span class="n">poll</span> <span class="n">daemon</span> <span class="n">socket</span>
<span class="n">multipathd</span><span class="p">.</span><span class="n">socket</span>             <span class="n">loaded</span> <span class="n">active</span> <span class="n">listening</span> <span class="n">multipathd</span> <span class="n">control</span> <span class="n">socket</span>
<span class="n">rpcbind</span><span class="p">.</span><span class="n">socket</span>                <span class="n">loaded</span> <span class="n">active</span> <span class="n">running</span>   <span class="n">RPCbind</span> <span class="n">Server</span> <span class="n">Activation</span><span class="o">&gt;</span>
<span class="n">sssd</span><span class="o">-</span><span class="n">kcm</span><span class="p">.</span><span class="n">socket</span>               <span class="n">loaded</span> <span class="n">active</span> <span class="n">running</span>   <span class="n">SSSD</span> <span class="n">Kerberos</span> <span class="n">Cache</span> <span class="n">Manag</span><span class="o">&gt;</span>
<span class="n">systemd</span><span class="o">-</span><span class="n">coredump</span><span class="p">.</span><span class="n">socket</span>       <span class="n">loaded</span> <span class="n">active</span> <span class="n">listening</span> <span class="n">Process</span> <span class="n">Core</span> <span class="n">Dump</span> <span class="n">Socket</span>
<span class="n">systemd</span><span class="o">-</span><span class="n">initctl</span><span class="p">.</span><span class="n">socket</span>        <span class="n">loaded</span> <span class="n">active</span> <span class="n">listening</span> <span class="n">initctl</span> <span class="n">Compatibility</span> <span class="n">Nam</span><span class="o">&gt;</span>
<span class="n">systemd</span><span class="o">-</span><span class="n">journald</span><span class="o">-</span><span class="n">dev</span><span class="o">-</span><span class="n">log</span><span class="p">.</span><span class="n">socket</span> <span class="n">loaded</span> <span class="n">active</span> <span class="n">running</span>   <span class="n">Journal</span> <span class="n">Socket</span> <span class="p">(</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">lo</span><span class="o">&gt;</span><span class="p">)</span>
<span class="n">systemd</span><span class="o">-</span><span class="n">journald</span><span class="p">.</span><span class="n">socket</span>       <span class="n">loaded</span> <span class="n">active</span> <span class="n">running</span>   <span class="n">Journal</span> <span class="n">Socket</span>
<span class="n">systemd</span><span class="o">-</span><span class="n">udevd</span><span class="o">-</span><span class="n">control</span><span class="p">.</span><span class="n">socket</span>  <span class="n">loaded</span> <span class="n">active</span> <span class="n">running</span>   <span class="n">udev</span> <span class="n">Control</span> <span class="n">Socket</span>
<span class="n">systemd</span><span class="o">-</span><span class="n">udevd</span><span class="o">-</span><span class="n">kernel</span><span class="p">.</span><span class="n">socket</span>   <span class="n">loaded</span> <span class="n">active</span> <span class="n">running</span>   <span class="n">udev</span> <span class="n">Kernel</span> <span class="n">Socket</span>
<span class="n">virtlockd</span><span class="p">.</span><span class="n">socket</span>              <span class="n">loaded</span> <span class="n">active</span> <span class="n">listening</span> <span class="n">Virtual</span> <span class="n">machine</span> <span class="n">lock</span> <span class="n">mana</span><span class="o">&gt;</span>
<span class="n">virtlogd</span><span class="p">.</span><span class="n">socket</span>               <span class="n">loaded</span> <span class="n">active</span> <span class="n">listening</span> <span class="n">Virtual</span> <span class="n">machine</span> <span class="n">log</span> <span class="n">manag</span><span class="o">&gt;</span>

<span class="n">LOAD</span>   <span class="o">=</span> <span class="n">Reflects</span> <span class="n">whether</span> <span class="n">the</span> <span class="n">unit</span> <span class="n">definition</span> <span class="n">was</span> <span class="n">properly</span> <span class="n">loaded</span><span class="p">.</span>
<span class="n">ACTIVE</span> <span class="o">=</span> <span class="n">The</span> <span class="n">high</span><span class="o">-</span><span class="n">level</span> <span class="n">unit</span> <span class="n">activation</span> <span class="n">state</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">e</span><span class="p">.</span> <span class="n">generalization</span> <span class="n">of</span> <span class="n">SUB</span><span class="p">.</span>
<span class="n">SUB</span>    <span class="o">=</span> <span class="n">The</span> <span class="n">low</span><span class="o">-</span><span class="n">level</span> <span class="n">unit</span> <span class="n">activation</span> <span class="n">state</span><span class="p">,</span> <span class="n">values</span> <span class="n">depend</span> <span class="n">on</span> <span class="n">unit</span> <span class="n">type</span><span class="p">.</span>

<span class="mi">18</span> <span class="n">loaded</span> <span class="n">units</span> <span class="n">listed</span><span class="p">.</span> <span class="n">Pass</span> <span class="o">--</span><span class="n">all</span> <span class="n">to</span> <span class="n">see</span> <span class="n">loaded</span> <span class="n">but</span> <span class="n">inactive</span> <span class="n">units</span><span class="p">,</span> <span class="n">too</span><span class="p">.</span>
<span class="n">To</span> <span class="n">show</span> <span class="n">all</span> <span class="n">installed</span> <span class="n">unit</span> <span class="n">files</span> <span class="n">use</span> <span class="err">'</span><span class="n">systemctl</span> <span class="n">list</span><span class="o">-</span><span class="n">unit</span><span class="o">-</span><span class="n">files</span><span class="err">'</span><span class="p">.</span>
<span class="n">lines</span> <span class="mi">4</span><span class="o">-</span><span class="mi">26</span><span class="o">/</span><span class="mi">26</span> <span class="p">(</span><span class="n">END</span><span class="p">)</span>

</pre></table></code></div></div><hr /><h2 id="configure-the-unit-file-precedence-and-automatic-restart">configure the unit file precedence and Automatic Restart</h2><p>server0:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
</pre><td class="rouge-code"><pre>
<span class="mi">1</span><span class="p">.</span> <span class="n">check</span> <span class="n">status</span><span class="p">,</span> <span class="n">find</span> <span class="n">the</span> <span class="n">location</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="n">status</span> <span class="n">httpd</span>
<span class="err">●</span> <span class="n">httpd</span><span class="p">.</span><span class="n">service</span> <span class="o">-</span> <span class="n">The</span> <span class="n">Apache</span> <span class="n">HTTP</span> <span class="n">Server</span>
   <span class="c1">// (location, autostart, ...)</span>
   <span class="n">Loaded</span><span class="o">:</span> <span class="n">loaded</span> <span class="p">(</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span><span class="p">;</span> <span class="n">enabled</span><span class="p">;</span> <span class="n">vendor</span> <span class="n">prese</span><span class="o">&gt;</span><span class="p">)</span>
   <span class="n">Active</span><span class="o">:</span> <span class="n">reloading</span> <span class="p">(</span><span class="n">reload</span><span class="p">)</span> <span class="n">since</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mi">14</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mi">16</span> <span class="n">EDT</span><span class="p">;</span> <span class="mi">2</span><span class="n">s</span> <span class="n">ago</span>
     <span class="n">Docs</span><span class="o">:</span> <span class="n">man</span><span class="o">:</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
 <span class="n">Main</span> <span class="n">PID</span><span class="o">:</span> <span class="mi">8944</span> <span class="p">(</span><span class="n">httpd</span><span class="p">)</span>

<span class="o">================================================================</span>

<span class="mi">2</span><span class="p">.</span> <span class="n">copy</span> <span class="n">the</span> <span class="n">file</span> <span class="n">to</span> <span class="n">the</span> <span class="n">higher</span> <span class="n">dependency</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">cp</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span>

<span class="o">================================================================</span>

<span class="mi">3</span><span class="p">.</span> <span class="n">notify</span> <span class="n">the</span> <span class="n">systemd</span> <span class="n">the</span> <span class="n">new</span> <span class="n">file</span><span class="p">.</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="n">disable</span> <span class="n">httpd</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">httpd</span>

<span class="n">or</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">daemon</span><span class="o">-</span><span class="n">reload</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">restart</span> <span class="n">httpd</span>

<span class="o">================================================================</span>

<span class="mi">4</span><span class="p">.</span> <span class="n">check</span> <span class="n">it</span><span class="p">.</span> <span class="n">the</span> <span class="n">location</span> <span class="n">changed</span><span class="p">.</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="n">status</span> <span class="n">httpd</span>
<span class="err">●</span> <span class="n">httpd</span><span class="p">.</span><span class="n">service</span> <span class="o">-</span> <span class="n">The</span> <span class="n">Apache</span> <span class="n">HTTP</span> <span class="n">Server</span>
   <span class="n">Loaded</span><span class="o">:</span> <span class="n">loaded</span> <span class="p">(</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span><span class="p">;</span> <span class="n">enabled</span><span class="p">;</span> <span class="n">vendor</span> <span class="n">preset</span><span class="o">:</span> <span class="n">d</span><span class="o">&gt;</span>
   <span class="n">Active</span><span class="o">:</span> <span class="n">reloading</span> <span class="p">(</span><span class="n">reload</span><span class="p">)</span> <span class="n">since</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mi">16</span><span class="o">:</span><span class="mi">46</span><span class="o">:</span><span class="mi">08</span> <span class="n">EDT</span><span class="p">;</span> <span class="mi">6</span><span class="n">s</span> <span class="n">ago</span>

<span class="o">================================================================</span>

<span class="mi">5</span><span class="p">.</span> <span class="n">edits</span> <span class="n">to</span> <span class="n">this</span> <span class="n">file</span> <span class="n">and</span> <span class="n">not</span> <span class="n">impact</span> <span class="n">the</span> <span class="n">base</span> <span class="n">file</span><span class="p">,</span> <span class="k">if</span> <span class="n">needed</span> <span class="n">that</span> <span class="n">file</span> <span class="n">again</span> <span class="k">for</span> <span class="n">a</span> <span class="n">restore</span> <span class="n">or</span> <span class="k">for</span> <span class="n">reference</span><span class="p">.</span>

<span class="n">autorestart</span> <span class="n">is</span> <span class="n">difficult</span> <span class="n">to</span> <span class="n">troubleshoot</span>


<span class="err">$</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span>
<span class="c1">// edit the file</span>

<span class="cp">#       [Service]
#       Environment=OPTIONS=-DMY_DEFINE
</span>
<span class="p">[</span><span class="n">Unit</span><span class="p">]</span>
<span class="n">Description</span><span class="o">=</span><span class="n">The</span> <span class="n">Apache</span> <span class="n">HTTP</span> <span class="n">Server</span>
<span class="n">Wants</span><span class="o">=</span><span class="n">httpd</span><span class="o">-</span><span class="n">init</span><span class="p">.</span><span class="n">service</span>
<span class="c1">// the dependency</span>
<span class="c1">// it must start after all these</span>
<span class="c1">// target that provide the needed service (requirement) for httpd to start.</span>
<span class="c1">// target - system status = runlevels</span>
<span class="n">After</span><span class="o">=</span><span class="n">network</span><span class="p">.</span><span class="n">target</span> <span class="n">remote</span><span class="o">-</span><span class="n">fs</span><span class="p">.</span><span class="n">target</span> <span class="n">nss</span><span class="o">-</span><span class="n">lookup</span><span class="p">.</span><span class="n">target</span> <span class="n">httpd</span><span class="o">-</span><span class="n">init</span><span class="p">.</span><span class="n">service</span>
<span class="n">Documentation</span><span class="o">=</span><span class="n">man</span><span class="o">:</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

<span class="p">[</span><span class="n">Service</span><span class="p">]</span>
<span class="c1">// add the line</span>
<span class="c1">// restart only when there is a crash or an unclean process exit.</span>
<span class="o">!!!!!</span>
<span class="n">Restart</span><span class="o">=</span><span class="n">on</span><span class="o">-</span><span class="n">failure</span>

<span class="c1">// tells the service to notify systemd when finished initializing and updated state</span>
<span class="n">Type</span><span class="o">=</span><span class="n">notify</span>
<span class="c1">// set environment variables for the service.</span>
<span class="n">Environment</span><span class="o">=</span><span class="n">LANG</span><span class="o">=</span><span class="n">C</span>
<span class="c1">// ExecStart: the actual binary program and its required command line options.</span>
<span class="n">ExecStart</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">httpd</span> <span class="err">$</span><span class="n">OPTIONS</span> <span class="o">-</span><span class="n">DFOREGROUND</span>
<span class="c1">// ExecReload: the command out options to gracefully reload the daemon</span>
<span class="n">ExecReload</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">httpd</span> <span class="err">$</span><span class="n">OPTIONS</span> <span class="o">-</span><span class="n">k</span> <span class="n">graceful</span>
<span class="c1">// ExecStop: calls kill with the variable of MAINPID.</span>
<span class="c1">// This will stop the main HTTP process, and killing off all child processes</span>
<span class="c1">// we don't just want to send a SIGTERM, signal to immediately kill all processes. We want to wait a second, and to do that, we send the SIGCONT signal as the kill signal. And then, the final option in the Service section is PrivateTmp, set to true.</span>
<span class="n">ExecStop</span><span class="o">=/</span><span class="n">bin</span><span class="o">/</span><span class="n">kill</span> <span class="o">-</span><span class="n">WINCH</span> <span class="err">$</span><span class="p">{</span><span class="n">MAINPID</span><span class="p">}</span>
<span class="cp"># Send SIGWINCH for graceful stop
</span><span class="n">KillSignal</span><span class="o">=</span><span class="n">SIGWINCH</span>
<span class="n">KillMode</span><span class="o">=</span><span class="n">mixed</span>
<span class="c1">// tells systemd to provide a private temp directory for this process</span>
<span class="c1">// a special security feature</span>
<span class="n">PrivateTmp</span><span class="o">=</span><span class="nb">true</span>

<span class="p">[</span><span class="n">Install</span><span class="p">]</span>
<span class="c1">// enable httpd, it will place it in the multi-user target</span>
<span class="c1">// disable it, it will remove that symbolic link</span>
<span class="n">WantedBy</span><span class="o">=</span><span class="n">multi</span><span class="o">-</span><span class="n">user</span><span class="p">.</span><span class="n">target</span>

<span class="o">================================================================</span>

<span class="mi">6</span><span class="p">.</span> <span class="n">reload</span> <span class="n">to</span> <span class="n">confirm</span> <span class="n">the</span> <span class="n">edit</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="n">disable</span> <span class="n">httpd</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">httpd</span>

<span class="n">or</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">daemon</span><span class="o">-</span><span class="n">reload</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">restart</span> <span class="n">httpd</span>

<span class="o">================================================================</span>

<span class="mi">7</span><span class="p">.</span> <span class="n">kill</span> <span class="n">it</span><span class="p">,</span> <span class="n">confirm</span> <span class="n">the</span> <span class="n">autorestart</span> <span class="n">with</span> <span class="n">different</span> <span class="n">PID</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="n">status</span> <span class="n">httpd</span>
<span class="err">●</span> <span class="n">httpd</span><span class="p">.</span><span class="n">service</span> <span class="o">-</span> <span class="n">The</span> <span class="n">Apache</span> <span class="n">HTTP</span> <span class="n">Server</span>
   <span class="n">Loaded</span><span class="o">:</span> <span class="n">loaded</span> <span class="p">(</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span><span class="p">;</span> <span class="n">enabled</span><span class="p">;</span> <span class="n">vendor</span> <span class="n">preset</span><span class="o">:</span> <span class="n">d</span><span class="o">&gt;</span><span class="p">)</span>
   <span class="n">Active</span><span class="o">:</span> <span class="n">active</span> <span class="p">(</span><span class="n">running</span><span class="p">)</span> <span class="n">since</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mi">17</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mi">42</span> <span class="n">EDT</span><span class="p">;</span> <span class="mi">23</span><span class="n">s</span> <span class="n">ago</span><span class="p">)</span>
     <span class="n">Docs</span><span class="o">:</span> <span class="n">man</span><span class="o">:</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
 <span class="n">Main</span> <span class="n">PID</span><span class="o">:</span> <span class="mi">12437</span> <span class="p">(</span><span class="n">httpd</span><span class="p">)</span>


<span class="err">$</span> <span class="n">sudo</span> <span class="n">killall</span> <span class="n">httpd</span>

<span class="err">$</span> <span class="n">ps</span> <span class="o">-</span><span class="n">aux</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">httpd</span>
<span class="n">root</span>     <span class="mi">12692</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">4</span> <span class="mi">280264</span> <span class="mi">11024</span> <span class="o">?</span>        <span class="n">Ss</span>   <span class="mi">17</span><span class="o">:</span><span class="mo">02</span>   <span class="mi">0</span><span class="o">:</span><span class="mo">00</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">httpd</span> <span class="o">-</span><span class="n">DFOREGROUND</span>
<span class="n">apache</span>   <span class="mi">12693</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">3</span> <span class="mi">292480</span>  <span class="mi">8456</span> <span class="o">?</span>        <span class="n">S</span>    <span class="mi">17</span><span class="o">:</span><span class="mo">02</span>   <span class="mi">0</span><span class="o">:</span><span class="mo">00</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">httpd</span> <span class="o">-</span><span class="n">DFOREGROUND</span>
<span class="n">apache</span>   <span class="mi">12694</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">6</span> <span class="mi">1481388</span> <span class="mi">13800</span> <span class="o">?</span>       <span class="n">Sl</span>   <span class="mi">17</span><span class="o">:</span><span class="mo">02</span>   <span class="mi">0</span><span class="o">:</span><span class="mo">00</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">httpd</span> <span class="o">-</span><span class="n">DFOREGROUND</span>
<span class="n">apache</span>   <span class="mi">12695</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">5</span> <span class="mi">1350252</span> <span class="mi">11752</span> <span class="o">?</span>       <span class="n">Sl</span>   <span class="mi">17</span><span class="o">:</span><span class="mo">02</span>   <span class="mi">0</span><span class="o">:</span><span class="mo">00</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">httpd</span> <span class="o">-</span><span class="n">DFOREGROUND</span>
<span class="n">apache</span>   <span class="mi">12696</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">5</span> <span class="mi">1350252</span> <span class="mi">11752</span> <span class="o">?</span>       <span class="n">Sl</span>   <span class="mi">17</span><span class="o">:</span><span class="mo">02</span>   <span class="mi">0</span><span class="o">:</span><span class="mo">00</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">httpd</span> <span class="o">-</span><span class="n">DFOREGROUND</span>
<span class="n">server1</span>  <span class="mi">12909</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">12108</span>  <span class="mi">1056</span> <span class="n">pts</span><span class="o">/</span><span class="mi">0</span>    <span class="n">R</span><span class="o">+</span>   <span class="mi">17</span><span class="o">:</span><span class="mo">02</span>   <span class="mi">0</span><span class="o">:</span><span class="mo">00</span> <span class="n">grep</span> <span class="o">--</span><span class="n">color</span><span class="o">=</span><span class="k">auto</span> <span class="n">httpd</span>


<span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">status</span> <span class="n">httpd</span>
<span class="err">●</span> <span class="n">httpd</span><span class="p">.</span><span class="n">service</span> <span class="o">-</span> <span class="n">The</span> <span class="n">Apache</span> <span class="n">HTTP</span> <span class="n">Server</span>
   <span class="n">Loaded</span><span class="o">:</span> <span class="n">loaded</span> <span class="p">(</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span><span class="p">;</span> <span class="n">enabled</span><span class="p">;</span> <span class="n">vendor</span> <span class="n">preset</span><span class="o">:</span> <span class="n">d</span><span class="o">&gt;</span><span class="p">)</span>
   <span class="n">Active</span><span class="o">:</span> <span class="n">active</span> <span class="p">(</span><span class="n">running</span><span class="p">)</span> <span class="n">since</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mi">17</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mi">25</span> <span class="n">EDT</span><span class="p">;</span> <span class="mi">29</span><span class="n">s</span> <span class="n">ago</span><span class="p">)</span>
     <span class="n">Docs</span><span class="o">:</span> <span class="n">man</span><span class="o">:</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
  <span class="n">Process</span><span class="o">:</span> <span class="mi">12687</span> <span class="n">ExecStop</span><span class="o">=/</span><span class="n">bin</span><span class="o">/</span><span class="n">kill</span> <span class="o">-</span><span class="n">WINCH</span> <span class="err">$</span><span class="p">{</span><span class="n">MAINPID</span><span class="p">}</span> <span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="n">exited</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">FA</span><span class="o">&gt;</span><span class="p">)</span>
 <span class="n">Main</span> <span class="n">PID</span><span class="o">:</span> <span class="mi">12692</span> <span class="p">(</span><span class="n">httpd</span><span class="p">)</span>


<span class="o">================================================================</span>

<span class="n">see</span> <span class="n">all</span> <span class="n">of</span> <span class="n">our</span> <span class="n">unit</span> <span class="n">settings</span>
<span class="n">including</span> <span class="n">the</span> <span class="k">default</span> <span class="n">ones</span> <span class="n">that</span> <span class="n">define</span> <span class="n">our</span> <span class="n">Service</span> <span class="n">unit</span><span class="p">.</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="n">show</span> <span class="n">httpd</span>


<span class="n">find</span> <span class="n">out</span> <span class="n">what</span> <span class="n">a</span> <span class="n">particular</span> <span class="n">setting</span> <span class="n">is</span>

<span class="err">$</span> <span class="n">man</span> <span class="n">systemd</span><span class="p">.</span><span class="n">unit</span>

<span class="o">================================================================</span>

</pre></table></code></div></div><hr /><h2 id="systemd-target">systemd: target</h2><p>server0:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
</pre><td class="rouge-code"><pre>
<span class="o">================================================================</span>

<span class="mi">1</span><span class="p">.</span> <span class="n">list</span> <span class="n">all</span> <span class="n">the</span> <span class="n">target</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="n">list</span><span class="o">-</span><span class="n">units</span> <span class="o">--</span><span class="n">type</span><span class="o">=</span><span class="n">target</span> <span class="o">--</span><span class="n">all</span>

<span class="n">UNIT</span>                      <span class="n">LOAD</span>      <span class="n">ACTIVE</span>   <span class="n">SUB</span>    <span class="n">DESCRIPTION</span>
<span class="n">basic</span><span class="p">.</span><span class="n">target</span>              <span class="n">loaded</span>    <span class="n">active</span>   <span class="n">active</span> <span class="n">Basic</span> <span class="n">System</span>
<span class="n">cryptsetup</span><span class="p">.</span><span class="n">target</span>         <span class="n">loaded</span>    <span class="n">active</span>   <span class="n">active</span> <span class="n">Local</span> <span class="n">Encrypted</span> <span class="n">Volumes</span>
<span class="n">emergency</span><span class="p">.</span><span class="n">target</span>          <span class="n">loaded</span>    <span class="n">inactive</span> <span class="n">dead</span>   <span class="n">Emergency</span> <span class="n">Mode</span>
<span class="c1">// loaded: system know it, but not active.</span>



<span class="mi">2</span><span class="p">.</span> <span class="n">list</span> <span class="n">all</span> <span class="n">the</span> <span class="n">active</span><span class="o">/</span><span class="n">running</span> <span class="n">target</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="n">list</span><span class="o">-</span><span class="n">units</span> <span class="o">--</span><span class="n">type</span><span class="o">=</span><span class="n">target</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">list</span><span class="o">-</span><span class="n">units</span> <span class="o">--</span><span class="n">type</span> <span class="n">target</span>

<span class="n">UNIT</span>                   <span class="n">LOAD</span>   <span class="n">ACTIVE</span> <span class="n">SUB</span>    <span class="n">DESCRIPTION</span>
<span class="n">basic</span><span class="p">.</span><span class="n">target</span>           <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">Basic</span> <span class="n">System</span>
<span class="n">cryptsetup</span><span class="p">.</span><span class="n">target</span>      <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">Local</span> <span class="n">Encrypted</span> <span class="n">Volumes</span>
<span class="n">getty</span><span class="p">.</span><span class="n">target</span>           <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">Login</span> <span class="n">Prompts</span>
<span class="n">graphical</span><span class="p">.</span><span class="n">target</span>       <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">Graphical</span> <span class="n">Interface</span>
<span class="n">local</span><span class="o">-</span><span class="n">fs</span><span class="o">-</span><span class="n">pre</span><span class="p">.</span><span class="n">target</span>    <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">Local</span> <span class="n">File</span> <span class="n">Systems</span> <span class="p">(</span><span class="n">Pre</span><span class="p">)</span>
<span class="n">local</span><span class="o">-</span><span class="n">fs</span><span class="p">.</span><span class="n">target</span>        <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">Local</span> <span class="n">File</span> <span class="n">Systems</span>
<span class="n">multi</span><span class="o">-</span><span class="n">user</span><span class="p">.</span><span class="n">target</span>      <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">Multi</span><span class="o">-</span><span class="n">User</span> <span class="n">System</span>
<span class="n">network</span><span class="o">-</span><span class="n">online</span><span class="p">.</span><span class="n">target</span>  <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">Network</span> <span class="n">is</span> <span class="n">Online</span>
<span class="n">network</span><span class="o">-</span><span class="n">pre</span><span class="p">.</span><span class="n">target</span>     <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">Network</span> <span class="p">(</span><span class="n">Pre</span><span class="p">)</span>
<span class="n">network</span><span class="p">.</span><span class="n">target</span>         <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">Network</span>
<span class="n">nfs</span><span class="o">-</span><span class="n">client</span><span class="p">.</span><span class="n">target</span>      <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">NFS</span> <span class="n">client</span> <span class="n">services</span>
<span class="n">nss</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">lookup</span><span class="p">.</span><span class="n">target</span> <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">User</span> <span class="n">and</span> <span class="n">Group</span> <span class="n">Name</span> <span class="n">Lookups</span>
<span class="n">paths</span><span class="p">.</span><span class="n">target</span>           <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">Paths</span>
<span class="n">remote</span><span class="o">-</span><span class="n">fs</span><span class="o">-</span><span class="n">pre</span><span class="p">.</span><span class="n">target</span>   <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">Remote</span> <span class="n">File</span> <span class="n">Systems</span> <span class="p">(</span><span class="n">Pre</span><span class="p">)</span>
<span class="n">remote</span><span class="o">-</span><span class="n">fs</span><span class="p">.</span><span class="n">target</span>       <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">Remote</span> <span class="n">File</span> <span class="n">Systems</span>
<span class="n">rpc_pipefs</span><span class="p">.</span><span class="n">target</span>      <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">rpc_pipefs</span><span class="p">.</span><span class="n">target</span>
<span class="n">rpcbind</span><span class="p">.</span><span class="n">target</span>         <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">RPC</span> <span class="n">Port</span> <span class="n">Mapper</span>
<span class="n">slices</span><span class="p">.</span><span class="n">target</span>          <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">Slices</span>
<span class="n">sockets</span><span class="p">.</span><span class="n">target</span>         <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">Sockets</span>
<span class="n">sound</span><span class="p">.</span><span class="n">target</span>           <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">Sound</span> <span class="n">Card</span>
<span class="n">sshd</span><span class="o">-</span><span class="n">keygen</span><span class="p">.</span><span class="n">target</span>     <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">sshd</span><span class="o">-</span><span class="n">keygen</span><span class="p">.</span><span class="n">target</span>
<span class="n">swap</span><span class="p">.</span><span class="n">target</span>            <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">Swap</span>
<span class="n">sysinit</span><span class="p">.</span><span class="n">target</span>         <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">System</span> <span class="n">Initialization</span>
<span class="n">timers</span><span class="p">.</span><span class="n">target</span>          <span class="n">loaded</span> <span class="n">active</span> <span class="n">active</span> <span class="n">Timers</span>

<span class="n">LOAD</span>   <span class="o">=</span> <span class="n">Reflects</span> <span class="n">whether</span> <span class="n">the</span> <span class="n">unit</span> <span class="n">definition</span> <span class="n">was</span> <span class="n">properly</span> <span class="n">loaded</span><span class="p">.</span>
<span class="n">ACTIVE</span> <span class="o">=</span> <span class="n">The</span> <span class="n">high</span><span class="o">-</span><span class="n">level</span> <span class="n">unit</span> <span class="n">activation</span> <span class="n">state</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">e</span><span class="p">.</span> <span class="n">generalization</span> <span class="n">of</span> <span class="n">SUB</span><span class="p">.</span>
<span class="n">SUB</span>    <span class="o">=</span> <span class="n">The</span> <span class="n">low</span><span class="o">-</span><span class="n">level</span> <span class="n">unit</span> <span class="n">activation</span> <span class="n">state</span><span class="p">,</span> <span class="n">values</span> <span class="n">depend</span> <span class="n">on</span> <span class="n">unit</span> <span class="n">type</span><span class="p">.</span>

<span class="mi">24</span> <span class="n">loaded</span> <span class="n">units</span> <span class="n">listed</span><span class="p">.</span> <span class="n">Pass</span> <span class="o">--</span><span class="n">all</span> <span class="n">to</span> <span class="n">see</span> <span class="n">loaded</span> <span class="n">but</span> <span class="n">inactive</span> <span class="n">units</span><span class="p">,</span> <span class="n">too</span><span class="p">.</span>
<span class="n">To</span> <span class="n">show</span> <span class="n">all</span> <span class="n">installed</span> <span class="n">unit</span> <span class="n">files</span> <span class="n">use</span> <span class="err">'</span><span class="n">systemctl</span> <span class="n">list</span><span class="o">-</span><span class="n">unit</span><span class="o">-</span><span class="n">files</span><span class="err">'</span><span class="p">.</span>


<span class="o">================================================================</span>

<span class="mi">3</span><span class="p">.</span> <span class="n">target</span>

<span class="n">when</span> <span class="n">enable</span> <span class="n">a</span> <span class="n">service</span>
<span class="n">it</span> <span class="n">place</span> <span class="n">a</span> <span class="n">symbolic</span> <span class="n">link</span> <span class="n">in</span> <span class="n">a</span> <span class="n">directory</span> <span class="k">for</span> <span class="n">that</span> <span class="n">target</span><span class="p">,</span> <span class="n">in</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="p">.</span>

<span class="err">$</span> <span class="n">cd</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span>
<span class="err">$</span> <span class="n">ls</span>
<span class="n">basic</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>                          <span class="n">nfs</span><span class="o">-</span><span class="n">blkmap</span><span class="p">.</span><span class="n">service</span><span class="p">.</span><span class="n">requires</span>
<span class="n">bluetooth</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>                      <span class="n">nfs</span><span class="o">-</span><span class="n">idmapd</span><span class="p">.</span><span class="n">service</span><span class="p">.</span><span class="n">requires</span>
<span class="n">dbus</span><span class="o">-</span><span class="n">org</span><span class="p">.</span><span class="n">bluez</span><span class="p">.</span><span class="n">service</span>                      <span class="n">nfs</span><span class="o">-</span><span class="n">mountd</span><span class="p">.</span><span class="n">service</span><span class="p">.</span><span class="n">requires</span>
<span class="n">dbus</span><span class="o">-</span><span class="n">org</span><span class="p">.</span><span class="n">fedoraproject</span><span class="p">.</span><span class="n">FirewallD1</span><span class="p">.</span><span class="n">service</span>   <span class="n">nfs</span><span class="o">-</span><span class="n">server</span><span class="p">.</span><span class="n">service</span><span class="p">.</span><span class="n">requires</span>
<span class="n">dbus</span><span class="o">-</span><span class="n">org</span><span class="p">.</span><span class="n">freedesktop</span><span class="p">.</span><span class="n">Avahi</span><span class="p">.</span><span class="n">service</span>          <span class="n">printer</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>
<span class="n">dbus</span><span class="o">-</span><span class="n">org</span><span class="p">.</span><span class="n">freedesktop</span><span class="p">.</span><span class="n">ModemManager1</span><span class="p">.</span><span class="n">service</span>  <span class="n">remote</span><span class="o">-</span><span class="n">fs</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>
<span class="n">dbus</span><span class="o">-</span><span class="n">org</span><span class="p">.</span><span class="n">freedesktop</span><span class="p">.</span><span class="n">nm</span><span class="o">-</span><span class="n">dispatcher</span><span class="p">.</span><span class="n">service</span>  <span class="n">rpc</span><span class="o">-</span><span class="n">gssd</span><span class="p">.</span><span class="n">service</span><span class="p">.</span><span class="n">requires</span>
<span class="n">dbus</span><span class="o">-</span><span class="n">org</span><span class="p">.</span><span class="n">freedesktop</span><span class="p">.</span><span class="n">resolve1</span><span class="p">.</span><span class="n">service</span>       <span class="n">rpc</span><span class="o">-</span><span class="n">statd</span><span class="o">-</span><span class="n">notify</span><span class="p">.</span><span class="n">service</span><span class="p">.</span><span class="n">requires</span>
<span class="n">dbus</span><span class="o">-</span><span class="n">org</span><span class="p">.</span><span class="n">freedesktop</span><span class="p">.</span><span class="n">timedate1</span><span class="p">.</span><span class="n">service</span>      <span class="n">rpc</span><span class="o">-</span><span class="n">statd</span><span class="p">.</span><span class="n">service</span><span class="p">.</span><span class="n">requires</span>
<span class="k">default</span><span class="p">.</span><span class="n">target</span>                              <span class="n">sockets</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>
<span class="n">display</span><span class="o">-</span><span class="n">manager</span><span class="p">.</span><span class="n">service</span>                     <span class="n">sysinit</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>
<span class="n">getty</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>                          <span class="n">syslog</span><span class="p">.</span><span class="n">service</span>
<span class="n">graphical</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>                      <span class="n">systemd</span><span class="o">-</span><span class="n">timedated</span><span class="p">.</span><span class="n">service</span>
<span class="n">httpd</span><span class="p">.</span><span class="n">service</span>                               <span class="n">timers</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>
<span class="n">multi</span><span class="o">-</span><span class="n">user</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>                     <span class="n">vmtoolsd</span><span class="p">.</span><span class="n">service</span><span class="p">.</span><span class="n">requires</span>
<span class="n">network</span><span class="o">-</span><span class="n">online</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>



<span class="n">the</span> <span class="n">multi</span><span class="o">-</span><span class="n">user</span> <span class="n">target</span> <span class="n">is</span> <span class="n">a</span> <span class="n">functioning</span><span class="p">,</span> <span class="n">network</span><span class="o">-</span><span class="n">enabled</span> <span class="n">system</span> <span class="n">state</span>
<span class="n">inside</span> <span class="n">its</span> <span class="n">directory</span>
<span class="n">see</span> <span class="n">symlinks</span> <span class="n">to</span> <span class="n">all</span> <span class="n">of</span> <span class="n">the</span> <span class="n">other</span> <span class="n">unit</span> <span class="n">files</span> <span class="n">that</span> <span class="n">make</span> <span class="n">up</span> <span class="n">this</span> <span class="n">system</span> <span class="n">state</span><span class="p">.</span>
<span class="n">all</span> <span class="n">the</span> <span class="n">things</span> <span class="n">that</span> <span class="n">need</span> <span class="n">to</span> <span class="n">be</span> <span class="n">running</span> <span class="n">when</span> <span class="n">in</span> <span class="n">the</span> <span class="n">multi</span><span class="o">-</span><span class="n">user</span> <span class="n">target</span><span class="p">.</span>

<span class="err">$</span> <span class="n">ls</span> <span class="n">multi</span><span class="o">-</span><span class="n">user</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>
<span class="n">atd</span><span class="p">.</span><span class="n">service</span>           <span class="n">ksm</span><span class="p">.</span><span class="n">service</span>             <span class="n">rsyslog</span><span class="p">.</span><span class="n">service</span>
<span class="n">auditd</span><span class="p">.</span><span class="n">service</span>        <span class="n">ksmtuned</span><span class="p">.</span><span class="n">service</span>        <span class="n">smartd</span><span class="p">.</span><span class="n">service</span>
<span class="n">avahi</span><span class="o">-</span><span class="n">daemon</span><span class="p">.</span><span class="n">service</span>  <span class="n">libstoragemgmt</span><span class="p">.</span><span class="n">service</span>  <span class="n">sshd</span><span class="p">.</span><span class="n">service</span>
<span class="n">chronyd</span><span class="p">.</span><span class="n">service</span>       <span class="n">libvirtd</span><span class="p">.</span><span class="n">service</span>        <span class="n">sssd</span><span class="p">.</span><span class="n">service</span>
<span class="n">crond</span><span class="p">.</span><span class="n">service</span>         <span class="n">mcelog</span><span class="p">.</span><span class="n">service</span>          <span class="n">tuned</span><span class="p">.</span><span class="n">service</span>
<span class="n">cups</span><span class="p">.</span><span class="n">path</span>             <span class="n">mdmonitor</span><span class="p">.</span><span class="n">service</span>       <span class="n">vboxadd</span><span class="p">.</span><span class="n">service</span>
<span class="n">dnf</span><span class="o">-</span><span class="n">makecache</span><span class="p">.</span><span class="n">timer</span>   <span class="n">ModemManager</span><span class="p">.</span><span class="n">service</span>    <span class="n">vboxadd</span><span class="o">-</span><span class="n">service</span><span class="p">.</span><span class="n">service</span>
<span class="n">firewalld</span><span class="p">.</span><span class="n">service</span>     <span class="n">NetworkManager</span><span class="p">.</span><span class="n">service</span>  <span class="n">vdo</span><span class="p">.</span><span class="n">service</span>
<span class="n">httpd</span><span class="p">.</span><span class="n">service</span>         <span class="n">nfs</span><span class="o">-</span><span class="n">client</span><span class="p">.</span><span class="n">target</span>       <span class="n">vmtoolsd</span><span class="p">.</span><span class="n">service</span>
<span class="n">irqbalance</span><span class="p">.</span><span class="n">service</span>    <span class="n">remote</span><span class="o">-</span><span class="n">fs</span><span class="p">.</span><span class="n">target</span>
<span class="n">kdump</span><span class="p">.</span><span class="n">service</span>         <span class="n">rpcbind</span><span class="p">.</span><span class="n">service</span>



<span class="n">look</span> <span class="n">at</span> <span class="n">those</span> <span class="n">symlinks</span>
<span class="n">see</span> <span class="n">the</span> <span class="n">service</span><span class="o">/</span><span class="n">unit</span> <span class="n">files</span><span class="p">,</span> <span class="n">symbolically</span> <span class="n">linked</span> <span class="n">to</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="p">.</span>

<span class="err">$</span> <span class="n">ls</span> <span class="o">-</span><span class="n">lah</span> <span class="n">multi</span><span class="o">-</span><span class="n">user</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span>
<span class="n">total</span> <span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="n">K</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="p">.</span>  <span class="mi">2</span> <span class="n">root</span> <span class="n">root</span> <span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="n">K</span> <span class="n">Apr</span> <span class="mi">19</span> <span class="mi">16</span><span class="o">:</span><span class="mi">19</span> <span class="p">.</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="p">.</span> <span class="mi">21</span> <span class="n">root</span> <span class="n">root</span> <span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="n">K</span> <span class="n">Apr</span> <span class="mi">19</span> <span class="mi">17</span><span class="o">:</span><span class="mo">01</span> <span class="p">..</span>
<span class="n">lrwxrwxrwx</span><span class="p">.</span>  <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span>   <span class="mi">35</span> <span class="n">Apr</span> <span class="mi">13</span> <span class="mi">21</span><span class="o">:</span><span class="mi">14</span> <span class="n">atd</span><span class="p">.</span><span class="n">service</span> <span class="o">-&gt;</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">atd</span><span class="p">.</span><span class="n">service</span>
<span class="n">lrwxrwxrwx</span><span class="p">.</span>  <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span>   <span class="mi">41</span> <span class="n">Apr</span> <span class="mi">13</span> <span class="mi">21</span><span class="o">:</span><span class="mi">14</span> <span class="n">firewalld</span><span class="p">.</span><span class="n">service</span> <span class="o">-&gt;</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">firewalld</span><span class="p">.</span><span class="n">service</span>
<span class="c1">// reload the daemon</span>
<span class="c1">// but doesnot update the target, still the old.</span>
<span class="n">lrwxrwxrwx</span><span class="p">.</span>  <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span>   <span class="mi">37</span> <span class="n">Apr</span> <span class="mi">19</span> <span class="mi">16</span><span class="o">:</span><span class="mi">19</span> <span class="n">httpd</span><span class="p">.</span><span class="n">service</span> <span class="o">-&gt;</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span>
<span class="p">..</span>

<span class="c1">// reboot will update auto</span>
<span class="c1">// or disable enable will solve it.</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">disable</span> <span class="n">httpd</span>
<span class="n">Removed</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">multi</span><span class="o">-</span><span class="n">user</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span><span class="o">/</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span><span class="p">.</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">httpd</span>
<span class="n">Created</span> <span class="n">symlink</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">multi</span><span class="o">-</span><span class="n">user</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span><span class="o">/</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span> <span class="err">→</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span><span class="p">.</span>

<span class="c1">// check</span>
<span class="err">$</span> <span class="n">ls</span> <span class="o">-</span><span class="n">lah</span> <span class="n">multi</span><span class="o">-</span><span class="n">user</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">httpd</span>
<span class="n">lrwxrwxrwx</span><span class="p">.</span>  <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span>   <span class="mi">33</span> <span class="n">Apr</span> <span class="mi">19</span> <span class="mi">17</span><span class="o">:</span><span class="mi">35</span> <span class="n">httpd</span><span class="p">.</span><span class="n">service</span> <span class="o">-&gt;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span>



<span class="o">================================================================</span>

<span class="mi">4</span><span class="p">.</span> <span class="n">set</span> <span class="n">the</span> <span class="k">default</span> <span class="n">target</span> <span class="n">on</span> <span class="n">our</span> <span class="n">system</span><span class="p">,</span> <span class="n">the</span> <span class="n">state</span> <span class="n">to</span> <span class="n">which</span> <span class="n">computer</span> <span class="n">will</span> <span class="n">boot</span> <span class="n">to</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="n">target_name</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="n">reboot</span>
<span class="err">$</span> <span class="n">init</span> <span class="mi">6</span>


<span class="c1">// check the default boot target</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">get</span><span class="o">-</span><span class="k">default</span>
<span class="n">graphical</span><span class="p">.</span><span class="n">target</span>

<span class="err">$</span> <span class="n">ls</span> <span class="o">-</span><span class="n">lah</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="k">default</span><span class="p">.</span><span class="n">target</span>
<span class="n">lrwxrwxrwx</span><span class="p">.</span> <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span> <span class="mi">36</span> <span class="n">Apr</span> <span class="mi">13</span> <span class="mi">21</span><span class="o">:</span><span class="mi">19</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="k">default</span><span class="p">.</span><span class="n">target</span> <span class="o">-&gt;</span> <span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">graphical</span><span class="p">.</span><span class="n">target</span>


<span class="err">$</span> <span class="n">systemctl</span> <span class="n">set</span><span class="o">-</span><span class="k">default</span> <span class="n">rescure</span>
<span class="n">removed</span> <span class="n">symlink</span>
<span class="n">create</span> <span class="n">symlink</span>


<span class="err">$</span> <span class="n">systemctl</span> <span class="n">set</span><span class="o">-</span><span class="k">default</span> <span class="n">graphical</span>

</pre></table></code></div></div><hr /><h2 id="systemd-control-group">systemd: control group</h2><p>server0:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
</pre><td class="rouge-code"><pre>
<span class="n">check</span> <span class="n">out</span> <span class="n">control</span> <span class="n">groups</span> <span class="n">in</span> <span class="n">action</span>
<span class="n">see</span> <span class="n">how</span> <span class="n">they</span> <span class="n">are</span> <span class="n">used</span> <span class="n">to</span> <span class="n">organize</span> <span class="n">the</span> <span class="n">currently</span><span class="o">-</span><span class="n">running</span> <span class="n">processes</span> <span class="n">on</span> <span class="n">system</span><span class="p">.</span>
<span class="o">-</span> <span class="n">slice</span><span class="o">:</span> <span class="n">grouping</span> <span class="n">of</span> <span class="n">scopes</span> <span class="n">and</span> <span class="n">services</span> <span class="n">together</span><span class="p">.</span>
  <span class="o">-</span> <span class="n">service</span><span class="o">:</span> <span class="n">a</span> <span class="n">collection</span> <span class="n">of</span> <span class="n">processes</span> <span class="n">started</span> <span class="n">by</span> <span class="n">systemd</span><span class="p">.</span>
  <span class="o">-</span> <span class="n">scope</span><span class="o">:</span> <span class="n">a</span> <span class="n">group</span> <span class="n">of</span> <span class="n">processes</span> <span class="n">started</span> <span class="n">externally</span> <span class="n">to</span> <span class="n">systemd</span><span class="p">.</span>


<span class="err">$</span> <span class="n">systemd</span><span class="o">-</span><span class="n">cgls</span>

<span class="n">Control</span> <span class="n">group</span> <span class="o">/:</span>
<span class="o">-</span><span class="p">.</span><span class="n">slice</span>
<span class="err">├─</span><span class="n">init</span><span class="p">.</span><span class="n">scope</span>         <span class="c1">// PID 1, or systemd itself</span>
<span class="err">│</span> <span class="err">└─</span><span class="mi">1</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">systemd</span> <span class="o">--</span><span class="n">switched</span><span class="o">-</span><span class="n">root</span> <span class="o">--</span><span class="n">system</span> <span class="o">--</span><span class="n">deserialize</span> <span class="mi">17</span>
<span class="err">├─</span><span class="n">user</span><span class="p">.</span><span class="n">slice</span>         <span class="c1">// where to find all logged-in users and their processes.</span>
<span class="err">│</span> <span class="err">├─</span><span class="n">user</span><span class="o">-</span><span class="mi">42</span><span class="p">.</span><span class="n">slice</span>    <span class="c1">// a specific user's slice, the processes for user UID 42</span>
<span class="err">│</span> <span class="err">│</span> <span class="err">├─</span><span class="n">session</span><span class="o">-</span><span class="n">c1</span><span class="p">.</span><span class="n">scope</span>
<span class="err">│</span> <span class="err">│</span> <span class="err">│</span> <span class="err">├─</span><span class="mi">2464</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">gnome</span><span class="o">-</span><span class="n">shell</span>
<span class="err">│</span> <span class="err">│</span> <span class="err">└─</span><span class="n">user</span><span class="err">@</span><span class="mi">42</span><span class="p">.</span><span class="n">service</span>
<span class="err">│</span> <span class="err">│</span>   <span class="err">├─</span><span class="n">xdg</span><span class="o">-</span><span class="n">permission</span><span class="o">-</span><span class="n">store</span><span class="p">.</span><span class="n">service</span>
<span class="err">│</span> <span class="err">│</span>   <span class="err">│</span> <span class="err">└─</span><span class="mi">2529</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">libexec</span><span class="o">/</span><span class="n">xdg</span><span class="o">-</span><span class="n">permission</span><span class="o">-</span><span class="n">store</span>
<span class="err">│</span> <span class="err">└─</span><span class="n">user</span><span class="o">-</span><span class="mi">1000</span><span class="p">.</span><span class="n">slice</span>  <span class="c1">// current user</span>
<span class="err">│</span>   <span class="err">├─</span><span class="n">user</span><span class="err">@</span><span class="mi">1000</span><span class="p">.</span><span class="n">service</span>
<span class="err">│</span>   <span class="err">└─</span><span class="n">session</span><span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="n">scope</span>
<span class="p">...</span>
<span class="err">└─</span><span class="n">system</span><span class="p">.</span><span class="n">slice</span>
  <span class="err">├─</span><span class="c1">// all the processes owned by the system and started up by systemd.</span>
  <span class="err">├─</span><span class="n">rngd</span><span class="p">.</span><span class="n">service</span>             <span class="c1">// the unit name</span>
  <span class="err">│</span> <span class="err">└─</span><span class="mi">979</span> <span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">rngd</span> <span class="o">-</span><span class="n">f</span>      <span class="c1">// the binary/actual executable for that service.</span>
  <span class="err">├─</span><span class="n">libstoragemgmt</span><span class="p">.</span><span class="n">service</span>
  <span class="err">│</span> <span class="err">└─</span><span class="mi">1002</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">lsmd</span> <span class="o">-</span><span class="n">d</span>


<span class="o">================================================================</span>

<span class="n">new</span> <span class="n">window</span><span class="o">:</span>
<span class="n">open</span> <span class="n">a</span> <span class="n">ssh</span> <span class="n">connection</span><span class="p">,</span> <span class="n">start</span> <span class="n">up</span> <span class="n">another</span> <span class="n">separate</span> <span class="n">session</span>

<span class="err">$</span> <span class="n">ssh</span> <span class="n">server1</span><span class="err">@</span><span class="n">localhost</span>
<span class="n">server1</span><span class="err">@</span><span class="n">localhosts</span> <span class="n">password</span><span class="o">:</span>
<span class="n">Activate</span> <span class="n">the</span> <span class="n">web</span> <span class="n">console</span> <span class="n">with</span><span class="o">:</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="o">--</span><span class="n">now</span> <span class="n">cockpit</span><span class="p">.</span><span class="n">socket</span>
<span class="n">Last</span> <span class="n">login</span><span class="o">:</span> <span class="n">Sun</span> <span class="n">Apr</span> <span class="mi">19</span> <span class="mi">17</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">58</span> <span class="mi">2020</span>


<span class="c1">// check out control groups in action again</span>
<span class="err">$</span> <span class="n">systemd</span><span class="o">-</span><span class="n">cgls</span>
<span class="n">Control</span> <span class="n">group</span> <span class="o">/:</span>
<span class="o">-</span><span class="p">.</span><span class="n">slice</span>
<span class="err">├─</span><span class="n">init</span><span class="p">.</span><span class="n">scope</span>         <span class="c1">// PID 1, or systemd itself</span>
<span class="err">│</span> <span class="err">└─</span><span class="mi">1</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">systemd</span> <span class="o">--</span><span class="n">switched</span><span class="o">-</span><span class="n">root</span> <span class="o">--</span><span class="n">system</span> <span class="o">--</span><span class="n">deserialize</span> <span class="mi">17</span>
<span class="err">├─</span><span class="n">user</span><span class="p">.</span><span class="n">slice</span>         <span class="c1">// where to find all logged-in users and their processes.</span>
<span class="err">│</span> <span class="err">├─</span><span class="n">user</span><span class="o">-</span><span class="mi">42</span><span class="p">.</span><span class="n">slice</span>    <span class="c1">// a specific user's slice, the processes for user UID 42</span>
<span class="err">│</span> <span class="err">│</span> <span class="err">├─</span><span class="n">session</span><span class="o">-</span><span class="n">c1</span><span class="p">.</span><span class="n">scope</span>
<span class="err">│</span> <span class="err">│</span> <span class="err">└─</span><span class="n">user</span><span class="err">@</span><span class="mi">42</span><span class="p">.</span><span class="n">service</span>
<span class="err">│</span> <span class="err">└─</span><span class="n">user</span><span class="o">-</span><span class="mi">1000</span><span class="p">.</span><span class="n">slice</span>
<span class="err">│</span>   <span class="err">├─</span><span class="n">user</span><span class="err">@</span><span class="mi">1000</span><span class="p">.</span><span class="n">service</span>
<span class="err">│</span>   <span class="err">├─</span><span class="n">session</span><span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="n">scope</span>
<span class="err">│</span>   <span class="err">└─</span><span class="n">session</span><span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="n">scope</span>
<span class="err">│</span>     <span class="err">├─</span><span class="mi">4905</span> <span class="n">sshd</span><span class="o">:</span> <span class="n">server1</span> <span class="p">[</span><span class="n">priv</span><span class="p">]</span>
<span class="err">│</span>     <span class="err">├─</span><span class="mi">4910</span> <span class="n">sshd</span><span class="o">:</span> <span class="n">server1</span><span class="err">@</span><span class="n">pts</span><span class="o">/</span><span class="mi">2</span>
<span class="err">│</span>     <span class="err">└─</span><span class="mi">4915</span> <span class="o">-</span><span class="n">bash</span>
<span class="p">...</span>
<span class="err">└─</span><span class="n">system</span><span class="p">.</span><span class="n">slice</span>

<span class="n">session</span><span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="n">scope</span><span class="p">,</span> <span class="n">new</span> <span class="n">session</span> <span class="n">added</span>
<span class="o">-</span> <span class="n">the</span> <span class="n">collection</span> <span class="n">of</span> <span class="n">external</span> <span class="n">processes</span> <span class="k">for</span> <span class="n">user</span><span class="p">,</span> <span class="n">underneath</span> <span class="n">users</span> <span class="n">slice</span>
<span class="o">-</span> <span class="n">logically</span> <span class="n">grouping</span> <span class="n">all</span> <span class="n">of</span> <span class="n">users</span> <span class="n">processes</span> <span class="n">under</span> <span class="n">one</span> <span class="n">slice</span><span class="p">.</span>


<span class="o">================================================================</span>

<span class="n">new</span> <span class="n">window</span><span class="o">:</span>
<span class="n">open</span> <span class="n">a</span> <span class="n">ssh</span> <span class="n">connection</span><span class="p">,</span> <span class="n">again</span> <span class="n">start</span> <span class="n">up</span> <span class="n">another</span> <span class="n">separate</span> <span class="n">session</span>
<span class="n">ssh</span> <span class="n">as</span> <span class="n">root</span> <span class="n">user</span>

<span class="err">$</span> <span class="n">ssh</span> <span class="n">root</span><span class="err">@</span><span class="n">localhost</span>
<span class="n">root</span><span class="err">@</span><span class="n">localhosts</span> <span class="n">password</span><span class="o">:</span>
<span class="n">Activate</span> <span class="n">the</span> <span class="n">web</span> <span class="n">console</span> <span class="n">with</span><span class="o">:</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="o">--</span><span class="n">now</span> <span class="n">cockpit</span><span class="p">.</span><span class="n">socket</span>
<span class="n">Last</span> <span class="n">login</span><span class="o">:</span> <span class="n">Sun</span> <span class="n">Apr</span> <span class="mi">19</span> <span class="mi">14</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">10</span> <span class="mi">2020</span>


<span class="c1">// check out control groups in action again</span>
<span class="c1">// new user show up</span>
<span class="err">$</span> <span class="n">systemd</span><span class="o">-</span><span class="n">cgls</span>
<span class="n">Control</span> <span class="n">group</span> <span class="o">/:</span>
<span class="o">-</span><span class="p">.</span><span class="n">slice</span>
<span class="err">├─</span><span class="n">init</span><span class="p">.</span><span class="n">scope</span>
<span class="err">│</span> <span class="err">└─</span><span class="mi">1</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">systemd</span> <span class="o">--</span><span class="n">switched</span><span class="o">-</span><span class="n">root</span> <span class="o">--</span><span class="n">system</span> <span class="o">--</span><span class="n">deserialize</span> <span class="mi">17</span>
<span class="err">├─</span><span class="n">user</span><span class="p">.</span><span class="n">slice</span>
<span class="err">│</span> <span class="err">├─</span><span class="n">user</span><span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="n">slice</span>
<span class="err">│</span> <span class="err">│</span> <span class="err">├─</span><span class="n">user</span><span class="err">@</span><span class="mi">0</span><span class="p">.</span><span class="n">service</span>
<span class="err">│</span> <span class="err">│</span> <span class="err">└─</span><span class="n">session</span><span class="o">-</span><span class="mi">5</span><span class="p">.</span><span class="n">scope</span>
<span class="err">│</span> <span class="err">├─</span><span class="n">user</span><span class="o">-</span><span class="mi">42</span><span class="p">.</span><span class="n">slice</span>
<span class="err">│</span> <span class="err">└─</span><span class="n">user</span><span class="o">-</span><span class="mi">1000</span><span class="p">.</span><span class="n">slice</span>
<span class="p">...</span>
<span class="err">└─</span><span class="n">system</span><span class="p">.</span><span class="n">slice</span>


<span class="o">================================================================</span>

<span class="err">$</span> <span class="n">systemd</span><span class="o">-</span><span class="n">cgtop</span>
<span class="c1">// show us all of the currently-running control groups on system</span>
<span class="c1">// organized by resource consumption,</span>
<span class="n">Control</span> <span class="n">Group</span>                            <span class="n">Tasks</span>   <span class="o">%</span><span class="n">CPU</span>   <span class="n">Memory</span>  <span class="n">Input</span><span class="o">/</span><span class="n">s</span> <span class="n">Output</span><span class="o">/</span><span class="n">s</span>
<span class="o">/</span>                                          <span class="mi">772</span>    <span class="mi">2</span><span class="p">.</span><span class="mi">0</span>     <span class="mi">1</span><span class="p">.</span><span class="mi">8</span><span class="n">G</span>        <span class="o">-</span>        <span class="o">-</span>
<span class="o">/</span><span class="n">system</span><span class="p">.</span><span class="n">slice</span>                              <span class="mi">328</span>      <span class="o">-</span>   <span class="mi">613</span><span class="p">.</span><span class="mi">0</span><span class="n">M</span>        <span class="o">-</span>        <span class="o">-</span>
<span class="o">/</span><span class="n">system</span><span class="p">.</span><span class="n">slice</span><span class="o">/</span><span class="n">ModemManager</span><span class="p">.</span><span class="n">service</span>           <span class="mi">3</span>      <span class="o">-</span>     <span class="mi">7</span><span class="p">.</span><span class="mi">7</span><span class="n">M</span>        <span class="o">-</span>        <span class="o">-</span>
<span class="o">/</span><span class="n">system</span><span class="p">.</span><span class="n">slice</span><span class="o">/</span><span class="n">NetworkManager</span><span class="p">.</span><span class="n">service</span>         <span class="mi">3</span>      <span class="o">-</span>     <span class="mi">8</span><span class="p">.</span><span class="mi">5</span><span class="n">M</span>        <span class="o">-</span>        <span class="o">-</span>
<span class="o">/</span><span class="n">system</span><span class="p">.</span><span class="n">slice</span><span class="o">/</span><span class="n">accounts</span><span class="o">-</span><span class="n">daemon</span><span class="p">.</span><span class="n">service</span>        <span class="mi">3</span>      <span class="o">-</span>     <span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="n">M</span>        <span class="o">-</span>        <span class="o">-</span>
<span class="o">/</span><span class="n">system</span><span class="p">.</span><span class="n">slice</span><span class="o">/</span><span class="n">alsa</span><span class="o">-</span><span class="n">state</span><span class="p">.</span><span class="n">service</span>             <span class="mi">1</span>      <span class="o">-</span>   <span class="mi">388</span><span class="p">.</span><span class="mi">0</span><span class="n">K</span>        <span class="o">-</span>        <span class="o">-</span>
<span class="o">/</span><span class="n">system</span><span class="p">.</span><span class="n">slice</span><span class="o">/</span><span class="n">atd</span><span class="p">.</span><span class="n">service</span>                    <span class="mi">1</span>      <span class="o">-</span>   <span class="mi">480</span><span class="p">.</span><span class="mi">0</span><span class="n">K</span>        <span class="o">-</span>        <span class="o">-</span>
<span class="o">/</span><span class="n">system</span><span class="p">.</span><span class="n">slice</span><span class="o">/</span><span class="n">auditd</span><span class="p">.</span><span class="n">service</span>                 <span class="mi">4</span>      <span class="o">-</span>     <span class="mi">4</span><span class="p">.</span><span class="mi">6</span><span class="n">M</span>        <span class="o">-</span>        <span class="o">-</span>
<span class="o">/</span><span class="n">system</span><span class="p">.</span><span class="n">slice</span><span class="o">/</span><span class="n">avahi</span><span class="o">-</span><span class="n">daemon</span><span class="p">.</span><span class="n">service</span>           <span class="mi">2</span>      <span class="o">-</span>     <span class="mi">1</span><span class="p">.</span><span class="mi">6</span><span class="n">M</span>        <span class="o">-</span>        <span class="o">-</span>
<span class="o">/</span><span class="n">system</span><span class="p">.</span><span class="n">slice</span><span class="o">/</span><span class="n">bolt</span><span class="p">.</span><span class="n">service</span>                   <span class="mi">3</span>      <span class="o">-</span>     <span class="mi">1</span><span class="p">.</span><span class="mi">9</span><span class="n">M</span>        <span class="o">-</span>        <span class="o">-</span>
<span class="o">/</span><span class="n">system</span><span class="p">.</span><span class="n">slice</span><span class="o">/</span><span class="n">boot</span><span class="p">.</span><span class="n">mount</span>                     <span class="o">-</span>      <span class="o">-</span>   <span class="mi">200</span><span class="p">.</span><span class="mi">0</span><span class="n">K</span>        <span class="o">-</span>        <span class="o">-</span>
<span class="o">/</span><span class="n">system</span><span class="p">.</span><span class="n">slice</span><span class="o">/</span><span class="n">chronyd</span><span class="p">.</span><span class="n">service</span>                <span class="mi">1</span>      <span class="o">-</span>     <span class="mi">1</span><span class="p">.</span><span class="mi">6</span><span class="n">M</span>        <span class="o">-</span>        <span class="o">-</span>
<span class="o">/</span><span class="n">system</span><span class="p">.</span><span class="n">slice</span><span class="o">/</span><span class="n">colord</span><span class="p">.</span><span class="n">service</span>                 <span class="mi">3</span>      <span class="o">-</span>     <span class="mi">3</span><span class="p">.</span><span class="mi">8</span><span class="n">M</span>        <span class="o">-</span>        <span class="o">-</span>
<span class="o">/</span><span class="n">system</span><span class="p">.</span><span class="n">slice</span><span class="o">/</span><span class="n">crond</span><span class="p">.</span><span class="n">service</span>                  <span class="mi">1</span>      <span class="o">-</span>     <span class="mi">1</span><span class="p">.</span><span class="mi">6</span><span class="n">M</span>        <span class="o">-</span>        <span class="o">-</span>
<span class="o">/</span><span class="n">system</span><span class="p">.</span><span class="n">slice</span><span class="o">/</span><span class="n">cups</span><span class="p">.</span><span class="n">service</span>                   <span class="mi">1</span>      <span class="o">-</span>     <span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="n">M</span>        <span class="o">-</span>        <span class="o">-</span>
<span class="o">/</span><span class="n">system</span><span class="p">.</span><span class="n">slice</span><span class="o">/</span><span class="n">dbus</span><span class="p">.</span><span class="n">service</span>                   <span class="mi">2</span>      <span class="o">-</span>     <span class="mi">5</span><span class="p">.</span><span class="mi">4</span><span class="n">M</span>        <span class="o">-</span>        <span class="o">-</span>
<span class="o">/</span><span class="n">system</span><span class="p">.</span><span class="n">slice</span><span class="o">/</span><span class="n">dev</span><span class="o">-</span><span class="n">hugepages</span><span class="p">.</span><span class="n">mount</span>            <span class="o">-</span>      <span class="o">-</span>   <span class="mi">796</span><span class="p">.</span><span class="mi">0</span><span class="n">K</span>        <span class="o">-</span>        <span class="o">-</span>
<span class="o">/</span><span class="n">system</span><span class="p">.</span><span class="n">slic</span><span class="err">…</span><span class="n">ev</span><span class="o">-</span><span class="n">mapper</span><span class="o">-</span><span class="n">cl</span><span class="err">\</span><span class="n">x2dswap</span><span class="p">.</span><span class="n">swap</span>       <span class="o">-</span>      <span class="o">-</span>   <span class="mi">412</span><span class="p">.</span><span class="mi">0</span><span class="n">K</span>        <span class="o">-</span>        <span class="o">-</span>
<span class="o">/</span><span class="n">system</span><span class="p">.</span><span class="n">slice</span><span class="o">/</span><span class="n">dev</span><span class="o">-</span><span class="n">mqueue</span><span class="p">.</span><span class="n">mount</span>               <span class="o">-</span>      <span class="o">-</span>    <span class="mi">48</span><span class="p">.</span><span class="mi">0</span><span class="n">K</span>        <span class="o">-</span>        <span class="o">-</span>

</pre></table></code></div></div><hr /><h2 id="limit-access-to-available-system-resources-with-policy">limit access to available system resources with policy</h2><p>to do that persistently, we make edits in the unit files for the service.</p><p>server0:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
</pre><td class="rouge-code"><pre>
<span class="n">pick</span> <span class="n">on</span> <span class="n">httpd</span><span class="p">,</span> <span class="n">limit</span> <span class="n">its</span> <span class="n">total</span> <span class="n">memory</span> <span class="n">that</span> <span class="n">it</span> <span class="n">can</span> <span class="n">allocate</span><span class="p">.</span>

<span class="n">whats</span> <span class="n">the</span> <span class="n">parameter</span> <span class="n">that</span> <span class="n">looking</span> <span class="k">for</span>
<span class="o">-</span> <span class="n">Google</span> <span class="n">it</span>
<span class="o">-</span> <span class="n">search</span> <span class="n">through</span> <span class="n">the</span> <span class="n">man</span> <span class="n">pages</span>
<span class="o">-</span> <span class="n">ask</span> <span class="n">systemd</span> <span class="n">itself</span>


<span class="err">$</span> <span class="n">systemctl</span> <span class="n">show</span> <span class="n">httpd</span>
<span class="n">Type</span><span class="o">=</span><span class="n">notify</span>
<span class="n">Restart</span><span class="o">=</span><span class="n">on</span><span class="o">-</span><span class="n">failure</span>
<span class="n">NotifyAccess</span><span class="o">=</span><span class="n">main</span>
<span class="n">RestartUSec</span><span class="o">=</span><span class="mi">100</span><span class="n">ms</span>
<span class="n">TimeoutStartUSec</span><span class="o">=</span><span class="mi">1</span><span class="n">min</span> <span class="mi">30</span><span class="n">s</span>
<span class="n">TimeoutStopUSec</span><span class="o">=</span><span class="mi">1</span><span class="n">min</span> <span class="mi">30</span><span class="n">s</span>
<span class="n">RuntimeMaxUSec</span><span class="o">=</span><span class="n">infinity</span>
<span class="n">WatchdogUSec</span><span class="o">=</span><span class="mi">0</span>
<span class="n">WatchdogTimestamp</span><span class="o">=</span><span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mi">25</span> <span class="n">EDT</span>
<span class="n">WatchdogTimestampMonotonic</span><span class="o">=</span><span class="mi">19477893</span>
<span class="n">PermissionsStartOnly</span><span class="o">=</span><span class="n">no</span>
<span class="n">RootDirectoryStartOnly</span><span class="o">=</span><span class="n">no</span>


<span class="err">$</span> <span class="n">systemctl</span> <span class="n">show</span> <span class="n">httpd</span> <span class="o">|</span> <span class="n">grep</span> <span class="o">-</span><span class="n">i</span> <span class="n">memo</span>
<span class="n">MemoryCurrent</span><span class="o">=</span><span class="mi">32940032</span>
<span class="n">MemoryAccounting</span><span class="o">=</span><span class="n">yes</span>
<span class="n">MemoryLow</span><span class="o">=</span><span class="mi">0</span>
<span class="n">MemoryHigh</span><span class="o">=</span><span class="n">infinity</span>
<span class="n">MemoryMax</span><span class="o">=</span><span class="n">infinity</span>
<span class="n">MemorySwapMax</span><span class="o">=</span><span class="n">infinity</span>
<span class="n">MemoryLimit</span><span class="o">=</span><span class="n">infinity</span>       <span class="c1">// no limit so far</span>
<span class="n">MemoryDenyWriteExecute</span><span class="o">=</span><span class="n">no</span>


<span class="c1">// edit it</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span>
<span class="c1">//add line in [service] section</span>
<span class="n">MemoryLimit</span><span class="o">=</span><span class="mi">512</span><span class="n">M</span>       <span class="c1">// no limit so far</span>


<span class="c1">// confirm the change</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">daemon</span><span class="o">-</span><span class="n">reload</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">restart</span> <span class="n">https</span>


<span class="c1">// check</span>
<span class="c1">// show the byte value</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">show</span> <span class="n">httpd</span> <span class="o">|</span> <span class="n">grep</span> <span class="o">-</span><span class="n">i</span> <span class="n">memo</span>
<span class="n">MemoryCurrent</span><span class="o">=</span><span class="mi">33988608</span>
<span class="n">MemoryAccounting</span><span class="o">=</span><span class="n">yes</span>
<span class="n">MemoryLow</span><span class="o">=</span><span class="mi">0</span>
<span class="n">MemoryHigh</span><span class="o">=</span><span class="n">infinity</span>
<span class="n">MemoryMax</span><span class="o">=</span><span class="n">infinity</span>
<span class="n">MemorySwapMax</span><span class="o">=</span><span class="n">infinity</span>
<span class="n">MemoryLimit</span><span class="o">=</span><span class="mi">536870912</span>
<span class="n">MemoryDenyWriteExecute</span><span class="o">=</span><span class="n">no</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="n">show</span> <span class="n">http</span> <span class="o">-</span><span class="n">p</span> <span class="n">MemoryLimit</span>
<span class="n">MemoryLimit</span><span class="o">=</span><span class="n">infinity</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="n">status</span> <span class="n">httpd</span>
<span class="err">●</span> <span class="n">httpd</span><span class="p">.</span><span class="n">service</span> <span class="o">-</span> <span class="n">The</span> <span class="n">Apache</span> <span class="n">HTTP</span> <span class="n">Server</span>
   <span class="n">Loaded</span><span class="o">:</span> <span class="n">loaded</span> <span class="p">(</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span><span class="p">;</span> <span class="n">enabled</span><span class="p">;</span> <span class="n">vendor</span> <span class="n">preset</span><span class="o">:</span> <span class="n">d</span><span class="o">&gt;</span><span class="p">)</span>
   <span class="n">Active</span><span class="o">:</span> <span class="n">active</span> <span class="p">(</span><span class="n">running</span><span class="p">)</span> <span class="n">since</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">59</span> <span class="n">EDT</span><span class="p">;</span> <span class="mi">3</span><span class="n">min</span> <span class="mi">48</span><span class="n">s</span> <span class="n">ago</span>
     <span class="n">Docs</span><span class="o">:</span> <span class="n">man</span><span class="o">:</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
  <span class="n">Process</span><span class="o">:</span> <span class="mi">5577</span> <span class="n">ExecStop</span><span class="o">=/</span><span class="n">bin</span><span class="o">/</span><span class="n">kill</span> <span class="o">-</span><span class="n">WINCH</span> <span class="err">$</span><span class="p">{</span><span class="n">MAINPID</span><span class="p">}</span> <span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="n">exited</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="mi">0</span><span class="o">/</span><span class="n">SUC</span><span class="o">&gt;</span>
 <span class="n">Main</span> <span class="n">PID</span><span class="o">:</span> <span class="mi">5590</span> <span class="p">(</span><span class="n">httpd</span><span class="p">)</span>
   <span class="n">Status</span><span class="o">:</span> <span class="s">"Running, listening on: port 80"</span>
    <span class="n">Tasks</span><span class="o">:</span> <span class="mi">213</span> <span class="p">(</span><span class="n">limit</span><span class="o">:</span> <span class="mi">14155</span><span class="p">)</span>
   <span class="n">Memory</span><span class="o">:</span> <span class="mi">32</span><span class="p">.</span><span class="mi">4</span><span class="n">M</span> <span class="p">(</span><span class="n">limit</span><span class="o">:</span> <span class="mi">512</span><span class="p">.</span><span class="mi">0</span><span class="n">M</span><span class="p">)</span>   <span class="c1">// here, the limit</span>
   <span class="n">CGroup</span><span class="o">:</span> <span class="o">/</span><span class="n">system</span><span class="p">.</span><span class="n">slice</span><span class="o">/</span><span class="n">httpd</span><span class="p">.</span><span class="n">service</span>

</pre></table></code></div></div><hr /><h2 id="logs-with-journalctl">Logs with journalctl</h2><p>server0:</p><p>journald.</p><ul><li>systemds logging mechanism.<li>by default, its data does not persist between reboots.<li>to configure the data to stick around between reboots.</ul><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
</pre><td class="rouge-code"><pre>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">journal</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">restart</span> <span class="n">systemd</span><span class="o">-</span><span class="n">journald</span>


<span class="err">$</span> <span class="n">cd</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">journal</span><span class="o">/</span>
<span class="err">$</span> <span class="n">ls</span>
<span class="n">a1293fe73fc04f3f8762991ccbf5ce93</span>

<span class="err">$</span> <span class="n">cd</span> <span class="n">a1293fe73fc04f3f8762991ccbf5ce93</span><span class="o">/</span>
<span class="err">$</span> <span class="n">ls</span>
<span class="n">system</span><span class="p">.</span><span class="n">journal</span>

<span class="c1">// a binary file</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">cat</span> <span class="n">system</span><span class="p">.</span><span class="n">journal</span>


<span class="err">$</span> <span class="n">sudo</span> <span class="n">journalctl</span>
<span class="c1">// date and time, host, who/process: putting this entry into the journal?</span>
<span class="o">--</span> <span class="n">Logs</span> <span class="n">begin</span> <span class="n">at</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mo">07</span> <span class="n">EDT</span><span class="p">,</span> <span class="n">end</span> <span class="n">at</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">53</span><span class="o">:</span><span class="mi">47</span> <span class="n">ED</span><span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mo">07</span> <span class="n">server1</span> <span class="n">kernel</span><span class="o">:</span> <span class="n">Linux</span> <span class="n">version</span> <span class="mi">4</span><span class="p">.</span><span class="mi">18</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">147</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="n">el8_1</span><span class="p">.</span><span class="n">x86_64</span> <span class="p">(</span><span class="n">mock</span><span class="o">&gt;</span><span class="p">)</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mo">07</span> <span class="n">server1</span> <span class="n">kernel</span><span class="o">:</span> <span class="n">Command</span> <span class="n">line</span><span class="o">:</span> <span class="n">BOOT_IMAGE</span><span class="o">=</span><span class="p">(</span><span class="n">hd0</span><span class="p">,</span><span class="n">msdos1</span><span class="p">)</span><span class="o">/</span><span class="n">vmlinuz</span><span class="o">-</span><span class="mi">4</span><span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mo">07</span> <span class="n">server1</span> <span class="n">kernel</span><span class="o">:</span> <span class="n">x86</span><span class="o">/</span><span class="n">fpu</span><span class="o">:</span> <span class="n">Supporting</span> <span class="n">XSAVE</span> <span class="n">feature</span> <span class="mh">0x001</span><span class="o">:</span> <span class="n">x87</span> <span class="n">f</span><span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mo">07</span> <span class="n">server1</span> <span class="n">kernel</span><span class="o">:</span> <span class="n">x86</span><span class="o">/</span><span class="n">fpu</span><span class="o">:</span> <span class="n">Supporting</span> <span class="n">XSAVE</span> <span class="n">feature</span> <span class="mh">0x002</span><span class="o">:</span> <span class="n">SSE</span> <span class="n">r</span><span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mo">07</span> <span class="n">server1</span> <span class="n">kernel</span><span class="o">:</span> <span class="n">x86</span><span class="o">/</span><span class="n">fpu</span><span class="o">:</span> <span class="n">Supporting</span> <span class="n">XSAVE</span> <span class="n">feature</span> <span class="mh">0x004</span><span class="o">:</span> <span class="n">AVX</span> <span class="n">r</span><span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mo">07</span> <span class="n">server1</span> <span class="n">kernel</span><span class="o">:</span> <span class="n">x86</span><span class="o">/</span><span class="n">fpu</span><span class="o">:</span> <span class="n">xstate_offset</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">:</span>  <span class="mi">576</span><span class="p">,</span> <span class="n">xstate_sizes</span><span class="p">[</span><span class="mi">2</span><span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mo">07</span> <span class="n">server1</span> <span class="n">systemd</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span> <span class="n">systemd</span> <span class="mi">239</span> <span class="n">running</span> <span class="n">in</span> <span class="n">system</span> <span class="n">mode</span><span class="p">.</span> <span class="p">(</span><span class="o">+</span><span class="n">PAM</span> <span class="o">+&gt;</span><span class="p">)</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mo">07</span> <span class="n">server1</span> <span class="n">systemd</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span> <span class="n">Detected</span> <span class="n">virtualization</span> <span class="n">oracle</span><span class="p">.</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mo">07</span> <span class="n">server1</span> <span class="n">systemd</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span> <span class="n">Detected</span> <span class="n">architecture</span> <span class="n">x86</span><span class="o">-</span><span class="mi">64</span><span class="p">.</span>
<span class="c1">// systemd is the first user process outside of the kernel, and it's PID, PID 1</span>



<span class="mi">1</span><span class="p">.</span> <span class="n">to</span> <span class="n">streaming</span> <span class="n">Output</span>

<span class="c1">// to continually read the bottom of the journal,</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">journalctl</span> <span class="o">-</span><span class="n">f</span>
<span class="o">--</span> <span class="n">Logs</span> <span class="n">begin</span> <span class="n">at</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mo">07</span> <span class="n">EDT</span><span class="p">.</span> <span class="o">--</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">55</span><span class="o">:</span><span class="mi">14</span> <span class="n">server0</span> <span class="n">org</span><span class="p">.</span><span class="n">gnome</span><span class="p">.</span><span class="n">Shell</span><span class="p">.</span><span class="n">desktop</span><span class="p">[</span><span class="mi">2850</span><span class="p">]</span><span class="o">:</span> <span class="n">Window</span> <span class="n">manager</span> <span class="n">warning</span><span class="o">:</span> <span class="n">last_user_time</span> <span class="p">(</span><span class="mi">11828777</span><span class="p">)</span> <span class="n">is</span> <span class="n">greater</span> <span class="n">than</span> <span class="n">comparison</span> <span class="n">timestamp</span> <span class="p">(</span><span class="mi">11828746</span><span class="p">).</span>  <span class="n">This</span> <span class="n">most</span> <span class="n">likely</span> <span class="n">represents</span> <span class="n">a</span> <span class="n">buggy</span> <span class="n">client</span> <span class="n">sending</span> <span class="n">inaccurate</span> <span class="n">timestamps</span> <span class="n">in</span> <span class="n">messages</span> <span class="n">such</span> <span class="n">as</span> <span class="p">..</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">55</span><span class="o">:</span><span class="mi">14</span> <span class="n">server0</span> <span class="n">org</span><span class="p">.</span><span class="n">gnome</span><span class="p">.</span><span class="n">Shell</span><span class="p">.</span><span class="n">desktop</span><span class="p">[</span><span class="mi">2850</span><span class="p">]</span><span class="o">:</span> <span class="n">Window</span> <span class="n">manager</span> <span class="n">warning</span><span class="o">:</span> <span class="n">W1</span> <span class="n">appears</span> <span class="n">to</span> <span class="n">be</span> <span class="n">one</span> <span class="n">of</span> <span class="n">the</span> <span class="n">offending</span> <span class="n">windows</span> <span class="n">with</span> <span class="n">a</span> <span class="n">timestamp</span> <span class="n">of</span> <span class="mi">11828777</span><span class="p">.</span>  <span class="n">Working</span> <span class="n">around</span><span class="p">...</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">55</span><span class="o">:</span><span class="mi">15</span> <span class="n">server0</span> <span class="n">org</span><span class="p">.</span><span class="n">gnome</span><span class="p">.</span><span class="n">Shell</span><span class="p">.</span><span class="n">desktop</span><span class="p">[</span><span class="mi">2850</span><span class="p">]</span><span class="o">:</span> <span class="n">Window</span> <span class="n">manager</span> <span class="n">warning</span><span class="o">:</span> <span class="n">last_user_time</span> <span class="p">(</span><span class="mi">11829370</span><span class="p">)</span> <span class="n">is</span> <span class="n">greater</span> <span class="n">than</span> <span class="n">comparison</span> <span class="n">timestamp</span> <span class="p">(</span><span class="mi">11829340</span><span class="p">).</span>  <span class="n">This</span> <span class="n">most</span> <span class="n">likely</span> <span class="n">represents</span> <span class="n">a</span> <span class="n">buggy</span> <span class="n">client</span> <span class="n">sending</span> <span class="n">inaccurate</span> <span class="n">timestamps</span> <span class="n">in</span> <span class="n">messages</span> <span class="n">such</span> <span class="n">as</span> <span class="p">.</span>  <span class="n">Trying</span> <span class="n">to</span> <span class="n">work</span> <span class="n">around</span><span class="p">...</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">55</span><span class="o">:</span><span class="mi">15</span> <span class="n">server0</span> <span class="n">org</span><span class="p">.</span><span class="n">gnome</span><span class="p">.</span><span class="n">Shell</span><span class="p">.</span><span class="n">desktop</span><span class="p">[</span><span class="mi">2850</span><span class="p">]</span><span class="o">:</span> <span class="n">Window</span> <span class="n">manager</span> <span class="n">warning</span><span class="o">:</span> <span class="n">W1</span> <span class="n">appears</span> <span class="n">to</span> <span class="n">be</span> <span class="n">one</span> <span class="n">of</span> <span class="n">the</span> <span class="n">offending</span> <span class="n">windows</span> <span class="n">with</span> <span class="n">a</span> <span class="n">timestamp</span> <span class="n">of</span> <span class="mi">11829370</span><span class="p">.</span>  <span class="n">Working</span> <span class="n">around</span><span class="p">...</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">55</span><span class="o">:</span><span class="mi">17</span> <span class="n">server0</span> <span class="n">org</span><span class="p">.</span><span class="n">gnome</span><span class="p">.</span><span class="n">Shell</span><span class="p">.</span><span class="n">desktop</span><span class="p">[</span><span class="mi">2850</span><span class="p">]</span><span class="o">:</span> <span class="n">Window</span> <span class="n">manager</span> <span class="n">warning</span><span class="o">:</span> <span class="n">last_user_time</span> <span class="p">(</span><span class="mi">11832100</span><span class="p">)</span> <span class="n">is</span> <span class="n">greater</span> <span class="n">than</span> <span class="n">comparison</span> <span class="n">timestamp</span> <span class="p">(</span><span class="mi">11832069</span><span class="p">).</span>  <span class="n">This</span> <span class="n">most</span> <span class="n">likely</span> <span class="n">represents</span> <span class="n">a</span> <span class="n">buggy</span> <span class="n">client</span> <span class="n">sending</span> <span class="n">inaccurate</span> <span class="n">timestamps</span> <span class="n">in</span> <span class="n">messages</span> <span class="n">such</span> <span class="n">as</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">55</span><span class="o">:</span><span class="mi">17</span> <span class="n">server0</span> <span class="n">org</span><span class="p">.</span><span class="n">gnome</span><span class="p">.</span><span class="n">Shell</span><span class="p">.</span><span class="n">desktop</span><span class="p">[</span><span class="mi">2850</span><span class="p">]</span><span class="o">:</span> <span class="n">Window</span> <span class="n">manager</span> <span class="n">warning</span><span class="o">:</span> <span class="n">W1</span> <span class="n">appears</span> <span class="n">to</span> <span class="n">be</span> <span class="n">one</span> <span class="n">of</span> <span class="n">the</span> <span class="n">offending</span> <span class="n">windows</span> <span class="n">with</span> <span class="n">a</span> <span class="n">timestamp</span> <span class="n">of</span> <span class="mi">11832100</span><span class="p">.</span>  <span class="n">Working</span> <span class="n">around</span><span class="p">...</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">58</span><span class="o">:</span><span class="mo">01</span> <span class="n">server0</span> <span class="n">sudo</span><span class="p">[</span><span class="mi">6187</span><span class="p">]</span><span class="o">:</span> <span class="n">pam_unix</span><span class="p">(</span><span class="n">sudo</span><span class="o">:</span><span class="n">session</span><span class="p">)</span><span class="o">:</span> <span class="n">session</span> <span class="n">closed</span> <span class="k">for</span> <span class="n">user</span> <span class="n">root</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">58</span><span class="o">:</span><span class="mo">05</span> <span class="n">server0</span> <span class="n">sudo</span><span class="p">[</span><span class="mi">6233</span><span class="p">]</span><span class="o">:</span>  <span class="n">server1</span> <span class="o">:</span> <span class="n">TTY</span><span class="o">=</span><span class="n">pts</span><span class="o">/</span><span class="mi">0</span> <span class="p">;</span> <span class="n">PWD</span><span class="o">=/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">journal</span><span class="o">/</span><span class="n">a1293fe73fc04f3f8762991ccbf5ce93</span> <span class="p">;</span> <span class="n">USER</span><span class="o">=</span><span class="n">root</span> <span class="p">;</span> <span class="n">COMMAND</span><span class="o">=/</span><span class="n">bin</span><span class="o">/</span><span class="n">journalctl</span> <span class="o">-</span><span class="n">f</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">58</span><span class="o">:</span><span class="mo">05</span> <span class="n">server0</span> <span class="n">sudo</span><span class="p">[</span><span class="mi">6233</span><span class="p">]</span><span class="o">:</span> <span class="n">pam_systemd</span><span class="p">(</span><span class="n">sudo</span><span class="o">:</span><span class="n">session</span><span class="p">)</span><span class="o">:</span> <span class="n">Cannot</span> <span class="n">create</span> <span class="n">session</span><span class="o">:</span> <span class="n">Already</span> <span class="n">running</span> <span class="n">in</span> <span class="n">a</span> <span class="n">session</span> <span class="n">or</span> <span class="n">user</span> <span class="n">slice</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">58</span><span class="o">:</span><span class="mo">05</span> <span class="n">server0</span> <span class="n">sudo</span><span class="p">[</span><span class="mi">6233</span><span class="p">]</span><span class="o">:</span> <span class="n">pam_unix</span><span class="p">(</span><span class="n">sudo</span><span class="o">:</span><span class="n">session</span><span class="p">)</span><span class="o">:</span> <span class="n">session</span> <span class="n">opened</span> <span class="k">for</span> <span class="n">user</span> <span class="n">root</span> <span class="n">by</span> <span class="p">(</span><span class="n">uid</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


<span class="n">piped</span> <span class="n">up</span> <span class="n">the</span> <span class="n">grap</span><span class="p">,</span> <span class="k">if</span> <span class="n">we</span> <span class="n">wanted</span> <span class="n">to</span> <span class="kr">restrict</span> <span class="n">the</span> <span class="n">output</span> <span class="n">to</span> <span class="n">a</span> <span class="n">particular</span> <span class="n">process</span> <span class="n">or</span> <span class="n">whatever</span> <span class="n">searchable</span> <span class="n">parameter</span> <span class="n">were</span> <span class="n">looking</span> <span class="k">for</span><span class="p">.</span>



<span class="mi">2</span><span class="p">.</span> <span class="n">this</span> <span class="n">is</span> <span class="n">all</span> <span class="n">structured</span> <span class="n">data</span><span class="p">.</span> <span class="n">look</span> <span class="n">at</span> <span class="n">whats</span> <span class="n">going</span> <span class="n">on</span> <span class="n">behind</span> <span class="n">the</span> <span class="n">scenes</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">journalctl</span> <span class="o">-</span><span class="n">o</span> <span class="n">verbose</span>
<span class="c1">// the data and the attribute of the log entry stored inside of journald.</span>
<span class="c1">// can use these attributes to query the journal.</span>
<span class="o">--</span> <span class="n">Logs</span> <span class="n">begin</span> <span class="n">at</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mo">07</span> <span class="n">EDT</span><span class="p">,</span> <span class="n">end</span> <span class="n">at</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mi">21</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mi">11</span> <span class="n">ED</span><span class="o">&gt;</span>
<span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mo">07</span><span class="p">.</span><span class="mi">344326</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="n">cf6636fb7ac4a5b8df72f582f3ade7d</span><span class="p">;</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">b</span><span class="o">=</span><span class="mi">9</span><span class="n">d</span><span class="o">&gt;</span><span class="p">]</span>
    <span class="n">SOURCE_MONOTONIC_TIMESTAMP</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">TRANSPORT</span><span class="o">=</span><span class="n">kernel</span>
    <span class="n">PRIORITY</span><span class="o">=</span><span class="mi">5</span>
    <span class="n">SYSLOG_FACILITY</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">SYSLOG_IDENTIFIER</span><span class="o">=</span><span class="n">kernel</span>
    <span class="n">MESSAGE</span><span class="o">=</span><span class="n">Linux</span> <span class="n">version</span> <span class="mi">4</span><span class="p">.</span><span class="mi">18</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">147</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="n">el8_1</span><span class="p">.</span><span class="n">x86_64</span> <span class="p">(</span><span class="n">mockbuild</span><span class="err">@</span><span class="n">kbuilder</span><span class="p">.</span><span class="n">bsys</span><span class="p">.</span><span class="o">&gt;</span><span class="p">)</span>
    <span class="n">BOOT_ID</span><span class="o">=</span><span class="mi">9</span><span class="n">d29ca0bf7a84f6abefe646cb1004555</span>
    <span class="n">MACHINE_ID</span><span class="o">=</span><span class="n">a1293fe73fc04f3f8762991ccbf5ce93</span>
    <span class="n">HOSTNAME</span><span class="o">=</span><span class="n">server1</span>
<span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mo">07</span><span class="p">.</span><span class="mi">344351</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="n">cf6636fb7ac4a5b8df72f582f3ade7d</span><span class="p">;</span><span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">b</span><span class="o">=</span><span class="mi">9</span><span class="n">d</span><span class="o">&gt;</span><span class="p">]</span>
    <span class="n">SOURCE_MONOTONIC_TIMESTAMP</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">TRANSPORT</span><span class="o">=</span><span class="n">kernel</span>
    <span class="n">SYSLOG_FACILITY</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">SYSLOG_IDENTIFIER</span><span class="o">=</span><span class="n">kernel</span>
    <span class="n">BOOT_ID</span><span class="o">=</span><span class="mi">9</span><span class="n">d29ca0bf7a84f6abefe646cb1004555</span>
    <span class="n">MACHINE_ID</span><span class="o">=</span><span class="n">a1293fe73fc04f3f8762991ccbf5ce93</span>
    <span class="n">HOSTNAME</span><span class="o">=</span><span class="n">server1</span>
    <span class="n">PRIORITY</span><span class="o">=</span><span class="mi">6</span>
    <span class="n">MESSAGE</span><span class="o">=</span><span class="n">Command</span> <span class="n">line</span><span class="o">:</span> <span class="n">BOOT_IMAGE</span><span class="o">=</span><span class="p">(</span><span class="n">hd0</span><span class="p">,</span><span class="n">msdos1</span><span class="p">)</span><span class="o">/</span><span class="n">vmlinuz</span><span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="mi">18</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">147</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="n">el8_1</span><span class="p">.</span><span class="o">&gt;</span><span class="p">)</span>
<span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mo">07</span><span class="p">.</span><span class="mi">344363</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="n">cf6636fb7ac4a5b8df72f582f3ade7d</span><span class="p">;</span><span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span><span class="n">b</span><span class="o">=</span><span class="mi">9</span><span class="n">d</span><span class="o">&gt;</span><span class="p">]</span>
    <span class="n">SOURCE_MONOTONIC_TIMESTAMP</span><span class="o">=</span><span class="mi">0</span>
<span class="n">lines</span> <span class="mi">1</span><span class="o">-</span><span class="mi">23</span>


<span class="c1">// can use these attributes to query the journal</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">journalctl</span> <span class="n">_UID</span><span class="o">=</span><span class="mi">1000</span>
<span class="o">--</span> <span class="n">Logs</span> <span class="n">begin</span> <span class="n">at</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mo">07</span> <span class="n">EDT</span><span class="p">,</span> <span class="n">end</span> <span class="n">at</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mi">21</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mi">45</span> <span class="n">ED</span><span class="o">&gt;</span><span class="n">_</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">17</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">58</span> <span class="n">server0</span> <span class="n">systemd</span><span class="p">[</span><span class="mi">2748</span><span class="p">]</span><span class="o">:</span> <span class="n">Started</span> <span class="n">Mark</span> <span class="n">boot</span> <span class="n">as</span> <span class="n">successful</span> <span class="n">after</span> <span class="n">th</span><span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">17</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">58</span> <span class="n">server0</span> <span class="n">systemd</span><span class="p">[</span><span class="mi">2748</span><span class="p">]</span><span class="o">:</span> <span class="n">Reached</span> <span class="n">target</span> <span class="n">Timers</span><span class="p">.</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">17</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">58</span> <span class="n">server0</span> <span class="n">systemd</span><span class="p">[</span><span class="mi">2748</span><span class="p">]</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">D</span><span class="o">-</span><span class="n">Bus</span> <span class="n">User</span> <span class="n">Message</span> <span class="n">Bus</span> <span class="n">Socket</span><span class="p">.</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">17</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">58</span> <span class="n">server0</span> <span class="n">systemd</span><span class="p">[</span><span class="mi">2748</span><span class="p">]</span><span class="o">:</span> <span class="n">Listening</span> <span class="n">on</span> <span class="n">Sound</span> <span class="n">System</span><span class="p">.</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">17</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">58</span> <span class="n">server0</span> <span class="n">systemd</span><span class="p">[</span><span class="mi">2748</span><span class="p">]</span><span class="o">:</span> <span class="n">Reached</span> <span class="n">target</span> <span class="n">Paths</span><span class="p">.</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">17</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">58</span> <span class="n">server0</span> <span class="n">systemd</span><span class="p">[</span><span class="mi">2748</span><span class="p">]</span><span class="o">:</span> <span class="n">Listening</span> <span class="n">on</span> <span class="n">Multimedia</span> <span class="n">System</span><span class="p">.</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">17</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">58</span> <span class="n">server0</span> <span class="n">systemd</span><span class="p">[</span><span class="mi">2748</span><span class="p">]</span><span class="o">:</span> <span class="n">Listening</span> <span class="n">on</span> <span class="n">D</span><span class="o">-</span><span class="n">Bus</span> <span class="n">User</span> <span class="n">Message</span> <span class="n">Bus</span> <span class="n">Sock</span><span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">17</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">58</span> <span class="n">server0</span> <span class="n">systemd</span><span class="p">[</span><span class="mi">2748</span><span class="p">]</span><span class="o">:</span> <span class="n">Reached</span> <span class="n">target</span> <span class="n">Sockets</span><span class="p">.</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">17</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">58</span> <span class="n">server0</span> <span class="n">systemd</span><span class="p">[</span><span class="mi">2748</span><span class="p">]</span><span class="o">:</span> <span class="n">Reached</span> <span class="n">target</span> <span class="n">Basic</span> <span class="n">System</span><span class="p">.</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">17</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">58</span> <span class="n">server0</span> <span class="n">systemd</span><span class="p">[</span><span class="mi">2748</span><span class="p">]</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">Sound</span> <span class="n">Service</span><span class="p">...</span>


<span class="err">$</span> <span class="n">sudo</span> <span class="n">journalctl</span> <span class="n">_SYSTEMD_UNIT</span><span class="o">=</span><span class="n">sshd</span><span class="p">.</span><span class="n">service</span>
<span class="o">--</span> <span class="n">Logs</span> <span class="n">begin</span> <span class="n">at</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mo">07</span> <span class="n">EDT</span><span class="p">,</span> <span class="n">end</span> <span class="n">at</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mi">21</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="mi">41</span> <span class="n">ED</span><span class="o">&gt;</span><span class="n">_</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mi">24</span> <span class="n">server0</span> <span class="n">sshd</span><span class="p">[</span><span class="mi">1122</span><span class="p">]</span><span class="o">:</span> <span class="n">Server</span> <span class="n">listening</span> <span class="n">on</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span> <span class="n">port</span> <span class="mi">22</span><span class="p">.</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mi">24</span> <span class="n">server0</span> <span class="n">sshd</span><span class="p">[</span><span class="mi">1122</span><span class="p">]</span><span class="o">:</span> <span class="n">Server</span> <span class="n">listening</span> <span class="n">on</span> <span class="o">::</span> <span class="n">port</span> <span class="mi">22</span><span class="p">.</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mo">04</span><span class="o">:</span><span class="mi">31</span> <span class="n">server0</span> <span class="n">sshd</span><span class="p">[</span><span class="mi">4811</span><span class="p">]</span><span class="o">:</span> <span class="n">Invalid</span> <span class="n">user</span> <span class="n">demo</span> <span class="n">from</span> <span class="o">::</span><span class="mi">1</span> <span class="n">port</span> <span class="mi">54122</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">08</span><span class="o">:</span><span class="mo">07</span> <span class="n">server0</span> <span class="n">sshd</span><span class="p">[</span><span class="mi">4871</span><span class="p">]</span><span class="o">:</span> <span class="n">Invalid</span> <span class="n">user</span> <span class="n">demo</span> <span class="n">from</span> <span class="o">::</span><span class="mi">1</span> <span class="n">port</span> <span class="mi">54124</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">08</span><span class="o">:</span><span class="mi">09</span> <span class="n">server0</span> <span class="n">sshd</span><span class="p">[</span><span class="mi">4871</span><span class="p">]</span><span class="o">:</span> <span class="n">pam_unix</span><span class="p">(</span><span class="n">sshd</span><span class="o">:</span><span class="n">auth</span><span class="p">)</span><span class="o">:</span> <span class="n">check</span> <span class="n">pass</span><span class="p">;</span> <span class="n">user</span> <span class="n">unkno</span><span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">08</span><span class="o">:</span><span class="mi">09</span> <span class="n">server0</span> <span class="n">sshd</span><span class="p">[</span><span class="mi">4871</span><span class="p">]</span><span class="o">:</span> <span class="n">pam_unix</span><span class="p">(</span><span class="n">sshd</span><span class="o">:</span><span class="n">auth</span><span class="p">)</span><span class="o">:</span> <span class="n">authentication</span> <span class="n">failure</span><span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">08</span><span class="o">:</span><span class="mi">11</span> <span class="n">server0</span> <span class="n">sshd</span><span class="p">[</span><span class="mi">4871</span><span class="p">]</span><span class="o">:</span> <span class="n">Failed</span> <span class="n">password</span> <span class="k">for</span> <span class="n">invalid</span> <span class="n">user</span> <span class="n">demo</span> <span class="n">from</span> <span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">08</span><span class="o">:</span><span class="mi">17</span> <span class="n">server0</span> <span class="n">sshd</span><span class="p">[</span><span class="mi">4871</span><span class="p">]</span><span class="o">:</span> <span class="n">pam_unix</span><span class="p">(</span><span class="n">sshd</span><span class="o">:</span><span class="n">auth</span><span class="p">)</span><span class="o">:</span> <span class="n">check</span> <span class="n">pass</span><span class="p">;</span> <span class="n">user</span> <span class="n">unkno</span><span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">08</span><span class="o">:</span><span class="mi">19</span> <span class="n">server0</span> <span class="n">sshd</span><span class="p">[</span><span class="mi">4871</span><span class="p">]</span><span class="o">:</span> <span class="n">Failed</span> <span class="n">password</span> <span class="k">for</span> <span class="n">invalid</span> <span class="n">user</span> <span class="n">demo</span> <span class="n">from</span> <span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">08</span><span class="o">:</span><span class="mi">26</span> <span class="n">server0</span> <span class="n">sshd</span><span class="p">[</span><span class="mi">4871</span><span class="p">]</span><span class="o">:</span> <span class="n">pam_unix</span><span class="p">(</span><span class="n">sshd</span><span class="o">:</span><span class="n">auth</span><span class="p">)</span><span class="o">:</span> <span class="n">check</span> <span class="n">pass</span><span class="p">;</span> <span class="n">user</span> <span class="n">unkno</span><span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">08</span><span class="o">:</span><span class="mi">28</span> <span class="n">server0</span> <span class="n">sshd</span><span class="p">[</span><span class="mi">4871</span><span class="p">]</span><span class="o">:</span> <span class="n">Failed</span> <span class="n">password</span> <span class="k">for</span> <span class="n">invalid</span> <span class="n">user</span> <span class="n">demo</span> <span class="n">from</span> <span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">08</span><span class="o">:</span><span class="mi">28</span> <span class="n">server0</span> <span class="n">sshd</span><span class="p">[</span><span class="mi">4871</span><span class="p">]</span><span class="o">:</span> <span class="n">Connection</span> <span class="n">closed</span> <span class="n">by</span> <span class="n">invalid</span> <span class="n">user</span> <span class="n">demo</span> <span class="o">::</span><span class="mi">1</span> <span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">08</span><span class="o">:</span><span class="mi">28</span> <span class="n">server0</span> <span class="n">sshd</span><span class="p">[</span><span class="mi">4871</span><span class="p">]</span><span class="o">:</span> <span class="n">PAM</span> <span class="mi">2</span> <span class="n">more</span> <span class="n">authenticati</span>


<span class="c1">// search according to the time</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">journalctl</span> <span class="o">--</span><span class="n">since</span> <span class="s">"1 hour ago"</span>
<span class="o">--</span> <span class="n">Logs</span> <span class="n">begin</span> <span class="n">at</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mo">07</span> <span class="n">EDT</span><span class="p">,</span> <span class="n">end</span> <span class="n">at</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mi">21</span><span class="o">:</span><span class="mi">08</span><span class="o">:</span><span class="mi">19</span> <span class="n">ED</span><span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">08</span><span class="o">:</span><span class="mi">19</span> <span class="n">server0</span> <span class="n">sshd</span><span class="p">[</span><span class="mi">4871</span><span class="p">]</span><span class="o">:</span> <span class="n">Failed</span> <span class="n">password</span> <span class="k">for</span> <span class="n">invalid</span> <span class="n">user</span> <span class="n">demo</span> <span class="n">from</span> <span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">20</span><span class="o">:</span><span class="mi">08</span><span class="o">:</span><span class="mi">26</span> <span class="n">server0</span> <span class="n">sshd</span><span class="p">[</span><span class="mi">4871</span><span class="p">]</span><span class="o">:</span> <span class="n">pam_unix</span><span class="p">(</span><span class="n">sshd</span><span class="o">:</span><span class="n">auth</span><span class="p">)</span><span class="o">:</span> <span class="n">check</span> <span class="n">pass</span><span class="p">;</span> <span class="n">user</span> <span class="n">unkno</span><span class="o">&gt;</span>


<span class="err">$</span> <span class="n">sudo</span> <span class="n">journalctl</span> <span class="o">--</span><span class="n">since</span> <span class="mi">19</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span>
<span class="o">--</span> <span class="n">Logs</span> <span class="n">begin</span> <span class="n">at</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mo">07</span> <span class="n">EDT</span><span class="p">,</span> <span class="n">end</span> <span class="n">at</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mi">21</span><span class="o">:</span><span class="mi">09</span><span class="o">:</span><span class="mi">39</span> <span class="n">ED</span><span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">19</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mo">01</span> <span class="n">server0</span> <span class="n">CROND</span><span class="p">[</span><span class="mi">4213</span><span class="p">]</span><span class="o">:</span> <span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">CMD</span> <span class="p">(</span><span class="n">run</span><span class="o">-</span><span class="n">parts</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="p">.</span><span class="n">hourly</span><span class="p">)</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">19</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mo">01</span> <span class="n">server0</span> <span class="n">run</span><span class="o">-</span><span class="n">parts</span><span class="p">[</span><span class="mi">4216</span><span class="p">]</span><span class="o">:</span> <span class="p">(</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="p">.</span><span class="n">hourly</span><span class="p">)</span> <span class="n">starting</span> <span class="mi">0</span><span class="n">anacron</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">19</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mo">01</span> <span class="n">server0</span> <span class="n">run</span><span class="o">-</span><span class="n">parts</span><span class="p">[</span><span class="mi">4222</span><span class="p">]</span><span class="o">:</span> <span class="p">(</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="p">.</span><span class="n">hourly</span><span class="p">)</span> <span class="n">finished</span> <span class="mi">0</span><span class="n">anacron</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">19</span><span class="o">:</span><span class="mi">36</span><span class="o">:</span><span class="mi">44</span> <span class="n">server0</span> <span class="n">cupsd</span><span class="p">[</span><span class="mi">1125</span><span class="p">]</span><span class="o">:</span> <span class="n">REQUEST</span> <span class="n">localhost</span>

</pre></table></code></div></div><hr /><h2 id="setup-tftp-server-and-client-by-xinetd">setup tftp server and client by xinetd</h2><p>server0:</p><ol><li>install the tftp-server</ol><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">xinetd</span> <span class="n">tftp</span><span class="o">-</span><span class="n">server</span> <span class="n">tftp</span>

<span class="err">$</span> <span class="n">cd</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">xinetd</span><span class="p">.</span><span class="n">d</span><span class="o">/</span>
<span class="err">$</span> <span class="n">ls</span>
<span class="n">chargen</span><span class="o">-</span><span class="n">dgram</span>   <span class="n">daytime</span><span class="o">-</span><span class="n">stream</span>  <span class="n">echo</span><span class="o">-</span><span class="n">dgram</span>     <span class="n">time</span><span class="o">-</span><span class="n">dgram</span>
<span class="n">chargen</span><span class="o">-</span><span class="n">stream</span>  <span class="n">discard</span><span class="o">-</span><span class="n">dgram</span>   <span class="n">echo</span><span class="o">-</span><span class="n">stream</span>    <span class="n">time</span><span class="o">-</span><span class="n">stream</span>
<span class="n">daytime</span><span class="o">-</span><span class="n">dgram</span>   <span class="n">discard</span><span class="o">-</span><span class="n">stream</span>  <span class="n">tcpmux</span><span class="o">-</span><span class="n">server</span>

<span class="n">directory</span> <span class="k">for</span> <span class="n">the</span> <span class="n">xinetd</span> <span class="n">configuration</span>
<span class="n">a</span> <span class="n">collection</span> <span class="n">of</span> <span class="n">configuration</span> <span class="n">files</span> <span class="k">for</span> <span class="n">the</span> <span class="n">various</span> <span class="n">services</span> <span class="n">that</span> <span class="n">xinetd</span> <span class="n">can</span> <span class="n">provide</span><span class="p">.</span>
<span class="n">can</span> <span class="n">build</span> <span class="n">your</span> <span class="n">own</span><span class="p">,</span> <span class="n">these</span> <span class="n">are</span> <span class="n">the</span> <span class="n">ones</span> <span class="n">that</span> <span class="n">come</span> <span class="n">with</span> <span class="n">the</span> <span class="n">package</span><span class="p">.</span>


<span class="err">$</span> <span class="n">sudo</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">xinetd</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">tftp</span>
<span class="n">service</span> <span class="n">tftp</span>
<span class="p">{</span>
        <span class="n">socket_type</span>     <span class="o">=</span> <span class="n">dgram</span>
        <span class="n">protocol</span>        <span class="o">=</span> <span class="n">udp</span>
        <span class="n">wait</span>            <span class="o">=</span> <span class="n">yes</span>
        <span class="n">user</span>            <span class="o">=</span> <span class="n">root</span>
        <span class="n">server</span>          <span class="o">=</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">in</span><span class="p">.</span><span class="n">tftpd</span>
        <span class="n">server_args</span>     <span class="o">=</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">tftpboot</span>   <span class="c1">// location to put file</span>
        <span class="n">disable</span>         <span class="o">=</span> <span class="n">no</span>
        <span class="n">per_source</span>      <span class="o">=</span> <span class="mi">11</span>
        <span class="n">cps</span>             <span class="o">=</span> <span class="mi">100</span> <span class="mi">2</span>
        <span class="n">flags</span>           <span class="o">=</span> <span class="n">IPv4</span>
<span class="p">}</span>

<span class="n">service</span> <span class="n">tftp</span>
<span class="p">{</span>
<span class="n">socket_type</span> <span class="o">=</span> <span class="n">dgram</span>
<span class="n">protocol</span> <span class="o">=</span> <span class="n">udp</span>
<span class="n">wait</span> <span class="o">=</span> <span class="n">yes</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">root</span>
<span class="n">port</span> <span class="o">=</span> <span class="mi">69</span>
<span class="n">server</span> <span class="o">=</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">in</span><span class="p">.</span><span class="n">tftpd</span>
<span class="n">server_args</span> <span class="o">=</span> <span class="o">-</span><span class="n">c</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">tftpboot</span>
<span class="n">disable</span> <span class="o">=</span> <span class="n">no</span>
<span class="n">per_source</span> <span class="o">=</span> <span class="mi">11</span>
<span class="n">cps</span> <span class="o">=</span> <span class="mi">100</span> <span class="mi">2</span>
<span class="n">flags</span> <span class="o">=</span> <span class="n">IPv4</span>
<span class="p">}</span>


<span class="n">the</span> <span class="k">default</span> <span class="n">TFTP</span> <span class="n">root</span> <span class="n">directory</span> <span class="n">is</span> <span class="n">set</span> <span class="n">to</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">tftpboot</span><span class="p">.</span>

<span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">tftpboot</span>
<span class="n">sudo</span> <span class="n">chmod</span> <span class="o">-</span><span class="n">R</span> <span class="mi">777</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">tftpboot</span>
</pre></table></code></div></div><ol><li>Enable TFTP Service</ol><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
</pre><td class="rouge-code"><pre>
<span class="n">The</span> <span class="n">CentOS</span> <span class="mi">7</span> <span class="n">services</span><span class="p">(</span><span class="n">systemd</span><span class="p">)</span> <span class="n">can</span> <span class="n">be</span> <span class="n">configured</span> <span class="n">from</span> <span class="n">files</span> <span class="n">under</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="p">.</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">vi</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">tftp</span><span class="p">.</span><span class="n">service</span>
<span class="c1">// edit tftp.service as follows</span>
<span class="p">[</span><span class="n">Unit</span><span class="p">]</span>
<span class="n">Description</span><span class="o">=</span><span class="n">Tftp</span> <span class="n">Server</span>

<span class="p">[</span><span class="n">Service</span><span class="p">]</span>
<span class="n">ExecStart</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">in</span><span class="p">.</span><span class="n">tftpd</span> <span class="o">-</span><span class="n">c</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">tftpboot</span>
<span class="n">StandardInput</span><span class="o">=</span><span class="n">socket</span>

<span class="p">[</span><span class="n">Install</span><span class="p">]</span>
<span class="n">WantedBy</span><span class="o">=</span><span class="n">multi</span><span class="o">-</span><span class="n">user</span><span class="p">.</span><span class="n">target</span>


<span class="n">start</span> <span class="n">services</span> <span class="n">xinetd</span> <span class="n">and</span> <span class="n">tftp</span><span class="o">:</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">daemon</span><span class="o">-</span><span class="n">reload</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">xinetd</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">tftp</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">xinetd</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">tftp</span>



<span class="n">In</span> <span class="n">CentOS</span> <span class="mi">7</span><span class="p">,</span> <span class="n">the</span> <span class="n">SELinux</span> <span class="n">is</span> <span class="n">not</span> <span class="n">supposed</span> <span class="n">to</span> <span class="n">be</span> <span class="n">disabled</span><span class="p">(</span><span class="n">the</span> <span class="n">system</span> <span class="n">will</span> <span class="n">abort</span> <span class="n">booting</span> <span class="k">if</span> <span class="n">you</span> <span class="n">disable</span> <span class="n">SELinux</span><span class="p">).</span> <span class="n">So</span> <span class="n">the</span> <span class="n">TFTP</span> <span class="n">read</span> <span class="n">and</span> <span class="n">write</span> <span class="n">must</span> <span class="n">be</span> <span class="n">allowed</span> <span class="n">in</span> <span class="n">SELinux</span><span class="p">.</span> <span class="n">By</span> <span class="k">default</span><span class="p">,</span> <span class="n">the</span> <span class="n">SELinux</span> <span class="n">uses</span> <span class="n">enforcing</span> <span class="n">policy</span><span class="p">,</span> <span class="n">which</span> <span class="n">does</span> <span class="n">not</span> <span class="n">accept</span> <span class="n">any</span> <span class="n">change</span><span class="p">.</span> <span class="n">To</span> <span class="n">make</span> <span class="n">any</span> <span class="n">change</span> <span class="n">to</span> <span class="n">SELinux</span><span class="p">,</span> <span class="n">first</span> <span class="n">modify</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">selinux</span><span class="o">/</span><span class="n">config</span> <span class="n">and</span> <span class="n">change</span> <span class="n">the</span> <span class="n">policy</span> <span class="n">to</span> <span class="n">permissive</span><span class="o">:</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">selinux</span><span class="o">/</span><span class="n">config</span>

<span class="cp"># This file controls the state of SELinux on the system.
# SELINUX= can take one of these three values:
#     enforcing - SELinux security policy is enforced.
#     permissive - SELinux prints warnings instead of enforcing.
#     disabled - No SELinux policy is loaded.
# change: SELINUX=enforcing
</span><span class="n">SELINUX</span><span class="o">=</span><span class="n">permissive</span>
<span class="cp"># SELINUXTYPE= can take one of three two values:
#     targeted - Targeted processes are protected,
#     minimum - Modification of targeted policy. Only selected processes are protected.
#     mls - Multi Level Security protection.
</span><span class="n">SELINUXTYPE</span><span class="o">=</span><span class="n">targeted</span>



<span class="n">reboot</span> <span class="n">the</span> <span class="n">system</span><span class="p">.</span> <span class="n">After</span> <span class="n">system</span> <span class="n">boot</span> <span class="n">up</span><span class="p">,</span> <span class="n">check</span> <span class="n">SELinux</span> <span class="n">status</span><span class="o">:</span>

<span class="err">$</span> <span class="n">reboot</span>

<span class="err">$</span> <span class="n">sestatus</span>
<span class="n">SELinux</span> <span class="n">status</span><span class="o">:</span>                 <span class="n">enabled</span>
<span class="n">SELinuxfs</span> <span class="n">mount</span><span class="o">:</span>                <span class="o">/</span><span class="n">sys</span><span class="o">/</span><span class="n">fs</span><span class="o">/</span><span class="n">selinux</span>
<span class="n">SELinux</span> <span class="n">root</span> <span class="n">directory</span><span class="o">:</span>         <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">selinux</span>
<span class="n">Loaded</span> <span class="n">policy</span> <span class="n">name</span><span class="o">:</span>             <span class="n">targeted</span>
<span class="n">Current</span> <span class="n">mode</span><span class="o">:</span>                   <span class="n">permissive</span>
<span class="n">Mode</span> <span class="n">from</span> <span class="n">config</span> <span class="n">file</span><span class="o">:</span>          <span class="n">permissive</span>
<span class="n">Policy</span> <span class="n">MLS</span> <span class="n">status</span><span class="o">:</span>              <span class="n">enabled</span>
<span class="n">Policy</span> <span class="n">deny_unknown</span> <span class="n">status</span><span class="o">:</span>     <span class="n">allowed</span>
<span class="n">Max</span> <span class="n">kernel</span> <span class="n">policy</span> <span class="n">version</span><span class="o">:</span>      <span class="mi">28</span>




<span class="n">check</span> <span class="n">the</span> <span class="n">tftp</span> <span class="n">permissions</span> <span class="n">in</span> <span class="n">SELinux</span><span class="o">:</span>

<span class="err">$</span> <span class="n">getsebool</span> <span class="o">-</span><span class="n">a</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">tftp</span>
<span class="n">tftp_anon_write</span> <span class="o">--&gt;</span> <span class="n">off</span>
<span class="n">tftp_home_dir</span> <span class="o">--&gt;</span> <span class="n">off</span>


<span class="n">enable</span> <span class="n">it</span> <span class="n">with</span> <span class="n">setsebool</span> <span class="n">command</span><span class="o">:</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">setsebool</span> <span class="o">-</span><span class="n">P</span> <span class="n">tftp_anon_write</span> <span class="mi">1</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">setsebool</span> <span class="o">-</span><span class="n">P</span> <span class="n">tftp_home_dir</span> <span class="mi">1</span>
</pre></table></code></div></div><ol><li>create the file</ol><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">sudo</span> <span class="n">vi</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">tftpboot</span><span class="o">/</span><span class="n">file</span><span class="p">.</span><span class="n">txt</span>
<span class="c1">// "teset file"</span>


<span class="n">sudo</span> <span class="n">service</span> <span class="n">xinetd</span> <span class="n">stop</span>
<span class="n">sudo</span> <span class="n">service</span> <span class="n">xinetd</span> <span class="n">start</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">restart</span> <span class="n">xinetd</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">journalctl</span> <span class="o">-</span><span class="n">u</span> <span class="n">xinetd</span>
<span class="o">--</span> <span class="n">Logs</span> <span class="n">begin</span> <span class="n">at</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mo">03</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mo">07</span> <span class="n">EDT</span><span class="p">,</span> <span class="n">end</span> <span class="n">at</span> <span class="n">Sun</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">19</span> <span class="mi">21</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mi">09</span> <span class="n">E</span><span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">21</span><span class="o">:</span><span class="mi">42</span><span class="o">:</span><span class="mi">37</span> <span class="n">server0</span> <span class="n">systemd</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">Xinetd</span> <span class="n">A</span> <span class="n">Powerful</span> <span class="n">Replacement</span> <span class="n">For</span><span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">21</span><span class="o">:</span><span class="mi">42</span><span class="o">:</span><span class="mi">37</span> <span class="n">server0</span> <span class="n">systemd</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span> <span class="n">xinetd</span><span class="p">.</span><span class="n">service</span><span class="o">:</span> <span class="n">Cant</span> <span class="n">open</span> <span class="n">PID</span> <span class="n">file</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">r</span><span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">21</span><span class="o">:</span><span class="mi">42</span><span class="o">:</span><span class="mi">37</span> <span class="n">server0</span> <span class="n">systemd</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span> <span class="n">Started</span> <span class="n">Xinetd</span> <span class="n">A</span> <span class="n">Powerful</span> <span class="n">Replacement</span> <span class="n">For</span> <span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">21</span><span class="o">:</span><span class="mi">42</span><span class="o">:</span><span class="mi">37</span> <span class="n">server0</span> <span class="n">xinetd</span><span class="p">[</span><span class="mi">7936</span><span class="p">]</span><span class="o">:</span> <span class="n">Reading</span> <span class="n">included</span> <span class="n">configuration</span> <span class="n">file</span><span class="o">:</span> <span class="o">/</span><span class="n">et</span><span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">21</span><span class="o">:</span><span class="mi">42</span><span class="o">:</span><span class="mi">37</span> <span class="n">server0</span> <span class="n">xinetd</span><span class="p">[</span><span class="mi">7936</span><span class="p">]</span><span class="o">:</span> <span class="n">Reading</span> <span class="n">included</span> <span class="n">configuration</span> <span class="n">file</span><span class="o">:</span> <span class="o">/</span><span class="n">et</span><span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">21</span><span class="o">:</span><span class="mi">42</span><span class="o">:</span><span class="mi">37</span> <span class="n">server0</span> <span class="n">systemd</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span> <span class="n">Started</span> <span class="n">Xinetd</span> <span class="n">A</span> <span class="n">Powerful</span> <span class="n">Replacement</span> <span class="n">For</span> <span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">21</span><span class="o">:</span><span class="mi">42</span><span class="o">:</span><span class="mi">37</span> <span class="n">server0</span> <span class="n">xinetd</span><span class="p">[</span><span class="mi">7936</span><span class="p">]</span><span class="o">:</span> <span class="n">Reading</span> <span class="n">included</span> <span class="n">configuration</span> <span class="n">file</span><span class="o">:</span> <span class="o">/</span><span class="n">et</span><span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">21</span><span class="o">:</span><span class="mi">42</span><span class="o">:</span><span class="mi">37</span> <span class="n">server0</span> <span class="n">xinetd</span><span class="p">[</span><span class="mi">7936</span><span class="p">]</span><span class="o">:</span> <span class="n">removing</span> <span class="n">chargen</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">21</span><span class="o">:</span><span class="mi">42</span><span class="o">:</span><span class="mi">37</span> <span class="n">server0</span> <span class="n">xinetd</span><span class="p">[</span><span class="mi">7936</span><span class="p">]</span><span class="o">:</span> <span class="n">xinetd</span> <span class="n">Version</span> <span class="mi">2</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span> <span class="n">started</span> <span class="n">with</span> <span class="n">loada</span><span class="o">&gt;</span>
<span class="n">Apr</span> <span class="mi">19</span> <span class="mi">21</span><span class="o">:</span><span class="mi">42</span><span class="o">:</span><span class="mi">37</span> <span class="n">server0</span> <span class="n">xinetd</span><span class="p">[</span><span class="mi">7936</span><span class="p">]</span><span class="o">:</span> <span class="n">Started</span> <span class="n">working</span><span class="o">:</span> <span class="mi">1</span> <span class="n">available</span> <span class="n">service</span>
<span class="c1">// it's TFTP</span>
<span class="n">lines</span> <span class="mi">7</span><span class="o">-</span><span class="mi">29</span><span class="o">/</span><span class="mi">29</span> <span class="p">(</span><span class="n">END</span><span class="p">)</span>
</pre></table></code></div></div><ol><li>Configure firewalld</ol><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="n">allow</span> <span class="n">TFTP</span> <span class="n">port</span> <span class="n">in</span> <span class="n">firewalld</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">permanent</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">port</span><span class="o">=</span><span class="mi">69</span><span class="o">/</span><span class="n">udp</span>
<span class="n">success</span>

<span class="n">allow</span> <span class="n">TFTP</span> <span class="n">service</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">reload</span>
<span class="n">success</span>


<span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">status</span> <span class="n">firewalld</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">firewalld</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">firewalld</span>
</pre></table></code></div></div><ol><li>create file</ol><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">echo</span> <span class="s">"hello"</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">tee</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">tftpboot</span><span class="o">/</span><span class="n">hello</span><span class="p">.</span><span class="n">txt</span>
<span class="n">hello</span>
<span class="err">$</span> <span class="n">echo</span> <span class="s">"get hello.txt"</span> <span class="o">|</span> <span class="n">tftp</span> <span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span>
<span class="n">tftp</span><span class="o">&gt;</span> <span class="n">get</span> <span class="n">hello</span><span class="p">.</span><span class="n">txt</span>
<span class="n">tftp</span><span class="o">&gt;</span>

<span class="err">$</span> <span class="n">cat</span> <span class="n">hello</span><span class="p">.</span><span class="n">txt</span>
<span class="n">hello</span>
</pre></table></code></div></div><p>server1:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">xinetd</span> <span class="n">tftp</span><span class="o">-</span><span class="n">server</span> <span class="n">tftp</span>

<span class="p">...</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">tftp</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span> <span class="o">-</span><span class="n">c</span> <span class="n">get</span> <span class="n">file</span><span class="p">.</span><span class="n">txt</span>
</pre></table></code></div></div><hr /><h2 id="check-cpu">check CPU</h2><p>server0:</p><ol><li>check the CPU information</ol><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
</pre><td class="rouge-code"><pre>
<span class="err">$</span> <span class="n">lscpu</span>
<span class="c1">// information about systems processor topology, and each individual chip in our environment.</span>
<span class="n">Architecture</span><span class="o">:</span>        <span class="n">x86_64</span>     <span class="c1">//64-bit chips</span>
<span class="n">CPU</span> <span class="n">op</span><span class="o">-</span><span class="n">mode</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">:</span>      <span class="mi">32</span><span class="o">-</span><span class="n">bit</span><span class="p">,</span> <span class="mi">64</span><span class="o">-</span><span class="n">bit</span>
<span class="n">Byte</span> <span class="n">Order</span><span class="o">:</span>          <span class="n">Little</span> <span class="n">Endian</span>
<span class="n">CPU</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">:</span>              <span class="mi">1</span>
<span class="n">On</span><span class="o">-</span><span class="n">line</span> <span class="n">CPU</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">list</span><span class="o">:</span> <span class="mi">0</span>
<span class="n">Thread</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">per</span> <span class="n">core</span><span class="o">:</span>  <span class="mi">1</span>
<span class="n">Core</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">per</span> <span class="n">socket</span><span class="o">:</span>  <span class="mi">1</span>
<span class="n">Socket</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">:</span>           <span class="mi">1</span>
<span class="n">NUMA</span> <span class="n">node</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">:</span>        <span class="mi">1</span>
<span class="n">Vendor</span> <span class="n">ID</span><span class="o">:</span>           <span class="n">GenuineIntel</span>
<span class="n">CPU</span> <span class="n">family</span><span class="o">:</span>          <span class="mi">6</span>
<span class="n">Model</span><span class="o">:</span>               <span class="mi">70</span>
<span class="n">Model</span> <span class="n">name</span><span class="o">:</span>          <span class="n">Intel</span><span class="p">(</span><span class="n">R</span><span class="p">)</span> <span class="n">Core</span><span class="p">(</span><span class="n">TM</span><span class="p">)</span> <span class="n">i7</span><span class="o">-</span><span class="mi">4770</span><span class="n">HQ</span> <span class="n">CPU</span> <span class="err">@</span> <span class="mi">2</span><span class="p">.</span><span class="mi">20</span><span class="n">GHz</span> <span class="c1">// processor</span>
<span class="n">Stepping</span><span class="o">:</span>            <span class="mi">1</span>
<span class="n">CPU</span> <span class="n">MHz</span><span class="o">:</span>             <span class="mi">2194</span><span class="p">.</span><span class="mi">918</span>
<span class="n">BogoMIPS</span><span class="o">:</span>            <span class="mi">4389</span><span class="p">.</span><span class="mi">83</span>
<span class="n">Hypervisor</span> <span class="n">vendor</span><span class="o">:</span>   <span class="n">KVM</span>
<span class="n">Virtualization</span> <span class="n">type</span><span class="o">:</span> <span class="n">full</span>
<span class="n">L1d</span> <span class="n">cache</span><span class="o">:</span>           <span class="mi">32</span><span class="n">K</span>
<span class="n">L1i</span> <span class="n">cache</span><span class="o">:</span>           <span class="mi">32</span><span class="n">K</span>
<span class="n">L2</span> <span class="n">cache</span><span class="o">:</span>            <span class="mi">256</span><span class="n">K</span>
<span class="n">L3</span> <span class="n">cache</span><span class="o">:</span>            <span class="mi">6144</span><span class="n">K</span>
<span class="n">L4</span> <span class="n">cache</span><span class="o">:</span>            <span class="mi">131072</span><span class="n">K</span>
<span class="n">NUMA</span> <span class="n">node0</span> <span class="n">CPU</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">:</span>   <span class="mi">0</span>
<span class="n">Flags</span><span class="o">:</span>               <span class="n">fpu</span> <span class="n">vme</span> <span class="n">de</span> <span class="n">pse</span> <span class="n">tsc</span> <span class="n">msr</span> <span class="n">pae</span> <span class="n">mce</span> <span class="n">cx8</span> <span class="n">apic</span> <span class="n">sep</span> <span class="n">mtrr</span> <span class="n">pge</span> <span class="n">mca</span> <span class="n">cmov</span> <span class="n">pat</span> <span class="n">pse36</span> <span class="n">clflush</span> <span class="n">mmx</span> <span class="n">fxsr</span> <span class="n">sse</span> <span class="n">sse2</span> <span class="n">ht</span> <span class="n">syscall</span> <span class="n">nx</span> <span class="n">rdtscp</span> <span class="n">lm</span> <span class="n">constant_tsc</span> <span class="n">rep_good</span> <span class="n">nopl</span> <span class="n">xtopology</span> <span class="n">nonstop_tsc</span> <span class="n">cpuid</span> <span class="n">tsc_known_freq</span> <span class="n">pni</span> <span class="n">pclmulqdq</span> <span class="n">monitor</span> <span class="n">ssse3</span> <span class="n">cx16</span> <span class="n">pcid</span> <span class="n">sse4_1</span> <span class="n">sse4_2</span> <span class="n">x2apic</span> <span class="n">movbe</span> <span class="n">popcnt</span> <span class="n">aes</span> <span class="n">xsave</span> <span class="n">avx</span> <span class="n">rdrand</span> <span class="n">hypervisor</span> <span class="n">lahf_lm</span> <span class="n">abm</span> <span class="n">invpcid_single</span> <span class="n">pti</span> <span class="n">fsgsbase</span> <span class="n">avx2</span> <span class="n">invpcid</span> <span class="n">md_clear</span> <span class="n">flush_l1d</span>



<span class="err">$</span> <span class="n">cat</span> <span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="n">cpuinfo</span>
<span class="c1">// same information</span>
<span class="n">processor</span>	<span class="o">:</span> <span class="mi">0</span>
<span class="n">vendor_id</span>	<span class="o">:</span> <span class="n">GenuineIntel</span>
<span class="n">cpu</span> <span class="n">family</span>	<span class="o">:</span> <span class="mi">6</span>
<span class="n">model</span>		<span class="o">:</span> <span class="mi">70</span>
<span class="n">model</span> <span class="n">name</span>	<span class="o">:</span> <span class="n">Intel</span><span class="p">(</span><span class="n">R</span><span class="p">)</span> <span class="n">Core</span><span class="p">(</span><span class="n">TM</span><span class="p">)</span> <span class="n">i7</span><span class="o">-</span><span class="mi">4770</span><span class="n">HQ</span> <span class="n">CPU</span> <span class="err">@</span> <span class="mi">2</span><span class="p">.</span><span class="mi">20</span><span class="n">GHz</span>
<span class="n">stepping</span>	<span class="o">:</span> <span class="mi">1</span>
<span class="n">cpu</span> <span class="n">MHz</span>		<span class="o">:</span> <span class="mi">2194</span><span class="p">.</span><span class="mi">918</span>
<span class="n">cache</span> <span class="n">size</span>	<span class="o">:</span> <span class="mi">6144</span> <span class="n">KB</span>
<span class="n">physical</span> <span class="n">id</span>	<span class="o">:</span> <span class="mi">0</span>
<span class="n">siblings</span>	<span class="o">:</span> <span class="mi">1</span>
<span class="n">core</span> <span class="n">id</span>		<span class="o">:</span> <span class="mi">0</span>
<span class="n">cpu</span> <span class="n">cores</span>	<span class="o">:</span> <span class="mi">1</span>
<span class="n">apicid</span>		<span class="o">:</span> <span class="mi">0</span>
<span class="n">initial</span> <span class="n">apicid</span>	<span class="o">:</span> <span class="mi">0</span>
<span class="n">fpu</span>		<span class="o">:</span> <span class="n">yes</span>
<span class="n">fpu_exception</span>	<span class="o">:</span> <span class="n">yes</span>
<span class="n">cpuid</span> <span class="n">level</span>	<span class="o">:</span> <span class="mi">13</span>
<span class="n">wp</span>		<span class="o">:</span> <span class="n">yes</span>
<span class="n">flags</span>		<span class="o">:</span> <span class="n">fpu</span> <span class="n">vme</span> <span class="n">de</span> <span class="n">pse</span> <span class="n">tsc</span> <span class="n">msr</span> <span class="n">pae</span> <span class="n">mce</span> <span class="n">cx8</span> <span class="n">apic</span> <span class="n">sep</span> <span class="n">mtrr</span> <span class="n">pge</span> <span class="n">mca</span> <span class="n">cmov</span> <span class="n">pat</span> <span class="n">pse36</span> <span class="n">clflush</span> <span class="n">mmx</span> <span class="n">fxsr</span> <span class="n">sse</span> <span class="n">sse2</span> <span class="n">ht</span> <span class="n">syscall</span> <span class="n">nx</span> <span class="n">rdtscp</span> <span class="n">lm</span> <span class="n">constant_tsc</span> <span class="n">rep_good</span> <span class="n">nopl</span> <span class="n">xtopology</span> <span class="n">nonstop_tsc</span> <span class="n">cpuid</span> <span class="n">tsc_known_freq</span> <span class="n">pni</span> <span class="n">pclmulqdq</span> <span class="n">monitor</span> <span class="n">ssse3</span> <span class="n">cx16</span> <span class="n">pcid</span> <span class="n">sse4_1</span> <span class="n">sse4_2</span> <span class="n">x2apic</span> <span class="n">movbe</span> <span class="n">popcnt</span> <span class="n">aes</span> <span class="n">xsave</span> <span class="n">avx</span> <span class="n">rdrand</span> <span class="n">hypervisor</span> <span class="n">lahf_lm</span> <span class="n">abm</span> <span class="n">invpcid_single</span> <span class="n">pti</span> <span class="n">fsgsbase</span> <span class="n">avx2</span> <span class="n">invpcid</span> <span class="n">md_clear</span> <span class="n">flush_l1d</span>
<span class="n">bugs</span>		<span class="o">:</span> <span class="n">cpu_meltdown</span> <span class="n">spectre_v1</span> <span class="n">spectre_v2</span> <span class="n">spec_store_bypass</span> <span class="n">l1tf</span> <span class="n">mds</span> <span class="n">swapgs</span> <span class="n">itlb_multihit</span>
<span class="n">bogomips</span>	<span class="o">:</span> <span class="mi">4389</span><span class="p">.</span><span class="mi">83</span>
<span class="n">clflush</span> <span class="n">size</span>	<span class="o">:</span> <span class="mi">64</span>
<span class="n">cache_alignment</span>	<span class="o">:</span> <span class="mi">64</span>
<span class="n">address</span> <span class="n">sizes</span>	<span class="o">:</span> <span class="mi">39</span> <span class="n">bits</span> <span class="n">physical</span><span class="p">,</span> <span class="mi">48</span> <span class="n">bits</span> <span class="k">virtual</span>
<span class="n">power</span> <span class="n">management</span><span class="o">:</span>

</pre></table></code></div></div><ol><li>monitor the CPU</ol><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre><td class="rouge-code"><pre>
<span class="c1">// keep reading a random number and throw it out on /dev/null</span>
<span class="err">$</span> <span class="n">cat</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">random</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span>


<span class="c1">// now check the CPU</span>
<span class="err">$</span> <span class="n">top</span>
<span class="n">top</span> <span class="o">-</span> <span class="mi">23</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mi">33</span> <span class="n">up</span> <span class="mi">22</span> <span class="n">min</span><span class="p">,</span>  <span class="mi">1</span> <span class="n">user</span><span class="p">,</span>  <span class="n">load</span> <span class="n">average</span><span class="o">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">31</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">24</span>
<span class="n">Tasks</span><span class="o">:</span> <span class="mi">226</span> <span class="n">total</span><span class="p">,</span>   <span class="mi">2</span> <span class="n">running</span><span class="p">,</span> <span class="mi">224</span> <span class="n">sleeping</span><span class="p">,</span>   <span class="mi">0</span> <span class="n">stopped</span><span class="p">,</span>   <span class="mi">0</span> <span class="n">zombie</span>
<span class="c1">// total number of tasks</span>
<span class="o">%</span><span class="n">Cpu</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">:</span> <span class="mi">60</span><span class="p">.</span><span class="mi">6</span> <span class="n">us</span><span class="p">,</span> <span class="mi">37</span><span class="p">.</span><span class="mi">8</span> <span class="n">sy</span><span class="p">,</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span> <span class="n">ni</span><span class="p">,</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span> <span class="n">id</span><span class="p">,</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span> <span class="n">wa</span><span class="p">,</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">6</span> <span class="n">hi</span><span class="p">,</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span> <span class="n">si</span><span class="p">,</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span> <span class="n">st</span>
<span class="c1">// CPU percentage：</span>
<span class="c1">// user processes, system processes(I/O, network interrupts, inside the kernel),</span>
<span class="c1">// nice processes: things that have had their priority adjusted.</span>
<span class="c1">// idle CPU: the time that the CPU's actually doing nothing and since we're running a pretty heavy load, that's going to be a very low value right now.</span>
<span class="c1">// WA for waits: any time the CPU is waiting for an external thing.</span>
<span class="c1">// The final three values are data points for hardware interrupts</span>
<span class="c1">// HI, software interrupts, ST - time stolen from this VM's hypervisor.</span>
<span class="c1">// CPU metrics, point to whats burning up your CPU.</span>
<span class="n">MiB</span> <span class="n">Mem</span> <span class="o">:</span>   <span class="mi">2245</span><span class="p">.</span><span class="mi">6</span> <span class="n">total</span><span class="p">,</span>    <span class="mi">152</span><span class="p">.</span><span class="mi">3</span> <span class="n">free</span><span class="p">,</span>   <span class="mi">1226</span><span class="p">.</span><span class="mi">6</span> <span class="n">used</span><span class="p">,</span>    <span class="mi">866</span><span class="p">.</span><span class="mi">7</span> <span class="n">buff</span><span class="o">/</span><span class="n">cache</span>
<span class="n">MiB</span> <span class="n">Swap</span><span class="o">:</span>   <span class="mi">2048</span><span class="p">.</span><span class="mi">0</span> <span class="n">total</span><span class="p">,</span>   <span class="mi">2048</span><span class="p">.</span><span class="mi">0</span> <span class="n">free</span><span class="p">,</span>      <span class="mi">0</span><span class="p">.</span><span class="mi">0</span> <span class="n">used</span><span class="p">.</span>    <span class="mi">843</span><span class="p">.</span><span class="mi">4</span> <span class="n">avail</span> <span class="n">Mem</span>

  <span class="n">PID</span> <span class="n">USER</span>      <span class="n">PR</span>  <span class="n">NI</span>    <span class="n">VIRT</span>    <span class="n">RES</span>    <span class="n">SHR</span> <span class="n">S</span>  <span class="o">%</span><span class="n">CPU</span>  <span class="o">%</span><span class="n">MEM</span>     <span class="n">TIME</span><span class="o">+</span> <span class="n">COMMAND</span>
  <span class="mi">998</span> <span class="n">root</span>      <span class="mi">20</span>   <span class="mi">0</span>  <span class="mi">160208</span>   <span class="mi">6464</span>   <span class="mi">5648</span> <span class="n">R</span>  <span class="mi">56</span><span class="p">.</span><span class="mi">6</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">3</span>   <span class="mi">0</span><span class="o">:</span><span class="mi">13</span><span class="p">.</span><span class="mi">35</span> <span class="n">rngd</span>
 <span class="mi">3994</span> <span class="n">server1</span>   <span class="mi">20</span>   <span class="mi">0</span>    <span class="mi">7420</span>    <span class="mi">832</span>    <span class="mi">768</span> <span class="n">S</span>  <span class="mi">24</span><span class="p">.</span><span class="mi">2</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">0</span><span class="o">:</span><span class="mo">04</span><span class="p">.</span><span class="mi">87</span> <span class="n">cat</span>
 <span class="mi">2859</span> <span class="n">server1</span>   <span class="mi">20</span>   <span class="mi">0</span> <span class="mi">3038408</span> <span class="mi">422480</span> <span class="mi">107312</span> <span class="n">S</span>  <span class="mi">14</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">18</span><span class="p">.</span><span class="mi">4</span>   <span class="mi">0</span><span class="o">:</span><span class="mi">14</span><span class="p">.</span><span class="mi">09</span> <span class="n">gnome</span><span class="o">-</span><span class="n">shell</span>


<span class="n">sorted</span> <span class="n">by</span> <span class="n">CPU</span> <span class="n">load</span><span class="p">.</span>
<span class="n">the</span> <span class="n">top</span> <span class="n">of</span> <span class="n">the</span> <span class="n">list</span> <span class="n">here</span> <span class="n">is</span> <span class="n">RNGD</span><span class="p">,</span> <span class="n">the</span> <span class="n">random</span> <span class="n">number</span> <span class="n">generator</span><span class="p">.</span>
<span class="n">the</span> <span class="n">process</span> <span class="n">that</span> <span class="n">feeds</span> <span class="n">the</span> <span class="n">random</span> <span class="n">number</span> <span class="n">generator</span> <span class="n">on</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">random</span>
<span class="n">it</span> <span class="n">is</span> <span class="n">taxing</span> <span class="n">the</span> <span class="n">system</span> <span class="n">to</span> <span class="n">high</span> <span class="mi">90</span><span class="n">s</span><span class="p">.</span>


<span class="c1">// outputs the load average and all of the logged in users</span>
<span class="err">$</span> <span class="n">w</span> <span class="n">uptime</span>
 <span class="mi">23</span><span class="o">:</span><span class="mi">53</span><span class="o">:</span><span class="mi">57</span> <span class="n">up</span>  <span class="mi">1</span><span class="o">:</span><span class="mo">01</span><span class="p">,</span>  <span class="mi">1</span> <span class="n">user</span><span class="p">,</span>  <span class="n">load</span> <span class="n">average</span><span class="o">:</span> <span class="mi">2</span><span class="p">.</span><span class="mi">32</span><span class="p">,</span> <span class="mi">2</span><span class="p">.</span><span class="mi">75</span><span class="p">,</span> <span class="mi">2</span><span class="p">.</span><span class="mi">53</span>
<span class="n">USER</span>     <span class="n">TTY</span>      <span class="n">FROM</span>             <span class="n">LOGIN</span><span class="err">@</span>   <span class="n">IDLE</span>   <span class="n">JCPU</span>   <span class="n">PCPU</span> <span class="n">WHAT</span>



<span class="o">=====</span>
<span class="n">what</span> <span class="n">to</span> <span class="k">do</span>
<span class="o">=====</span>

<span class="n">Find</span> <span class="n">out</span> <span class="n">what</span> <span class="n">the</span> <span class="n">process</span> <span class="n">does</span> <span class="n">and</span> <span class="n">determine</span> <span class="k">if</span> <span class="n">its</span> <span class="n">impacting</span> <span class="n">the</span> <span class="n">usability</span> <span class="n">of</span> <span class="n">our</span> <span class="n">system</span><span class="p">.</span>

</pre></table></code></div></div><ol><li>different between <code class="language-plaintext highlighter-rouge">load average</code> and <code class="language-plaintext highlighter-rouge">CPU percentage</code></ol><p><code class="language-plaintext highlighter-rouge">load average</code>: the average length of the run queue for each of our CPUs on our system</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>
<span class="err">$</span> <span class="n">top</span>
<span class="n">top</span> <span class="o">-</span> <span class="mi">23</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mi">33</span> <span class="n">up</span> <span class="mi">22</span> <span class="n">min</span><span class="p">,</span>  <span class="mi">1</span> <span class="n">user</span><span class="p">,</span>  <span class="n">load</span> <span class="n">average</span><span class="o">:</span> <span class="mi">2</span><span class="p">.</span><span class="mi">17</span><span class="p">,</span> <span class="mi">1</span><span class="p">.</span><span class="mi">97</span><span class="p">,</span> <span class="mi">1</span><span class="p">.</span> <span class="mi">42</span>

<span class="cp"># one minute, five minute, and 15 minute CPU load averages on the first line
# for the last 15 minutes, there has been 1. 42 processes in the run queue
</span>
<span class="cp"># queues floating around between one and two is ok.
# things arent waiting long for access.
</span>
</pre></table></code></div></div><ol><li>stop the Tasks</ol><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>
<span class="c1">// 2nd tab</span>
<span class="c1">// to stop the task</span>
<span class="n">control</span><span class="o">+</span><span class="n">z</span>


<span class="c1">// one stop service</span>
<span class="err">$</span> <span class="n">top</span>
<span class="n">top</span> <span class="o">-</span> <span class="mi">23</span><span class="o">:</span><span class="mi">37</span><span class="o">:</span><span class="mo">03</span> <span class="n">up</span> <span class="mi">44</span> <span class="n">min</span><span class="p">,</span>  <span class="mi">1</span> <span class="n">user</span><span class="p">,</span>  <span class="n">load</span> <span class="n">average</span><span class="o">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">73</span><span class="p">,</span> <span class="mi">2</span><span class="p">.</span><span class="mi">09</span><span class="p">,</span> <span class="mi">1</span><span class="p">.</span><span class="mi">95</span>
<span class="n">Tasks</span><span class="o">:</span> <span class="mi">226</span> <span class="n">total</span><span class="p">,</span>   <span class="mi">5</span> <span class="n">running</span><span class="p">,</span> <span class="mi">220</span> <span class="n">sleeping</span><span class="p">,</span>   <span class="mi">1</span> <span class="n">stopped</span><span class="p">,</span>   <span class="mi">0</span> <span class="n">zombie</span>


<span class="c1">// 2nd tab</span>
<span class="c1">// bring task back</span>
<span class="err">$</span> <span class="n">fg</span>
<span class="n">cat</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">random</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span>

</pre></table></code></div></div><ol><li>operate the I/O to disk</ol><p>write data to a file and control where the data comes from and how the data is written out</p><p>write a lot of very small I/Os to disk. write one-byte I/OS to a file, our server will spend more time on I/O overhead than the actual disk transfer itself.</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre>
<span class="err">$</span> <span class="n">dd</span> <span class="k">if</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">zero</span> <span class="n">of</span><span class="o">=</span><span class="n">test1</span><span class="p">.</span><span class="n">img</span> <span class="n">bs</span><span class="o">=</span><span class="mi">1</span> <span class="n">count</span><span class="o">=</span><span class="mi">100000</span> <span class="n">oflag</span><span class="o">=</span><span class="n">sync</span>
<span class="c1">// input file /dev/zero, read a bunch of zeros out.</span>
<span class="c1">// write them into a file named test1.img</span>
<span class="c1">// block size: one byte</span>
<span class="c1">// do this 100, 000 times</span>
<span class="c1">// add this parameter called oflag=sync.</span>
<span class="n">each</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span> <span class="n">will</span> <span class="n">be</span> <span class="n">synchronous</span><span class="p">,</span> <span class="n">each</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span> <span class="n">transaction</span> <span class="n">will</span> <span class="n">need</span> <span class="n">to</span> <span class="n">be</span> <span class="n">completely</span> <span class="n">flushed</span> <span class="n">out</span> <span class="n">the</span> <span class="n">disk</span> <span class="n">and</span> <span class="n">an</span> <span class="n">acknowledgement</span> <span class="n">returned</span> <span class="n">to</span> <span class="n">the</span> <span class="n">operating</span> <span class="n">system</span> <span class="n">before</span> <span class="n">the</span> <span class="n">next</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span> <span class="n">can</span> <span class="n">occur</span><span class="p">.</span> <span class="n">have</span> <span class="n">to</span> <span class="n">wait</span> <span class="k">for</span> <span class="n">each</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span> <span class="n">to</span> <span class="n">occur</span><span class="p">.</span>


<span class="err">$</span> <span class="n">top</span>
<span class="c1">// cpu% wait time go up.</span>
<span class="n">top</span> <span class="o">-</span> <span class="mo">00</span><span class="o">:</span><span class="mo">04</span><span class="o">:</span><span class="mi">26</span> <span class="n">up</span>  <span class="mi">1</span><span class="o">:</span><span class="mi">11</span><span class="p">,</span>  <span class="mi">1</span> <span class="n">user</span><span class="p">,</span>  <span class="n">load</span> <span class="n">average</span><span class="o">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">29</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">59</span><span class="p">,</span> <span class="mi">1</span><span class="p">.</span><span class="mi">40</span>
<span class="n">Tasks</span><span class="o">:</span> <span class="mi">226</span> <span class="n">total</span><span class="p">,</span>   <span class="mi">4</span> <span class="n">running</span><span class="p">,</span> <span class="mi">222</span> <span class="n">sleeping</span><span class="p">,</span>   <span class="mi">0</span> <span class="n">stopped</span><span class="p">,</span>   <span class="mi">0</span> <span class="n">zombie</span>
<span class="o">%</span><span class="n">Cpu</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">:</span>  <span class="mi">5</span><span class="p">.</span><span class="mi">8</span> <span class="n">us</span><span class="p">,</span> <span class="mi">57</span><span class="p">.</span><span class="mi">1</span> <span class="n">sy</span><span class="p">,</span>  <span class="mi">8</span><span class="p">.</span><span class="mi">5</span> <span class="n">ni</span><span class="p">,</span>  <span class="mi">8</span><span class="p">.</span><span class="mi">5</span> <span class="n">id</span><span class="p">,</span>  <span class="mi">5</span><span class="p">.</span><span class="mi">4</span> <span class="n">wa</span><span class="p">,</span> <span class="mi">11</span><span class="p">.</span><span class="mi">6</span> <span class="n">hi</span><span class="p">,</span>  <span class="mi">3</span><span class="p">.</span><span class="mi">1</span> <span class="n">si</span><span class="p">,</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span> <span class="n">st</span>
<span class="n">MiB</span> <span class="n">Mem</span> <span class="o">:</span>   <span class="mi">2245</span><span class="p">.</span><span class="mi">6</span> <span class="n">total</span><span class="p">,</span>    <span class="mi">254</span><span class="p">.</span><span class="mi">2</span> <span class="n">free</span><span class="p">,</span>   <span class="mi">1124</span><span class="p">.</span><span class="mi">5</span> <span class="n">used</span><span class="p">,</span>    <span class="mi">866</span><span class="p">.</span><span class="mi">9</span> <span class="n">buff</span><span class="o">/</span><span class="n">cache</span>
<span class="n">MiB</span> <span class="n">Swap</span><span class="o">:</span>   <span class="mi">2048</span><span class="p">.</span><span class="mi">0</span> <span class="n">total</span><span class="p">,</span>   <span class="mi">2048</span><span class="p">.</span><span class="mi">0</span> <span class="n">free</span><span class="p">,</span>      <span class="mi">0</span><span class="p">.</span><span class="mi">0</span> <span class="n">used</span><span class="p">.</span>    <span class="mi">945</span><span class="p">.</span><span class="mi">5</span> <span class="n">avail</span> <span class="n">Mem</span>

  <span class="n">PID</span> <span class="n">USER</span>      <span class="n">PR</span>  <span class="n">NI</span>    <span class="n">VIRT</span>    <span class="n">RES</span>    <span class="n">SHR</span> <span class="n">S</span>  <span class="o">%</span><span class="n">CPU</span>  <span class="o">%</span><span class="n">MEM</span>     <span class="n">TIME</span><span class="o">+</span> <span class="n">COMMAND</span>
  <span class="mi">527</span> <span class="n">root</span>       <span class="mi">0</span> <span class="o">-</span><span class="mi">20</span>       <span class="mi">0</span>      <span class="mi">0</span>      <span class="mi">0</span> <span class="n">I</span>  <span class="mi">45</span><span class="p">.</span><span class="mi">8</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">0</span><span class="o">:</span><span class="mo">04</span><span class="p">.</span><span class="mi">88</span> <span class="n">kworker</span><span class="o">/</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="n">H</span><span class="o">-</span><span class="n">kbl</span><span class="o">+</span>
 <span class="mi">2859</span> <span class="n">server1</span>   <span class="mi">20</span>   <span class="mi">0</span> <span class="mi">2939476</span> <span class="mi">315080</span> <span class="mi">107312</span> <span class="n">R</span>   <span class="mi">5</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">13</span><span class="p">.</span><span class="mi">7</span>   <span class="mi">0</span><span class="o">:</span><span class="mi">24</span><span class="p">.</span><span class="mi">38</span> <span class="n">gnome</span><span class="o">-</span><span class="n">shell</span>
 <span class="mi">4589</span> <span class="n">server1</span>   <span class="mi">20</span>   <span class="mi">0</span>    <span class="mi">7324</span>    <span class="mi">808</span>    <span class="mi">744</span> <span class="n">R</span>   <span class="mi">4</span><span class="p">.</span><span class="mi">7</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">0</span><span class="o">:</span><span class="mo">00</span><span class="p">.</span><span class="mi">35</span> <span class="n">dd</span>
<span class="c1">// R: Running</span>
<span class="c1">// D: waiting</span>


<span class="n">high</span> <span class="n">CPU</span> <span class="n">situation</span><span class="p">,</span> <span class="n">high</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span> <span class="n">waits</span><span class="p">,</span>
<span class="n">troubleshooting</span> <span class="n">rather</span> <span class="n">than</span> <span class="n">is</span> <span class="n">it</span> <span class="n">just</span> <span class="n">a</span> <span class="n">raw</span> <span class="n">CPU</span> <span class="n">issue</span><span class="p">.</span>
<span class="n">It</span> <span class="n">could</span> <span class="n">be</span> <span class="n">disks</span> <span class="n">are</span> <span class="n">underperforming</span> <span class="n">or</span> <span class="n">saturated</span><span class="p">.</span>
<span class="n">It</span> <span class="n">could</span> <span class="n">also</span> <span class="n">be</span> <span class="n">networking</span><span class="p">,</span> <span class="n">anything</span> <span class="n">thats</span> <span class="n">classified</span> <span class="n">as</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span> <span class="n">in</span> <span class="n">your</span> <span class="n">system</span><span class="p">.</span>

</pre></table></code></div></div><hr /><h2 id="memory">Memory</h2><p>server0:</p><ol><li>investigating system memory.</ol><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre><td class="rouge-code"><pre>
<span class="err">$</span> <span class="n">cat</span> <span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="n">meminfo</span>
<span class="err">$</span> <span class="n">cat</span> <span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="n">meminfo</span> <span class="o">|</span> <span class="n">sort</span>
<span class="n">MemTotal</span><span class="o">:</span>        <span class="mi">2299536</span> <span class="n">kB</span>
<span class="n">MemFree</span><span class="o">:</span>          <span class="mi">563356</span> <span class="n">kB</span>
<span class="n">MemAvailable</span><span class="o">:</span>     <span class="mi">997356</span> <span class="n">kB</span>
<span class="n">Buffers</span><span class="o">:</span>            <span class="mi">1104</span> <span class="n">kB</span>
<span class="n">Cached</span><span class="o">:</span>           <span class="mi">554136</span> <span class="n">kB</span>


<span class="err">$</span> <span class="n">free</span>
<span class="err">$</span> <span class="n">free</span> <span class="o">-</span><span class="n">m</span>
<span class="c1">// output in megabytes</span>
              <span class="n">total</span>        <span class="n">used</span>        <span class="n">free</span>      <span class="n">shared</span>  <span class="n">buff</span><span class="o">/</span><span class="n">cache</span>   <span class="n">available</span>
<span class="n">Mem</span><span class="o">:</span>           <span class="mi">2245</span>        <span class="mi">1090</span>         <span class="mi">567</span>          <span class="mi">11</span>         <span class="mi">587</span>         <span class="mi">991</span>
<span class="n">Swap</span><span class="o">:</span>          <span class="mi">2047</span>          <span class="mi">25</span>        <span class="mi">2022</span>
<span class="c1">/// buff/cache 205</span>
<span class="n">file</span> <span class="n">system</span> <span class="n">cache</span>
<span class="n">helps</span> <span class="n">more</span> <span class="n">efficient</span> <span class="n">read</span><span class="o">-</span><span class="n">write</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span> <span class="n">to</span> <span class="n">our</span> <span class="n">drives</span> <span class="n">cause</span> <span class="n">the</span> <span class="n">drives</span> <span class="n">are</span> <span class="n">the</span> <span class="n">slowest</span> <span class="n">things</span> <span class="n">in</span> <span class="n">system</span>
<span class="n">so</span> <span class="n">file</span> <span class="n">system</span> <span class="n">cache</span> <span class="n">can</span> <span class="n">help</span> <span class="n">interact</span> <span class="n">with</span> <span class="n">drive</span> <span class="n">better</span><span class="p">.</span>



<span class="err">$</span> <span class="n">dd</span> <span class="k">if</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">zero</span> <span class="n">of</span><span class="o">=</span><span class="n">test1</span><span class="p">.</span><span class="n">img</span> <span class="n">bs</span><span class="o">=</span><span class="mi">1</span> <span class="n">count</span><span class="o">=</span><span class="mi">100000</span> <span class="n">oflag</span><span class="o">=</span><span class="n">sync</span>
<span class="mi">100000</span><span class="o">+</span><span class="mi">0</span> <span class="n">records</span> <span class="n">in</span>
<span class="mi">100000</span><span class="o">+</span><span class="mi">0</span> <span class="n">records</span> <span class="n">out</span>
<span class="mi">100000</span> <span class="n">bytes</span> <span class="p">(</span><span class="mi">100</span> <span class="n">kB</span><span class="p">,</span> <span class="mi">98</span> <span class="n">KiB</span><span class="p">)</span> <span class="n">copied</span><span class="p">,</span> <span class="mi">86</span><span class="p">.</span><span class="mi">5205</span> <span class="n">s</span><span class="p">,</span> <span class="mi">1</span><span class="p">.</span><span class="mi">2</span> <span class="n">kB</span><span class="o">/</span><span class="n">s</span>

<span class="n">with</span> <span class="n">oflag</span><span class="o">=</span><span class="n">sync</span>
<span class="n">want</span> <span class="n">it</span> <span class="n">to</span> <span class="n">side</span> <span class="n">step</span> <span class="n">the</span> <span class="n">file</span> <span class="n">system</span> <span class="n">cache</span> <span class="n">and</span> <span class="n">perform</span> <span class="n">the</span> <span class="n">entire</span> <span class="n">disk</span> <span class="n">transaction</span>
<span class="n">throughput</span> <span class="n">was</span> <span class="mi">1</span><span class="p">.</span> <span class="mi">3</span> <span class="n">kilobytes</span> <span class="n">a</span> <span class="n">second</span><span class="p">.</span>

<span class="n">So</span> <span class="n">performing</span> <span class="n">one</span> <span class="n">byte</span> <span class="n">I</span><span class="o">/</span><span class="n">OS</span> <span class="n">synchronously</span> <span class="n">obviously</span> <span class="n">is</span> <span class="n">not</span> <span class="n">a</span> <span class="n">good</span> <span class="n">disk</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span> <span class="n">pattern</span> <span class="n">to</span> <span class="n">leverage</span> <span class="n">the</span> <span class="n">capacity</span> <span class="n">of</span> <span class="n">this</span> <span class="n">drive</span><span class="p">,</span> <span class="n">performance</span> <span class="n">is</span> <span class="n">simply</span> <span class="n">terrible</span><span class="p">.</span>


<span class="err">$</span> <span class="n">dd</span> <span class="k">if</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">zero</span> <span class="n">of</span><span class="o">=</span><span class="n">test1</span><span class="p">.</span><span class="n">img</span> <span class="n">bs</span><span class="o">=</span><span class="mi">1</span> <span class="n">count</span><span class="o">=</span><span class="mi">100000</span>
<span class="mi">100000</span><span class="o">+</span><span class="mi">0</span> <span class="n">records</span> <span class="n">in</span>
<span class="mi">100000</span><span class="o">+</span><span class="mi">0</span> <span class="n">records</span> <span class="n">out</span>
<span class="mi">100000</span> <span class="n">bytes</span> <span class="p">(</span><span class="mi">100</span> <span class="n">kB</span><span class="p">,</span> <span class="mi">98</span> <span class="n">KiB</span><span class="p">)</span> <span class="n">copied</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">218376</span> <span class="n">s</span><span class="p">,</span> <span class="mi">458</span> <span class="n">kB</span><span class="o">/</span><span class="n">s</span>

<span class="n">remove</span> <span class="n">this</span> <span class="n">flag</span><span class="p">,</span> <span class="n">leverage</span> <span class="n">the</span> <span class="n">file</span> <span class="n">system</span> <span class="n">cache</span>
<span class="n">oflag</span><span class="o">=</span><span class="n">sync</span> <span class="n">disables</span> <span class="n">ability</span> <span class="n">to</span> <span class="n">use</span> <span class="n">the</span> <span class="n">file</span> <span class="n">system</span> <span class="n">cache</span><span class="p">,</span> <span class="n">waiting</span> <span class="k">for</span> <span class="n">that</span> <span class="n">entire</span> <span class="n">disk</span> <span class="n">transaction</span><span class="p">.</span>

<span class="n">about</span> <span class="n">a</span> <span class="mi">700</span> <span class="n">times</span> <span class="n">improvement</span> <span class="n">using</span> <span class="n">the</span> <span class="n">file</span> <span class="n">system</span> <span class="n">cache</span>
<span class="n">cause</span> <span class="n">all</span> <span class="n">that</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span> <span class="n">is</span> <span class="n">going</span> <span class="n">to</span> <span class="n">get</span> <span class="n">absorbed</span> <span class="n">into</span> <span class="n">the</span> <span class="n">file</span> <span class="n">system</span> <span class="n">cache</span> <span class="n">into</span> <span class="n">write</span> <span class="n">buffers</span> <span class="n">and</span> <span class="n">then</span> <span class="n">destaged</span> <span class="n">to</span> <span class="n">disk</span> <span class="n">in</span> <span class="n">the</span> <span class="n">background</span><span class="p">.</span>

</pre></table></code></div></div><ol><li>isolate a memory hog on system</ol><p>find out who and more specifically which process is burning up all the memory on our system.</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
</pre><td class="rouge-code"><pre>
<span class="mi">1</span><span class="p">.</span> <span class="n">create</span> <span class="n">a</span> <span class="n">c</span> <span class="n">program</span><span class="p">.</span>

<span class="err">$</span> <span class="n">mkdir</span> <span class="n">demos</span><span class="o">/</span>
<span class="err">$</span> <span class="n">mkdir</span> <span class="n">demos</span><span class="o">/</span><span class="n">m3</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">vi</span> <span class="n">memtest</span><span class="p">.</span><span class="n">c</span>
<span class="c1">// create file.</span>
<span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
        <span class="kt">int</span> <span class="n">size</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">sizeofint</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">elements</span><span class="p">;</span>
        <span class="kt">int</span> <span class="o">*</span><span class="n">mem</span><span class="o">*</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">allocationsize</span><span class="p">;</span>

        <span class="n">allocationsize</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
        <span class="c1">// not safe, just for demonstration</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Memory allocation size: %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">allocationsize</span><span class="p">);</span>

        <span class="n">sizeofint</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">);</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">allocationsize</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">;</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">size</span> <span class="o">/</span> <span class="n">sizeofint</span><span class="p">;</span>

        <span class="n">printf</span><span class="p">(</span><span class="s">"Waiting 5 seconds...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>

        <span class="n">mem</span> <span class="o">=</span> <span class="n">calloc</span><span class="p">(</span> <span class="n">elements</span><span class="p">,</span> <span class="n">sizeofint</span><span class="p">);</span>

        <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">elements</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="n">mem</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span> <span class="n">i</span><span class="p">;</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">"elements: %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">mem</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>

        <span class="p">}</span>

        <span class="n">free</span><span class="p">(</span><span class="n">mem</span><span class="p">);</span>
<span class="p">}</span>


<span class="err">$</span> <span class="n">gcc</span> <span class="o">-</span><span class="n">o</span> <span class="n">memtest</span> <span class="n">memtest</span><span class="p">.</span><span class="n">c</span>

<span class="o">==================================================================</span>
<span class="err">$</span> <span class="n">free</span> <span class="o">-</span><span class="n">m</span>
<span class="c1">// output in megabytes</span>
              <span class="n">total</span>        <span class="n">used</span>        <span class="n">free</span>      <span class="n">shared</span>  <span class="n">buff</span><span class="o">/</span><span class="n">cache</span>   <span class="n">available</span>
<span class="n">Mem</span><span class="o">:</span>           <span class="mi">2245</span>        <span class="mi">1090</span>         <span class="mi">567</span>          <span class="mi">11</span>         <span class="mi">587</span>         <span class="mi">991</span>
<span class="n">Swap</span><span class="o">:</span>          <span class="mi">2047</span>          <span class="mi">25</span>        <span class="mi">2022</span>

<span class="o">==================================================================</span>

<span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">memtest</span> <span class="mi">256</span>
<span class="c1">//ask for 256 megabytes of memory.</span>


<span class="c1">// the free mem decease.</span>
<span class="err">$</span> <span class="n">free</span> <span class="o">-</span><span class="n">m</span>
              <span class="n">total</span>        <span class="n">used</span>        <span class="n">free</span>      <span class="n">shared</span>  <span class="n">buff</span><span class="o">/</span><span class="n">cache</span>   <span class="n">available</span>
<span class="n">Mem</span><span class="o">:</span>           <span class="mi">2245</span>        <span class="mi">1077</span>         <span class="mi">511</span>          <span class="mi">11</span>         <span class="mi">656</span>        <span class="mi">1003</span>
<span class="n">Swap</span><span class="o">:</span>          <span class="mi">2047</span>          <span class="mi">25</span>        <span class="mi">2022</span>

<span class="o">==================================================================</span>

<span class="n">startup</span> <span class="n">new</span> <span class="n">terminal</span> <span class="n">to</span> <span class="n">monitor</span>

<span class="err">$</span> <span class="n">top</span>
<span class="c1">// f, chose %mem, s, q</span>
<span class="c1">// sorted by memory utlization</span>
<span class="n">Tasks</span><span class="o">:</span> <span class="mi">228</span> <span class="n">total</span><span class="p">,</span>   <span class="mi">4</span> <span class="n">running</span><span class="p">,</span> <span class="mi">224</span> <span class="n">sleeping</span><span class="p">,</span>   <span class="mi">0</span> <span class="n">stopped</span><span class="p">,</span>   <span class="mi">0</span> <span class="n">zombie</span>
<span class="o">%</span><span class="n">Cpu</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">:</span> <span class="mi">72</span><span class="p">.</span><span class="mi">6</span> <span class="n">us</span><span class="p">,</span> <span class="mi">24</span><span class="p">.</span><span class="mi">1</span> <span class="n">sy</span><span class="p">,</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span> <span class="n">ni</span><span class="p">,</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span> <span class="n">id</span><span class="p">,</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span> <span class="n">wa</span><span class="p">,</span>  <span class="mi">3</span><span class="p">.</span><span class="mi">3</span> <span class="n">hi</span><span class="p">,</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span> <span class="n">si</span><span class="p">,</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span> <span class="n">st</span>
<span class="n">MiB</span> <span class="n">Mem</span> <span class="o">:</span>   <span class="mi">2245</span><span class="p">.</span><span class="mi">6</span> <span class="n">total</span><span class="p">,</span>    <span class="mi">493</span><span class="p">.</span><span class="mi">4</span> <span class="n">free</span><span class="p">,</span>   <span class="mi">1095</span><span class="p">.</span><span class="mi">8</span> <span class="n">used</span><span class="p">,</span>    <span class="mi">656</span><span class="p">.</span><span class="mi">4</span> <span class="n">buff</span><span class="o">/</span><span class="n">cache</span>
<span class="n">MiB</span> <span class="n">Swap</span><span class="o">:</span>   <span class="mi">2048</span><span class="p">.</span><span class="mi">0</span> <span class="n">total</span><span class="p">,</span>   <span class="mi">2022</span><span class="p">.</span><span class="mi">8</span> <span class="n">free</span><span class="p">,</span>     <span class="mi">25</span><span class="p">.</span><span class="mi">2</span> <span class="n">used</span><span class="p">.</span>    <span class="mi">985</span><span class="p">.</span><span class="mi">4</span> <span class="n">avail</span> <span class="n">Mem</span>

  <span class="n">PID</span> <span class="n">USER</span>      <span class="n">PR</span>  <span class="n">NI</span>    <span class="n">VIRT</span>    <span class="n">RES</span>    <span class="n">SHR</span> <span class="n">S</span>  <span class="o">%</span><span class="n">CPU</span>  <span class="o">%</span><span class="n">MEM</span>     <span class="n">TIME</span><span class="o">+</span> <span class="n">COMMAND</span>
 <span class="mi">7315</span> <span class="n">server1</span>   <span class="mi">20</span>   <span class="mi">0</span> <span class="mi">2891100</span> <span class="mi">253188</span> <span class="mi">106864</span> <span class="n">S</span>  <span class="mi">19</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">11</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">0</span><span class="o">:</span><span class="mi">55</span><span class="p">.</span><span class="mi">27</span> <span class="n">gnome</span><span class="o">-</span><span class="n">shell</span>
 <span class="mi">2471</span> <span class="n">gdm</span>       <span class="mi">20</span>   <span class="mi">0</span> <span class="mi">2586840</span> <span class="mi">211888</span>  <span class="mi">98444</span> <span class="n">S</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">9</span><span class="p">.</span><span class="mi">2</span>   <span class="mi">0</span><span class="o">:</span><span class="mi">10</span><span class="p">.</span><span class="mi">28</span> <span class="n">gnome</span><span class="o">-</span><span class="n">shell</span>
 <span class="mi">7680</span> <span class="n">server1</span>   <span class="mi">20</span>   <span class="mi">0</span> <span class="mi">1052452</span>  <span class="mi">78444</span>  <span class="mi">38560</span> <span class="n">S</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">4</span>   <span class="mi">0</span><span class="o">:</span><span class="mo">00</span><span class="p">.</span><span class="mi">97</span> <span class="n">gnome</span><span class="o">-</span><span class="n">software</span>
 <span class="mi">8884</span> <span class="n">server1</span>   <span class="mi">20</span>   <span class="mi">0</span>  <span class="mi">266476</span>  <span class="mi">69336</span>   <span class="mi">1344</span> <span class="n">R</span>  <span class="mi">30</span><span class="p">.</span><span class="mi">5</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">0</span><span class="o">:</span><span class="mi">22</span><span class="p">.</span><span class="mi">64</span> <span class="n">memtest</span>

<span class="c1">// memtest goes up</span>
<span class="n">VIRT</span><span class="o">:</span> <span class="n">memory</span> <span class="n">allocated</span> <span class="n">in</span> <span class="n">the</span> <span class="k">virtual</span> <span class="n">address</span> <span class="n">space</span> <span class="n">of</span> <span class="n">mentest</span>
<span class="n">RES</span><span class="o">:</span> <span class="n">memory</span> <span class="k">for</span> <span class="n">this</span> <span class="n">process</span> <span class="n">thats</span> <span class="n">resident</span> <span class="n">in</span> <span class="n">physical</span> <span class="n">memory</span><span class="p">.</span>

<span class="n">So</span> <span class="n">this</span> <span class="n">process</span> <span class="n">is</span> <span class="n">running</span> <span class="n">great</span><span class="p">.</span>
<span class="n">Its</span> <span class="n">performing</span> <span class="n">well</span><span class="p">,</span> <span class="n">its</span> <span class="n">not</span> <span class="n">paging</span> <span class="n">and</span> <span class="n">not</span> <span class="n">impacting</span> <span class="n">our</span> <span class="n">system</span> <span class="n">negatively</span>
<span class="n">but</span> <span class="n">dont</span> <span class="n">have</span> <span class="n">a</span> <span class="n">lot</span> <span class="n">of</span> <span class="n">room</span> <span class="n">left</span> <span class="n">to</span> <span class="n">breathe</span>
<span class="o">-</span> <span class="n">about</span> <span class="mi">2022</span><span class="p">.</span><span class="mi">8</span> <span class="n">free</span> <span class="n">left</span> <span class="n">from</span> <span class="n">a</span> <span class="n">memory</span> <span class="n">standpoint</span><span class="p">.</span>

<span class="o">==================================================================</span>

<span class="n">how</span> <span class="n">much</span> <span class="n">disk</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span> <span class="n">are</span> <span class="n">generating</span>
<span class="n">take</span> <span class="n">a</span> <span class="n">sample</span> <span class="n">every</span> <span class="n">second</span><span class="p">,</span> <span class="mi">100</span> <span class="n">times</span><span class="p">.</span>

<span class="err">$</span> <span class="n">vmstat</span> <span class="mi">1</span> <span class="mi">100</span>
<span class="n">procs</span> <span class="o">-----------</span><span class="n">memory</span><span class="o">----------</span> <span class="o">---</span><span class="n">swap</span><span class="o">--</span> <span class="o">-----</span><span class="n">io</span><span class="o">----</span> <span class="o">-</span><span class="n">system</span><span class="o">--</span> <span class="o">------</span><span class="n">cpu</span><span class="o">-----</span>
<span class="c1">// SI, SO: how many memory pages are being read/swapped in or written/swapped out.</span>
<span class="c1">// BI, block in, so how many blocks we're reading in at each interval</span>
<span class="c1">// BO, is how many blocks are being written out.</span>
 <span class="n">r</span>  <span class="n">b</span>   <span class="n">swpd</span>   <span class="n">free</span>   <span class="n">buff</span>  <span class="n">cache</span>   <span class="n">si</span>   <span class="n">so</span>    <span class="n">bi</span>    <span class="n">bo</span>   <span class="n">in</span>   <span class="n">cs</span> <span class="n">us</span> <span class="n">sy</span> <span class="n">id</span> <span class="n">wa</span> <span class="n">st</span>
 <span class="mi">2</span>  <span class="mi">0</span>  <span class="mi">25776</span> <span class="mi">569580</span>   <span class="mi">1120</span> <span class="mi">671264</span>    <span class="mi">1</span>    <span class="mi">2</span>    <span class="mi">60</span>    <span class="mi">81</span>  <span class="mi">205</span> <span class="mi">1114</span>  <span class="mi">4</span>  <span class="mi">3</span> <span class="mi">93</span>  <span class="mi">0</span>  <span class="mi">0</span>
 <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">25776</span> <span class="mi">569400</span>   <span class="mi">1120</span> <span class="mi">671308</span>    <span class="mi">0</span>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>  <span class="mi">381</span>  <span class="mi">614</span>  <span class="mi">9</span>  <span class="mi">5</span> <span class="mi">86</span>  <span class="mi">0</span>  <span class="mi">0</span>
 <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">25776</span> <span class="mi">569400</span>   <span class="mi">1120</span> <span class="mi">671308</span>    <span class="mi">0</span>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>  <span class="mi">396</span>  <span class="mi">737</span>  <span class="mi">6</span>  <span class="mi">3</span> <span class="mi">91</span>  <span class="mi">0</span>  <span class="mi">0</span>
 <span class="mi">3</span>  <span class="mi">0</span>  <span class="mi">25776</span> <span class="mi">569400</span>   <span class="mi">1120</span> <span class="mi">671308</span>    <span class="mi">0</span>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>  <span class="mi">437</span>  <span class="mi">678</span> <span class="mi">12</span>  <span class="mi">3</span> <span class="mi">85</span>  <span class="mi">0</span>  <span class="mi">0</span>
 <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">25776</span> <span class="mi">569400</span>   <span class="mi">1120</span> <span class="mi">671308</span>    <span class="mi">0</span>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>  <span class="mi">438</span>  <span class="mi">753</span> <span class="mi">10</span>  <span class="mi">4</span> <span class="mi">86</span>  <span class="mi">0</span>  <span class="mi">0</span>
 <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">25776</span> <span class="mi">569400</span>   <span class="mi">1120</span> <span class="mi">671308</span>    <span class="mi">0</span>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>  <span class="mi">245</span>  <span class="mi">410</span>  <span class="mi">4</span>  <span class="mi">2</span> <span class="mi">94</span>  <span class="mi">0</span>  <span class="mi">0</span>

<span class="o">==================================================================</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">dsate</span>
<span class="err">$</span> <span class="n">dstat</span>
<span class="n">You</span> <span class="n">did</span> <span class="n">not</span> <span class="n">select</span> <span class="n">any</span> <span class="n">stats</span><span class="p">,</span> <span class="n">using</span> <span class="o">-</span><span class="n">cdngy</span> <span class="n">by</span> <span class="k">default</span><span class="p">.</span>
<span class="o">----</span><span class="n">total</span><span class="o">-</span><span class="n">usage</span><span class="o">----</span> <span class="o">-</span><span class="n">dsk</span><span class="o">/</span><span class="n">total</span><span class="o">-</span> <span class="o">-</span><span class="n">net</span><span class="o">/</span><span class="n">total</span><span class="o">-</span> <span class="o">---</span><span class="n">paging</span><span class="o">--</span> <span class="o">---</span><span class="n">system</span><span class="o">--</span>
<span class="n">usr</span> <span class="n">sys</span> <span class="n">idl</span> <span class="n">wai</span> <span class="n">stl</span><span class="o">|</span> <span class="n">read</span>  <span class="n">writ</span><span class="o">|</span> <span class="n">recv</span>  <span class="n">send</span><span class="o">|</span>  <span class="n">in</span>   <span class="n">out</span> <span class="o">|</span> <span class="kt">int</span>   <span class="n">csw</span>
 <span class="mi">16</span>   <span class="mi">3</span>  <span class="mi">77</span>   <span class="mi">0</span>   <span class="mi">0</span><span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span> <span class="mi">484</span>   <span class="mi">456</span>
 <span class="mi">16</span>   <span class="mi">5</span>  <span class="mi">76</span>   <span class="mi">0</span>   <span class="mi">0</span><span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span> <span class="mi">512</span>   <span class="mi">807</span>
 <span class="mi">14</span>   <span class="mi">3</span>  <span class="mi">83</span>   <span class="mi">0</span>   <span class="mi">0</span><span class="o">|</span>   <span class="mi">0</span>   <span class="mi">364</span><span class="n">k</span><span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span> <span class="mi">411</span>   <span class="mi">556</span>
  <span class="mi">6</span>   <span class="mi">1</span>  <span class="mi">91</span>   <span class="mi">0</span>   <span class="mi">0</span><span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span> <span class="mi">251</span>   <span class="mi">461</span>


<span class="n">after</span> <span class="n">rum</span> <span class="n">the</span> <span class="n">memtest</span>

<span class="err">$</span> <span class="n">dstat</span>
<span class="o">----</span><span class="n">total</span><span class="o">-</span><span class="n">usage</span><span class="o">----</span> <span class="o">-</span><span class="n">dsk</span><span class="o">/</span><span class="n">total</span><span class="o">-</span> <span class="o">-</span><span class="n">net</span><span class="o">/</span><span class="n">total</span><span class="o">-</span> <span class="o">---</span><span class="n">paging</span><span class="o">--</span> <span class="o">---</span><span class="n">system</span><span class="o">--</span>
<span class="n">usr</span> <span class="n">sys</span> <span class="n">idl</span> <span class="n">wai</span> <span class="n">stl</span><span class="o">|</span> <span class="n">read</span>  <span class="n">writ</span><span class="o">|</span> <span class="n">recv</span>  <span class="n">send</span><span class="o">|</span>  <span class="n">in</span>   <span class="n">out</span> <span class="o">|</span> <span class="kt">int</span>   <span class="n">csw</span>
 <span class="mi">49</span>  <span class="mi">17</span>   <span class="mi">1</span>   <span class="mi">0</span>   <span class="mi">0</span><span class="o">|</span>   <span class="mi">0</span>    <span class="mi">76</span><span class="n">k</span><span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span><span class="mi">1090</span>  <span class="mi">3701</span>
 <span class="mi">55</span>  <span class="mi">14</span>   <span class="mi">0</span>   <span class="mi">0</span>   <span class="mi">0</span><span class="o">|</span>   <span class="mi">0</span>    <span class="mi">96</span><span class="n">k</span><span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span><span class="mi">1119</span>  <span class="mi">3663</span>
 <span class="mi">55</span>  <span class="mi">16</span>   <span class="mi">0</span>   <span class="mi">0</span>   <span class="mi">0</span><span class="o">|</span>   <span class="mi">0</span>    <span class="mi">86</span><span class="n">k</span><span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span><span class="mi">1169</span>  <span class="mi">3716</span>
 <span class="mi">55</span>  <span class="mi">16</span>   <span class="mi">0</span>   <span class="mi">0</span>   <span class="mi">0</span><span class="o">|</span>   <span class="mi">0</span>    <span class="mi">84</span><span class="n">k</span><span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span><span class="mi">1140</span>  <span class="mi">3680</span>
 <span class="mi">54</span>  <span class="mi">16</span>   <span class="mi">0</span>   <span class="mi">0</span>   <span class="mi">0</span><span class="o">|</span>   <span class="mi">0</span>    <span class="mi">84</span><span class="n">k</span><span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span><span class="mi">1124</span>  <span class="mi">3691</span>
 <span class="mi">68</span>  <span class="mi">17</span>   <span class="mi">0</span>   <span class="mi">0</span>   <span class="mi">0</span><span class="o">|</span>   <span class="mi">0</span>    <span class="mi">67</span><span class="n">k</span><span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span><span class="mi">1294</span>  <span class="mi">2835</span>
 <span class="mi">65</span>  <span class="mi">19</span>   <span class="mi">0</span>   <span class="mi">0</span>   <span class="mi">0</span><span class="o">|</span>   <span class="mi">0</span>    <span class="mi">49</span><span class="n">k</span><span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span><span class="mi">1208</span>  <span class="mi">2892</span>
 <span class="mi">66</span>  <span class="mi">18</span>   <span class="mi">0</span>   <span class="mi">0</span>   <span class="mi">0</span><span class="o">|</span>   <span class="mi">0</span>   <span class="mi">175</span><span class="n">k</span><span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span><span class="mi">1438</span>  <span class="mi">3295</span>
</pre></table></code></div></div><hr /><h2 id="find-high-io-processes-measure-disk-latency">find high I/O processes, measure disk latency.</h2><p>server0:</p><p><strong>to isolate which process is driving the most I/O on system</strong></p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">iotop</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">iotop</span>
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://i.imgur.com/9PJt9QF.png" alt="Screen Shot 2020-04-22 at 21.17.34" /></p><p>generate some load</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c1">// block size=1</span>
<span class="err">$</span> <span class="n">dd</span> <span class="k">if</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">zero</span> <span class="n">of</span><span class="o">=</span><span class="n">test1</span><span class="p">.</span><span class="n">img</span> <span class="n">bs</span><span class="o">=</span><span class="mi">1</span> <span class="n">oflag</span><span class="o">=</span><span class="n">sync</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">iotop</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">total</code>: I/O amongst all processes, includes things like things that might be in cache or on the file system cache <code class="language-plaintext highlighter-rouge">actual</code>: actual block device I/OS.</p><ul><li>maybe some cache hits coming out of total, but actual is the stuff that’s actually hitting block device itself.</ul><p>process ID, user, disk read, disk write, swap in, I/O waits, command</p><p><img data-proofer-ignore data-src="https://i.imgur.com/fBD62bE.png" alt="Screen Shot 2020-04-22 at 21.20.16" /></p><p><strong>measure disk I/O latency</strong></p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c1">// check the size</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">blockdev</span> <span class="o">--</span><span class="n">getbsz</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda2</span>
<span class="p">[</span><span class="n">sudo</span><span class="p">]</span> <span class="n">password</span> <span class="k">for</span> <span class="n">server1</span><span class="o">:</span>
<span class="mi">4096</span>

<span class="c1">// block size=4096</span>
<span class="err">$</span> <span class="n">dd</span> <span class="k">if</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">zero</span> <span class="n">of</span><span class="o">=</span><span class="n">test1</span><span class="p">.</span><span class="n">img</span> <span class="n">bs</span><span class="o">=</span><span class="mi">4096</span> <span class="n">count</span><span class="o">=</span><span class="mi">10000</span> <span class="n">oflag</span><span class="o">=</span><span class="n">sync</span>
<span class="mi">10000</span><span class="o">+</span><span class="mi">0</span> <span class="n">records</span> <span class="n">in</span>
<span class="mi">10000</span><span class="o">+</span><span class="mi">0</span> <span class="n">records</span> <span class="n">out</span>
<span class="mi">40960000</span> <span class="n">bytes</span> <span class="p">(</span><span class="mi">41</span> <span class="n">MB</span><span class="p">,</span> <span class="mi">39</span> <span class="n">MiB</span><span class="p">)</span> <span class="n">copied</span><span class="p">,</span> <span class="mi">6</span><span class="p">.</span><span class="mi">4623</span> <span class="n">s</span><span class="p">,</span> <span class="mi">6</span><span class="p">.</span><span class="mi">3</span> <span class="n">MB</span><span class="o">/</span><span class="n">s</span>


<span class="err">$</span> <span class="n">dd</span> <span class="k">if</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">zero</span> <span class="n">of</span><span class="o">=</span><span class="n">test1</span><span class="p">.</span><span class="n">img</span> <span class="n">bs</span><span class="o">=</span><span class="mi">1</span><span class="n">M</span> <span class="n">count</span><span class="o">=</span><span class="mi">10000</span> <span class="n">oflag</span><span class="o">=</span><span class="n">sync</span>
<span class="mi">10000</span><span class="o">+</span><span class="mi">0</span> <span class="n">records</span> <span class="n">in</span>
<span class="mi">10000</span><span class="o">+</span><span class="mi">0</span> <span class="n">records</span> <span class="n">out</span>
<span class="mi">10485760000</span> <span class="n">bytes</span> <span class="p">(</span><span class="mi">10</span> <span class="n">GB</span><span class="p">,</span> <span class="mi">9</span><span class="p">.</span><span class="mi">8</span> <span class="n">GiB</span><span class="p">)</span> <span class="n">copied</span><span class="p">,</span> <span class="mi">49</span><span class="p">.</span><span class="mi">6129</span> <span class="n">s</span><span class="p">,</span> <span class="mi">211</span> <span class="n">MB</span><span class="o">/</span><span class="n">s</span>

</pre></table></code></div></div><p>smaller I/OS are going to have a lower latency larger I/OS are going to have a higher latency,but also going to be able to consume more of the bandwidth out to the block device.</p><p>when test for latency, use a smaller I/O, block size</p><p>when test for bandwidth, use a larger I/O to task that disk subsystem</p><p>I/O size is really going to be application dependent and so here doing synthetic testing.</p><p>But when testing disk subsystems, we do want to test for varying I/O sizes, specifically the ones that our applications use, that depends on the application itself.</p><hr /><h2 id="look-at-interface-buffers-and-socket-queues-find-network-hogs">look at interface buffers and socket queues, find network hogs</h2><p>server0:</p><p><strong>check network traffic</strong></p><ul><li>isolate which network interface with <code class="language-plaintext highlighter-rouge">IPTraf</code><li>figure out who the communicators were, the senders and the receivers, which protocols were involved<li>to determine who was burning a lot of bandwidth on system.</ul><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>
<span class="mi">1</span><span class="p">.</span> <span class="n">install</span> <span class="n">the</span> <span class="n">Tools</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">iptraf</span><span class="o">-</span><span class="n">ng</span>


<span class="mi">2</span><span class="p">.</span> <span class="n">copy</span> <span class="n">file</span> <span class="n">to</span> <span class="n">server1</span><span class="p">.</span>
<span class="n">generate</span> <span class="n">a</span> <span class="n">excessive</span> <span class="n">load</span> <span class="n">on</span> <span class="n">network</span><span class="p">.</span>

<span class="err">$</span> <span class="n">scp</span> <span class="n">test1</span><span class="p">.</span><span class="n">img</span> <span class="n">root</span><span class="err">@</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="o">:/</span><span class="n">root</span>


<span class="mi">3</span><span class="p">.</span> <span class="n">monitor</span> <span class="n">the</span> <span class="n">network</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">iptraf</span><span class="o">-</span><span class="n">ng</span>
</pre></table></code></div></div><p>ip traffic monitor <img data-proofer-ignore data-src="https://i.imgur.com/yzQj5LD.png" alt="Screen Shot 2020-04-23 at 20.41.26" /></p><p>general interface statistics <img data-proofer-ignore data-src="https://i.imgur.com/W5pWk36.png" alt="Screen Shot 2020-04-23 at 20.42.09" /></p><p>detailed interface statistics <img data-proofer-ignore data-src="https://i.imgur.com/6eTpGaw.png" alt="Screen Shot 2020-04-23 at 20.42.42" /></p><p>statistical breakdown <img data-proofer-ignore data-src="https://i.imgur.com/RFmWJzy.png" alt="Screen Shot 2020-04-23 at 20.43.16" /></p><p>LAM station monitor <img data-proofer-ignore data-src="https://i.imgur.com/ejcxaio.png" alt="Screen Shot 2020-04-23 at 20.43.44" /></p><p><strong>check socket queues</strong></p><ul><li>see if there was kernel-level blocking or anything going on slowing down data flows</ul><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre>
<span class="n">seen</span> <span class="n">queuing</span> <span class="k">for</span> <span class="n">a</span> <span class="n">very</span> <span class="n">small</span> <span class="n">period</span> <span class="n">of</span> <span class="n">time</span><span class="p">,</span> <span class="n">not</span> <span class="n">a</span> <span class="n">big</span> <span class="n">deal</span><span class="p">.</span>
<span class="n">queue</span> <span class="n">works</span> <span class="n">down</span> <span class="n">quickly</span> <span class="n">and</span> <span class="n">goes</span> <span class="n">away</span><span class="p">,</span> <span class="n">be</span> <span class="n">in</span> <span class="n">good</span> <span class="n">shape</span>

<span class="err">$</span> <span class="n">ss</span> <span class="o">-</span><span class="n">t4</span>
<span class="n">State</span>  <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>   <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>      <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>         <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">ESTAB</span>  <span class="mi">0</span>        <span class="mi">0</span>             <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">43160</span>       <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="o">:</span><span class="n">ssh</span>
<span class="n">State</span>  <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>   <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>      <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>         <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">ESTAB</span>  <span class="mi">0</span>        <span class="mi">0</span>             <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">43160</span>       <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="o">:</span><span class="n">ssh</span>
<span class="n">State</span>  <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>   <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>      <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>         <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">ESTAB</span>  <span class="mi">252</span>      <span class="mi">0</span>             <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">43160</span>       <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="o">:</span><span class="n">ssh</span>
<span class="n">State</span>  <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>   <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>      <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>         <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">ESTAB</span>  <span class="mi">36</span>       <span class="mi">0</span>             <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">43160</span>       <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="o">:</span><span class="n">ssh</span>
<span class="n">State</span>  <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>   <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>      <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>         <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">ESTAB</span>  <span class="mi">72</span>       <span class="mi">0</span>             <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">43160</span>       <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="o">:</span><span class="n">ssh</span>
<span class="n">State</span>  <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>   <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>      <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>         <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">ESTAB</span>  <span class="mi">0</span>        <span class="mi">131360</span>        <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">43160</span>       <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="o">:</span><span class="n">ssh</span>
<span class="n">State</span>  <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>   <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>      <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>         <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">ESTAB</span>  <span class="mi">216</span>      <span class="mi">0</span>             <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">43160</span>       <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="o">:</span><span class="n">ssh</span>
<span class="n">State</span>  <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>   <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>      <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>         <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">ESTAB</span>  <span class="mi">180</span>      <span class="mi">0</span>             <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">43160</span>       <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="o">:</span><span class="n">ssh</span>
<span class="n">State</span>  <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>   <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>      <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>         <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">ESTAB</span>  <span class="mi">36</span>       <span class="mi">0</span>             <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">43160</span>       <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="o">:</span><span class="n">ssh</span>
<span class="n">State</span>  <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>   <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>      <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>         <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">ESTAB</span>  <span class="mi">0</span>        <span class="mi">0</span>             <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">43160</span>       <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="o">:</span><span class="n">ssh</span>
<span class="n">State</span>  <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>   <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>      <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>         <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">ESTAB</span>  <span class="mi">0</span>        <span class="mi">459760</span>        <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">43160</span>       <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="o">:</span><span class="n">ssh</span>
<span class="n">State</span>  <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>   <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>      <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>         <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">ESTAB</span>  <span class="mi">0</span>        <span class="mi">459760</span>        <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">43160</span>       <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="o">:</span><span class="n">ssh</span>
<span class="n">State</span>  <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>   <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>      <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>         <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">ESTAB</span>  <span class="mi">0</span>        <span class="mi">0</span>             <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">43160</span>       <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="o">:</span><span class="n">ssh</span>
<span class="n">State</span>  <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>   <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>       <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>        <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">ESTAB</span>  <span class="mi">0</span>        <span class="mi">1609160</span>        <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">43160</span>      <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="o">:</span><span class="n">ssh</span>
<span class="n">State</span>  <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>   <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>      <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>         <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">ESTAB</span>  <span class="mi">144</span>      <span class="mi">0</span>             <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">43160</span>       <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="o">:</span><span class="n">ssh</span>
<span class="n">State</span>  <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>   <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>      <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>         <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">ESTAB</span>  <span class="mi">0</span>        <span class="mi">0</span>             <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">43160</span>       <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="o">:</span><span class="n">ssh</span>
<span class="n">State</span>  <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>   <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>      <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>         <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">ESTAB</span>  <span class="mi">0</span>        <span class="mi">65680</span>         <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">43160</span>       <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="o">:</span><span class="n">ssh</span>
<span class="n">State</span>  <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>   <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>      <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>         <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">ESTAB</span>  <span class="mi">0</span>        <span class="mi">0</span>             <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">43160</span>       <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="o">:</span><span class="n">ssh</span>
<span class="n">State</span>  <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>   <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>      <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>         <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">ESTAB</span>  <span class="mi">180</span>      <span class="mi">0</span>             <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">43160</span>       <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="o">:</span><span class="n">ssh</span>

</pre></table></code></div></div><hr /><h2 id="generate-reports-for-the-system-status">generate reports for the system Status</h2><p>server0:</p><p><strong>sysstat</strong></p><p>a great high-level tool for long-term performance data,</p><ul><li>report on historical performance information over time.<li>collect and report on system performance information over time.<li>so can answer the question what happened when on system at some point in the past,</ul><p><code class="language-plaintext highlighter-rouge">SADC</code>: system activity data collector <code class="language-plaintext highlighter-rouge">/usr/lib64/sa/sa2</code>: a shell script wapping commands around the execution of the SAR command</p><p>with this crontab configuration</p><ul><li><code class="language-plaintext highlighter-rouge">sysstat</code> will churn along collecting long-term performance data in the background</ul><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>
<span class="err">$</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sysconfig</span><span class="o">/</span><span class="n">sysstat</span>
<span class="c1"># sysstat-11.7.3 configuration file.
# How long to keep log files (in days).
# If value is greater than 28, then use sadc's option -D to prevent older data files from being overwritten. See sadc(8) and sysstat(5) manual pages.
# !!!!!!!!!!!!!!!!!!!!
</span><span class="n">HISTORY</span><span class="o">=</span><span class="mi">28</span>


<span class="err">$</span> <span class="n">sudo</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">sysstat</span>
<span class="c1"># collect and store binary data into the system activity data file every 10min, one record should be written one time into the data.
</span><span class="o">*/</span><span class="mi">10</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="n">root</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib64</span><span class="o">/</span><span class="n">sa</span><span class="o">/</span><span class="n">sa1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="c1"># collects and stores a daily activity report each day. at 11:52pm. it create that file and store in /var/log/sa
</span><span class="mi">53</span> <span class="mi">23</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="n">root</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib64</span><span class="o">/</span><span class="n">sa</span><span class="o">/</span><span class="n">sa2</span> <span class="o">-</span><span class="n">A</span>
</pre></table></code></div></div><p>get data each time the sa1 command was executed,</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">cd</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">sa</span>
<span class="err">$</span> <span class="n">ll</span>
<span class="n">total</span> <span class="mi">4</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span> <span class="mi">2996</span> <span class="n">Apr</span> <span class="mi">23</span> <span class="mi">21</span><span class="o">:</span><span class="mi">18</span> <span class="n">sa23</span>
</pre></table></code></div></div><p>It is the responsibility of crontab to create this file every day</p><p><strong>view the SAR file</strong></p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">less</span> <span class="n">sar23</span>
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://i.imgur.com/XPaplET.png" alt="Screen Shot 2020-04-23 at 21.41.26" /></p><p><strong>view the SA file</strong></p><p>if this machine was up 24/7 like a server, will show a full run of data at each sample point for each day. able to go back and forth and look at data files accordingly.</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
</pre><td class="rouge-code"><pre>
<span class="mi">1</span><span class="p">.</span> <span class="n">CPU</span> <span class="n">utilization</span> <span class="n">and</span> <span class="n">a</span> <span class="n">percentages</span> <span class="n">over</span> <span class="n">time</span><span class="p">.</span> <span class="n">Good</span> <span class="k">for</span> <span class="n">narrowing</span> <span class="n">down</span> <span class="n">a</span> <span class="n">CPU</span> <span class="n">issue</span><span class="p">.</span>

<span class="err">$</span> <span class="n">sar</span> <span class="o">-</span><span class="n">u</span>
<span class="n">Linux</span> <span class="mi">4</span><span class="p">.</span><span class="mi">18</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">147</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="n">el8_1</span><span class="p">.</span><span class="n">x86_64</span> <span class="p">(</span><span class="n">server0</span><span class="p">)</span> 	<span class="mo">04</span><span class="o">/</span><span class="mi">23</span><span class="o">/</span><span class="mi">2020</span> 	<span class="n">_x86_64_</span>	<span class="p">(</span><span class="mi">1</span> <span class="n">CPU</span><span class="p">)</span>
<span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">42</span> <span class="n">PM</span>     <span class="n">CPU</span>     <span class="o">%</span><span class="n">user</span>     <span class="o">%</span><span class="n">nice</span>   <span class="o">%</span><span class="n">system</span>   <span class="o">%</span><span class="n">iowait</span>    <span class="o">%</span><span class="n">steal</span>     <span class="o">%</span><span class="n">idle</span>
<span class="mi">09</span><span class="o">:</span><span class="mi">34</span><span class="o">:</span><span class="mi">58</span> <span class="n">PM</span>     <span class="n">all</span>      <span class="mi">0</span><span class="p">.</span><span class="mi">87</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">01</span>      <span class="mi">0</span><span class="p">.</span><span class="mi">54</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">02</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">00</span>     <span class="mi">98</span><span class="p">.</span><span class="mi">56</span>
<span class="mi">09</span><span class="o">:</span><span class="mi">36</span><span class="o">:</span><span class="mo">06</span> <span class="n">PM</span>     <span class="n">all</span>      <span class="mi">1</span><span class="p">.</span><span class="mi">61</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">00</span>      <span class="mi">0</span><span class="p">.</span><span class="mi">79</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">01</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">00</span>     <span class="mi">97</span><span class="p">.</span><span class="mi">58</span>
<span class="mi">09</span><span class="o">:</span><span class="mi">36</span><span class="o">:</span><span class="mi">08</span> <span class="n">PM</span>     <span class="n">all</span>      <span class="mi">2</span><span class="p">.</span><span class="mi">37</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">00</span>      <span class="mi">0</span><span class="p">.</span><span class="mi">95</span>      <span class="mi">0</span><span class="p">.</span><span class="mi">47</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">00</span>     <span class="mi">96</span><span class="p">.</span><span class="mi">21</span>
<span class="mi">09</span><span class="o">:</span><span class="mi">36</span><span class="o">:</span><span class="mi">09</span> <span class="n">PM</span>     <span class="n">all</span>      <span class="mi">6</span><span class="p">.</span><span class="mi">12</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">00</span>      <span class="mi">3</span><span class="p">.</span><span class="mo">06</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">00</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">00</span>     <span class="mi">90</span><span class="p">.</span><span class="mi">82</span>



<span class="mi">2</span><span class="p">.</span> <span class="n">load</span> <span class="n">averages</span> <span class="k">for</span> <span class="n">one</span> <span class="n">minute</span><span class="p">,</span> <span class="n">five</span> <span class="n">minute</span> <span class="n">and</span> <span class="mi">15</span> <span class="n">minutes</span><span class="p">,</span> <span class="n">again</span> <span class="n">over</span> <span class="n">time</span><span class="p">.</span> <span class="n">find</span> <span class="n">out</span> <span class="n">when</span> <span class="n">had</span> <span class="n">some</span> <span class="n">slow</span> <span class="n">down</span> <span class="n">in</span> <span class="n">system</span><span class="p">.</span>

<span class="err">$</span> <span class="n">sar</span> <span class="o">-</span><span class="n">q</span>
<span class="n">Linux</span> <span class="mi">4</span><span class="p">.</span><span class="mi">18</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">147</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="n">el8_1</span><span class="p">.</span><span class="n">x86_64</span> <span class="p">(</span><span class="n">server0</span><span class="p">)</span> 	<span class="mo">04</span><span class="o">/</span><span class="mi">23</span><span class="o">/</span><span class="mi">2020</span> 	<span class="n">_x86_64_</span>	<span class="p">(</span><span class="mi">1</span> <span class="n">CPU</span><span class="p">)</span>
<span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">42</span> <span class="n">PM</span>   <span class="n">runq</span><span class="o">-</span><span class="n">sz</span>  <span class="n">plist</span><span class="o">-</span><span class="n">sz</span>   <span class="n">ldavg</span><span class="o">-</span><span class="mi">1</span>   <span class="n">ldavg</span><span class="o">-</span><span class="mi">5</span>  <span class="n">ldavg</span><span class="o">-</span><span class="mi">15</span>   <span class="n">blocked</span>
<span class="mi">09</span><span class="o">:</span><span class="mi">34</span><span class="o">:</span><span class="mi">58</span> <span class="n">PM</span>         <span class="mi">3</span>       <span class="mi">760</span>      <span class="mi">0</span><span class="p">.</span><span class="mi">08</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">04</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">02</span>         <span class="mi">0</span>
<span class="mi">09</span><span class="o">:</span><span class="mi">36</span><span class="o">:</span><span class="mo">06</span> <span class="n">PM</span>         <span class="mi">3</span>       <span class="mi">757</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">02</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">03</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">02</span>         <span class="mi">0</span>
<span class="mi">09</span><span class="o">:</span><span class="mi">36</span><span class="o">:</span><span class="mi">08</span> <span class="n">PM</span>         <span class="mi">2</span>       <span class="mi">757</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">02</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">03</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">02</span>         <span class="mi">0</span>
<span class="mi">09</span><span class="o">:</span><span class="mi">36</span><span class="o">:</span><span class="mi">09</span> <span class="n">PM</span>         <span class="mi">4</span>       <span class="mi">757</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">02</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">02</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">02</span>         <span class="mi">0</span>
<span class="mi">09</span><span class="o">:</span><span class="mi">36</span><span class="o">:</span><span class="mi">23</span> <span class="n">PM</span>         <span class="mi">3</span>       <span class="mi">761</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">02</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">02</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">02</span>         <span class="mi">0</span>
<span class="mi">09</span><span class="o">:</span><span class="mi">36</span><span class="o">:</span><span class="mi">24</span> <span class="n">PM</span>         <span class="mi">4</span>       <span class="mi">761</span>      <span class="mi">0</span><span class="p">.</span><span class="mi">18</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">06</span>      <span class="mi">0</span><span class="p">.</span><span class="mo">03</span>         <span class="mi">0</span>


<span class="mi">3</span><span class="p">.</span> <span class="n">pull</span> <span class="n">it</span> <span class="n">from</span> <span class="n">a</span> <span class="n">previous</span> <span class="n">file</span>

<span class="err">$</span> <span class="n">sar</span> <span class="o">-</span><span class="n">q</span> <span class="o">-</span><span class="n">f</span>  <span class="n">sa01</span>



<span class="mi">4</span><span class="p">.</span> <span class="n">dump</span> <span class="n">everything</span> <span class="n">to</span> <span class="n">the</span> <span class="n">screen</span>

<span class="err">$</span> <span class="n">sar</span> <span class="o">-</span><span class="n">A</span>


<span class="mi">5</span><span class="p">.</span> <span class="n">specific</span> <span class="n">times</span>

<span class="err">$</span> <span class="n">sar</span> <span class="o">-</span><span class="n">A</span> <span class="o">-</span><span class="n">s</span> <span class="mi">21</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mo">00</span>
<span class="err">$</span> <span class="n">sar</span> <span class="o">-</span><span class="n">A</span> <span class="o">-</span><span class="n">s</span> <span class="mi">21</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mo">00</span> <span class="o">-</span><span class="n">e</span> <span class="mi">22</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span>


<span class="mi">6</span><span class="p">.</span> <span class="n">output</span> <span class="n">into</span> <span class="n">csv</span>

<span class="err">$</span> <span class="n">sadf</span> <span class="o">-</span><span class="n">d</span> <span class="o">|</span> <span class="n">head</span>
<span class="cp"># hostname;interval;timestamp;CPU;%user;%nice;%system;%iowait;%steal;%idle
</span><span class="n">server0</span><span class="p">;</span><span class="mi">975</span><span class="p">;</span><span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">24</span> <span class="mo">01</span><span class="o">:</span><span class="mi">34</span><span class="o">:</span><span class="mi">58</span> <span class="n">UTC</span><span class="p">;</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mi">87</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mo">01</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mi">54</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mo">02</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mo">00</span><span class="p">;</span><span class="mi">98</span><span class="p">.</span><span class="mi">56</span>
<span class="n">server0</span><span class="p">;</span><span class="mi">68</span><span class="p">;</span><span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">24</span> <span class="mo">01</span><span class="o">:</span><span class="mi">36</span><span class="o">:</span><span class="mo">06</span> <span class="n">UTC</span><span class="p">;</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="mi">1</span><span class="p">.</span><span class="mi">61</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mo">00</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mi">79</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mo">01</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mo">00</span><span class="p">;</span><span class="mi">97</span><span class="p">.</span><span class="mi">58</span>
<span class="n">server0</span><span class="p">;</span><span class="mi">2</span><span class="p">;</span><span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">24</span> <span class="mo">01</span><span class="o">:</span><span class="mi">36</span><span class="o">:</span><span class="mi">08</span> <span class="n">UTC</span><span class="p">;</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="mi">2</span><span class="p">.</span><span class="mi">37</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mo">00</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mi">95</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mi">47</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mo">00</span><span class="p">;</span><span class="mi">96</span><span class="p">.</span><span class="mi">21</span>
<span class="n">server0</span><span class="p">;</span><span class="mi">1</span><span class="p">;</span><span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">24</span> <span class="mo">01</span><span class="o">:</span><span class="mi">36</span><span class="o">:</span><span class="mi">09</span> <span class="n">UTC</span><span class="p">;</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="mi">6</span><span class="p">.</span><span class="mi">12</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mo">00</span><span class="p">;</span><span class="mi">3</span><span class="p">.</span><span class="mo">06</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mo">00</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mo">00</span><span class="p">;</span><span class="mi">90</span><span class="p">.</span><span class="mi">82</span>
<span class="n">server0</span><span class="p">;</span><span class="mi">14</span><span class="p">;</span><span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">24</span> <span class="mo">01</span><span class="o">:</span><span class="mi">36</span><span class="o">:</span><span class="mi">23</span> <span class="n">UTC</span><span class="p">;</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="mi">3</span><span class="p">.</span><span class="mi">54</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mo">00</span><span class="p">;</span><span class="mi">4</span><span class="p">.</span><span class="mi">39</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mi">21</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mo">00</span><span class="p">;</span><span class="mi">91</span><span class="p">.</span><span class="mi">86</span>
<span class="n">server0</span><span class="p">;</span><span class="mi">1</span><span class="p">;</span><span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">24</span> <span class="mo">01</span><span class="o">:</span><span class="mi">36</span><span class="o">:</span><span class="mi">24</span> <span class="n">UTC</span><span class="p">;</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="mi">9</span><span class="p">.</span><span class="mi">30</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mo">00</span><span class="p">;</span><span class="mi">83</span><span class="p">.</span><span class="mi">72</span><span class="p">;</span><span class="mi">1</span><span class="p">.</span><span class="mi">16</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mo">00</span><span class="p">;</span><span class="mi">5</span><span class="p">.</span><span class="mi">81</span>
<span class="n">server0</span><span class="p">;</span><span class="mi">1</span><span class="p">;</span><span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">24</span> <span class="mo">01</span><span class="o">:</span><span class="mi">36</span><span class="o">:</span><span class="mi">25</span> <span class="n">UTC</span><span class="p">;</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="mi">11</span><span class="p">.</span><span class="mi">84</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mo">00</span><span class="p">;</span><span class="mi">73</span><span class="p">.</span><span class="mi">68</span><span class="p">;</span><span class="mi">1</span><span class="p">.</span><span class="mi">32</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mo">00</span><span class="p">;</span><span class="mi">13</span><span class="p">.</span><span class="mi">16</span>
<span class="n">server0</span><span class="p">;</span><span class="mi">113</span><span class="p">;</span><span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">24</span> <span class="mo">01</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mi">18</span> <span class="n">UTC</span><span class="p">;</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="mi">2</span><span class="p">.</span><span class="mi">52</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mo">00</span><span class="p">;</span><span class="mi">45</span><span class="p">.</span><span class="mi">73</span><span class="p">;</span><span class="mi">1</span><span class="p">.</span><span class="mi">38</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mo">00</span><span class="p">;</span><span class="mi">50</span><span class="p">.</span><span class="mi">37</span>
<span class="n">server0</span><span class="p">;</span><span class="mi">1</span><span class="p">;</span><span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">24</span> <span class="mo">01</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mi">18</span> <span class="n">UTC</span><span class="p">;</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="mi">6</span><span class="p">.</span><span class="mi">67</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mo">00</span><span class="p">;</span><span class="mi">20</span><span class="p">.</span><span class="mo">00</span><span class="p">;</span><span class="mi">1</span><span class="p">.</span><span class="mi">33</span><span class="p">;</span><span class="mi">0</span><span class="p">.</span><span class="mo">00</span><span class="p">;</span><span class="mi">72</span><span class="p">.</span><span class="mo">00</span>

<span class="err">$</span> <span class="n">sadf</span> <span class="o">-</span><span class="n">d</span> <span class="o">&gt;</span> <span class="n">output</span><span class="p">.</span><span class="n">csv</span>
</pre></table></code></div></div><p><strong>dstat</strong></p><p>to triage a performance problem right now.</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre>
<span class="err">$</span> <span class="n">dstat</span>
<span class="o">----</span><span class="n">total</span><span class="o">-</span><span class="n">usage</span><span class="o">----</span> <span class="o">-</span><span class="n">dsk</span><span class="o">/</span><span class="n">total</span><span class="o">-</span> <span class="o">-</span><span class="n">net</span><span class="o">/</span><span class="n">total</span><span class="o">-</span> <span class="o">---</span><span class="n">paging</span><span class="o">--</span> <span class="o">---</span><span class="n">system</span><span class="o">--</span>
<span class="n">usr</span> <span class="n">sys</span> <span class="n">idl</span> <span class="n">wai</span> <span class="n">stl</span><span class="o">|</span> <span class="n">read</span>  <span class="n">writ</span><span class="o">|</span> <span class="n">recv</span>  <span class="n">send</span><span class="o">|</span>  <span class="n">in</span>   <span class="n">out</span> <span class="o">|</span> <span class="kt">int</span>   <span class="n">csw</span>
  <span class="mi">4</span>   <span class="mi">1</span>  <span class="mi">92</span>   <span class="mi">0</span>   <span class="mi">0</span><span class="o">|</span> <span class="mi">452</span><span class="n">k</span>    <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span> <span class="mi">226</span>   <span class="mi">308</span>
  <span class="mi">1</span>   <span class="mi">1</span>  <span class="mi">98</span>   <span class="mi">0</span>   <span class="mi">0</span><span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span> <span class="mi">115</span>   <span class="mi">218</span>
  <span class="mi">5</span>   <span class="mi">0</span>  <span class="mi">94</span>   <span class="mi">0</span>   <span class="mi">0</span><span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span> <span class="mi">194</span>   <span class="mi">228</span>
  <span class="mi">4</span>   <span class="mi">0</span>  <span class="mi">94</span>   <span class="mi">0</span>   <span class="mi">0</span><span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span>   <span class="mi">0</span>     <span class="mi">0</span> <span class="o">|</span> <span class="mi">184</span>   <span class="mi">237</span> <span class="o">^</span><span class="n">C</span>


<span class="err">$</span> <span class="n">dstat</span> <span class="o">--</span><span class="n">tcp</span>
<span class="o">------</span><span class="n">tcp</span><span class="o">-</span><span class="n">sockets</span><span class="o">-------</span>
<span class="n">lis</span>  <span class="n">act</span>  <span class="n">syn</span>  <span class="n">tim</span>  <span class="n">clo</span>
  <span class="mi">4</span>    <span class="mi">1</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>
  <span class="mi">4</span>    <span class="mi">1</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>
  <span class="mi">4</span>    <span class="mi">1</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>


<span class="err">$</span> <span class="n">dstat</span> <span class="o">--</span><span class="n">all</span> <span class="o">--</span><span class="n">tcp</span>


<span class="err">$</span> <span class="n">dstat</span> <span class="o">-</span><span class="n">t</span> <span class="o">--</span><span class="n">all</span> <span class="o">--</span><span class="n">tcp</span>
<span class="o">----</span><span class="n">system</span><span class="o">----</span> <span class="o">----</span><span class="n">total</span><span class="o">-</span><span class="n">usage</span><span class="o">----</span> <span class="o">-</span><span class="n">dsk</span><span class="o">/</span><span class="n">total</span><span class="o">-</span> <span class="o">-</span><span class="n">net</span><span class="o">/</span><span class="n">total</span><span class="o">-&gt;</span>
     <span class="n">time</span>     <span class="o">|</span><span class="n">usr</span> <span class="n">sys</span> <span class="n">idl</span> <span class="n">wai</span> <span class="n">stl</span><span class="o">|</span> <span class="n">read</span>  <span class="n">writ</span><span class="o">|</span> <span class="n">recv</span>  <span class="n">send</span><span class="o">&gt;</span>
<span class="mi">23</span><span class="o">-</span><span class="mo">04</span> <span class="mi">22</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mi">42</span><span class="o">|</span>                   <span class="o">|</span>           <span class="o">|</span>           <span class="o">&gt;</span>
<span class="mi">23</span><span class="o">-</span><span class="mo">04</span> <span class="mi">22</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mi">43</span><span class="o">|</span> <span class="mi">25</span>  <span class="mi">26</span>  <span class="mi">45</span>   <span class="mi">2</span>   <span class="mi">0</span><span class="o">|</span>  <span class="mi">45</span><span class="n">M</span>  <span class="mi">831</span><span class="n">k</span><span class="o">|</span> <span class="mi">148</span><span class="n">k</span>   <span class="mi">56</span><span class="n">M</span><span class="o">&gt;</span>
<span class="mi">23</span><span class="o">-</span><span class="mo">04</span> <span class="mi">22</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mi">44</span><span class="o">|</span> <span class="mi">19</span>  <span class="mi">22</span>  <span class="mi">55</span>   <span class="mi">1</span>   <span class="mi">0</span><span class="o">|</span>  <span class="mi">39</span><span class="n">M</span>  <span class="mi">508</span><span class="n">k</span><span class="o">|</span> <span class="mi">116</span><span class="n">k</span>   <span class="mi">44</span><span class="n">M</span><span class="o">&gt;</span>
</pre></table></code></div></div><hr /><h2 id="manage-the-rpm-packages">manage the RPM packages</h2><p>server0:</p><p><code class="language-plaintext highlighter-rouge">rpm</code> is a package that contains all of the software in things needed to install the software.</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">cd</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">doc</span>
<span class="err">$</span> <span class="n">ls</span>
<span class="n">abattis</span><span class="o">-</span><span class="n">cantarell</span><span class="o">-</span><span class="n">fonts</span>        <span class="n">libXrender</span>
<span class="n">accountsservice</span>                <span class="n">libXrender</span><span class="o">-</span><span class="n">devel</span>
<span class="n">adcli</span>                          <span class="n">libXres</span>
<span class="n">adobe</span><span class="o">-</span><span class="n">mappings</span><span class="o">-</span><span class="n">cmap</span>            <span class="n">libxslt</span>
<span class="n">adobe</span><span class="o">-</span><span class="n">mappings</span><span class="o">-</span><span class="n">pdf</span>             <span class="n">libXt</span>
<span class="n">alsa</span><span class="o">-</span><span class="n">lib</span>                       <span class="n">libXtst</span>
<span class="n">alsa</span><span class="o">-</span><span class="n">plugins</span><span class="o">-</span><span class="n">pulseaudio</span>        <span class="n">libXv</span>
<span class="n">alsa</span><span class="o">-</span><span class="n">utils</span>                     <span class="n">libXvMC</span>


<span class="n">put</span> <span class="n">the</span> <span class="n">CentOS</span> <span class="n">installation</span> <span class="n">DVD</span> <span class="n">into</span> <span class="n">the</span> <span class="k">virtual</span> <span class="n">CD</span> <span class="n">drive</span> <span class="n">of</span> <span class="k">virtual</span> <span class="n">machine</span>

<span class="err">$</span> <span class="n">mount</span>
<span class="n">sysfs</span> <span class="n">on</span> <span class="o">/</span><span class="n">sys</span> <span class="n">type</span> <span class="n">sysfs</span> <span class="p">(</span><span class="n">rw</span><span class="p">,</span><span class="n">nosuid</span><span class="p">,</span><span class="n">nodev</span><span class="p">,</span><span class="n">noexec</span><span class="p">,</span><span class="n">relatime</span><span class="p">,</span><span class="n">seclabel</span><span class="p">)</span>
<span class="n">proc</span> <span class="n">on</span> <span class="o">/</span><span class="n">proc</span> <span class="n">type</span> <span class="n">proc</span> <span class="p">(</span><span class="n">rw</span><span class="p">,</span><span class="n">nosuid</span><span class="p">,</span><span class="n">nodev</span><span class="p">,</span><span class="n">noexec</span><span class="p">,</span><span class="n">relatime</span><span class="p">)</span>
<span class="n">devtmpfs</span> <span class="n">on</span> <span class="o">/</span><span class="n">dev</span> <span class="n">type</span> <span class="n">devtmpfs</span> <span class="p">(</span><span class="n">rw</span><span class="p">,</span><span class="n">nosuid</span><span class="p">,</span><span class="n">seclabel</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">1132468</span><span class="n">k</span><span class="p">,</span><span class="n">nr_inodes</span><span class="o">=</span><span class="mi">283117</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="mi">755</span><span class="p">)</span>

<span class="err">$</span> <span class="n">mount</span> <span class="o">|</span> <span class="n">grep</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sr0</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sr0</span> <span class="n">on</span> <span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">server1</span><span class="o">/</span><span class="n">VBox_GAs_6</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">20</span> <span class="n">type</span> <span class="n">iso9660</span> <span class="p">(</span><span class="n">ro</span><span class="p">,</span><span class="n">nosuid</span><span class="p">,</span><span class="n">nodev</span><span class="p">,</span><span class="n">relatime</span><span class="p">,</span><span class="n">nojoliet</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="n">s</span><span class="p">,</span><span class="n">map</span><span class="o">=</span><span class="n">n</span><span class="p">,</span><span class="n">blocksize</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span><span class="n">uid</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">gid</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">dmode</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">fmode</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span><span class="n">uhelper</span><span class="o">=</span><span class="n">udisks2</span><span class="p">)</span>


<span class="err">$</span> <span class="n">cd</span> <span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">server1</span><span class="o">/</span>
<span class="n">dr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="p">.</span> <span class="mi">5</span> <span class="n">server1</span> <span class="n">server1</span> <span class="mi">2408</span> <span class="n">Apr</span>  <span class="mi">9</span> <span class="mi">12</span><span class="o">:</span><span class="mo">06</span> <span class="n">VBox_GAs_6</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">20</span>
<span class="n">dr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="p">.</span> <span class="mi">5</span> <span class="n">server1</span> <span class="n">server1</span> <span class="mi">2408</span> <span class="n">Apr</span>  <span class="mi">9</span> <span class="mi">12</span><span class="o">:</span><span class="mo">06</span> <span class="n">CentOS7</span>
<span class="err">$</span> <span class="n">cd</span> <span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">server1</span><span class="o">/</span><span class="n">CentOS7</span><span class="o">/</span><span class="n">packages</span>
<span class="c1">// all rpm file, packages that com along with the installation DVD of CentOS.</span>
<span class="n">mc</span><span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">7</span><span class="o">-</span><span class="mi">8</span><span class="p">.</span><span class="n">el7</span><span class="p">.</span><span class="n">x86_64</span><span class="p">.</span><span class="n">rpm</span>
<span class="c1">// name-version-release-architecture</span>
</pre></table></code></div></div><ol><li>check the information</ol><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">rpm</span> <span class="o">-</span><span class="n">qi</span> <span class="n">mc</span><span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">7</span><span class="o">-</span><span class="mi">8</span><span class="p">.</span><span class="n">el7</span><span class="p">.</span><span class="n">x86_64</span><span class="p">.</span><span class="n">rpm</span> <span class="c1">// look in database for particular package installed setup</span>
<span class="err">$</span> <span class="n">rpm</span> <span class="o">-</span><span class="n">qip</span> <span class="n">mc</span><span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">7</span><span class="o">-</span><span class="mi">8</span><span class="p">.</span><span class="n">el7</span><span class="p">.</span><span class="n">x86_64</span><span class="p">.</span><span class="n">rpm</span> <span class="c1">// get metadata information from a package</span>
<span class="n">Name</span>        <span class="o">:</span> <span class="n">mc</span>
<span class="n">Epoch</span>       <span class="o">:</span> <span class="mi">1</span>
<span class="n">Version</span>     <span class="o">:</span> <span class="mi">4</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">7</span>
<span class="n">Release</span>     <span class="o">:</span> <span class="mi">8</span><span class="p">.</span><span class="n">el7</span>  <span class="c1">// enterprise Linux</span>
<span class="n">Architecture</span><span class="o">:</span> <span class="n">x86_64</span>
<span class="n">Install</span> <span class="n">Date</span><span class="o">:</span> <span class="p">(</span><span class="n">not</span> <span class="n">installed</span><span class="p">)</span>
<span class="n">Group</span>       <span class="o">:</span> <span class="n">System</span> <span class="n">Environment</span><span class="o">/</span><span class="n">Shells</span>
<span class="n">Size</span>        <span class="o">:</span> <span class="mi">2159623</span>
<span class="n">License</span>     <span class="o">:</span> <span class="n">GPLv3</span><span class="o">+</span>
<span class="n">Signature</span>   <span class="o">:</span> <span class="n">RSA</span><span class="o">/</span><span class="n">SHA256</span><span class="p">,</span> <span class="n">Sat</span> <span class="mo">05</span> <span class="n">Jul</span> <span class="mi">2014</span> <span class="mi">09</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">28</span> <span class="n">AM</span> <span class="n">EDT</span><span class="p">,</span> <span class="n">Key</span> <span class="n">ID</span> <span class="mi">24</span><span class="n">c6a8a7f4a80eb5</span>
<span class="n">Source</span> <span class="n">RPM</span>  <span class="o">:</span> <span class="p">(</span><span class="n">none</span><span class="p">)</span>
<span class="n">Build</span> <span class="n">Date</span>  <span class="o">:</span> <span class="n">Mon</span> <span class="mi">09</span> <span class="n">Jun</span> <span class="mi">2014</span> <span class="mo">06</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">17</span> <span class="n">PM</span> <span class="n">EDT</span>
<span class="n">Build</span> <span class="n">Host</span>  <span class="o">:</span> <span class="n">worker1</span><span class="p">.</span><span class="n">bsys</span><span class="p">.</span><span class="n">centos</span><span class="p">.</span><span class="n">org</span>
<span class="n">Relocations</span> <span class="o">:</span> <span class="p">(</span><span class="n">not</span> <span class="n">relocatable</span><span class="p">)</span>
<span class="n">Packager</span>    <span class="o">:</span> <span class="n">CentOS</span> <span class="n">BuildSystem</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//bugs.centos.org&gt;</span>
<span class="n">Vendor</span>      <span class="o">:</span> <span class="n">CentOS</span>
<span class="n">URL</span>         <span class="o">:</span> <span class="n">http</span><span class="o">:</span><span class="c1">//www.midnight-commander.org/</span>
<span class="n">Summary</span>     <span class="o">:</span> <span class="n">User</span><span class="o">-</span><span class="n">friendly</span> <span class="n">text</span> <span class="n">console</span> <span class="n">file</span> <span class="n">manager</span> <span class="n">and</span> <span class="n">visual</span> <span class="n">shell</span>
<span class="n">Description</span> <span class="o">:</span>
<span class="n">Midnight</span> <span class="n">Commander</span> <span class="n">is</span> <span class="n">a</span> <span class="n">visual</span> <span class="n">shell</span> <span class="n">much</span> <span class="n">like</span> <span class="n">a</span> <span class="n">file</span> <span class="n">manager</span><span class="p">,</span> <span class="n">only</span>
<span class="n">with</span> <span class="n">many</span> <span class="n">more</span> <span class="n">features</span><span class="p">.</span> <span class="n">It</span> <span class="n">is</span> <span class="n">a</span> <span class="n">text</span> <span class="n">mode</span> <span class="n">application</span><span class="p">,</span> <span class="n">but</span> <span class="n">it</span> <span class="n">also</span>
<span class="n">includes</span> <span class="n">mouse</span> <span class="n">support</span><span class="p">.</span> <span class="n">Midnight</span> <span class="n">Commanders</span> <span class="n">best</span> <span class="n">features</span> <span class="n">are</span> <span class="n">its</span>
<span class="n">ability</span> <span class="n">to</span> <span class="n">FTP</span><span class="p">,</span> <span class="n">view</span> <span class="n">tar</span> <span class="n">and</span> <span class="n">zip</span> <span class="n">files</span><span class="p">,</span> <span class="n">and</span> <span class="n">to</span> <span class="n">poke</span> <span class="n">into</span> <span class="n">RPMs</span> <span class="k">for</span>
<span class="n">specific</span> <span class="n">files</span><span class="p">.</span>
</pre></table></code></div></div><ol><li>list all file inside setup package</ol><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">rpm</span> <span class="o">-</span><span class="n">ql</span> <span class="n">mc</span><span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">7</span><span class="o">-</span><span class="mi">8</span><span class="p">.</span><span class="n">el7</span><span class="p">.</span><span class="n">src</span><span class="p">.</span><span class="n">rpm</span>
<span class="err">$</span> <span class="n">rpm</span> <span class="o">-</span><span class="n">qlp</span> <span class="n">mc</span><span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">7</span><span class="o">-</span><span class="mi">8</span><span class="p">.</span><span class="n">el7</span><span class="p">.</span><span class="n">src</span><span class="p">.</span><span class="n">rpm</span>
<span class="n">mc</span><span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">7</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">xz</span>
<span class="n">mc</span><span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="n">man_mcdiff</span><span class="p">.</span><span class="n">patch</span>
<span class="n">mc</span><span class="o">-</span><span class="n">VFSsegfault</span><span class="p">.</span><span class="n">patch</span>
<span class="n">mc</span><span class="o">-</span><span class="n">cpiosegfault</span><span class="p">.</span><span class="n">patch</span>
<span class="n">mc</span><span class="o">-</span><span class="n">signed_overflow_fix</span><span class="p">.</span><span class="n">patch</span>
<span class="n">mc</span><span class="o">-</span><span class="n">widgetsegfault</span><span class="p">.</span><span class="n">patch</span>
<span class="n">mc</span><span class="p">.</span><span class="n">spec</span>
</pre></table></code></div></div><ol><li>check the signiture ```c $ rpm -K mc-4.8.7-8.el7.src.rpm mc-4.8.7-8.el7.src.rpm: rsa sha1 (md5) pgp md5 OK</ol><p>$ rpm -K mc-4.8.7-8.el7.src.rpm.demo // check some content mc-4.8.7-8.el7.src.rpm.demo: digests SIGNATURES NOT OK</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>

4. install, update, remove
```c
// -install verbose hashes
$ rpm -ivh mc-4.8.7-8.el7.src.rpm.demo
// update
$ rpm -Uvh mc
// remove
$ rpm -e mc

</pre></table></code></div></div><ol><li>confirm the install</ol><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">rpm</span> <span class="o">-</span><span class="n">qa</span> <span class="n">mc</span>
<span class="err">$</span> <span class="n">rpm</span> <span class="o">-</span><span class="n">q</span> <span class="n">mc</span>
<span class="n">mc</span><span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">7</span><span class="o">-</span><span class="mi">8</span><span class="p">.</span><span class="n">el7</span><span class="p">.</span><span class="n">src</span><span class="p">.</span><span class="n">rpm</span>
<span class="n">package</span> <span class="n">mc</span> <span class="n">is</span> <span class="n">not</span> <span class="n">installed</span>
<span class="c1">// check all installed</span>
<span class="err">$</span> <span class="n">rpm</span> <span class="o">-</span><span class="n">qa</span>

</pre></table></code></div></div><ol><li>get the original copy from the packages</ol><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="c1">// take all the information from the package and write it locally on our file system.</span>
<span class="err">$</span> <span class="n">ls</span>
<span class="n">mc</span><span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">7</span><span class="o">-</span><span class="mi">8</span><span class="p">.</span><span class="n">el7</span><span class="p">.</span><span class="n">src</span><span class="p">.</span><span class="n">rpm</span>
<span class="err">$</span> <span class="n">rpm2cpio</span> <span class="n">mc</span><span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">7</span><span class="o">-</span><span class="mi">8</span><span class="p">.</span><span class="n">el7</span><span class="p">.</span><span class="n">src</span><span class="p">.</span><span class="n">rpm</span> <span class="o">|</span> <span class="n">cpio</span> <span class="o">-</span><span class="n">id</span>
<span class="mi">4221</span> <span class="n">blocks</span>
<span class="err">$</span> <span class="n">ls</span>
<span class="n">mc</span><span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">7</span><span class="o">-</span><span class="mi">8</span><span class="p">.</span><span class="n">el7</span><span class="p">.</span><span class="n">src</span><span class="p">.</span><span class="n">rpm</span>     <span class="n">mc</span><span class="o">-</span><span class="n">signed_overflow_fix</span><span class="p">.</span><span class="n">patch</span>
<span class="n">mc</span><span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">7</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">xz</span>            <span class="n">mc</span><span class="p">.</span><span class="n">spec</span>
<span class="n">mc</span><span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="n">man_mcdiff</span><span class="p">.</span><span class="n">patch</span>  <span class="n">mc</span><span class="o">-</span><span class="n">VFSsegfault</span><span class="p">.</span><span class="n">patch</span>
<span class="n">mc</span><span class="o">-</span><span class="n">cpiosegfault</span><span class="p">.</span><span class="n">patch</span>      <span class="n">mc</span><span class="o">-</span><span class="n">widgetsegfault</span><span class="p">.</span><span class="n">patch</span>


<span class="c1">// check when it come from</span>
<span class="err">$</span> <span class="n">rpm</span> <span class="o">-</span><span class="n">qf</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">fstab</span>
<span class="n">setup</span><span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="mi">12</span><span class="p">.</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="n">el8_1</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="n">noarch</span>
</pre></table></code></div></div><ol><li>verify package attribute</ol><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="c1">// compare the change</span>
<span class="err">$</span> <span class="n">rpm</span> <span class="o">-</span><span class="n">Vv</span> <span class="n">setup</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">aliases</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">bashrc</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">csh</span><span class="p">.</span><span class="n">cshrc</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">csh</span><span class="p">.</span><span class="n">login</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">environment</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ethertypes</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">exports</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">filesystems</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">fstab</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">group</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">gshadow</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">host</span><span class="p">.</span><span class="n">conf</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">inputrc</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">motd</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">networks</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">printcap</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">profile</span>
<span class="p">.........</span>    <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">profile</span><span class="p">.</span><span class="n">d</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">profile</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">csh</span><span class="p">.</span><span class="n">local</span>
<span class="p">.........</span>    <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">profile</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">lang</span><span class="p">.</span><span class="n">csh</span>
<span class="p">.........</span>    <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">profile</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">lang</span><span class="p">.</span><span class="n">sh</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">profile</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">sh</span><span class="p">.</span><span class="n">local</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">protocols</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">services</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">shadow</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">shells</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">subgid</span>
<span class="p">.........</span>  <span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">subuid</span>
<span class="p">.........</span>    <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">doc</span><span class="o">/</span><span class="n">setup</span>
<span class="p">.........</span>  <span class="n">d</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">doc</span><span class="o">/</span><span class="n">setup</span><span class="o">/</span><span class="n">uidgid</span>
<span class="p">.........</span>    <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">licenses</span><span class="o">/</span><span class="n">setup</span>
<span class="p">.........</span>  <span class="n">l</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">licenses</span><span class="o">/</span><span class="n">setup</span><span class="o">/</span><span class="n">COPYING</span>
<span class="p">.</span><span class="n">M</span><span class="p">....</span><span class="n">G</span><span class="p">..</span>  <span class="n">g</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">lastlog</span>
<span class="n">size</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">MD5</span> <span class="n">check</span> <span class="n">zone</span><span class="p">,</span> <span class="n">device</span> <span class="n">number</span><span class="p">,</span> <span class="n">link</span><span class="p">,</span> <span class="n">user</span> <span class="n">owner</span><span class="p">,</span> <span class="n">group</span> <span class="n">owner</span><span class="p">,</span> <span class="n">files</span> <span class="n">time</span><span class="p">,</span> <span class="n">capabilities</span><span class="p">.</span>
<span class="c1">//</span>
<span class="err">$</span> <span class="n">man</span> <span class="n">rpm</span>
<span class="o">/</span><span class="n">verify</span> <span class="n">options</span>
</pre></table></code></div></div><hr /><h2 id="build-a-rpm-package">build a RPM package</h2><h3 id="1-what-is-rpm-make-of">1. what is RPM make of.</h3><p>http://vault.centos.org/ -&gt; source -&gt; binary RPM centos 8.1.1911 -&gt; os/ -&gt; source/ -&gt; Spackages/ -&gt; rpm -&gt; save link as</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
</pre><td class="rouge-code"><pre>
<span class="err">$</span> <span class="n">cd</span> <span class="n">demo</span><span class="o">/</span><span class="n">m4</span>
<span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">src</span><span class="p">.</span><span class="n">rpm</span>

<span class="err">$</span> <span class="n">rpm</span> <span class="o">-</span><span class="n">qlp</span> <span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">src</span><span class="p">.</span><span class="n">rpm</span>
<span class="n">README</span><span class="p">.</span><span class="n">md</span>
<span class="n">README</span><span class="p">.</span><span class="n">top</span>
<span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">xz</span>  <span class="c1">// the program source code</span>
<span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="p">.</span><span class="n">spec</span>           <span class="c1">// the specification on how to build it</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">rpm2cpio</span> <span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">src</span><span class="p">.</span><span class="n">rpm</span> <span class="o">|</span> <span class="n">cpio</span> <span class="o">-</span><span class="n">id</span>
<span class="mi">1833</span> <span class="n">blocks</span>

<span class="err">$</span> <span class="n">ll</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">server1</span> <span class="n">server1</span> <span class="mi">935129</span> <span class="n">Apr</span> <span class="mi">24</span> <span class="mi">23</span><span class="o">:</span><span class="mi">35</span> <span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">src</span><span class="p">.</span><span class="n">rpm</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">server1</span> <span class="n">server1</span> <span class="mi">904416</span> <span class="n">Apr</span> <span class="mi">24</span> <span class="mi">23</span><span class="o">:</span><span class="mi">38</span> <span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">xz</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">server1</span> <span class="n">server1</span>  <span class="mi">13150</span> <span class="n">Apr</span> <span class="mi">24</span> <span class="mi">23</span><span class="o">:</span><span class="mi">38</span> <span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="p">.</span><span class="n">spec</span>


<span class="err">$</span> <span class="n">tar</span> <span class="o">-</span><span class="n">xf</span> <span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">xz</span>
<span class="err">$</span> <span class="n">ll</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="p">.</span> <span class="mi">14</span> <span class="n">server1</span> <span class="n">server1</span>   <span class="mi">4096</span> <span class="n">May</span> <span class="mi">19</span>  <span class="mi">2018</span> <span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="p">.</span>  <span class="mi">1</span> <span class="n">server1</span> <span class="n">server1</span> <span class="mi">935129</span> <span class="n">Apr</span> <span class="mi">24</span> <span class="mi">23</span><span class="o">:</span><span class="mi">35</span> <span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">src</span><span class="p">.</span><span class="n">rpm</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="p">.</span>  <span class="mi">1</span> <span class="n">server1</span> <span class="n">server1</span> <span class="mi">904416</span> <span class="n">Apr</span> <span class="mi">24</span> <span class="mi">23</span><span class="o">:</span><span class="mi">38</span> <span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">xz</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="p">.</span>  <span class="mi">1</span> <span class="n">server1</span> <span class="n">server1</span>  <span class="mi">13150</span> <span class="n">Apr</span> <span class="mi">24</span> <span class="mi">23</span><span class="o">:</span><span class="mi">38</span> <span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="p">.</span><span class="n">spec</span>


<span class="err">$</span> <span class="n">cd</span> <span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="o">/</span>
<span class="c1">// the source code</span>
<span class="err">$</span> <span class="n">ls</span>
<span class="n">ABOUT</span><span class="o">-</span><span class="n">NLS</span>     <span class="n">COPYING</span><span class="p">.</span><span class="n">LIB</span>    <span class="n">misc</span>           <span class="n">ps</span>             <span class="n">tload</span><span class="p">.</span><span class="mi">1</span>
<span class="n">aclocal</span><span class="p">.</span><span class="n">m4</span>    <span class="n">depcomp</span>        <span class="n">missing</span>        <span class="n">pwdx</span><span class="p">.</span><span class="mi">1</span>         <span class="n">tload</span><span class="p">.</span><span class="n">c</span>
<span class="n">AUTHORS</span>       <span class="n">Documentation</span>  <span class="n">mkinstalldirs</span>  <span class="n">pwdx</span><span class="p">.</span><span class="n">c</span>         <span class="n">top</span>
<span class="n">autogen</span><span class="p">.</span><span class="n">sh</span>    <span class="n">free</span><span class="p">.</span><span class="mi">1</span>         <span class="n">NEWS</span>           <span class="n">skill</span><span class="p">.</span><span class="mi">1</span>        <span class="n">uptime</span><span class="p">.</span><span class="mi">1</span>
<span class="n">ChangeLog</span>     <span class="n">free</span><span class="p">.</span><span class="n">c</span>         <span class="n">pgrep</span><span class="p">.</span><span class="mi">1</span>        <span class="n">skill</span><span class="p">.</span><span class="n">c</span>        <span class="n">uptime</span><span class="p">.</span><span class="n">c</span>
<span class="n">compile</span>       <span class="n">include</span>        <span class="n">pgrep</span><span class="p">.</span><span class="n">c</span>        <span class="n">slabtop</span><span class="p">.</span><span class="mi">1</span>      <span class="n">vmstat</span><span class="p">.</span><span class="mi">8</span>
<span class="n">config</span><span class="p">.</span><span class="n">guess</span>  <span class="n">install</span><span class="o">-</span><span class="n">sh</span>     <span class="n">pidof</span><span class="p">.</span><span class="mi">1</span>        <span class="n">slabtop</span><span class="p">.</span><span class="n">c</span>      <span class="n">vmstat</span><span class="p">.</span><span class="n">c</span>
<span class="n">config</span><span class="p">.</span><span class="n">h</span><span class="p">.</span><span class="n">in</span>   <span class="n">kill</span><span class="p">.</span><span class="mi">1</span>         <span class="n">pidof</span><span class="p">.</span><span class="n">c</span>        <span class="n">snice</span><span class="p">.</span><span class="mi">1</span>        <span class="n">w</span><span class="p">.</span><span class="mi">1</span>
<span class="n">config</span><span class="p">.</span><span class="n">rpath</span>  <span class="n">lib</span>            <span class="n">pkill</span><span class="p">.</span><span class="mi">1</span>        <span class="n">sysctl</span><span class="p">.</span><span class="mi">8</span>       <span class="n">watch</span><span class="p">.</span><span class="mi">1</span>
<span class="n">config</span><span class="p">.</span><span class="n">sub</span>    <span class="n">ltmain</span><span class="p">.</span><span class="n">sh</span>      <span class="n">pmap</span><span class="p">.</span><span class="mi">1</span>         <span class="n">sysctl</span><span class="p">.</span><span class="n">c</span>       <span class="n">watch</span><span class="p">.</span><span class="n">c</span>
<span class="n">configure</span>     <span class="n">m4</span>             <span class="n">pmap</span><span class="p">.</span><span class="n">c</span>         <span class="n">sysctl</span><span class="p">.</span><span class="n">conf</span>    <span class="n">w</span><span class="p">.</span><span class="n">c</span>
<span class="n">configure</span><span class="p">.</span><span class="n">ac</span>  <span class="n">Makefile</span><span class="p">.</span><span class="n">am</span>    <span class="n">po</span>             <span class="n">sysctl</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="mi">5</span>
<span class="n">contrib</span>       <span class="n">Makefile</span><span class="p">.</span><span class="n">in</span>    <span class="n">proc</span>           <span class="n">test</span><span class="o">-</span><span class="n">driver</span>
<span class="n">COPYING</span>       <span class="n">man</span><span class="o">-</span><span class="n">po</span>         <span class="n">procio</span><span class="p">.</span><span class="n">c</span>       <span class="n">testsuite</span>



<span class="err">$</span> <span class="n">more</span> <span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="p">.</span><span class="n">spec</span>
<span class="c1">// the spec file</span>
<span class="cp"># The testsuite is unsuitable for running on buildsystems
</span><span class="o">%</span><span class="n">global</span> <span class="n">tests_enabled</span> <span class="mi">0</span>

<span class="n">Summary</span><span class="o">:</span> <span class="n">System</span> <span class="n">and</span> <span class="n">process</span> <span class="n">monitoring</span> <span class="n">utilities</span>
<span class="n">Name</span><span class="o">:</span> <span class="n">procps</span><span class="o">-</span><span class="n">ng</span>
<span class="n">Version</span><span class="o">:</span> <span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span>
<span class="n">Release</span><span class="o">:</span> <span class="mi">1</span><span class="o">%</span><span class="p">{</span><span class="o">?</span><span class="n">dist</span><span class="p">}</span>
<span class="n">License</span><span class="o">:</span> <span class="n">GPL</span><span class="o">+</span> <span class="n">and</span> <span class="n">GPLv2</span> <span class="n">and</span> <span class="n">GPLv2</span><span class="o">+</span> <span class="n">and</span> <span class="n">GPLv3</span><span class="o">+</span> <span class="n">and</span> <span class="n">LGPLv2</span><span class="o">+</span>
<span class="n">Group</span><span class="o">:</span> <span class="n">Applications</span><span class="o">/</span><span class="n">System</span>
<span class="n">URL</span><span class="o">:</span> <span class="n">https</span><span class="o">:</span><span class="c1">//sourceforge.net/projects/procps-ng/</span>

<span class="n">Source0</span><span class="o">:</span> <span class="n">http</span><span class="o">:</span><span class="c1">//downloads.sourceforge.net/%{name}/%{name}-%{version}.ta</span>
<span class="n">r</span><span class="p">.</span><span class="n">xz</span>
<span class="cp"># README files are missing in latest tarball
# wget https://gitlab.com/procps-ng/procps/raw/e0784ddaed30d095bb1d9a8a
</span><span class="n">d6b5a23d10a212c4</span><span class="o">/</span><span class="n">README</span><span class="p">.</span><span class="n">md</span>
<span class="n">Source1</span><span class="o">:</span> <span class="n">README</span><span class="p">.</span><span class="n">md</span>
<span class="cp"># wget https://gitlab.com/procps-ng/procps/raw/e0784ddaed30d095bb1d9a8a
</span><span class="n">d6b5a23d10a212c4</span><span class="o">/</span><span class="n">top</span><span class="o">/</span><span class="n">README</span><span class="p">.</span><span class="n">top</span>
<span class="n">Source2</span><span class="o">:</span> <span class="n">README</span><span class="p">.</span><span class="n">top</span>

<span class="n">BuildRequires</span><span class="o">:</span> <span class="n">ncurses</span><span class="o">-</span><span class="n">devel</span>
<span class="n">BuildRequires</span><span class="o">:</span> <span class="n">libtool</span>
<span class="n">BuildRequires</span><span class="o">:</span> <span class="n">autoconf</span>
<span class="n">BuildRequires</span><span class="o">:</span> <span class="n">automake</span>
<span class="n">BuildRequires</span><span class="o">:</span> <span class="n">gcc</span>
<span class="n">BuildRequires</span><span class="o">:</span> <span class="n">gettext</span><span class="o">-</span><span class="n">devel</span>
<span class="n">BuildRequires</span><span class="o">:</span> <span class="n">systemd</span><span class="o">-</span><span class="n">devel</span>

</pre></table></code></div></div><h3 id="2-build-an-rpm-from-source">2. build an RPM from source.</h3><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
</pre><td class="rouge-code"><pre>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">group</span> <span class="n">install</span> <span class="s">"Development Tools"</span>
<span class="c1">// include all requirement needed to compile and build RPM from source code</span>


<span class="err">$</span> <span class="n">ls</span>
<span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">src</span><span class="p">.</span><span class="n">rpm</span>


<span class="err">$</span> <span class="n">rpmbuild</span> <span class="o">--</span><span class="n">rebuild</span> <span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">src</span><span class="p">.</span><span class="n">rpm</span>
<span class="c1">// install the rpm</span>
<span class="c1">// going though and start to complie the software</span>
<span class="n">Installing</span> <span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">src</span><span class="p">.</span><span class="n">rpm</span>
<span class="n">error</span><span class="o">:</span> <span class="n">Failed</span> <span class="n">build</span> <span class="n">dependencies</span><span class="o">:</span>
	<span class="n">systemd</span><span class="o">-</span><span class="n">devel</span> <span class="n">is</span> <span class="n">needed</span> <span class="n">by</span> <span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">x86_64</span>

  <span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">systemd</span><span class="o">-</span><span class="n">devel</span>



<span class="err">$</span> <span class="n">cd</span>
<span class="c1">// it will make a rpmbuild directory</span>
<span class="err">$</span> <span class="n">ls</span>
<span class="n">demo</span>     <span class="n">Documents</span>  <span class="n">index</span><span class="p">.</span><span class="n">html</span>  <span class="n">Pictures</span>  <span class="n">rpmbuild</span>   <span class="n">Videos</span>
<span class="n">Desktop</span>  <span class="n">Downloads</span>  <span class="n">Music</span>       <span class="n">Public</span>    <span class="n">Templates</span>
<span class="c1">// prefer to use user to install not root.</span>


<span class="err">$</span> <span class="n">ls</span> <span class="o">-</span><span class="n">R</span> <span class="n">rpmbuild</span><span class="o">/</span>
<span class="n">rpmbuild</span><span class="o">/:</span>
<span class="n">BUILD</span>  <span class="n">BUILDROOT</span>  <span class="n">RPMS</span>  <span class="n">SOURCES</span>  <span class="n">SPECS</span>  <span class="n">SRPMS</span>

<span class="n">rpmbuild</span><span class="o">/</span><span class="n">BUILD</span><span class="o">:</span>

<span class="n">rpmbuild</span><span class="o">/</span><span class="n">BUILDROOT</span><span class="o">:</span>

<span class="n">rpmbuild</span><span class="o">/</span><span class="n">RPMS</span><span class="o">:</span>
<span class="n">noarch</span>  <span class="n">x86_64</span>

<span class="n">rpmbuild</span><span class="o">/</span><span class="n">RPMS</span><span class="o">/</span><span class="n">noarch</span><span class="o">:</span>
<span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="n">i18n</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">noarch</span><span class="p">.</span><span class="n">rpm</span>

<span class="c1">// build constructed RPM</span>
<span class="n">rpmbuild</span><span class="o">/</span><span class="n">RPMS</span><span class="o">/</span><span class="n">x86_64</span><span class="o">:</span>
<span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">x86_64</span><span class="p">.</span><span class="n">rpm</span>
<span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="n">debuginfo</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">x86_64</span><span class="p">.</span><span class="n">rpm</span>
<span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="n">debugsource</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">x86_64</span><span class="p">.</span><span class="n">rpm</span>
<span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="n">devel</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">x86_64</span><span class="p">.</span><span class="n">rpm</span>

<span class="c1">// source file</span>
<span class="n">rpmbuild</span><span class="o">/</span><span class="n">SOURCES</span><span class="o">:</span>
<span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">x86_64</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>

<span class="c1">// spec file</span>
<span class="n">rpmbuild</span><span class="o">/</span><span class="n">SPECS</span><span class="o">:</span>
<span class="n">procps</span><span class="p">.</span><span class="n">spec</span>

<span class="n">rpmbuild</span><span class="o">/</span><span class="n">SRPMS</span><span class="o">:</span>
</pre></table></code></div></div><h3 id="3-build-a-rpm-package-from-code">3. build a RPM package from code</h3><p><strong>spec file</strong></p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="c1">// under the SPEC path, temple for sepc</span>
<span class="err">$</span> <span class="n">vi</span> <span class="n">newfile</span><span class="p">.</span><span class="n">spec</span>

<span class="err">$</span> <span class="n">more</span> <span class="n">hello</span><span class="p">.</span><span class="n">spec</span>
<span class="c1">//...name...</span>
<span class="c1">// configuration sections</span>
<span class="c1">// special directives that tell RPM what to do at certain parts of the build phase.</span>

<span class="o">%</span><span class="n">prep</span>
<span class="o">%</span><span class="n">setup</span> <span class="o">-</span><span class="n">q</span>

<span class="cp"># prep section
</span><span class="c1">// caused the command setup -q</span>
<span class="c1">// creates the data directories in build process and uncompresses source tarball</span>

<span class="o">%</span><span class="n">Build</span>
<span class="cp">#make   // either one words
</span><span class="n">gcc</span> <span class="o">-</span><span class="n">o</span> <span class="n">hello</span> <span class="n">hello</span><span class="p">.</span><span class="n">c</span>

<span class="cp"># build section
</span><span class="c1">// actually builds the software</span>

<span class="o">%</span><span class="n">install</span>
<span class="n">rm</span> <span class="p">...</span>
<span class="n">mkdir</span> <span class="p">...</span>
<span class="n">install</span> <span class="p">...</span>

<span class="cp"># install section
</span><span class="c1">// are the directories on what to do while building software package in our build directory.</span>
<span class="c1">// kind of a temporary working space where software is compiled</span>
<span class="c1">// first, delete a directory if it exists.</span>
<span class="c1">// Then recreate that directory, give a blank space to work in</span>
<span class="c1">// and then finally et up some permissions on particular binary that compiling and distributing.</span>

<span class="o">%</span><span class="n">clean</span>
<span class="n">rm</span> <span class="p">...</span>
<span class="c1">// clean the working place</span>

<span class="o">%</span><span class="n">files</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="p">.</span><span class="n">bin</span><span class="o">/</span><span class="n">hello</span>
<span class="c1">// files that need to be package inside the rpm</span>
</pre></table></code></div></div><p><strong>build the rpm</strong></p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
</pre><td class="rouge-code"><pre>
<span class="mi">1</span><span class="p">.</span> <span class="n">create</span> <span class="n">the</span> <span class="n">source</span> <span class="n">code</span><span class="p">.</span>

<span class="err">$</span> <span class="n">tar</span> <span class="o">-</span><span class="n">zxvf</span> <span class="n">hello</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>
<span class="c1">// 2 file inside</span>
<span class="n">hello</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span>
<span class="n">hello</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">hello</span><span class="p">.</span><span class="n">c</span>    <span class="c1">// the c program</span>
<span class="n">hello</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">Makefile</span>   <span class="c1">// makefile to compile it</span>


<span class="err">$</span> <span class="n">mkdir</span> <span class="n">hello</span><span class="o">-</span><span class="mi">1</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">vi</span> <span class="n">hello</span><span class="p">.</span><span class="n">c</span>
<span class="cp">#include</span> <span class="cpf">&lt;hellomake.h&gt;</span><span class="cp">
</span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// call a function in another file</span>
  <span class="n">myPrintHelloMake</span><span class="p">();</span>

  <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">vi</span> <span class="n">Makefile</span>
<span class="n">hellomake</span><span class="o">:</span> <span class="n">hellomake</span><span class="p">.</span><span class="n">c</span> <span class="n">hellofunc</span><span class="p">.</span><span class="n">c</span>
     <span class="n">gcc</span> <span class="o">-</span><span class="n">o</span> <span class="n">hellomake</span> <span class="n">hellomake</span><span class="p">.</span><span class="n">c</span> <span class="n">hellofunc</span><span class="p">.</span><span class="n">c</span> <span class="o">-</span><span class="n">I</span><span class="p">.</span>


<span class="err">$</span> <span class="n">tar</span> <span class="o">-</span><span class="n">czvf</span> <span class="n">hello</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">server1https</span><span class="o">:</span><span class="c1">//github.com/ocholuo/language/tree/master/0.project/webdemo/m4/hello-1</span>


<span class="cp"># sudo vi hello.spec
</span><span class="c1">// create</span>
<span class="n">Name</span><span class="o">:</span>       <span class="n">hello</span>
<span class="n">Version</span><span class="o">:</span>    <span class="mi">1</span>
<span class="n">Release</span><span class="o">:</span>    <span class="mi">1</span><span class="o">%</span><span class="p">{</span><span class="o">?</span><span class="n">dist</span><span class="p">}</span>
<span class="n">Summary</span><span class="o">:</span>    <span class="n">simple</span> <span class="n">hello</span> <span class="n">world</span> <span class="n">program</span> <span class="n">in</span> <span class="n">a</span> <span class="n">package</span>

<span class="n">License</span><span class="o">:</span>    <span class="n">MIT</span>
<span class="n">URL</span><span class="o">:</span>        <span class="n">www</span><span class="p">.</span><span class="n">pluralsight</span><span class="p">.</span><span class="n">com</span>
<span class="n">source0</span><span class="o">:</span>    <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">server1</span><span class="o">/</span><span class="n">rpmbuild</span><span class="o">/</span><span class="n">SOURCES</span><span class="o">/</span><span class="n">hello</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>

<span class="o">%</span><span class="n">description</span>
<span class="n">simple</span> <span class="n">hello</span> <span class="n">world</span> <span class="n">program</span> <span class="n">in</span> <span class="n">a</span> <span class="n">package</span>

<span class="o">%</span><span class="n">prep</span>
<span class="o">%</span><span class="n">setup</span> <span class="o">-</span><span class="n">q</span>

<span class="o">%</span><span class="n">build</span>
<span class="cp">#make
</span><span class="n">gcc</span> <span class="o">-</span><span class="n">o</span> <span class="n">hello</span> <span class="n">hello</span><span class="p">.</span><span class="n">c</span>

<span class="o">%</span><span class="n">install</span>
<span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="err">$</span><span class="n">RPM_BUILD_ROOT</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span>
<span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="err">$</span><span class="n">RPM_BUILD_ROOT</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span>
<span class="n">install</span> <span class="o">-</span><span class="n">m</span> <span class="mi">755</span> <span class="n">hello</span> <span class="err">$</span><span class="n">RPM_BUILD_ROOT</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">hello</span>

<span class="o">%</span><span class="n">clean</span>
<span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="err">$</span><span class="n">RPM_BUILD_ROOT</span>

<span class="o">%</span><span class="n">files</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">hello</span>


<span class="o">=====================================================</span>

<span class="err">$</span> <span class="n">ls</span>
<span class="n">hello</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>   <span class="c1">// the source file</span>
<span class="n">hello</span><span class="p">.</span><span class="n">spec</span>       <span class="c1">// the metadata, name, version, url, source, configuration</span>

<span class="o">=====================================================</span>
<span class="c1">// put in the right place</span>
<span class="err">$</span> <span class="n">mv</span> <span class="n">hello</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span> <span class="o">~/</span><span class="n">rpmbuild</span><span class="o">/</span><span class="n">SOURCES</span><span class="o">/</span>
<span class="err">$</span> <span class="n">mv</span> <span class="n">hello</span><span class="p">.</span><span class="n">spec</span> <span class="o">~/</span><span class="n">rpmbuild</span><span class="o">/</span><span class="n">SPECS</span><span class="o">/</span>

</pre></table></code></div></div><p>install from the source code</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">cd</span> <span class="o">~/</span><span class="n">rpmbuild</span><span class="o">/</span><span class="n">SOURCES</span>
<span class="err">$</span> <span class="n">wget</span> <span class="n">http</span><span class="o">:</span><span class="c1">//ftp.gnu.org/gnu/hello/hello-2.10.tar.gz -P ~/rpmbuild/SOURCES</span>

<span class="err">$</span> <span class="n">cd</span> <span class="o">~/</span><span class="n">rpmbuild</span><span class="o">/</span><span class="n">SPECS</span>
<span class="err">$</span> <span class="n">rpmdev</span><span class="o">-</span><span class="n">newspec</span> <span class="n">hello</span>
<span class="err">$</span> <span class="n">ls</span>
<span class="n">hello</span><span class="p">.</span><span class="n">spec</span>


<span class="err">$</span> <span class="n">vi</span> <span class="n">hello</span><span class="p">.</span><span class="n">spec</span>

<span class="n">Name</span><span class="o">:</span>           <span class="n">hello</span>
<span class="n">Version</span><span class="o">:</span>        <span class="mi">2</span><span class="p">.</span><span class="mi">10</span>
<span class="n">Release</span><span class="o">:</span>        <span class="mi">1</span><span class="o">%</span><span class="p">{</span><span class="o">?</span><span class="n">dist</span><span class="p">}</span>
<span class="n">Summary</span><span class="o">:</span>        <span class="n">The</span> <span class="s">"Hello World"</span> <span class="n">program</span> <span class="n">from</span> <span class="n">GNU</span>

<span class="n">License</span><span class="o">:</span>        <span class="n">GPLv3</span><span class="o">+</span>
<span class="n">URL</span><span class="o">:</span>            <span class="n">http</span><span class="o">:</span><span class="c1">//ftp.gnu.org/gnu/%{name}</span>
<span class="n">Source0</span><span class="o">:</span>        <span class="n">http</span><span class="o">:</span><span class="c1">//ftp.gnu.org/gnu/%{name}/%{name}-%{version}.tar.gz</span>

<span class="n">BuildRequires</span><span class="o">:</span> <span class="n">gettext</span>

<span class="n">Requires</span><span class="p">(</span><span class="n">post</span><span class="p">)</span><span class="o">:</span> <span class="n">info</span>
<span class="n">Requires</span><span class="p">(</span><span class="n">preun</span><span class="p">)</span><span class="o">:</span> <span class="n">info</span>

<span class="o">%</span><span class="n">description</span>
<span class="n">The</span> <span class="s">"Hello World"</span> <span class="n">program</span> <span class="n">package</span>

<span class="o">%</span><span class="n">prep</span>
<span class="o">%</span><span class="n">autosetup</span>

<span class="o">%</span><span class="n">build</span>
<span class="o">%</span><span class="n">configure</span>
<span class="n">make</span> <span class="o">%</span><span class="p">{</span><span class="n">make_build</span><span class="p">}</span>

<span class="o">%</span><span class="n">install</span>
<span class="o">%</span><span class="n">make_install</span>
<span class="o">%</span><span class="n">find_lang</span> <span class="o">%</span><span class="p">{</span><span class="n">name</span><span class="p">}</span>
<span class="n">rm</span> <span class="o">-</span><span class="n">f</span> <span class="o">%</span><span class="p">{</span><span class="n">buildroot</span><span class="p">}</span><span class="o">/%</span><span class="p">{</span><span class="n">_infodir</span><span class="p">}</span><span class="o">/</span><span class="n">dir</span>

<span class="o">%</span><span class="n">post</span>
<span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">install</span><span class="o">-</span><span class="n">info</span> <span class="o">%</span><span class="p">{</span><span class="n">_infodir</span><span class="p">}</span><span class="o">/%</span><span class="p">{</span><span class="n">name</span><span class="p">}.</span><span class="n">info</span> <span class="o">%</span><span class="p">{</span><span class="n">_infodir</span><span class="p">}</span><span class="o">/</span><span class="n">dir</span> <span class="o">||</span> <span class="o">:</span>

<span class="o">%</span><span class="n">preun</span>
<span class="k">if</span> <span class="p">[</span> <span class="err">$</span><span class="mi">1</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">]</span> <span class="p">;</span> <span class="n">then</span>
<span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">install</span><span class="o">-</span><span class="n">info</span> <span class="o">--</span><span class="n">delete</span> <span class="o">%</span><span class="p">{</span><span class="n">_infodir</span><span class="p">}</span><span class="o">/%</span><span class="p">{</span><span class="n">name</span><span class="p">}.</span><span class="n">info</span> <span class="o">%</span><span class="p">{</span><span class="n">_infodir</span><span class="p">}</span><span class="o">/</span><span class="n">dir</span> <span class="o">||</span> <span class="o">:</span>
<span class="n">fi</span>

<span class="o">%</span><span class="n">files</span> <span class="o">-</span><span class="n">f</span> <span class="o">%</span><span class="p">{</span><span class="n">name</span><span class="p">}.</span><span class="n">lang</span>
<span class="o">%</span><span class="p">{</span><span class="n">_mandir</span><span class="p">}</span><span class="o">/</span><span class="n">man1</span><span class="o">/</span><span class="n">hello</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="o">*</span>
<span class="o">%</span><span class="p">{</span><span class="n">_infodir</span><span class="p">}</span><span class="o">/</span><span class="n">hello</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="o">*</span>
<span class="o">%</span><span class="p">{</span><span class="n">_bindir</span><span class="p">}</span><span class="o">/</span><span class="n">hello</span>

<span class="o">%</span><span class="n">doc</span> <span class="n">AUTHORS</span> <span class="n">ChangeLog</span> <span class="n">NEWS</span> <span class="n">README</span> <span class="n">THANKS</span> <span class="n">TODO</span>
<span class="o">%</span><span class="n">license</span> <span class="n">COPYING</span>

<span class="cp">#%changelog
#* Tue May 28 2019 Aaron Kili
</span></pre></table></code></div></div><p><strong>build the rpm</strong></p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="c1">// built the rpm from source file</span>
<span class="err">$</span> <span class="n">cd</span> <span class="n">rpmbuild</span><span class="o">/</span><span class="n">SPECS</span><span class="o">/</span>
<span class="err">$</span> <span class="n">rpmbuild</span> <span class="o">-</span><span class="n">ba</span> <span class="n">hello</span><span class="p">.</span><span class="n">spec</span>

<span class="n">After</span> <span class="n">the</span> <span class="n">build</span> <span class="n">process</span><span class="p">,</span> <span class="n">the</span> <span class="n">source</span> <span class="n">RPMs</span> <span class="n">and</span> <span class="n">binary</span> <span class="n">RPMs</span> <span class="n">wills</span> <span class="n">be</span> <span class="n">created</span> <span class="n">in</span> <span class="n">the</span> <span class="p">..</span><span class="o">/</span><span class="n">SRPMS</span><span class="o">/</span> <span class="n">and</span> <span class="p">..</span><span class="o">/</span><span class="n">RPMS</span><span class="o">/</span> <span class="n">directories</span> <span class="n">respectively</span><span class="p">.</span>
<span class="n">use</span> <span class="n">the</span> <span class="n">rpmlint</span> <span class="n">program</span> <span class="n">to</span> <span class="n">check</span> <span class="n">and</span> <span class="n">ensure</span> <span class="n">that</span> <span class="n">the</span> <span class="n">spec</span> <span class="n">file</span> <span class="n">and</span> <span class="n">RPM</span> <span class="n">files</span> <span class="n">created</span> <span class="n">conform</span> <span class="n">to</span> <span class="n">RPM</span> <span class="n">design</span> <span class="n">rules</span><span class="o">:</span>


<span class="c1">// have the source rpm now</span>
<span class="err">$</span> <span class="n">ls</span> <span class="o">-</span><span class="n">R</span> <span class="n">rpmbuild</span><span class="o">/</span>

<span class="c1">// install</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">rpm</span> <span class="o">-</span><span class="n">ivh</span> <span class="n">rpmbuild</span><span class="o">/</span><span class="n">RPMS</span><span class="o">/</span><span class="n">x86_64</span><span class="o">/</span><span class="n">hello</span><span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="mi">10</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">x86_64</span><span class="p">.</span><span class="n">rpm</span>

<span class="c1">// query it</span>
<span class="err">$</span> <span class="n">rpm</span> <span class="o">-</span><span class="n">qi</span> <span class="n">hello</span>
</pre></table></code></div></div><hr /><h2 id="yum">yum</h2><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">zsh</span>
<span class="c1">// download, install, verify</span>

<span class="err">$</span> <span class="n">cd</span> <span class="n">rpmbuild</span><span class="o">/</span><span class="n">RPMS</span><span class="o">/</span><span class="n">x86_64</span><span class="o">/</span>
<span class="err">$</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">mc</span><span class="p">.</span><span class="n">rpm</span>
<span class="c1">// install package</span>


<span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">update</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="o">-</span><span class="n">y</span> <span class="n">update</span>
<span class="c1">// 1st step after installed</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">update</span> <span class="n">tuned</span>
</pre></table></code></div></div><p><strong>yum group</strong></p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
</pre><td class="rouge-code"><pre>
<span class="err">$</span> <span class="n">yum</span> <span class="n">group</span> <span class="n">list</span>
<span class="c1">// list the group</span>
<span class="n">Available</span> <span class="n">Environment</span> <span class="n">Groups</span><span class="o">:</span>
   <span class="n">Server</span>
   <span class="n">Minimal</span> <span class="n">Install</span>
   <span class="n">Workstation</span>
   <span class="n">KDE</span> <span class="n">Plasma</span> <span class="n">Workspaces</span>
   <span class="n">Virtualization</span> <span class="n">Host</span>
   <span class="n">Custom</span> <span class="n">Operating</span> <span class="n">System</span>
<span class="n">Installed</span> <span class="n">Environment</span> <span class="n">Groups</span><span class="o">:</span>
   <span class="n">Server</span> <span class="n">with</span> <span class="n">GUI</span>
<span class="n">Installed</span> <span class="n">Groups</span><span class="o">:</span>
   <span class="n">Container</span> <span class="n">Management</span>
   <span class="n">Development</span> <span class="n">Tools</span>
   <span class="n">Headless</span> <span class="n">Management</span>
<span class="n">Available</span> <span class="n">Groups</span><span class="o">:</span>
   <span class="p">.</span><span class="n">NET</span> <span class="n">Core</span> <span class="n">Development</span>
   <span class="n">RPM</span> <span class="n">Development</span> <span class="n">Tools</span>
   <span class="n">Graphical</span> <span class="n">Administration</span> <span class="n">Tools</span>
   <span class="n">Legacy</span> <span class="n">UNIX</span> <span class="n">Compatibility</span>
   <span class="n">Network</span> <span class="n">Servers</span>
   <span class="n">Scientific</span> <span class="n">Support</span>
   <span class="n">Security</span> <span class="n">Tools</span>
   <span class="n">Smart</span> <span class="n">Card</span> <span class="n">Support</span>
   <span class="n">System</span> <span class="n">Tools</span>
   <span class="n">Fedora</span> <span class="n">Packager</span>
   <span class="n">Xfce</span>


<span class="err">$</span> <span class="n">yum</span> <span class="n">group</span> <span class="n">info</span> <span class="s">"basic web server"</span>
<span class="c1">// see contend</span>
<span class="n">Group</span><span class="o">:</span> <span class="n">Basic</span> <span class="n">Web</span> <span class="n">Server</span>
 <span class="n">Description</span><span class="o">:</span> <span class="n">These</span> <span class="n">tools</span> <span class="n">allow</span> <span class="n">you</span> <span class="n">to</span> <span class="n">run</span> <span class="n">a</span> <span class="n">Web</span> <span class="n">server</span> <span class="n">on</span> <span class="n">the</span> <span class="n">system</span><span class="p">.</span>
 <span class="n">Mandatory</span> <span class="n">Packages</span><span class="o">:</span>
   <span class="n">httpd</span>
 <span class="n">Default</span> <span class="n">Packages</span><span class="o">:</span>
   <span class="n">httpd</span><span class="o">-</span><span class="n">manual</span>
   <span class="n">mod_fcgid</span>
   <span class="n">mod_ssl</span>
 <span class="n">Optional</span> <span class="n">Packages</span><span class="o">:</span>
   <span class="n">libmemcached</span>
   <span class="n">memcached</span>
   <span class="n">mod_auth_gssapi</span>
   <span class="n">mod_security</span>
   <span class="n">mod_security</span><span class="o">-</span><span class="n">mlogc</span>
   <span class="n">mod_security_crs</span>


<span class="err">$</span> <span class="n">yum</span> <span class="n">group</span> <span class="n">install</span> <span class="s">"basic web server"</span>
<span class="err">$</span> <span class="n">yum</span> <span class="n">group</span> <span class="n">remove</span> <span class="s">"basic web server"</span>


<span class="err">$</span> <span class="n">yum</span> <span class="n">list</span> <span class="n">tuned</span>
<span class="c1">// info</span>
<span class="n">Installed</span> <span class="n">Packages</span>
<span class="n">tuned</span><span class="p">.</span><span class="n">noarch</span>                      <span class="mi">2</span><span class="p">.</span><span class="mi">12</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="n">el8_1</span><span class="p">.</span><span class="mi">1</span>                       <span class="err">@</span><span class="n">BaseOS</span>


<span class="err">$</span> <span class="n">yum</span> <span class="n">search</span> <span class="n">tuned</span>
<span class="c1">// package that it showup</span>

<span class="err">$</span> <span class="n">yum</span> <span class="n">info</span> <span class="n">tuned</span>
<span class="c1">// metadata</span>

<span class="err">$</span> <span class="n">yum</span> <span class="n">provides</span> <span class="n">top</span>
<span class="c1">// ask</span>
<span class="err">$</span> <span class="n">yum</span> <span class="n">provides</span> <span class="n">top</span>
<span class="n">Last</span> <span class="n">metadata</span> <span class="n">expiration</span> <span class="n">check</span><span class="o">:</span> <span class="mi">0</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mo">00</span> <span class="n">ago</span> <span class="n">on</span> <span class="n">Sun</span> <span class="mi">26</span> <span class="n">Apr</span> <span class="mi">2020</span> <span class="mo">02</span><span class="o">:</span><span class="mi">54</span><span class="o">:</span><span class="mi">57</span> <span class="n">PM</span> <span class="n">EDT</span><span class="p">.</span>
<span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">i686</span> <span class="o">:</span> <span class="n">System</span> <span class="n">and</span> <span class="n">process</span> <span class="n">monitoring</span> <span class="n">utilities</span>
<span class="n">Repo</span>        <span class="o">:</span> <span class="n">BaseOS</span>
<span class="n">Matched</span> <span class="n">from</span><span class="o">:</span>
<span class="n">Filename</span>    <span class="o">:</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">top</span>

<span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">x86_64</span> <span class="o">:</span> <span class="n">System</span> <span class="n">and</span> <span class="n">process</span> <span class="n">monitoring</span> <span class="n">utilities</span>
<span class="n">Repo</span>        <span class="o">:</span> <span class="err">@</span><span class="n">System</span>
<span class="n">Matched</span> <span class="n">from</span><span class="o">:</span>
<span class="n">Filename</span>    <span class="o">:</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">top</span>

<span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">x86_64</span> <span class="o">:</span> <span class="n">System</span> <span class="n">and</span> <span class="n">process</span> <span class="n">monitoring</span> <span class="n">utilities</span>
<span class="n">Repo</span>        <span class="o">:</span> <span class="n">BaseOS</span>
<span class="n">Matched</span> <span class="n">from</span><span class="o">:</span>
<span class="n">Filename</span>    <span class="o">:</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">top</span>


<span class="err">$</span> <span class="n">yum</span> <span class="n">list</span> <span class="n">installed</span>
<span class="c1">// list all Installed</span>

<span class="err">$</span> <span class="n">yumdownloader</span> <span class="n">procps</span><span class="o">-</span><span class="n">ng</span>
<span class="c1">// downloader specific packages, then install on other pc</span>
<span class="p">[</span><span class="n">SKIPPED</span><span class="p">]</span> <span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">i686</span><span class="p">.</span><span class="n">rpm</span><span class="o">:</span> <span class="n">Already</span> <span class="n">downloaded</span>
<span class="p">[</span><span class="n">SKIPPED</span><span class="p">]</span> <span class="n">procps</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">15</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">x86_64</span><span class="p">.</span><span class="n">rpm</span><span class="o">:</span> <span class="n">Already</span> <span class="n">downloaded</span>
</pre></table></code></div></div><hr /><h2 id="repository">repository</h2><p>store software package</p><ul><li>software publisher: Redhat, CentOS<li>third party: EPEL(extra packages for enterprise linux), RPMForge<li>build you own.</ul><p>trusted and authenticated</p><p><code class="language-plaintext highlighter-rouge">/etc/yum.repos.d</code>: all repo configuration file</p><p><code class="language-plaintext highlighter-rouge">/var/repo/dvd</code>: put custom.repo file</p><h3 id="1-repository-configuration">1. <strong>repository configuration</strong></h3><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
</pre><td class="rouge-code"><pre><span class="c1">// yum configuration file</span>
<span class="err">$</span> <span class="n">more</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">yum</span><span class="p">.</span><span class="n">conf</span>
<span class="p">[</span><span class="n">main</span><span class="p">]</span>
<span class="n">cachedir</span><span class="o">=/</span><span class="n">var</span><span class="o">/</span><span class="n">cache</span><span class="o">/</span><span class="n">yum</span><span class="o">/</span><span class="err">$</span><span class="n">basearch</span><span class="o">/</span><span class="err">$</span><span class="n">releasever</span>  <span class="c1">//where YUM caches packages locally with performing installations.</span>
<span class="n">keepcache</span><span class="o">=</span><span class="mi">0</span>                <span class="c1">//  after done installation, delete the cache</span>
<span class="n">debuglevel</span><span class="o">=</span><span class="mi">2</span>
<span class="n">logfile</span><span class="o">=/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">yum</span><span class="p">.</span><span class="n">log</span>
<span class="n">exactarch</span><span class="o">=</span><span class="mi">1</span>
<span class="n">obsoletes</span><span class="o">=</span><span class="mi">1</span>
<span class="n">gpgcheck</span><span class="o">=</span><span class="mi">1</span>
<span class="n">plugins</span><span class="o">=</span><span class="mi">1</span>
<span class="n">installonly_limit</span><span class="o">=</span><span class="mi">3</span>
<span class="cp"># PUT YOUR REPOS HERE OR IN separate files named file.repo in /etc/yum.repos.d
</span>

<span class="err">$</span> <span class="n">cd</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">yum</span><span class="p">.</span><span class="n">repos</span><span class="p">.</span><span class="n">d</span>
<span class="err">$</span> <span class="n">ls</span>
<span class="n">CentOS</span><span class="o">-</span><span class="n">AppStream</span><span class="p">.</span><span class="n">repo</span>   <span class="n">CentOS</span><span class="o">-</span><span class="n">Extras</span><span class="p">.</span><span class="n">repo</span>      <span class="n">CentOS</span><span class="o">-</span><span class="n">Vault</span><span class="p">.</span><span class="n">repo</span>
<span class="n">CentOS</span><span class="o">-</span><span class="n">Base</span><span class="p">.</span><span class="n">repo</span>        <span class="n">CentOS</span><span class="o">-</span><span class="n">fasttrack</span><span class="p">.</span><span class="n">repo</span>   <span class="n">epel</span><span class="o">-</span><span class="n">modular</span><span class="p">.</span><span class="n">repo</span>
<span class="n">CentOS</span><span class="o">-</span><span class="n">centosplus</span><span class="p">.</span><span class="n">repo</span>  <span class="n">CentOS</span><span class="o">-</span><span class="n">HA</span><span class="p">.</span><span class="n">repo</span>          <span class="n">epel</span><span class="o">-</span><span class="n">playground</span><span class="p">.</span><span class="n">repo</span>
<span class="n">CentOS</span><span class="o">-</span><span class="n">CR</span><span class="p">.</span><span class="n">repo</span>          <span class="n">CentOS</span><span class="o">-</span><span class="n">Media</span><span class="p">.</span><span class="n">repo</span>       <span class="n">epel</span><span class="p">.</span><span class="n">repo</span>
<span class="n">CentOS</span><span class="o">-</span><span class="n">Debuginfo</span><span class="p">.</span><span class="n">repo</span>   <span class="n">CentOS</span><span class="o">-</span><span class="n">PowerTools</span><span class="p">.</span><span class="n">repo</span>  <span class="n">epel</span><span class="o">-</span><span class="n">testing</span><span class="o">-</span><span class="n">modular</span><span class="p">.</span><span class="n">repo</span>
<span class="n">CentOS</span><span class="o">-</span><span class="n">Devel</span><span class="p">.</span><span class="n">repo</span>       <span class="n">CentOS</span><span class="o">-</span><span class="n">Sources</span><span class="p">.</span><span class="n">repo</span>     <span class="n">epel</span><span class="o">-</span><span class="n">testing</span><span class="p">.</span><span class="n">repo</span>


<span class="err">$</span> <span class="n">more</span> <span class="n">CentOS</span><span class="o">-</span><span class="n">Base</span><span class="p">.</span><span class="n">repo</span>
<span class="c1">// check one of it</span>
<span class="cp"># CentOS-Base.repo
# The mirror system uses the connecting IP address of the client and the update status of each mirror to pick mirrors that are updated to and geographically close to the client.  You should use this for CentOS updates unless you are manually picking other mirrors.
# If the mirrorlist= does not work for you, as a fall back you can try the remarked out baseurl= line instead.
</span>
<span class="p">[</span><span class="n">BaseOS</span><span class="p">]</span>
<span class="n">name</span><span class="o">=</span><span class="n">CentOS</span><span class="o">-</span><span class="err">$</span><span class="n">releasever</span> <span class="o">-</span> <span class="n">Base</span>
<span class="n">mirrorlist</span><span class="o">=</span><span class="n">http</span><span class="o">:</span><span class="c1">//mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo</span>
<span class="o">=</span><span class="n">BaseOS</span><span class="o">&amp;</span><span class="n">infra</span><span class="o">=</span><span class="err">$</span><span class="n">infra</span>
<span class="c1">// a copy of the package to download from</span>
<span class="cp">#baseurl=http://mirror.centos.org/$contentdir/$releasever/BaseOS/$basearch/os/
</span><span class="n">gpgcheck</span><span class="o">=</span><span class="mi">1</span>
<span class="c1">// enabled=one. authenticates the remote repository with a digital signature, gpgkey.</span>
<span class="n">gpgkey</span><span class="o">=</span><span class="n">file</span><span class="o">:</span><span class="c1">///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial</span>
<span class="c1">//local copy of the key provided from the repo.</span>
<span class="n">enabled</span><span class="o">=</span><span class="mi">1</span>
<span class="c1">// enabled = 0: turns this repository off from bing used when use the YUM commands to administer the packages on system. useful if no longer want or need packages from a particular repository.</span>


<span class="c1">// see all enabled repo on system</span>
<span class="err">$</span> <span class="n">yum</span> <span class="n">repolist</span>
<span class="n">Last</span> <span class="n">metadata</span> <span class="n">expiration</span> <span class="n">check</span><span class="o">:</span> <span class="mi">5</span><span class="o">:</span><span class="mi">19</span><span class="o">:</span><span class="mo">07</span> <span class="n">ago</span> <span class="n">on</span> <span class="n">Sun</span> <span class="mi">26</span> <span class="n">Apr</span> <span class="mi">2020</span> <span class="mo">02</span><span class="o">:</span><span class="mi">54</span><span class="o">:</span><span class="mi">57</span> <span class="n">PM</span> <span class="n">EDT</span><span class="p">.</span>
<span class="n">repo</span> <span class="n">id</span>         <span class="n">repo</span> <span class="n">name</span>                                                 <span class="n">status</span>
<span class="n">AppStream</span>       <span class="n">CentOS</span><span class="o">-</span><span class="mi">8</span> <span class="o">-</span> <span class="n">AppStream</span>                                      <span class="mi">4</span><span class="p">,</span><span class="mi">830</span>
<span class="n">BaseOS</span>          <span class="n">CentOS</span><span class="o">-</span><span class="mi">8</span> <span class="o">-</span> <span class="n">Base</span>                                           <span class="mi">1</span><span class="p">,</span><span class="mi">661</span>
<span class="n">PowerTools</span>      <span class="n">CentOS</span><span class="o">-</span><span class="mi">8</span> <span class="o">-</span> <span class="n">PowerTools</span>                                     <span class="mi">1</span><span class="p">,</span><span class="mi">456</span>
<span class="o">*</span><span class="n">epel</span>           <span class="n">Extra</span> <span class="n">Packages</span> <span class="k">for</span> <span class="n">Enterprise</span> <span class="n">Linux</span> <span class="mi">8</span> <span class="o">-</span> <span class="n">x86_64</span>            <span class="mi">5</span><span class="p">,</span><span class="mi">352</span>
<span class="o">*</span><span class="n">epel</span><span class="o">-</span><span class="n">modular</span>   <span class="n">Extra</span> <span class="n">Packages</span> <span class="k">for</span> <span class="n">Enterprise</span> <span class="n">Linux</span> <span class="n">Modular</span> <span class="mi">8</span> <span class="o">-</span> <span class="n">x86_64</span>        <span class="mi">0</span>
<span class="n">extras</span>          <span class="n">CentOS</span><span class="o">-</span><span class="mi">8</span> <span class="o">-</span> <span class="n">Extras</span>                                            <span class="mi">15</span>

<span class="err">$</span> <span class="n">yum</span> <span class="o">-</span><span class="n">v</span> <span class="n">repolist</span>
<span class="c1">// more version detail info</span>
<span class="n">Repo</span><span class="o">-</span><span class="n">id</span>      <span class="o">:</span> <span class="n">AppStream</span>
<span class="n">Repo</span><span class="o">-</span><span class="n">name</span>    <span class="o">:</span> <span class="n">CentOS</span><span class="o">-</span><span class="mi">8</span> <span class="o">-</span> <span class="n">AppStream</span>
<span class="n">Repo</span><span class="o">-</span><span class="n">revision</span><span class="o">:</span> <span class="mi">8</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1911</span>
<span class="n">Repo</span><span class="o">-</span><span class="n">distro</span><span class="o">-</span><span class="n">tags</span><span class="o">:</span> <span class="p">[</span><span class="n">cpe</span><span class="o">:/</span><span class="n">o</span><span class="o">:</span><span class="n">centos</span><span class="o">:</span><span class="n">centos</span><span class="o">:</span><span class="mi">8</span><span class="p">]</span><span class="o">:</span>  <span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">t</span>
<span class="n">Repo</span><span class="o">-</span><span class="n">updated</span> <span class="o">:</span> <span class="n">Wed</span> <span class="mi">22</span> <span class="n">Apr</span> <span class="mi">2020</span> <span class="mo">01</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mo">06</span> <span class="n">AM</span> <span class="n">EDT</span>
<span class="n">Repo</span><span class="o">-</span><span class="n">pkgs</span>    <span class="o">:</span> <span class="mi">4</span><span class="p">,</span><span class="mi">830</span>
<span class="n">Repo</span><span class="o">-</span><span class="n">size</span>    <span class="o">:</span> <span class="mi">5</span><span class="p">.</span><span class="mi">6</span> <span class="n">G</span>
<span class="n">Repo</span><span class="o">-</span><span class="n">mirrors</span> <span class="o">:</span> <span class="n">http</span><span class="o">:</span><span class="c1">//mirrorlist.centos.org/?release=8&amp;arch=x86_64&amp;repo=AppStream&amp;infra=stock</span>
<span class="n">Repo</span><span class="o">-</span><span class="n">baseurl</span> <span class="o">:</span> <span class="n">http</span><span class="o">:</span><span class="c1">//mirrors.xtom.com/centos/8.1.1911/AppStream/x86_64/os/ (9 more)</span>
<span class="n">Repo</span><span class="o">-</span><span class="n">expire</span>  <span class="o">:</span> <span class="mi">172</span><span class="p">,</span><span class="mi">800</span> <span class="n">second</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="p">(</span><span class="n">last</span><span class="o">:</span> <span class="n">Sun</span> <span class="mi">26</span> <span class="n">Apr</span> <span class="mi">2020</span> <span class="mo">02</span><span class="o">:</span><span class="mi">54</span><span class="o">:</span><span class="mi">15</span> <span class="n">PM</span> <span class="n">EDT</span><span class="p">)</span>
<span class="n">Repo</span><span class="o">-</span><span class="n">filename</span><span class="o">:</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">yum</span><span class="p">.</span><span class="n">repos</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">CentOS</span><span class="o">-</span><span class="n">AppStream</span><span class="p">.</span><span class="n">repo</span>
<span class="c1">// actual location</span>
</pre></table></code></div></div><h3 id="2-create-own-local-repository-base-on-dvd-of-centos">2. <strong>create own local repository base on DVD of CentOS</strong></h3><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
</pre><td class="rouge-code"><pre><span class="n">install</span> <span class="n">and</span> <span class="n">save</span> <span class="n">network</span> <span class="n">resource</span>
<span class="n">download</span> <span class="n">dvd</span> <span class="n">iso</span> <span class="n">and</span> <span class="n">make</span> <span class="n">a</span> <span class="n">yum</span> <span class="n">repo</span> <span class="n">configuration</span><span class="p">,</span> <span class="n">use</span> <span class="n">that</span> <span class="n">to</span> <span class="n">install</span> <span class="n">the</span> <span class="n">rpm</span><span class="p">.</span>

<span class="n">ref</span><span class="o">:</span>
<span class="n">https</span><span class="o">:</span><span class="c1">//www.itzgeek.com/how-tos/linux/centos-how-tos/create-local-yum-repository-on-centos-7-rhel-7-using-dvd.html</span>
<span class="n">https</span><span class="o">:</span><span class="c1">//www.tecmint.com/setup-local-http-yum-repository-on-centos-7/</span>
<span class="n">https</span><span class="o">:</span><span class="c1">//phoenixnap.com/kb/create-local-yum-repository-centos</span>
<span class="o">============================================</span>


<span class="err">$</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">createrepo</span>


<span class="o">-</span> <span class="n">make</span> <span class="n">a</span> <span class="n">dir</span> <span class="n">to</span> <span class="n">mount</span> <span class="n">the</span> <span class="n">dvd</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">repo</span><span class="o">/</span><span class="n">dvd</span>

<span class="c1">// If the CD has been mounted automatically, then ignore this step. Otherwise, mount it manually.</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">mount</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sr0</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">repo</span><span class="o">/</span><span class="n">dvd</span>
<span class="err">$</span> <span class="n">ls</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">repo</span><span class="o">/</span><span class="n">dvd</span>      <span class="c1">// content of the centos dvd</span>

<span class="c1">// If the ISO is present on the file system, mount it to /media/CentOS using the mount command with -o loop option.</span>
<span class="err">$</span> <span class="n">mount</span> <span class="o">-</span><span class="n">o</span> <span class="n">loop</span> <span class="n">CentOS</span><span class="o">-</span><span class="n">DVD1</span><span class="p">.</span><span class="n">iso</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">repo</span><span class="o">/</span><span class="n">dvd</span>

<span class="err">$</span> <span class="n">ls</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">repo</span><span class="o">/</span><span class="n">dvd</span>
<span class="n">AppStream</span>  <span class="n">BaseOS</span>  <span class="n">EFI</span>  <span class="n">images</span>  <span class="n">isolinux</span>  <span class="n">media</span><span class="p">.</span><span class="n">repo</span>  <span class="n">TRANS</span><span class="p">.</span><span class="n">TBL</span>

<span class="err">$</span> <span class="n">more</span> <span class="n">media</span><span class="p">.</span><span class="n">repo</span>
<span class="p">[</span><span class="n">InstallMedia</span><span class="p">]</span>
<span class="n">name</span><span class="o">=</span><span class="n">CentOS</span> <span class="n">Linux</span> <span class="mi">8</span>
<span class="n">mediaid</span><span class="o">=</span><span class="n">None</span>
<span class="n">metadata_expire</span><span class="o">=-</span><span class="mi">1</span>
<span class="n">gpgcheck</span><span class="o">=</span><span class="mi">0</span>
<span class="n">cost</span><span class="o">=</span><span class="mi">500</span>

<span class="o">============================================</span>

<span class="o">-</span> <span class="n">create</span> <span class="n">the</span> <span class="n">repo</span> <span class="n">configuration</span>

<span class="err">$</span> <span class="n">cd</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">yum</span><span class="p">.</span><span class="n">repos</span><span class="p">.</span><span class="n">d</span>
<span class="err">$</span> <span class="n">cp</span> <span class="o">-</span><span class="n">v</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">repo</span><span class="o">/</span><span class="n">dvd</span><span class="o">/</span><span class="n">media</span><span class="p">.</span><span class="n">repo</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">yum</span><span class="p">.</span><span class="n">repos</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">local</span><span class="o">-</span><span class="n">centos8</span><span class="p">.</span><span class="n">repo</span>

<span class="c1">// assign file permissions as shown to prevent modification or alteration by other users.</span>
<span class="cp"># chmod 644 /etc/yum.repos.d/local-centos8.repo
# ls -l /etc/yum.repos.d/local-centos8.repo
</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">yum</span><span class="p">.</span><span class="n">repos</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">local</span><span class="o">-</span><span class="n">centos8</span><span class="p">.</span><span class="n">repo</span>
<span class="c1">// add</span>
<span class="p">[</span><span class="n">Local</span><span class="o">-</span><span class="n">Centos8</span><span class="o">-</span><span class="n">baseOS</span><span class="p">]</span>
<span class="n">name</span><span class="o">=</span><span class="n">Local</span><span class="o">-</span><span class="n">CentOS8</span><span class="o">-</span><span class="n">BaseOS</span>
<span class="n">metadata_expire</span><span class="o">=-</span><span class="mi">1</span>
<span class="n">enabled</span><span class="o">=</span><span class="mi">1</span>
<span class="n">baseurl</span><span class="o">=</span><span class="n">file</span><span class="o">:</span><span class="c1">///var/repo/dvd/BaseOS/</span>
<span class="n">gpgcheck</span><span class="o">=</span><span class="mi">0</span>

<span class="p">[</span><span class="n">Local</span><span class="o">-</span><span class="n">Centos8</span><span class="o">-</span><span class="n">AppStream</span><span class="p">]</span>
<span class="n">name</span><span class="o">=</span><span class="n">Local</span><span class="o">-</span><span class="n">CentOS8</span><span class="o">-</span><span class="n">AppStream</span>
<span class="n">metadata_expire</span><span class="o">=-</span><span class="mi">1</span>
<span class="n">enabled</span><span class="o">=</span><span class="mi">1</span>
<span class="n">baseurl</span><span class="o">=</span><span class="n">file</span><span class="o">:</span><span class="c1">///var/repo/dvd/AppStream/</span>
<span class="n">gpgcheck</span><span class="o">=</span><span class="mi">0</span>

<span class="c1">//After modifying the repository file with new entries, proceed and clear the DNF / YUM cache as shown.</span>
<span class="err">$</span> <span class="n">yum</span> <span class="n">clean</span> <span class="n">all</span>

<span class="o">============================================</span>

<span class="o">-</span> <span class="n">disable</span> <span class="n">other</span> <span class="n">repo</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">vi</span> <span class="n">xx</span><span class="p">.</span><span class="n">repo</span>
<span class="c1">//add</span>
<span class="n">enable</span><span class="o">=</span><span class="mi">0</span>


<span class="o">-</span> <span class="n">check</span>
<span class="err">$</span> <span class="n">yum</span> <span class="n">repolist</span>
<span class="n">repo</span> <span class="n">id</span>                 <span class="n">repo</span> <span class="n">name</span>                                           <span class="n">status</span>
<span class="n">AppStream</span>               <span class="n">CentOS</span><span class="o">-</span><span class="mi">8</span> <span class="o">-</span> <span class="n">AppStream</span>                                <span class="mi">5</span><span class="p">,</span><span class="mi">402</span>
<span class="n">BaseOS</span>                  <span class="n">CentOS</span><span class="o">-</span><span class="mi">8</span> <span class="o">-</span> <span class="n">Base</span>                                     <span class="mi">1</span><span class="p">,</span><span class="mi">661</span>
<span class="n">Local</span><span class="o">-</span><span class="n">Centos8</span><span class="o">-</span><span class="n">AppStream</span> <span class="n">Local</span><span class="o">-</span><span class="n">CentOS8</span><span class="o">-</span><span class="n">AppStream</span>                             <span class="mi">4</span><span class="p">,</span><span class="mi">754</span>
<span class="n">Local</span><span class="o">-</span><span class="n">Centos8</span><span class="o">-</span><span class="n">baseOS</span>    <span class="n">Local</span><span class="o">-</span><span class="n">CentOS8</span><span class="o">-</span><span class="n">BaseOS</span>                                <span class="mi">1</span><span class="p">,</span><span class="mi">659</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">vsftpd</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">ypserv</span>
<span class="o">================================================================================</span>
 <span class="n">Package</span>         <span class="n">Arch</span>      <span class="n">Version</span>                           <span class="n">Repository</span>    <span class="n">Size</span>
<span class="o">================================================================================</span>
<span class="n">Installing</span><span class="o">:</span>
 <span class="n">ypserv</span>          <span class="n">x86_64</span>    <span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">6</span><span class="p">.</span><span class="mi">20170331</span><span class="n">git5bfba76</span><span class="p">.</span><span class="n">el8</span>      <span class="n">Local</span>     <span class="mi">171</span> <span class="n">k</span>
<span class="n">Installing</span> <span class="n">dependencies</span><span class="o">:</span>
 <span class="n">tokyocabinet</span>    <span class="n">x86_64</span>    <span class="mi">1</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">48</span><span class="o">-</span><span class="mi">10</span><span class="p">.</span><span class="n">el8</span>                     <span class="n">Local</span>     <span class="mi">486</span> <span class="n">k</span>


<span class="o">-</span> <span class="n">clean</span> <span class="n">the</span> <span class="n">cache</span>
<span class="err">$</span> <span class="n">yum</span> <span class="n">clean</span> <span class="n">all</span>
</pre></table></code></div></div><h3 id="3-create-own-http-based-repository">3. <strong>create own HTTP based repository</strong></h3><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
</pre><td class="rouge-code"><pre>
<span class="n">Step</span> <span class="mi">1</span><span class="o">:</span> <span class="n">setup</span> <span class="n">Web</span> <span class="n">Server</span>

<span class="err">$</span> <span class="n">yum</span> <span class="n">list</span> <span class="n">httpd</span>
<span class="err">$</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">zone</span><span class="o">=</span><span class="n">public</span> <span class="o">--</span><span class="n">permanent</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">service</span><span class="o">=</span><span class="n">http</span>
<span class="err">$</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">zone</span><span class="o">=</span><span class="n">public</span> <span class="o">--</span><span class="n">permanent</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">service</span><span class="o">=</span><span class="n">https</span>
<span class="err">$</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">reload</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">httpd</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">httpd</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">status</span> <span class="n">httpd</span>
<span class="c1">// confirm that server is up and running</span>
<span class="n">http</span><span class="o">:</span><span class="c1">//192.168.1.1</span>


<span class="n">Step</span> <span class="mi">2</span><span class="o">:</span> <span class="n">Create</span> <span class="n">Yum</span> <span class="n">Local</span> <span class="n">Repository</span>

<span class="err">$</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">createrepo</span>
<span class="err">$</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">yum</span><span class="o">-</span><span class="n">utils</span>
<span class="c1">// a better toolbox for managing repositories</span>


<span class="o">-</span> <span class="n">create</span> <span class="n">directory</span><span class="o">:</span> <span class="n">path</span> <span class="n">of</span> <span class="n">the</span> <span class="n">http</span> <span class="n">repo</span> <span class="n">in</span> <span class="n">file</span> <span class="n">system</span>
<span class="c1">// create the necessary directories (yum repositories) that will store packages and any related information.</span>
<span class="err">$</span> <span class="n">ls</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span>
<span class="n">index</span><span class="p">.</span><span class="n">html</span>
<span class="err">$</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">custom</span>

<span class="c1">// synchronize CentOS YUM repositories to the local directories as shown.</span>
<span class="c1">// $ sudo reposync -m --repoid=BaseOS --newest-only --download-metadata -p DOWNLOAD_PATH=/var/www/html/repos/</span>


<span class="n">Step</span> <span class="mi">3</span><span class="o">:</span> <span class="n">Create</span> <span class="n">a</span> <span class="n">Directory</span> <span class="n">to</span> <span class="n">Store</span> <span class="n">the</span> <span class="n">Repositories</span>

<span class="o">-</span> <span class="n">create</span> <span class="n">repo</span> <span class="n">configuration</span> <span class="n">file</span><span class="o">:</span> <span class="n">custom</span> <span class="n">repo</span><span class="p">.</span>

<span class="err">$</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">yum</span><span class="p">.</span><span class="n">repos</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">custom</span><span class="p">.</span><span class="n">repo</span>
<span class="c1">// change</span>
<span class="p">[</span><span class="n">http</span><span class="p">]</span>
<span class="n">name</span><span class="o">=</span><span class="n">Local</span> <span class="n">HTTP</span> <span class="n">repository</span>
<span class="n">baseurl</span><span class="o">=</span><span class="n">http</span><span class="o">:</span><span class="c1">//192.168.1.1/custom</span>
<span class="c1">// default http Document root for HTTP server</span>
<span class="n">enabled</span><span class="o">=</span><span class="mi">1</span>
<span class="n">gpgcheck</span><span class="o">=</span><span class="mi">0</span>
<span class="c1">// for system want to use this repo</span>
<span class="c1">// just take this custom.repo file put it in /etc/yum.repos.d on that servers</span>


<span class="n">Step</span> <span class="mi">4</span><span class="o">:</span> <span class="n">add</span> <span class="n">own</span> <span class="n">custom</span> <span class="n">built</span> <span class="n">package</span> <span class="n">to</span> <span class="n">repositories</span>

<span class="o">-</span> <span class="n">put</span> <span class="n">package</span> <span class="n">inside</span>
<span class="err">$</span> <span class="n">cd</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">custom</span><span class="o">/</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">yumdownloader</span> <span class="n">ypserv</span>
<span class="err">$</span> <span class="n">ls</span>
<span class="n">ypserv</span><span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">6</span><span class="p">.</span><span class="mi">20170331</span><span class="n">git5bfba76</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">x86_64</span><span class="p">.</span><span class="n">rpm</span>



<span class="n">Step</span> <span class="mi">5</span><span class="o">:</span> <span class="n">Create</span> <span class="n">the</span> <span class="n">New</span> <span class="n">Repository</span>

<span class="c1">// create the repo metadata database about the repo</span>
<span class="c1">// each time add packages</span>
<span class="p">[</span><span class="n">server1</span><span class="err">@</span><span class="n">server0</span> <span class="n">custom</span><span class="p">]</span><span class="err">$</span> <span class="n">sudo</span> <span class="n">createrepo</span> <span class="p">.</span>
<span class="n">Directory</span> <span class="n">walk</span> <span class="n">started</span>
<span class="n">Directory</span> <span class="n">walk</span> <span class="n">done</span> <span class="o">-</span> <span class="mi">1</span> <span class="n">packages</span>
<span class="n">Temporary</span> <span class="n">output</span> <span class="n">repo</span> <span class="n">path</span><span class="o">:</span> <span class="p">.</span><span class="o">/</span><span class="p">.</span><span class="n">repodata</span><span class="o">/</span>
<span class="n">Preparing</span> <span class="n">sqlite</span> <span class="n">DBs</span>
<span class="n">Pool</span> <span class="n">started</span> <span class="p">(</span><span class="n">with</span> <span class="mi">5</span> <span class="n">workers</span><span class="p">)</span>
<span class="n">Pool</span> <span class="n">finished</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">clean</span> <span class="n">all</span> <span class="c1">//clean cache</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">makecache</span> <span class="c1">// update repo info</span>

</pre></table></code></div></div><hr /><h2 id="configure-and-manage-nfs-share-resource">configure and manage NFS, share resource</h2><p><code class="language-plaintext highlighter-rouge">exports</code>: shared resources</p><ul><li>in /etc/exports:<ul><li>/share1 server1.psdemo.local<li>rw/ro: read only<li>async/sync:<ul><li>trade off of the perform and safety<li>server reply the right request when the I/O flush/commit to disc<li>write acknowledgement</ul><li>edelay: delay write to disc. if NFS knows other request in coming soon.<li>root_squash: client request come as root, UID 0, NFS map the UID to anonymous. prevent root access.<li>all_squash:<ul><li>all users map to an anonymous user. when resource for public with low security.</ul><li>sec=krb5, krb5i, krb5p<ul><li>authentication settings. default=sys<li>krb5 = user authentication only<li>krb5i = add integrity checking<li>krb5p = add Encryption, most secure.</ul></ul></ul><p><code class="language-plaintext highlighter-rouge">exportfs</code> update and maintains a table of exports in server.</p><p>table path: /var/lib/nfs/etab table holds the run time configuration of exports</p><p>host:</p><ul><li>single machine:<ul><li>IP/name: <code class="language-plaintext highlighter-rouge">server1.psdemo.local</code></ul><li>IP network:<ul><li>CIDR Notation: <code class="language-plaintext highlighter-rouge">192.168.2.0/25</code></ul><li>range: * ? [a-z]<ul><li><code class="language-plaintext highlighter-rouge">*.psdemo.local</code><li><code class="language-plaintext highlighter-rouge">server?.psdemo.local</code> : any single value character.<li><code class="language-plaintext highlighter-rouge">server[2-9].psdemo.local</code></ul></ul><ol><li><p>runtime mounting: mount -t nfs -o rw server0.psdemo.local:/share1 /mnt/share1</p><li><p>persistent mounting: (keep mount after reboot) /etc/fstab server0.psdemo.local:/share1 /mnt/share1 nfs rw 0 0</p><li><p>dynamic/on demand mounting: autofs</p><li><p>global server-level/mount-point-level NFS options: /etc/nfsmount.conf</p></ol><h3 id="runtime-mount">runtime mount</h3><p>server0:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
</pre><td class="rouge-code"><pre>
<span class="n">step</span> <span class="mi">1</span><span class="p">.</span> <span class="n">install</span> <span class="n">nfs</span> <span class="n">server</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">nfs</span><span class="o">-</span><span class="n">utils</span>
<span class="err">$</span> <span class="n">yum</span> <span class="n">info</span> <span class="n">nfs</span><span class="o">-</span><span class="n">utils</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">nfs</span><span class="o">-</span><span class="n">server</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">nfs</span><span class="o">-</span><span class="n">server</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">status</span> <span class="n">nfs</span><span class="o">-</span><span class="n">server</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">rpcbind</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">rpcbind</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">status</span> <span class="n">rpcbind</span>


<span class="err">$</span> <span class="n">sudo</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">permanent</span> <span class="o">--</span><span class="n">zone</span><span class="o">=</span><span class="n">public</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">service</span><span class="o">=</span><span class="n">nfs</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">permanent</span> <span class="o">--</span><span class="n">zone</span><span class="o">=</span><span class="n">public</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">service</span><span class="o">=</span><span class="n">rpc</span><span class="o">-</span><span class="n">bind</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">permanent</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">service</span><span class="o">=</span><span class="n">mountd</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">reload</span>


<span class="n">step</span> <span class="mi">2</span><span class="p">.</span> <span class="n">setup</span> <span class="n">DNS</span> <span class="n">to</span> <span class="n">manage</span> <span class="n">naming</span> <span class="n">of</span> <span class="n">system</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span>
<span class="c1">// modify</span>
<span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span>   <span class="n">localhost</span> <span class="n">localhost</span><span class="p">.</span><span class="n">localdomain</span> <span class="n">localhost4</span> <span class="n">localhost4</span><span class="p">.</span><span class="n">localdomain4</span>
<span class="o">::</span><span class="mi">1</span>         <span class="n">localhost</span> <span class="n">localhost</span><span class="p">.</span><span class="n">localdomain</span> <span class="n">localhost6</span> <span class="n">localhost6</span><span class="p">.</span><span class="n">localdomain6</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>     <span class="n">server0</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>   <span class="n">server1</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">100</span>   <span class="n">server2</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span>



<span class="n">step</span> <span class="mi">3</span><span class="p">.</span> <span class="n">define</span> <span class="n">exports</span> <span class="k">for</span> <span class="n">servers</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">share1</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">exports</span>
<span class="o">/</span><span class="n">share1</span> <span class="n">server1</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span>

<span class="c1">// reload the file</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">exportfs</span> <span class="o">-</span><span class="n">arv</span>
<span class="n">exportfs</span><span class="o">:</span> <span class="n">No</span> <span class="n">options</span> <span class="k">for</span> <span class="o">/</span><span class="n">share1</span> <span class="n">server1</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="o">:</span> <span class="n">suggest</span> <span class="n">server1</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="p">(</span><span class="n">sync</span><span class="p">)</span> <span class="n">to</span> <span class="n">avoid</span> <span class="n">warning</span>
<span class="n">exporting</span> <span class="n">server1</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="o">:/</span><span class="n">share1</span>


<span class="c1">// check the rumtime configuration of NFS</span>
<span class="err">$</span> <span class="n">cat</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">nfs</span><span class="o">/</span><span class="n">etab</span>
<span class="o">/</span><span class="n">share1</span>	<span class="n">server1</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="p">(</span><span class="n">ro</span><span class="p">,</span><span class="n">sync</span><span class="p">,</span><span class="n">wdelay</span><span class="p">,</span><span class="n">hide</span><span class="p">,</span><span class="n">nocrossmnt</span><span class="p">,</span><span class="n">secure</span><span class="p">,</span><span class="n">root_squash</span><span class="p">,</span><span class="n">no_all_squash</span><span class="p">,</span><span class="n">no_subtree_check</span><span class="p">,</span><span class="n">secure_locks</span><span class="p">,</span><span class="n">acl</span><span class="p">,</span><span class="n">no_pnfs</span><span class="p">,</span><span class="n">anonuid</span><span class="o">=</span><span class="mi">65534</span><span class="p">,</span><span class="n">anongid</span><span class="o">=</span><span class="mi">65534</span><span class="p">,</span><span class="n">sec</span><span class="o">=</span><span class="n">sys</span><span class="p">,</span><span class="n">ro</span><span class="p">,</span><span class="n">secure</span><span class="p">,</span><span class="n">root_squash</span><span class="p">,</span><span class="n">no_all_squash</span><span class="p">)</span>
<span class="c1">// default options</span>


<span class="err">$</span> <span class="n">sudo</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">exports</span>
<span class="o">/</span><span class="n">share1</span> <span class="n">server1</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="p">(</span><span class="n">rw</span><span class="p">)</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">exportfs</span> <span class="o">-</span><span class="n">arv</span>              <span class="c1">// no warning</span>
<span class="n">exporting</span> <span class="n">server1</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="o">:/</span><span class="n">share1</span>
<span class="err">$</span> <span class="n">cat</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">nfs</span><span class="o">/</span><span class="n">etab</span>
<span class="o">/</span><span class="n">share1</span>	<span class="n">server1</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="p">(</span><span class="n">rw</span><span class="p">,</span><span class="n">sync</span><span class="p">...)</span>


<span class="c1">// no space</span>
<span class="o">/</span><span class="n">share1</span> <span class="n">server1</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span> <span class="p">(</span><span class="n">rw</span><span class="p">)</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">exportfs</span> <span class="o">-</span><span class="n">arv</span>
<span class="n">exportfs</span><span class="o">:</span> <span class="n">No</span> <span class="n">options</span> <span class="k">for</span> <span class="o">/</span><span class="n">share1</span> <span class="n">server1</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="o">:</span> <span class="n">suggest</span> <span class="n">server1</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="p">(</span><span class="n">sync</span><span class="p">)</span> <span class="n">to</span> <span class="n">avoid</span> <span class="n">warning</span>
<span class="n">exportfs</span><span class="o">:</span> <span class="n">No</span> <span class="n">host</span> <span class="n">name</span> <span class="n">given</span> <span class="n">with</span> <span class="o">/</span><span class="n">share1</span> <span class="p">(</span><span class="n">rw</span><span class="p">),</span> <span class="n">suggest</span> <span class="o">*</span><span class="p">(</span><span class="n">rw</span><span class="p">)</span> <span class="n">to</span> <span class="n">avoid</span> <span class="n">warning</span>
<span class="n">exporting</span> <span class="n">server1</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="o">:/</span><span class="n">share1</span>
<span class="n">exporting</span> <span class="o">*:/</span><span class="n">share1</span>  <span class="c1">// allow anyone to access share1</span>
</pre></table></code></div></div><p>client:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
</pre><td class="rouge-code"><pre>

<span class="n">step</span> <span class="mi">1</span><span class="o">:</span> <span class="n">setup</span> <span class="n">client</span> <span class="n">side</span>

<span class="c1">// set the dns setting for each client:</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span>
<span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span>   <span class="n">localhost</span> <span class="n">localhost</span><span class="p">.</span><span class="n">localdomain</span> <span class="n">localhost4</span> <span class="n">localhost4</span><span class="p">.</span><span class="n">localdomain4</span>
<span class="o">::</span><span class="mi">1</span>         <span class="n">localhost</span> <span class="n">localhost</span><span class="p">.</span><span class="n">localdomain</span> <span class="n">localhost6</span> <span class="n">localhost6</span><span class="p">.</span><span class="n">localdomain6</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>     <span class="n">server0</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>   <span class="n">server1</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">100</span>   <span class="n">server2</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span>


<span class="c1">// install</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">nfs</span><span class="o">-</span><span class="n">utils</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">status</span> <span class="n">nfs</span><span class="o">-</span><span class="n">server</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">status</span> <span class="n">rpcbind</span>


<span class="err">$</span> <span class="n">sudo</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">permanent</span> <span class="o">--</span><span class="n">zone</span><span class="o">=</span><span class="n">public</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">service</span><span class="o">=</span><span class="n">nfs</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">permanent</span> <span class="o">--</span><span class="n">zone</span><span class="o">=</span><span class="n">public</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">service</span><span class="o">=</span><span class="n">rpc</span><span class="o">-</span><span class="n">bind</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">permanent</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">service</span><span class="o">=</span><span class="n">mountd</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">reload</span>

<span class="c1">// mount the exports</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">mount</span> <span class="o">-</span><span class="n">t</span> <span class="n">nfs</span> <span class="n">server0</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="o">:/</span><span class="n">share1</span> <span class="o">/</span><span class="n">mnt</span>

<span class="c1">// check</span>
<span class="err">$</span> <span class="n">mount</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">server0</span>
<span class="n">server0</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="o">:/</span><span class="n">share1</span> <span class="n">on</span> <span class="o">/</span><span class="n">mnt</span> <span class="n">type</span> <span class="n">nfs4</span> <span class="p">(</span><span class="n">rw</span><span class="p">,</span><span class="n">relatime</span><span class="p">,</span><span class="n">vers</span><span class="o">=</span><span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span><span class="n">rsize</span><span class="o">=</span><span class="mi">524288</span><span class="p">,</span><span class="n">wsize</span><span class="o">=</span><span class="mi">524288</span><span class="p">,</span><span class="n">namlen</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span><span class="n">hard</span><span class="p">,</span><span class="n">proto</span><span class="o">=</span><span class="n">tcp</span><span class="p">,</span><span class="n">timeo</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span><span class="n">retrans</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">sec</span><span class="o">=</span><span class="n">sys</span><span class="p">,</span><span class="n">clientaddr</span><span class="o">=</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="p">,</span><span class="n">local_lock</span><span class="o">=</span><span class="n">none</span><span class="p">,</span><span class="n">addr</span><span class="o">=</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>


<span class="o">================================================================</span>

<span class="n">didnot</span> <span class="n">know</span> <span class="n">the</span> <span class="n">exports</span>
<span class="n">ask</span> <span class="n">NFS</span> <span class="n">server</span><span class="p">,</span> <span class="n">need</span> <span class="n">to</span> <span class="n">enable</span> <span class="n">the</span> <span class="n">rpcbind</span> <span class="n">server</span> <span class="n">on</span> <span class="n">the</span> <span class="n">NFS</span> <span class="n">server</span>

<span class="n">server1</span><span class="o">:</span>
<span class="err">$</span> <span class="n">showmount</span> <span class="o">-</span><span class="n">e</span> <span class="n">server0</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span> <span class="c1">// or 192.168.1.1</span>
<span class="n">Export</span> <span class="n">list</span> <span class="k">for</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span>
<span class="o">/</span><span class="n">share1</span> <span class="n">server1</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span>

<span class="err">$</span> <span class="n">showmount</span> <span class="o">-</span><span class="n">e</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>
<span class="n">clnt_create</span><span class="o">:</span> <span class="n">RPC</span><span class="o">:</span> <span class="n">Unable</span> <span class="n">to</span> <span class="n">receive</span>
<span class="cp"># firewall： server systemctl stop firewalld, client success.
</span>
<span class="n">server</span> <span class="n">side</span><span class="o">:</span>
<span class="cp"># firewall-cmd --permanent --add-service=nfs
# firewall-cmd --permanent --add-service=rpcbind
# firewall-cmd --permanent --add-service=mountd // this one!!!
# firewall-cmd --reload
</span>
<span class="o">================================================================</span>
</pre></table></code></div></div><h3 id="persistent-mount">persistent mount</h3><p>reboot all lost, rumtime mount</p><p>server1:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">sudo</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">fstab</span>
<span class="c1">// add</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">mapper</span><span class="o">/</span><span class="n">cl</span><span class="o">-</span><span class="n">root</span>     <span class="o">/</span>                       <span class="n">xfs</span>     <span class="n">defaults</span>        <span class="mi">0</span> <span class="mi">0</span>
<span class="n">UUID</span><span class="o">=</span><span class="n">ca2f12da</span><span class="o">-</span><span class="n">b776</span><span class="o">-</span><span class="mi">4</span><span class="n">a8a</span><span class="o">-</span><span class="mi">9</span><span class="n">dd0</span><span class="o">-</span><span class="mi">308</span><span class="n">da349067a</span> <span class="o">/</span><span class="n">boot</span>                   <span class="n">ext4</span>    <span class="n">defaults</span>        <span class="mi">1</span> <span class="mi">2</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">mapper</span><span class="o">/</span><span class="n">cl</span><span class="o">-</span><span class="n">swap</span>     <span class="n">swap</span>                    <span class="n">swap</span>    <span class="n">defaults</span>        <span class="mi">0</span> <span class="mi">0</span>
<span class="n">server0</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="o">:/</span><span class="n">share1</span>	     <span class="o">/</span><span class="n">mnt</span>	        <span class="n">nfs</span>	    <span class="n">defaults</span><span class="p">,</span><span class="n">rw</span><span class="p">,</span><span class="n">_netdev</span>  <span class="mi">0</span> <span class="mi">0</span>
<span class="c1">// _netdev: not attempt to mount file system until the network device is online, since nfs through network.</span>

<span class="err">$</span> <span class="n">mount</span>

<span class="err">$</span> <span class="n">showmount</span> <span class="o">-</span><span class="n">e</span> <span class="n">server0</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span>
<span class="n">Export</span> <span class="n">list</span> <span class="k">for</span> <span class="n">server0</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="o">:</span>
<span class="o">/</span><span class="n">share1</span> <span class="n">server</span><span class="o">?</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">umount</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span>

<span class="c1">// update configuration file</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">mount</span> <span class="o">-</span><span class="n">a</span>

<span class="c1">// new mount show</span>
<span class="err">$</span> <span class="n">mount</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">server0</span>
<span class="n">server0</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="o">:/</span><span class="n">share1</span> <span class="n">on</span> <span class="o">/</span><span class="n">mnt</span> <span class="n">type</span> <span class="n">nfs4</span> <span class="p">(</span><span class="n">rw</span><span class="p">,</span><span class="n">relatime</span><span class="p">,</span><span class="n">vers</span><span class="o">=</span><span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span><span class="n">rsize</span><span class="o">=</span><span class="mi">524288</span><span class="p">,</span><span class="n">wsize</span><span class="o">=</span><span class="mi">524288</span><span class="p">,</span><span class="n">namlen</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span><span class="n">hard</span><span class="p">,</span><span class="n">proto</span><span class="o">=</span><span class="n">tcp</span><span class="p">,</span><span class="n">timeo</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span><span class="n">retrans</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">sec</span><span class="o">=</span><span class="n">sys</span><span class="p">,</span><span class="n">clientaddr</span><span class="o">=</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="p">,</span><span class="n">local_lock</span><span class="o">=</span><span class="n">none</span><span class="p">,</span><span class="n">addr</span><span class="o">=</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="n">_netdev_</span><span class="p">)</span>

</pre></table></code></div></div><h3 id="dynamic-monut-autofs"><strong>dynamic monut: autofs</strong></h3><p>autofs a daemon that runs on computer that dynamically mount shares/exports/anything/even local file systems</p><p>server1:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">autofs</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">autofs</span>


<span class="err">$</span> <span class="n">sudo</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="k">auto</span><span class="p">.</span><span class="n">misc</span>
<span class="c1">// add</span>
<span class="cp"># This is an automounter map and it has the following format key [ -mount-options-separated-by-comma ] location
# Details may be found in the autofs(5) manpage
</span>
<span class="n">cd</span>               <span class="o">-</span><span class="n">fstype</span><span class="o">=</span><span class="n">iso9660</span><span class="p">,</span><span class="n">ro</span><span class="p">,</span><span class="n">nosuid</span><span class="p">,</span><span class="n">nodev</span> <span class="o">:/</span><span class="n">dev</span><span class="o">/</span><span class="n">cdrom</span>
<span class="n">share1</span>           <span class="o">-</span><span class="n">fstype</span><span class="o">=</span><span class="n">nfs</span><span class="p">,</span><span class="n">rw</span>          <span class="n">server0</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="o">:/</span><span class="n">share1</span>

<span class="cp"># the following entries are samples to pique your imagination
#linux          -ro,soft,intr           ftp.example.org:/pub/linux
#boot           -fstype=ext2            :/dev/hda1
#floppy         -fstype=auto            :/dev/fd0
#floppy         -fstype=ext2            :/dev/fd0
#e2floppy       -fstype=ext2            :/dev/fd0
#jaz            -fstype=ext2            :/dev/sdc1
#removable      -fstype=ext2            :/dev/hdd
</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="n">restart</span> <span class="n">autofs</span>
<span class="err">$</span> <span class="n">ls</span> <span class="o">/</span><span class="n">misc</span>  <span class="c1">// nothing</span>
<span class="err">$</span> <span class="n">ls</span> <span class="o">/</span><span class="n">misc</span><span class="o">/</span><span class="n">share1</span>
<span class="err">$</span> <span class="n">ls</span> <span class="o">/</span><span class="n">misc</span>
<span class="n">share1</span>      <span class="c1">// share1 shows up, on demands</span>

</pre></table></code></div></div><h3 id="mount-unsuccessful">mount unsuccessful</h3><p>server2:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">sudo</span> <span class="n">mount</span> <span class="o">-</span><span class="n">t</span> <span class="n">nfs</span> <span class="n">server0</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="o">:/</span><span class="n">share1</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span>
<span class="n">mount</span><span class="p">.</span><span class="n">nfs</span><span class="o">:</span> <span class="n">access</span> <span class="n">denied</span> <span class="n">by</span> <span class="n">server</span> <span class="k">while</span> <span class="n">mounting</span> <span class="n">server0</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="o">:/</span><span class="n">share1</span>
</pre></table></code></div></div><p>server0:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c1">// change</span>
<span class="err">$</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">exports</span>
<span class="o">/</span><span class="n">share1</span> <span class="n">server</span><span class="o">?</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="p">(</span><span class="n">rw</span><span class="p">)</span>   <span class="c1">// not server1.psdemo.local(rw)</span>

<span class="c1">// update to reread the configuration file</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">exportfs</span> <span class="o">-</span><span class="n">arv</span>
<span class="n">exporting</span> <span class="n">server</span><span class="o">?</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="o">:/</span><span class="n">share1</span>
</pre></table></code></div></div><p>server2:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">sudo</span> <span class="n">mount</span> <span class="o">-</span><span class="n">t</span> <span class="n">nfs</span> <span class="n">server0</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="o">:/</span><span class="n">share1</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span>

<span class="err">$</span> <span class="n">mount</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">server0</span>
<span class="n">server0</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="o">:/</span><span class="n">share1</span> <span class="n">on</span> <span class="o">/</span><span class="n">mnt</span> <span class="n">type</span> <span class="n">nfs4</span> <span class="p">(</span><span class="n">rw</span><span class="p">,</span><span class="n">relatime</span><span class="p">,</span><span class="n">vers</span><span class="o">=</span><span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span><span class="n">rsize</span><span class="o">=</span><span class="mi">524288</span><span class="p">,</span><span class="n">wsize</span><span class="o">=</span><span class="mi">524288</span><span class="p">,</span><span class="n">namlen</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span><span class="n">hard</span><span class="p">,</span><span class="n">proto</span><span class="o">=</span><span class="n">tcp</span><span class="p">,</span><span class="n">timeo</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span><span class="n">retrans</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">sec</span><span class="o">=</span><span class="n">sys</span><span class="p">,</span><span class="n">clientaddr</span><span class="o">=</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">100</span><span class="p">,</span><span class="n">local_lock</span><span class="o">=</span><span class="n">none</span><span class="p">,</span><span class="n">addr</span><span class="o">=</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
</pre></table></code></div></div><hr /><h2 id="nfs-file-permission">NFS file permission</h2><p>UID and GID overlap:</p><ul><li>configuration file specific the user machine, lack scalability.<li>central authentication server</ul><p><code class="language-plaintext highlighter-rouge">AUTH_SYS</code>:</p><ul><li>dafult for NFS.<li>UID/GID model</ul><p><code class="language-plaintext highlighter-rouge">AUTH_GSS</code>:</p><ul><li>base on kerberos.<li>authorize both the user and the system.<li>requirement: configuration need to be setup<ul><li>kerneros key distribution center (KDC) installed<li>host and service principals added for client and server.<li>create a add key-tabs on client and server.<li>change the authentication mechanisms on NFS client and server to use.<ul><li>sec=krb5, krb5i, krb5p</ul></ul></ul><h3 id="auth_sys-default-security-mechanism">AUTH_SYS (default security mechanism)</h3><p>no authentication, but passing same UID.</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre>
<span class="n">server1</span><span class="o">:</span>

<span class="err">$</span> <span class="n">ssh</span> <span class="n">server1</span><span class="err">@</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>

<span class="err">$</span> <span class="n">touch</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">file1</span><span class="p">.</span><span class="n">test</span>
<span class="n">touch</span><span class="o">:</span> <span class="n">cannot</span> <span class="n">touch</span> <span class="err">'</span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">file1</span><span class="p">.</span><span class="n">test</span><span class="err">'</span><span class="o">:</span> <span class="n">Permission</span> <span class="n">denied</span>

<span class="err">$</span> <span class="n">ll</span> <span class="o">/</span>
<span class="n">lrwxrwxrwx</span><span class="p">.</span>   <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span>       <span class="mi">7</span> <span class="n">May</span> <span class="mi">10</span>  <span class="mi">2019</span> <span class="n">bin</span> <span class="o">-&gt;</span> <span class="n">usr</span><span class="o">/</span><span class="n">bin</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="p">.</span>   <span class="mi">2</span> <span class="n">root</span> <span class="n">root</span>       <span class="mi">6</span> <span class="n">May</span> <span class="mi">10</span>  <span class="mi">2019</span> <span class="n">mnt</span>

<span class="o">================================================</span>

<span class="n">server0</span><span class="o">:</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">chown</span> <span class="n">server1</span><span class="o">:</span><span class="n">server1</span> <span class="o">/</span><span class="n">share1</span>

<span class="o">================================================</span>

<span class="n">server1</span><span class="o">:</span>
<span class="err">$</span> <span class="n">ll</span> <span class="o">/</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="p">.</span>   <span class="mi">2</span> <span class="n">server1</span> <span class="n">server1</span>       <span class="mi">6</span> <span class="n">Apr</span> <span class="mi">28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">23</span> <span class="n">share1</span>

<span class="err">$</span> <span class="n">touch</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">file1</span><span class="p">.</span><span class="n">test</span>


<span class="err">$</span> <span class="n">cat</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">server0</span>
<span class="n">server0</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">1000</span><span class="o">:</span><span class="mi">1000</span><span class="o">:</span><span class="n">server0</span><span class="o">:/</span><span class="n">home</span><span class="o">/</span><span class="n">server0</span><span class="o">:/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span>
<span class="err">$</span> <span class="n">cat</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">server1</span>
<span class="n">server1</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">1000</span><span class="o">:</span><span class="mi">1000</span><span class="o">:</span><span class="n">server1</span><span class="o">:/</span><span class="n">home</span><span class="o">/</span><span class="n">server1</span><span class="o">:/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span>
</pre></table></code></div></div><h3 id="auth_gss-kebereo-on-nfs-server">AUTH_GSS (kebereo on NFS server)</h3><ol><li><p>name resolution: /etc/hosts</p><li><p>ensure NTP clock synchronization, keberos is time-sentitive.</p><li><p>setup the Kerberos server and client.</p></ol><h3 id="get-the-machine-access">get the machine access</h3><ol><li>setup client</ol><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nl">server1:</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">kadmin</span>

<span class="n">addprinc</span> <span class="o">-</span><span class="n">randkey</span> <span class="n">host</span><span class="o">/</span><span class="n">server1</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span>
<span class="n">addprinc</span> <span class="o">-</span><span class="n">randkey</span> <span class="n">nfs</span><span class="o">/</span><span class="n">server1</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span>
<span class="n">ktadd</span> <span class="n">host</span><span class="o">/</span><span class="n">server1</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span>
<span class="n">ktadd</span> <span class="n">nfs</span><span class="o">/</span><span class="n">server1</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span>
</pre></table></code></div></div><ol><li>setup server</ol><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nl">server0:</span> <span class="n">server</span> <span class="n">side</span>

<span class="err">$</span> <span class="n">kadmin</span>
<span class="c1">// add service principal for NFS server</span>
<span class="n">addprinc</span> <span class="o">-</span><span class="n">randkey</span> <span class="n">nfs</span><span class="o">/</span><span class="n">server0</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span>
<span class="n">ktadd</span> <span class="n">host</span><span class="o">/</span><span class="n">server0</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span>
<span class="n">ktadd</span> <span class="n">nfs</span><span class="o">/</span><span class="n">server0</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span>

</pre></table></code></div></div><ol><li>configure the kerberos server to authenticate on NFS mounts</ol><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="nl">server0:</span>

<span class="n">configure</span> <span class="k">for</span> <span class="n">NFS</span>

<span class="err">$</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">exports</span>
<span class="c1">// add sec=krb5</span>
<span class="o">/</span><span class="n">share1</span> <span class="n">server</span><span class="o">*</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="p">(</span><span class="n">rw</span><span class="p">,</span><span class="n">sec</span><span class="o">=</span><span class="n">krb5</span><span class="p">)</span>


<span class="c1">// reload the export configuration</span>
<span class="err">$</span> <span class="n">exportfs</span> <span class="o">-</span><span class="n">arv</span>
<span class="n">exporting</span> <span class="n">server1</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="o">:/</span><span class="n">share1</span>

<span class="c1">// check the rumtime configuration</span>
<span class="err">$</span> <span class="n">cat</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">nfs</span><span class="o">/</span><span class="n">etab</span>
<span class="o">/</span><span class="n">share1</span>	<span class="n">server1</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="p">(</span><span class="n">rw</span><span class="p">,</span><span class="n">sync</span><span class="p">,</span><span class="n">wdelay</span><span class="p">,</span><span class="n">hide</span><span class="p">,</span><span class="n">nocrossmnt</span><span class="p">,</span><span class="n">secure</span><span class="p">,</span><span class="n">root_squash</span><span class="p">,</span><span class="n">no_all_squash</span><span class="p">,</span><span class="n">no_subtree_check</span><span class="p">,</span><span class="n">secure_locks</span><span class="p">,</span><span class="n">acl</span><span class="p">,</span><span class="n">no_pnfs</span><span class="p">,</span><span class="n">anonuid</span><span class="o">=</span><span class="mi">65534</span><span class="p">,</span><span class="n">anongid</span><span class="o">=</span><span class="mi">65534</span><span class="p">,</span><span class="n">sec</span><span class="o">=</span><span class="n">krb5</span><span class="p">,</span><span class="n">rw</span><span class="p">,</span><span class="n">secure</span><span class="p">,</span><span class="n">root_squash</span><span class="p">,</span><span class="n">no_all_squash</span><span class="p">)</span>
</pre></table></code></div></div><ol><li>configure the client to use kerberos based configuration</ol><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="nl">server1:</span> <span class="n">unmount</span> <span class="n">and</span> <span class="n">remount</span> <span class="n">again</span><span class="p">.</span>


<span class="mi">1</span><span class="p">.</span> <span class="n">runtime</span> <span class="n">mount</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">umount</span> <span class="o">/</span><span class="n">mnt</span>

<span class="err">$</span> <span class="n">mount</span> <span class="o">-</span><span class="n">t</span> <span class="n">nfs</span> <span class="o">-</span><span class="n">o</span> <span class="n">sec</span><span class="o">=</span><span class="n">krb5</span> <span class="n">server0</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="o">:/</span><span class="n">share1</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span>

<span class="err">$</span> <span class="n">mount</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">server0</span>
<span class="n">server0</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="o">:/</span><span class="n">share1</span> <span class="n">on</span> <span class="o">/</span><span class="n">mnt</span> <span class="n">type</span> <span class="n">nfs4</span> <span class="p">(</span><span class="n">rw</span><span class="p">,</span><span class="n">relatime</span><span class="p">,</span><span class="n">vers</span><span class="o">=</span><span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span><span class="n">rsize</span><span class="o">=</span><span class="mi">524288</span><span class="p">,</span><span class="n">wsize</span><span class="o">=</span><span class="mi">524288</span><span class="p">,</span><span class="n">namlen</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span><span class="n">hard</span><span class="p">,</span><span class="n">proto</span><span class="o">=</span><span class="n">tcp</span><span class="p">,</span><span class="n">timeo</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span><span class="n">retrans</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">sec</span><span class="o">=</span><span class="n">krb5</span><span class="p">,</span><span class="n">clientaddr</span><span class="o">=</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="n">local_lock</span><span class="o">=</span><span class="n">none</span><span class="p">,</span><span class="n">addr</span><span class="o">=</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>


<span class="mi">2</span><span class="p">.</span> <span class="n">add</span> <span class="n">mount</span> <span class="n">in</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">fstab</span><span class="p">.</span>

<span class="err">$</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">fstab</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">mapper</span><span class="o">/</span><span class="n">cl</span><span class="o">-</span><span class="n">root</span>     <span class="o">/</span>                       <span class="n">xfs</span>     <span class="n">defaults</span>        <span class="mi">0</span> <span class="mi">0</span>
<span class="n">server0</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="o">:/</span><span class="n">share1</span>	<span class="o">/</span><span class="n">mnt</span>		<span class="n">nfs</span>	<span class="n">defaults</span><span class="p">,</span><span class="n">rw</span><span class="p">,</span><span class="n">_netdev</span><span class="p">,</span><span class="n">sec</span><span class="o">=</span><span class="n">krb5</span>	<span class="mi">0</span> <span class="mi">0</span>

<span class="err">$</span> <span class="n">mount</span> <span class="o">-</span><span class="n">a</span>
<span class="err">$</span> <span class="n">mount</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">server0</span>
<span class="n">server0</span><span class="p">.</span><span class="n">psdemo</span><span class="p">.</span><span class="n">local</span><span class="o">:/</span><span class="n">share1</span> <span class="n">on</span> <span class="o">/</span><span class="n">mnt</span> <span class="n">type</span> <span class="n">nfs4</span> <span class="p">(</span><span class="n">rw</span><span class="p">,</span><span class="n">relatime</span><span class="p">,</span><span class="n">vers</span><span class="o">=</span><span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span><span class="n">rsize</span><span class="o">=</span><span class="mi">524288</span><span class="p">,</span><span class="n">wsize</span><span class="o">=</span><span class="mi">524288</span><span class="p">,</span><span class="n">namlen</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span><span class="n">hard</span><span class="p">,</span><span class="n">proto</span><span class="o">=</span><span class="n">tcp</span><span class="p">,</span><span class="n">timeo</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span><span class="n">retrans</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">sec</span><span class="o">=</span><span class="n">krb5</span><span class="p">,</span><span class="n">clientaddr</span><span class="o">=</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="n">local_lock</span><span class="o">=</span><span class="n">none</span><span class="p">,</span><span class="n">addr</span><span class="o">=</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="n">_netdev_</span><span class="p">)</span>


<span class="err">$</span> <span class="n">ls</span> <span class="o">/</span><span class="n">mnt</span>
<span class="n">ls</span><span class="o">:</span> <span class="n">cannot</span> <span class="n">access</span> <span class="err">'</span><span class="o">/</span><span class="n">mnt</span><span class="err">'</span><span class="o">:</span> <span class="n">Permission</span> <span class="n">denied</span>

<span class="n">machine</span> <span class="n">access</span> <span class="n">finish</span><span class="p">,</span> <span class="n">user</span> <span class="n">not</span> <span class="n">yet</span><span class="p">.</span>
</pre></table></code></div></div><h3 id="get-the-user-access">get the user access</h3><p>server1:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">sudo</span> <span class="n">kadmin</span>

<span class="c1">// add user principal</span>
<span class="n">addprinc</span> <span class="n">demo</span>

<span class="c1">// need to get a ticket from kdc.</span>
<span class="err">$</span> <span class="n">kinit</span>
<span class="c1">// verify kerberos ticket</span>
<span class="err">$</span> <span class="n">klist</span>

</pre></table></code></div></div><hr /><h2 id="setup-selinux-performance-and-monitor-in-centos-8">Setup SELinux Performance and Monitor in CentOS 8</h2><p>default SELinux security context support NFS.</p><p><code class="language-plaintext highlighter-rouge">Multiple mount points</code>: Multiple mount points to the subdirectory of root directory</p><p><code class="language-plaintext highlighter-rouge">Multiple-protocol sharing</code>: web server contents</p><p>monitor: nfsstat, nfsiostat, mountstats</p><p>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/00codenote/'>00CodeNote</a>, <a href='/categories/linuxnote/'>LinuxNote</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linux/" class="post-tag no-text-decoration" >Linux</a> <a href="/tags/lfce/" class="post-tag no-text-decoration" >LFCE</a> <a href="/tags/pluralsight/" class="post-tag no-text-decoration" >Pluralsight</a> <a href="/tags/sysadmin/" class="post-tag no-text-decoration" >Sysadmin</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=LFCE.2 Advanced Network and System Administration - Grace&url=https://ocholuo.github.io//posts/LFCE.2.AdvancedNetworkandSystemAdministration/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=LFCE.2 Advanced Network and System Administration - Grace&u=https://ocholuo.github.io//posts/LFCE.2.AdvancedNetworkandSystemAdministration/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=LFCE.2 Advanced Network and System Administration - Grace&url=https://ocholuo.github.io//posts/LFCE.2.AdvancedNetworkandSystemAdministration/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Amazon-CloudFront/">AWS Lab - AWS CloudFront</a><li><a href="/posts/Alexa-1stSkill/">AWS Alex First Skill - RedVelvet Time</a><li><a href="/posts/NetworkProtocol-SSL-TLS-Handshake/">NetworkProtocol SSL/TLS Handshake</a><li><a href="/posts/pythonCrash/">Python Crash</a><li><a href="/posts/%E4%B8%80%E5%8F%A5%E8%AF%9D%E8%A7%A3%E9%87%8AAWS/">AWS - 一句话解释AWS</a><li><a href="/posts/GKE/">GCP - Google Cloud Computing - Kubernetes and Kubernetes Engine</a><li><a href="/posts/Go-Note/">Go Note</a><li><a href="/posts/SCPs/">AWS - IdenAccessManage - SCPs (Service Control Policies)</a><li><a href="/posts/CompanyBenefit/">Company Benefit</a><li><a href="/posts/Encryption-SSL&TLS/">Cryptography - SSL/TLS Encryption</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/CentOSEnterpriseLinuxUserandGroupManagement/"><div class="card-body"> <span class="timeago small" >Jul 16, 2020<i class="unloaded">2020-07-16T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Linux - CentOS Enterprise User and Group Management</h3><div class="text-muted small"><p> CentOS Enterprise Linux User and Group Management [toc] PAM PAM: pluggable authentictaion module user login (SSH, Condole, GUI…) -&gt; PAM (Authentication, limits, home directory) -&gt; access ...</p></div></div></a></div><div class="card"> <a href="/posts/LFCE.1.AdvancedLinuxNetworking/"><div class="card-body"> <span class="timeago small" >Jul 16, 2020<i class="unloaded">2020-07-16T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>LFCE.1 Advanced Linux Networking</h3><div class="text-muted small"><p> LFCE: Advanced Linux Networking [toc] virtual network Setup between centos make a virtual network things you gotta do first 1. virtubalbox. add network adapter. server0 &gt; adapter 1: ...</p></div></div></a></div><div class="card"> <a href="/posts/LFCE.3.NetworkandHostSecurity/"><div class="card-body"> <span class="timeago small" >Jul 16, 2020<i class="unloaded">2020-07-16T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>LFCE.3 Network and Host Security</h3><div class="text-muted small"><p> LFCE: Network and Host Security [toc] lab server0: network change to bridge. server0: 192.168.1.30 enp0s10 192.168.0.110 server1: 193.168.3.100 enp0s8 server2: 192.168.2.100/25 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/LFCE.1.AdvancedLinuxNetworking/" class="btn btn-outline-primary" prompt="Older"><p>LFCE.1 Advanced Linux Networking</p></a> <a href="/posts/LFCE.3.NetworkandHostSecurity/" class="btn btn-outline-primary" prompt="Newer"><p>LFCE.3 Network and Host Security</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ocholuo">Grace JyL</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ocholuo.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script defer src="/assets/js/dist/pvreport.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-179830187-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-179830187-1'); }); </script>
