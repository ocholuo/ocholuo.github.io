<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="pv-proxy-endpoint" content="https://myochosite-291718.appspot.com/query?id=ahNwfm15b2Nob3NpdGUtMjkxNzE4chULEghBcGlRdWVyeRiAgIDo14eBCgw"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Meow’s CyberAttack - - Web cache posion" /><meta property="og:locale" content="en" /><meta name="description" content="Meow’s CyberAttack - Web cache posion 背景知识 User Browser Cache Poisoning 浏览器缓存投毒 攻击危害: 攻击实现: Server Cache Poisoning 服务器缓存 攻击实现: example 1: example 2: 实验测试 攻击前提 保护网站免收此类攻击 Web Cache Deception Web缓存欺骗 漏洞成因 漏洞利用 漏洞条件 攻击实现: example 1 example 2 漏洞防御 MITIGATIONS Web Cache欺骗攻击实例" /><meta property="og:description" content="Meow’s CyberAttack - Web cache posion 背景知识 User Browser Cache Poisoning 浏览器缓存投毒 攻击危害: 攻击实现: Server Cache Poisoning 服务器缓存 攻击实现: example 1: example 2: 实验测试 攻击前提 保护网站免收此类攻击 Web Cache Deception Web缓存欺骗 漏洞成因 漏洞利用 漏洞条件 攻击实现: example 1 example 2 漏洞防御 MITIGATIONS Web Cache欺骗攻击实例" /><link rel="canonical" href="https://ocholuo.github.io//posts/web-cache/" /><meta property="og:url" content="https://ocholuo.github.io//posts/web-cache/" /><meta property="og:site_name" content="Grace" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-12-21T10:11:11-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Meow’s CyberAttack - - Web cache posion" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-11-02T12:14:41-04:00","datePublished":"2020-12-21T10:11:11-05:00","description":"Meow’s CyberAttack - Web cache posion 背景知识 User Browser Cache Poisoning 浏览器缓存投毒 攻击危害: 攻击实现: Server Cache Poisoning 服务器缓存 攻击实现: example 1: example 2: 实验测试 攻击前提 保护网站免收此类攻击 Web Cache Deception Web缓存欺骗 漏洞成因 漏洞利用 漏洞条件 攻击实现: example 1 example 2 漏洞防御 MITIGATIONS Web Cache欺骗攻击实例","headline":"Meow’s CyberAttack - - Web cache posion","mainEntityOfPage":{"@type":"WebPage","@id":"https://ocholuo.github.io//posts/web-cache/"},"url":"https://ocholuo.github.io//posts/web-cache/"}</script><title>Meow's CyberAttack - - Web cache posion | Grace</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Grace"><meta name="application-name" content="Grace"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://myochosite-291718.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://myochosite-291718.appspot.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/huoye.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Grace</a></div><div class="site-subtitle font-italic">2023 Mar 14 updated</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/ocholuo" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Meow's CyberAttack - - Web cache posion</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Meow's CyberAttack - - Web cache posion</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Grace JyL </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Dec 21, 2020, 10:11 AM -0500" >Dec 21, 2020<i class="unloaded">2020-12-21T10:11:11-05:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Wed, Nov 2, 2022, 9:14 AM -0700" >Nov 2, 2022<i class="unloaded">2022-11-02T12:14:41-04:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4933 words">27 min read</span> <span id="pv" class="pageviews"> <i class="fas fa-spinner fa-spin fa-fw"></i> </span> views</div></div><div class="post-content"><ul><li><a href="#meows-cyberattack---web-cache-posion">Meow’s CyberAttack - Web cache posion</a><ul><li><a href="#背景知识">背景知识</a><li><a href="#user-browser-cache-poisoning-浏览器缓存投毒">User Browser Cache Poisoning 浏览器缓存投毒</a><ul><li><a href="#攻击危害">攻击危害:</a><li><a href="#攻击实现">攻击实现:</a></ul><li><a href="#server-cache-poisoning-服务器缓存">Server Cache Poisoning 服务器缓存</a><ul><li><a href="#攻击实现-1">攻击实现:</a><ul><li><a href="#example-1">example 1:</a><li><a href="#example-2">example 2:</a></ul><li><a href="#实验测试">实验测试</a><li><a href="#攻击前提">攻击前提</a><li><a href="#保护网站免收此类攻击">保护网站免收此类攻击</a></ul><li><a href="#web-cache-deception-web缓存欺骗">Web Cache Deception Web缓存欺骗</a><ul><li><a href="#漏洞成因">漏洞成因</a><li><a href="#漏洞利用">漏洞利用</a><li><a href="#漏洞条件">漏洞条件</a><li><a href="#攻击实现-2">攻击实现:</a><ul><li><a href="#example-1-1">example 1</a><li><a href="#example-2-1">example 2</a></ul><li><a href="#漏洞防御-mitigations">漏洞防御 MITIGATIONS</a><li><a href="#web-cache欺骗攻击实例">Web Cache欺骗攻击实例</a></ul></ul></ul><hr /><h1 id="meows-cyberattack---web-cache-posion">Meow’s CyberAttack - Web cache posion</h1><hr /><h2 id="背景知识">背景知识</h2><blockquote><p>在请求网站时，会遇到 js，css，图片等等的加载， 如果每次请求都加载一次，服务器可能会消耗许多时间， 因此服务器缓存尤为重要，其中CDN就是Web Server Cache的一个典例</p><ul><li>网站通常都会通过如CDN、负载均衡器、或者反向代理来实现<code class="language-plaintext highlighter-rouge">Web缓存功能</code>。<li>通过缓存频繁访问的文件，降低服务器响应延迟。 因此浏览器中可引入Cache，用以缓存静态资源，以加快访问速度。</ul></blockquote><p>浏览器缓存控制机制有两种：</p><ul><li><code class="language-plaintext highlighter-rouge">HTML Meta标签</code> 以及 <code class="language-plaintext highlighter-rouge">HTTP头信息</code><li>通常，web开发者可以在HTML页面的&lt;head&gt;节点中加入<meta />标签，比如：</ul><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>#!html
<span class="nt">&lt;META</span> <span class="na">HTTP-EQUIV=</span><span class="s">"Pragma"</span> <span class="na">CONTENT=</span><span class="s">"no-cache"</span><span class="nt">&gt;</span>

<span class="c">&lt;!-- 代码的作用是告诉浏览器当前页面不被缓存，每次访问都需要去服务器拉取。 --&gt;</span>
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200509/1588991996164345.png" alt="cache" title="1588839397180767.png" /></p><p><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200509/1588991996755309.png" alt="cache" title="1588839413890794.png" /></p><p>访问链接在第一个人访问后，其页面response将会被CDN缓存，下一个请求者则会直接从CDN获取response</p><ul><li>减轻服务器处理请求的压力，<li>同时达到了防止Dos攻击的目的。<li>加快请求速度，例如我们访问服务器，请求首先会被CDN处理，计算出response给我们的最优ip地址。</ul><p>但如果Cache被攻击者利用，也可以产生一些严重的攻击, 聚焦于以下3种攻击：</p><ul><li>User Browser Cache Poisoning<li>Server Cache Poisoning<li>Web Cache Deception</ul><hr /><h2 id="user-browser-cache-poisoning-浏览器缓存投毒">User Browser Cache Poisoning 浏览器缓存投毒</h2><p>影响浏览器缓存的文件，将其污染以达到攻击目的。</p><ul><li>可能被污染的文件: 浏览器一般缓存 <font color="red"> 静态资源 </font> ，攻击者的攻击目标也就是诸如JS、CSS的静态资源了。</ul><h3 id="攻击危害">攻击危害:</h3><p><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200509/1588991997157578.png" alt="attack" title="1588839532246238.png" /></p><p><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200509/1588991998164102.png" alt="attack" title="1588839541142056.png" /></p><p>一旦 <font color="red"> 浏览器缓存资源 </font> 被污染</p><ul><li>当请求网站时，应用了污染的静态资源，<li>则会产生xss一类的攻击。<li>但这种攻击持久性会随缓存时间的到期而终止，又或者用户勤清缓存而解除。</ul><h3 id="攻击实现">攻击实现:</h3><p><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200509/1588991998211390.png" alt="2020-05-07-15-48-41.png" title="1588839552363882.png" /></p><p>当攻击者和受害者处于同一WiFi下，攻击者可以利用一些攻击手段，让自己成为受害者的代理，</p><ul><li>而当受害者请求目标网站资源时，攻击者可在中间修改。<li>当目标网站 response 需要缓存的资源时，攻击者可将其替换为自己篡改的同名文件，以达到污染浏览器缓存的目的。<li>但考虑到缓存存在时效性，如果目标网站认为缓存过期，则污染缓存就会失效<li>因此如何最大化污染缓存时间成为一个新的问题，但这里我们可以采用如下做法：</ul><p><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200509/1588991999778033.png" alt="2020-05-07-15-51-13.png" title="1588839559126519.png" /></p><p>可以首先对一些知名网站进行分析，查看他们缓存时间最长的文件，以决定我们污染文件的文件名。</p><p>check 缓存时间呢:</p><ul><li>利用 <code class="language-plaintext highlighter-rouge">Http Header</code> 的属性:<li><code class="language-plaintext highlighter-rouge">Cache-Control : max-age=1000</code></ul><p>浏览器污染工具：</p><ul><li>https://github.com/EtherDream/mitm-http-cache-poisoning.git</ul><hr /><h2 id="server-cache-poisoning-服务器缓存">Server Cache Poisoning 服务器缓存</h2><p><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200509/1588991999136941.png" alt="attack" title="1588839586206397.png" /></p><ol><li>利用恶意的request，使Cache缓存恶意的response，让访问者受到拒绝服务攻击：</ol><p><img data-proofer-ignore data-src="https://i.imgur.com/Phgi8cX.png" alt="1592294799388320" /></p><ol><li>通过特定的request，可以使目标网站缓存不同的response，例如使静态资源，甚至网站不可用：</ol><p><img data-proofer-ignore data-src="https://i.imgur.com/7aFTO5a.png" alt="1592294800300841" /></p><h3 id="攻击实现-1">攻击实现:</h3><p>服务器会缓存某个链接的第一个访问者的response内容</p><ul><li>如果第一个人是攻击者，就很有可能让CDN错误的缓存污染内容，达成攻击：</ul><p>服务器如何判断2个请求者请求的是不是同一个页面</p><ul><li>by <font color="red"> Cache Key </font> 的概念：<li>服务器会判断橙色字部分，看其是否相同<ul><li>若相同则对应同一个cache，<li>但蓝色字体部分其实不同，此时2个访问者的response理应不同，因为他们对应的不同语言，<li>但因为缓存机制的问题，导致第2个请求者看到了错误语言的页面。</ul></ul><p><img data-proofer-ignore data-src="https://i.imgur.com/Sn1QNpI.png" alt="Screen Shot 2020-12-21 at 17.26.23" /></p><h4 id="example-1">example 1:</h4><ul><li>response页面中会 <font color="red"> 拼接 X-Forwarded-Host </font><li>假设我们是第一个请求者，此response将会被缓存，<li><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200509/1588992000829624.png" alt="attack" title="1588839605872239.png" /><li>那么当下一个请求者再次访问如下链接, 将受到xss的攻击。<li><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200509/1588992001199138.png" alt="attack" title="1588839614808715.png" /></ul><h4 id="example-2">example 2:</h4><p>攻击者可以发送一个带有 恶意值(X-Malicious-Header) 的request请求</p><ul><li>由于该请求是第一次请求，因此其不存在于Cache中，<li>于是交由Origin Server进行处理，<li>但是由于http header中存在非法值，导致Origin Server解析时出现400的错误，并进行response，<li>而此时由于Cache服务器的设置问题，其错误的将请求<code class="language-plaintext highlighter-rouge">example.org/index.html</code>的请求，判定为<code class="language-plaintext highlighter-rouge">response为400</code><li>从而导致以后的访问者再次访问该页面时，只能得到页面400错误的response<li>从而达成Dos攻击。</ul><p>可以发送的使网站出现解析异常的恶意value：</p><ul><li>HTTP Method <code class="language-plaintext highlighter-rouge">Override (HMO) Attack</code><li>HTTP Header <code class="language-plaintext highlighter-rouge">Oversize (HHO) Attack</code><li>HTTP <code class="language-plaintext highlighter-rouge">Meta Character (HMC) Attack</code></ul><hr /> <font color="red"> HTTP Method Override (HMO) Attack </font><p><img data-proofer-ignore data-src="https://i.imgur.com/o15ApWP.png" alt="1592294800201069-1" /></p><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="c"># 存在一些http header可以更改请求方式，例如如下几种：</span>
X-HTTP-Method-Override
X-HTTP-Method
X-Method-Override

<span class="c"># 假设请求发送形式为：</span>
GET /index.html HTTP/1.1
Host: example.org
X-HTTP-Method-Override: POST

<span class="c"># 此时服务器则会认为该请求为POST请求，于是会返回：</span>
HTTP/1.1 404 Not Found
Content-Length: 29
Content-Type: text/plain
POST on /index.html not found

<span class="c"># 从而导致请求资源方式的错误，以至于Cache服务器缓存404页面</span>
<span class="c"># 而以后的用户，如果正常通过GET访问该网址，则会导致DOS攻击，回显404 Not Found:</span>
</pre></table></code></div></div><hr /> <font color="red"> HTTP Header Oversize (HHO) Attack </font><p><img data-proofer-ignore data-src="https://i.imgur.com/Z1GIrx6.png" alt="1592294801142492" /></p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>但该攻击为什么会发生:

例如CDN，是会对过长的request进行拦截的，并不会进行缓存或者发送至源服务器。

但对于一个request请求，其header长度通常被限制在  8,000 bytes 以下，

例如Amazon CloudFront CDN允许的header长度却为 24,713 bytes。

因此如果攻击者发送的header长度为10,000bytes，是可以通过CDN的拦截，并产生危害的。
</pre></table></code></div></div><hr /> <font color="red"> HTTP Meta Character (HMC) Attack </font><p><img data-proofer-ignore data-src="https://i.imgur.com/LoX9QZZ.png" alt="1592294801131698" /></p><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c"># 为了防止CRLF攻击，通常http会禁止value中带有\n或\r等符号</span>
<span class="c"># 但由于Cache对此可能并不做过滤，那么就会产生语义上的gap</span>

<span class="c"># 假设攻击者发送请求：</span>
GET /index.html HTTP/1.1
Host: example.org
X-Metachar-Header: <span class="se">\n</span>


<span class="c"># 由于该请求为第一次请求，Cache服务器将其转发给源服务器</span>
<span class="c"># 而源服务器解析由于遇到危险字符，将会返回：</span>
HTTP/1.1 400 Bad Request
Content-Length: 21
Content-Type: text/plain
Character not allowed

<span class="c"># 但由于Cache服务器对这些字符未必有过滤，于是将其对应缓存下来，那么当正常用户访问该页面时，将受到400 Bad Request的回显，从而产生Dos攻击。</span>
</pre></table></code></div></div><hr /><h3 id="实验测试">实验测试</h3><p>作者为了验证自己的3种攻击方式的可用性，其选择5个较为出名的proxies caches以及10个CDN：</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>Apache HTTP Server (Apache HTTPD) v2.4.18
Nginx v1.10.3,
Varnish v6.0.1
Apache Traffic Server (Apache TS) v8.0.2
Squid v3.5.12
Akamai
CloudFront
Cloudflare
Stackpath
Azure
CDN77
CDNSun
Fastly
KeyCDN
G-Score Labs
</pre></table></code></div></div><p>为了达成Dos攻击，那么要求上述缓存服务器必须可以缓存400 / 500等http状态的页面</p><ul><li>只有 <code class="language-plaintext highlighter-rouge">Varnish, Apache TS, Akamai, Azure, CDN77, Cloudflare, CloudFront</code> 可以缓存 <code class="language-plaintext highlighter-rouge">400 / 500</code> 的页面</ul><p><img data-proofer-ignore data-src="https://i.imgur.com/kihEry3.png" alt="1592294801146974" /></p><p>HMO攻击</p><ul><li>对于请求方式覆盖的http属性，测试了哪些后端框架是可以接受的：<li>Play1、Symfony、Lavarel框架都是默认支持这一方式的，<li>那么如果后端使用上述框架之一，都可能遭受HMO攻击的影响。</ul><p><img data-proofer-ignore data-src="https://i.imgur.com/DBT7Yax.png" alt="1592294802551715" /></p><p>HHO攻击</p><ul><li>关键点在于header限制长度语义不对等的问题，测试web框架，CDN等header限制的长度：<li>假设目标网站使用Play2作为网站后端框架，使用Azure作为缓存，那么即可能遭受HHO攻击，产生Dos攻击，因为 Play2的header长度限制为 8319bytes，而 Azure为 24567bytes<li>如果攻击者发送 <code class="language-plaintext highlighter-rouge">10000bytes</code> 的header进行request<li>那么就可能被缓存下 <code class="language-plaintext highlighter-rouge">400 Bad Request</code> 的状态。</ul><p><img data-proofer-ignore data-src="https://i.imgur.com/GsoAV2N.png" alt="1592294802104968" /></p><p>HMC攻击</p><ul><li>依赖于服务端对 http header中关键字符的过滤，而缓存服务器则无视的语义差异<li>当http header属性中带有<code class="language-plaintext highlighter-rouge">\t</code>，对于Play2后端框架会发生<code class="language-plaintext highlighter-rouge">400 Bad Request</code>，<li>而对于CDN Azure，可以正常放行<li>如此攻击即可用<code class="language-plaintext highlighter-rouge">\t</code>来攻击<code class="language-plaintext highlighter-rouge">Play2+Azure</code>的组合，产生Dos攻击。</ul><blockquote><p>对于使用CDN CloudFront的网站，非常容易受到 HMO / HHO / HMC的攻击。 而对于Varnish, Akamai, CDN77, Cloudflare或是Fastly则相对安全。</p></blockquote><p>有多少网站使用较为危险的CDN或中间件：</p><p><img data-proofer-ignore data-src="https://i.imgur.com/O1YLO1l.png" alt="1592294803410122" /></p><hr /><h3 id="攻击前提">攻击前提</h3><ul><li>即我们需要是第一个请求某个页面的人</ul><p>如何做到这一点</p><ul><li>利用response里的 <font color="red"> Age和 max-age </font><ul><li>Age代表当前response的时间，<li>max-age代表该页面缓存何时会过期，</ul><li>以此我们即可计算出投毒时机。</ul><p><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200509/1588992001357546.png" alt="attack" title="1588839623163142.png" /></p><h3 id="保护网站免收此类攻击">保护网站免收此类攻击</h3><ul><li>by cache key<li>利用 Vary 指定 Cache Key 为 User-Agent，<li>那么不仅需要<code class="language-plaintext highlighter-rouge">2个访问者请求域名和url相同</code>，同时需要<code class="language-plaintext highlighter-rouge">2人拥有同样的User-Agent</code>，才会命中同一块cache。</ul><p><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200509/1588992003123256.png" alt="protect" title="1588839631138146.png" /></p><hr /><h2 id="web-cache-deception-web缓存欺骗">Web Cache Deception Web缓存欺骗</h2><p>相较于前两种攻击，该攻击更为普遍，利用也相对容易。不乏其在CTF中出现的频频身影。</p><p><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200509/1588992004715055.png" alt="Web" title="1588839644402612.png" /></p><p>例如，</p><ul><li>网站 <code class="language-plaintext highlighter-rouge">htttp://www.example.com</code> 配置了反向代理。<li>对于包含用户个人信息的页面，如 <code class="language-plaintext highlighter-rouge">http://www.example.com/home.php</code> ，由于每个用户返回的内容有所不同，因此这类页面通常是动态生成，并不会在缓存服务器中进行缓存。<li>通常缓存的主要是可公开访问的静态文件，如<code class="language-plaintext highlighter-rouge">css文件、js文件、txt文件、图片</code>等等。<li>此外，很多最佳实践类的文章也建议，对于那些能公开访问的静态文件进行缓存，并且忽略HTTP缓存头。</ul><p>Web cache攻击类似于RPO相对路径重写攻击，都 <font color="red"> 依赖于浏览器与服务器对URL的解析方式 </font></p><ul><li>当访问不存在的URL时，如 <code class="language-plaintext highlighter-rouge">http://www.example.com/home.php/non-existent.css</code><li>浏览器发送get请求，依赖于使用的技术与配置，服务器返回了页面 <code class="language-plaintext highlighter-rouge">http://www.example.com/home.php</code> 的内容<li>同时URL地址仍然是 <code class="language-plaintext highlighter-rouge">http://www.example.com/home.php/non-existent.css</code>，<li>http头的内容也与直接访问 <code class="language-plaintext highlighter-rouge">http://www.example.com/home.php</code> 相同，cacheing header、content-type（此处为text/html）也相同。</ul><h3 id="漏洞成因">漏洞成因</h3><p>当代理服务器设置为 <font color="red"> 缓存静态文件 </font> 并 <font color="red"> 忽略这类文件的caching header</font> 时，</p><ol><li>访问 <code class="language-plaintext highlighter-rouge">http://www.example.com/home.php/no-existent.css</code><li>浏览器请求 <code class="language-plaintext highlighter-rouge">http://www.example.com/home.php/no-existent.css</code> ;<li>服务器返回 <code class="language-plaintext highlighter-rouge">http://www.example.com/home.php</code> 的内容(通常来说不会缓存该页面);<li>响应经过代理服务器;<li>代理识别该文件有css后缀;<li>在缓存目录下，代理服务器创建目录 <code class="language-plaintext highlighter-rouge">home.php</code> ，将返回的内容作为 <code class="language-plaintext highlighter-rouge">non-existent.css</code> 保存。</ol><h3 id="漏洞利用">漏洞利用</h3><p>A successful exploitation will cause the vulnerable page – <font color="red"> containing the user's personal content </font> – to be cached and thus publicly accessible.</p><ul><li>This is a cached, static version of the file; the attacker cannot impersonate the victim.<li>The file cannot be overridden, and remains valid until it expires.<li>导致含有用户个人信息的页面被缓存，从而能被公开访问到。<li>The impact can increase significantly <code class="language-plaintext highlighter-rouge">if the body of the response</code> contains the <code class="language-plaintext highlighter-rouge">user's session identifier (for some reason)</code>, <code class="language-plaintext highlighter-rouge">security answers</code>, <code class="language-plaintext highlighter-rouge">CSRF tokens</code>, etc.<ul><li>如果返回的内容包含session标识、安全问题的答案，或者csrf token。这样攻击者能接着获得这些信息，因为通常而言大部分网站静态资源都是公开可访问的。</ul><li>leveraged to additional attacks, and lead to a complete account takeover.</ul><h3 id="漏洞条件">漏洞条件</h3><p>Three conditions must be met in order for an attacker to perform web cache deception:</p><ol><li>accessing <code class="language-plaintext highlighter-rouge">http://www.example.com/home.php/nonexistent.css</code>, the web server returns the content of <code class="language-plaintext highlighter-rouge">home.php</code> for that URL.<li>Web cache functionality is set for the web application to cache files by their extensions, disregarding any caching headers.<li>The victim must be authenticated while accessing the malicious URL<li>web cache功能根据扩展进行保存，并忽略caching header;</ol><h3 id="攻击实现-2">攻击实现:</h3><h4 id="example-1-1">example 1</h4><p><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200612/1591971871132192.png" alt="attack" title="1591971871132192.png" /></p><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="c"># 诱导管理员访问链接：</span>
http://10.2.122.1/secret.php/test.css

<span class="c"># 由于是第一次访问，Web Cache将其转发给源服务器，</span>

<span class="c"># 服务器处理该链接源服务器在解析时，由于中间件或者后端配置问题，将其解析为访问/secret.php路由，并进行response，而此时Web Cache将其对应记录。</span>
<span class="c"># 由于test.css不存在，其会向前解析，如下：</span>
http://10.2.122.1/secret.php

<span class="c"># 此时response页面即为secret.php的页面内容，而CDN对此不知，其认为当请求链接为：</span>
http://10.2.122.1/secret.php/test.css
<span class="c"># response应为管理员的secret.php页面内容。</span>

<span class="c"># 而后攻击者再次请求：</span>
http://10.2.122.1/secret.php/test.css
<span class="c"># CDN将作出响应，将管理员的secret.php页面内容返回，造成信息泄露。</span>
</pre></table></code></div></div><p><strong>工具设计</strong></p><p><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200612/1591971895155938.png" alt="2020-06-12-22-01-47.png" title="1591971895155938.png" /></p><p>利用该攻击 <font color="red"> WCD(Web Cache Deception) </font> 的场景为：</p><ul><li>网站有一些私有信息，只能由用户访问，<li>但因为Web Cache欺骗，致使其他用户可以访问到这些数据。<li>这就是一次WCD(Web Cache Deception)攻击。</ul><p>首先作者进行了网站搜集，其建立一个种子池:</p><ul><li>然后使用启发式工具，发现池中网站的子域名，以此扩充数据集。<li>然后对每个网站进行账户创建，此时分别创立2个用户：攻击者用户与受害者用户。<li>此举旨在后期利用攻击者用户获取受害者用户数据。<li>同时还会使用爬虫搜集攻击者与受害者的cookies信息，以判断WCD攻击是否需要依赖于Cookies。</ul><blockquote><p>值得注意的是，在搜集网站的时候，由于利用种子池中的域名，进行启发式搜集 那么爬虫可能遇到大量相似的url： 这样的遍历和循环非常的浪费时间，于是作者设置了上限，诸如此类的url，每个域名只随机挑选500个。</p></blockquote><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>http://example.com/?lang=en
http://example.com/?lang=fr
http://example.com/?lang=cn

http://example.com/028
http://example.com/142
http://example.com/359
</pre></table></code></div></div><p>在上述准备工作完毕后，则使用工具以此测试每个url是否存在WCD攻击隐患。攻击做法如下：</p><ol><li>对于指定url：<ul><li><code class="language-plaintext highlighter-rouge">http://example.com/028</code><li>在其路径后拼接随机数.css文件：<li><code class="language-plaintext highlighter-rouge">http://example.com/028/.css</code></ul><li><p>使用受害者账户点击上述网址</p><li><p>使用攻击者账户点击上述网址，并记录回显</p><li>再次点击上述网址，但此时不带任何cookie，并记录回显</ol><p>然后对搜集到的response进行提取</p><ul><li>查看里面是否有受害者账户的关键信息，<li>同时判断response中是否带出安全相关属性，例如 : <code class="language-plaintext highlighter-rouge">csrf、xsrf、token、state、client-id</code></ul><p><strong>实验评估</strong></p><p>作者首先在Alexa Top 5K网站中，选取了295个支持Google OAuth的网站:</p><ul><li><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200612/1591971965587052.png" alt="OAuth" /></ul><p>将其作为种子池，进行爬取并测试:</p><ul><li><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200612/1591971971213209.png" alt="种子池" /></ul><p>在1470410个网页中</p><ul><li>有17293个页面存在WCD攻击，<li>同时发现对于使用 <font color="red"> Cloudflare 和 Akamai CDN </font> 的网站可能更容易受到威胁：<li><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200612/1591971976173733.png" alt="WCD" /></ul><p>同时在受到WCD的网页中，其可以泄露的私密数据分布如下：</p><ul><li><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200612/1591971983110426.png" alt="victim" /><li>不仅用户名泄露较为严重，Sess ID、Auth Code等安全相关的信息泄露也存在一定比例。</ul><p>并且通过对照观察，在使用cookie和不使用cookie时，攻击结果一致</p><ul><li>说明WCD攻击不依赖于授权用户或带有cookie的访问者。<li>进一步提升了该攻击的危害性，降低攻击成本。</ul><p>同时，作者还提出了相应的bypass方式，其发现不仅诸如如下请求方式可以进行WCD攻击：使用其他一些手段也可以达成相应的目的：</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>/account.php/nonexistent.jpg
/account.php%0Anonexistent.jpg
/account.php%3Bnonexistent.jpg
/account.php%23nonexistent.jpg
/account.php%3Fnonexistent.jpg
</pre></table></code></div></div><p>同时作者进一步加大了数据集，用于测试新的payload方式，同时发现其分布如下：</p><p><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200612/1591972003144284.png" alt="2020-06-12-22-19-05.png" title="1591972003144284.png" /></p><p>可见这些bypass方式可以有效的进行WCD攻击。</p><ul><li>同时这些攻击也可以并存<li>例如既可以使用 <code class="language-plaintext highlighter-rouge">%0A</code> 进行WCD攻击，也可以使用 <code class="language-plaintext highlighter-rouge">%3F</code> 进行WCD攻击：</ul><p><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200612/1591972011983805.png" alt="2020-06-12-22-20-41.png" title="1591972011983805.png" /></p><h4 id="example-2-1">example 2</h4><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c"># 1. The attacker lures a logged-on user to access https://www.bank.com/account.do/logo.png.</span>
<span class="c"># 2. The victim's browser requests https://www.bank.com/account.do/logo.png.</span>
<span class="c"># 3. The request arrives to the proxy, which is not familiar with this file, and therefore asks the web server for it.</span>
<span class="c"># 4. The web server returns the content of the victim's account page with a 200 OK response, meaning the URL stays the same.</span>
<span class="c"># 5. The caching mechanism receives the file and identifies that the URL ends with a static extension (.png). Because the mechanism is configured to cache all static files and disregard any caching headers, the imposter .png file is cached. A new directory named account.do is created in the cache directory, and the file is cached with the name logo.png.</span>
<span class="c"># 6. The user receives his account page.</span>
<span class="c"># 7. The attacker accesses https://www.bank.com/account.do/logo.png. The request arrives to the proxy server, which directly returns the victim’s cached account page to the attacker's browser.</span>
</pre></table></code></div></div><h3 id="漏洞防御-mitigations">漏洞防御 MITIGATIONS</h3><ol><li>Configure the <code class="language-plaintext highlighter-rouge">cache mechanism</code><ul><li>to cache files only if their <code class="language-plaintext highlighter-rouge">HTTP caching headers</code> allow.<li>从根本上杜绝该问题;</ul><li>Store all static files in a designated directory and cache only that directory.<li>If the cache component provides the option, configure it to cache files by their content type.<ul><li>如果缓存组件提供选项，设置为根据content-type进行缓存;</ul><li>Configure the web server<ul><li>so pages like <code class="language-plaintext highlighter-rouge">http://www.example.com/home.php/nonexistent.css</code>,<li>the web server does not return the content of <code class="language-plaintext highlighter-rouge">home.php</code> with the triggering URL;<li>instead, the server should return a <code class="language-plaintext highlighter-rouge">404 or 302</code> response.</ul></ol><h3 id="web-cache欺骗攻击实例">Web Cache欺骗攻击实例</h3><blockquote><p>Paypal Paypal在未修复之前，通过该攻击，可以获取的信息包括：用户姓名、账户金额、信用卡的最后4位数、交易数据、emaill地址等信息。受该攻击的部分页面包括：</p><ul><li><code class="language-plaintext highlighter-rouge">https://www.paypal.com/myaccount/home/attack.css</code><li><code class="language-plaintext highlighter-rouge">https://www.paypal.com/myaccount/settings/notifications/attack.css</code><li><code class="language-plaintext highlighter-rouge">https://history.paypal.com/cgi-bin/webscr/attack.css?cmd=_history-details</code> 。</ul></blockquote><p>此种攻击在2019 CyBRICS CTF Quals或2019 XCTF Final都有出现，</p><p>以2019 CyBRICS CTF Quals的一道题为例：</p><ul><li><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200509/1588992005954775.jpeg" alt="CTF" title="1588839679460813.jpeg" /><li>题目预设了request功能，同时注意到其http header：<li><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200509/1588992005300570.jpeg" alt="CTF" title="1588839688925608.jpeg" /></ul><p>结合题目提示：cache is vulnerabilities，那么可以判断此处应该为Web缓存欺骗的情况。</p><p>需要利用request功能，让其去请求flag页面，再利用缓存信息将内容带出。</p><ul><li>首先可以读取主页内容，构造 <code class="language-plaintext highlighter-rouge">http://95.179.190.31/index.php/skyiscool.js</code><li>此时缓存将会将此url记录，对应内容则为 <code class="language-plaintext highlighter-rouge">index.php</code> 的内容。<li>然后我们再次访问该链接，即可获取 index.php内容：<ul><li><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200509/1588992005809818.jpeg" alt="index" title="1588839703188063.jpeg" /></ul><li>再让题目携带 csrf-token 去请求 flag 即可：<ul><li><img data-proofer-ignore data-src="https://img.4hou.com/uploads/ueditor/php/upload/image/20200509/1588992006185190.jpeg" alt="index" title="1588839710995888.jpeg" /><li><code class="language-plaintext highlighter-rouge">http://95.179.190.31/index.php/skyiscool.js?csrf-token=b04d2bc2f3d3654947ba82d59a2b367630743d3447dbc0af46182359f166c4bd%26flag=1</code></ul><li>此时再请求缓存页面，即可获取flag:<ul><li><code class="language-plaintext highlighter-rouge">cybrics{Bu9s_C4N_83_uN1N73Nd3D!}</code></ul></ul><hr /><p>ref:</p><ul><li>http://drops.xmd5.com/static/drops/tips-9947.html<li>https://skysec.top/2019/07/22/CyBRICS-CTF-Quals-2019-Web-Writeup/#Fixaref<li>https://www.blackhat.com/docs/us-17/wednesday/us-17-Gil-Web-Cache-Deception-Attack-wp.pdf<li><a href="https://i.blackhat.com/us-18/Thu-August-9/us-18-Kettle-Practical-Web-Cache-Poisoning-Redefining-Unexploitable.pdf">WHITE PAPERWEB CACHE DECEPTION ATTACK</a><li><a href="https://www.4hou.com/posts/RwoL">Web缓存利用分析(一)</a><li><a href="https://www.4hou.com/posts/vDmM">Web缓存利用分析(二)</a><li><a href="https://www.4hou.com/posts/p79y">Web缓存利用分析(三)</a><li>Cached and Confused: Web Cache Deception in the Wild<li><a href="https://portswigger.net/blog/practical-web-cache-poisoning">practical web cache poisoning</a><li><a href="https://www.usenix.org/conference/usenixsecurity18/presentation/hao">End-Users Get Maneuvered: Empirical Analysis of Redirection Hijacking in Content Delivery Networks</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/10cyberattack/'>10CyberAttack</a>, <a href='/categories/vulnerability/'>Vulnerability</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/cyberattack/" class="post-tag no-text-decoration" >CyberAttack</a> <a href="/tags/vulnerability/" class="post-tag no-text-decoration" >Vulnerability</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Meow's CyberAttack - - Web cache posion - Grace&url=https://ocholuo.github.io//posts/web-cache/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Meow's CyberAttack - - Web cache posion - Grace&u=https://ocholuo.github.io//posts/web-cache/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Meow's CyberAttack - - Web cache posion - Grace&url=https://ocholuo.github.io//posts/web-cache/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Amazon-CloudFront/">AWS Lab - AWS CloudFront</a><li><a href="/posts/Alexa-1stSkill/">AWS Alex First Skill - RedVelvet Time</a><li><a href="/posts/NetworkProtocol-SSL-TLS-Handshake/">NetworkProtocol SSL/TLS Handshake</a><li><a href="/posts/pythonCrash/">Python Crash</a><li><a href="/posts/%E4%B8%80%E5%8F%A5%E8%AF%9D%E8%A7%A3%E9%87%8AAWS/">AWS - 一句话解释AWS</a><li><a href="/posts/GKE/">GCP - Google Cloud Computing - Kubernetes and Kubernetes Engine</a><li><a href="/posts/Go-Note/">Go Note</a><li><a href="/posts/SCPs/">AWS - IdenAccessManage - SCPs (Service Control Policies)</a><li><a href="/posts/CompanyBenefit/">Company Benefit</a><li><a href="/posts/Encryption-SSL&TLS/">Cryptography - SSL/TLS Encryption</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/FireEye12/"><div class="card-body"> <span class="timeago small" >Dec 13, 2020<i class="unloaded">2020-12-13T10:11:11-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Vul - FireEye 20201213</h3><div class="text-muted small"><p> [toc] Vulnerability - FireEye 202012 SUNBURST Malware Overview 12142020 DESCRIPTION SUNBURST is a backdoor that has the ability to spawn and kill processes, write and d...</p></div></div></a></div><div class="card"> <a href="/posts/CVE-2020-9484/"><div class="card-body"> <span class="timeago small" >Jan 9, 2021<i class="unloaded">2021-01-09T10:11:11-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Vul - CVE-2020-9484 Tomcat RCE漏洞分析</h3><div class="text-muted small"><p> CVE-2020-9484 Tomcat RCE漏洞分析 1. 漏洞简述 2. 条件 Tomcat PersistentManager Configuration The exploit 3. 漏洞详情 4. 漏洞复现 ...</p></div></div></a></div><div class="card"> <a href="/posts/HSTS/"><div class="card-body"> <span class="timeago small" >Sep 28, 2020<i class="unloaded">2020-09-28T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HSTS - HTTP Strict Transport Security</h3><div class="text-muted small"><p> [toc] HSTS - HTTP Strict Transport Security The HTTP Strict Transport Security (HSTS) header a web security policy mechanism web sites communicate to browsers that all traffic exchanged ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/FireEye12/" class="btn btn-outline-primary" prompt="Older"><p>Vul - FireEye 20201213</p></a> <a href="/posts/Prometheus/" class="btn btn-outline-primary" prompt="Newer"><p>Monitor - Prometheus</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ocholuo">Grace JyL</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ocholuo.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script defer src="/assets/js/dist/pvreport.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-179830187-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-179830187-1'); }); </script>
