<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="pv-proxy-endpoint" content="https://myochosite-291718.appspot.com/query?id=ahNwfm15b2Nob3NpdGUtMjkxNzE4chULEghBcGlRdWVyeRiAgIDo14eBCgw"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="AWS - CodeDevelop - CodePipeline" /><meta property="og:locale" content="en" /><meta name="description" content="CodePipeline basic Components of AWS Data Pipeline Accessing AWS Data Pipeline Related Services Pipeline Components, Instances, and Attempts Pipeline Definition Pipeline Components Data Nodes setup CodePipeline: CodeCommit - ManualAppove - CloudFormation CodePipeline: S3 - CodeDeploy - CloudFormation" /><meta property="og:description" content="CodePipeline basic Components of AWS Data Pipeline Accessing AWS Data Pipeline Related Services Pipeline Components, Instances, and Attempts Pipeline Definition Pipeline Components Data Nodes setup CodePipeline: CodeCommit - ManualAppove - CloudFormation CodePipeline: S3 - CodeDeploy - CloudFormation" /><link rel="canonical" href="https://ocholuo.github.io//posts/0CodePipeline/" /><meta property="og:url" content="https://ocholuo.github.io//posts/0CodePipeline/" /><meta property="og:site_name" content="Grace" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-07-18T11:11:11-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="AWS - CodeDevelop - CodePipeline" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-02T18:41:04-05:00","datePublished":"2020-07-18T11:11:11-04:00","description":"CodePipeline basic Components of AWS Data Pipeline Accessing AWS Data Pipeline Related Services Pipeline Components, Instances, and Attempts Pipeline Definition Pipeline Components Data Nodes setup CodePipeline: CodeCommit - ManualAppove - CloudFormation CodePipeline: S3 - CodeDeploy - CloudFormation","headline":"AWS - CodeDevelop - CodePipeline","mainEntityOfPage":{"@type":"WebPage","@id":"https://ocholuo.github.io//posts/0CodePipeline/"},"url":"https://ocholuo.github.io//posts/0CodePipeline/"}</script><title>AWS - CodeDevelop - CodePipeline | Grace</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Grace"><meta name="application-name" content="Grace"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://myochosite-291718.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://myochosite-291718.appspot.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/huoye.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Grace</a></div><div class="site-subtitle font-italic">2023 Mar 14 updated</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/ocholuo" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>AWS - CodeDevelop - CodePipeline</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>AWS - CodeDevelop - CodePipeline</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Grace JyL </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Jul 18, 2020, 11:11 AM -0400" >Jul 18, 2020<i class="unloaded">2020-07-18T11:11:11-04:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Jan 2, 2023, 3:41 PM -0800" >Jan 2<i class="unloaded">2023-01-02T18:41:04-05:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2137 words">11 min read</span> <span id="pv" class="pageviews"> <i class="fas fa-spinner fa-spin fa-fw"></i> </span> views</div></div><div class="post-content"><ul><li><a href="#codepipeline">CodePipeline</a><ul><li><a href="#basic">basic</a><li><a href="#components-of-aws-data-pipeline">Components of AWS Data Pipeline</a><li><a href="#accessing-aws-data-pipeline">Accessing AWS Data Pipeline</a><li><a href="#related-services">Related Services</a><li><a href="#pipeline-components-instances-and-attempts">Pipeline Components, Instances, and Attempts</a><li><a href="#pipeline-definition">Pipeline Definition</a><li><a href="#pipeline-components">Pipeline Components</a><ul><li><a href="#data-nodes">Data Nodes</a></ul><li><a href="#setup">setup</a><ul><li><a href="#codepipeline-codecommit---manualappove---cloudformation">CodePipeline: CodeCommit - ManualAppove - CloudFormation</a><li><a href="#codepipeline-s3---codedeploy---cloudformation">CodePipeline: S3 - CodeDeploy - CloudFormation</a></ul></ul></ul><hr /><h1 id="codepipeline">CodePipeline</h1><hr /><h2 id="basic">basic</h2><ul><li>a web service<li>automate the movement and transformation of data.<li>define data-driven workflows<ul><li>tasks can be dependent on the successful completion of previous tasks.</ul><li><p>define the parameters of your data transformations and AWS Data Pipeline enforces the logic that you’ve set up.</p><li>fully managed<li> <font color="red"> Continuous integration / continuous delivery service. </font><ul><li>Orchestrates <font color="blue"> Build, Test &amp; Deployment (the end-to-end software release process) </font> based on the workflow pre-defined.<li>A pipeline is a workflow construct that describes how code changes go through a release process.</ul><li> <font color="red"> Automated release process required to release the code </font><ul><li>fast, consistent, fewer mistakes<li>The pipeline is triggered every time there is a changeto your code<li>enables quick release of new features and bug fixes.</ul><li> <font color="red"> CodePipeline integrates with </font><ul><li>CodeCommit, CodeBuild, CodeDeploy,<li>Github, Jenkins, Elasetic Beanstalk,<li>CloudFormation, Lambda<li>Elastic container Service</ul></ul><p><img data-proofer-ignore data-src="https://i.imgur.com/IOZKewF.png" alt="CodePipeline" /></p><p>CodePipeline: <font color="blue"> Defined Workflow </font></p><ul><li>the workflow begins when there is a change detected in the source code.</ul><p>CodeCommit: <font color="blue"> New code appears </font></p><ul><li>New source code appears in the CodeCommit repository</ul><p>CodeBuild: <font color="blue"> Code is built&amp;tested </font></p><ul><li>CodeBuild immediately compiles source code, runs tests, and produces packages.</ul><p>CodeDeploy: <font color="blue"> Application Deployed </font></p><ul><li>The newly built application is deployed into a staging or porduction environment.</ul><hr /><h2 id="components-of-aws-data-pipeline">Components of AWS Data Pipeline</h2><p>Components of AWS Data Pipeline work together to manage the data:</p><ol><li><p>A <font color="red"> pipeline definition </font> specifies the business logic of your data management.</p><li>A <font color="red"> pipeline schedules </font> and runs tasks by creating Amazon EC2 instances to perform the defined work activities.<ul><li>upload your pipeline definition to the pipeline,<li>and then activate the pipeline.<li>can edit the pipeline definition for a running pipeline and activate the pipeline again for it to take effect.<li>can deactivate the pipeline, modify a data source, and then activate the pipeline again.<li>When finished with your pipeline, can delete it.</ul><li> <font color="red"> Task Runner </font><p>polls for tasks and then performs those tasks.</p><ul><li>For example:<li>Task Runner could copy log files to Amazon S3 and launch Amazon EMR clusters.<li>Task Runner is installed and runs automatically on resources created by the pipeline definitions.<li>write a custom task runner application, or you can use the Task Runner application that is provided by AWS Data Pipeline.</ul></ol><p>For example</p><ul><li>use AWS Data Pipeline to archive your web server’s logs to Amazon Simple Storage Service (Amazon S3) each day and then run a weekly Amazon EMR (Amazon EMR) cluster over those logs to generate traffic reports.<li>AWS Data Pipeline schedules the daily tasks to copy data and the weekly task to launch the Amazon EMR cluster.<li>AWS Data Pipeline ensures that Amazon EMR waits for the final day’s data to be uploaded to Amazon S3 before it begins its analysis, even if there is an unforeseen delay in uploading the logs.</ul><h2 id="accessing-aws-data-pipeline">Accessing AWS Data Pipeline</h2><p>You can create, access, and manage your pipelines using any of the following interfaces:</p><ol><li>AWS Management Console:<ul><li>web interface to access AWS Data Pipeline.</ul><li>AWS Command Line Interface (AWS CLI):<ul><li>Provides commands for a broad set of AWS services, including AWS Data Pipeline<li>supported on Windows, macOS, and Linux.</ul><li>AWS SDKs<ul><li>Provides language-specific APIs and takes care of many of the connection details, such as calculating signatures, handling request retries, and error handling.</ul><li>Query API<ul><li>Provides low-level APIs that you call using HTTPS requests.<li>Using the Query API is the most direct way to access AWS Data Pipeline, but it requires that your application handle low-level details such as generating the hash to sign the request, and error handling.</ul></ol><hr /><h2 id="related-services">Related Services</h2><p>AWS Data Pipeline works with the following services <font color="red"> to store data </font></p><ul><li> <font color="blue"> Amazon DynamoDB </font><ul><li>fully managed NoSQL database with fast performance at a low cost.</ul><li> <font color="blue"> Amazon RDS </font><ul><li>fully managed relational database that scales to large datasets.</ul><li> <font color="blue"> Amazon Redshift </font><ul><li>fast, fully managed, petabyte-scale data warehouse that makes it easy and cost-effective to analyze a vast amount of data.</ul><li> <font color="blue"> Amazon S3 </font><ul><li>secure, durable, and highly scalable object storage.</ul></ul><p>AWS Data Pipeline works with the following compute services to <font color="red"> transform data </font></p><ul><li> <font color="red"> Amazon EC2 </font><ul><li>resizable computing capacity to build and host your software systems.</ul><li> <font color="red"> Amazon EMR </font><ul><li>easy, fast, and cost-effective to distribute and process vast amounts of data across Amazon EC2 servers,<li>using a framework such as Apache Hadoop or Apache Spark.</ul></ul><hr /><h2 id="pipeline-components-instances-and-attempts">Pipeline Components, Instances, and Attempts</h2><p>3 types of items associated with a scheduled pipeline:</p><ol><li>Pipeline Components<ul><li>define the rules of data management.<li>represent the business logic of the pipeline<li>represented by the different sections of a pipeline definition.<li>specify the data sources, activities, schedule, and preconditions of the workflow.<li>can inherit properties from parent components. Relationships among components are defined by reference.</ul><li>Instances<ul><li>When AWS Data Pipeline runs a pipeline, it compiles the pipeline components to create a set of actionable instances.<li>Each instance contains all the information for performing a specific task.<li>The complete set of instances is the to-do list of the pipeline.<li>AWS Data Pipeline hands the instances out to task runners to process.</ul><li>Attempt objects<ul><li>To provide robust data management, AWS Data Pipeline retries a failed operation.<li>It continues to do so until the task reaches the maximum number of allowed retry attempts.<li>Attempt objects track the various attempts, results, and failure reasons if applicable.<li>Essentially, it is the instance with a counter.<li>AWS Data Pipeline performs retries using the same resources from the previous attempts, such as Amazon EMR clusters and EC2 instances.</ul></ol><p>Retrying failed tasks</p><ul><li>an important part of a fault tolerance strategy, and AWS Data Pipeline definitions provide conditions and thresholds to control retries.<li>but too many retries can delay detection of an unrecoverable failure<ul><li>because AWS Data Pipeline does not report failure until it has exhausted all the retries that you specify.<li>The extra retries may accrue additional charges if they are running on AWS resources.<li>As a result, carefully consider when it is appropriate to exceed the AWS Data Pipeline default settings that you use to control re-tries and related settings.</ul></ul><p><img data-proofer-ignore data-src="https://i.imgur.com/CXbguCV.png" alt="dp-object-types" /></p><hr /><h2 id="pipeline-definition">Pipeline Definition</h2><p><strong>pipeline definition</strong>: how business logic communicate to AWS Data Pipeline.</p><ul><li>It contains the following information:<ul><li>Names, locations, and formats of the data sources<li>Activities that transform the data<li>The schedule for those activities<li>Resources that run the activities and preconditions<li>Preconditions that must be satisfied before the activities can be scheduled<li>Ways to alert with status updates as pipeline execution proceeds</ul></ul><p>From your pipeline definition, AWS Data Pipeline determines the tasks, schedules them, and assigns them to task runners.</p><ul><li>If a task is not completed successfully, AWS Data Pipeline retries the task according to your instructions and, if necessary, reassigns it to another task runner.<li>If the task fails repeatedly, you can configure the pipeline to notify you.</ul><blockquote><p>For example in pipeline definition: specify that log files generated by your application are archived each month in 2013 to an Amazon S3 bucket. AWS Data Pipeline would then create 12 tasks, each copying over a month’s worth of data, regardless of whether the month contained 30, 31, 28, or 29 days.</p></blockquote><font color="red"> create a pipeline definition </font><ul><li>Graphically, by using the AWS Data Pipeline console<li>Textually, JSON file used by the command line interface<li>Programmatically, call the web service with either one of the AWS SDKs or the AWS Data Pipeline API</ul><hr /><h2 id="pipeline-components">Pipeline Components</h2><h3 id="data-nodes">Data Nodes</h3><ul><li>the location and type of data that a pipeline activity uses as input data for a task or output data is to be stored.<li>AWS Data Pipeline supports the following types of data nodes:<ul><li>DynamoDBDataNode<ul><li>A DynamoDB table that contains data for HiveActivity or EmrActivity to use.</ul><li>SqlDataNode<ul><li>An SQL table and database query that represent data for a pipeline activity to use.<li>Previously, MySqlDataNode was used. Use SqlDataNode instead.</ul><li>RedshiftDataNode<ul><li>An Amazon Redshift table that contains data for RedshiftCopyActivity to use.</ul><li>S3DataNode<ul><li>An Amazon S3 location that contains one or more files for a pipeline activity to use.</ul></ul></ul><p>Activities A definition of work to perform on a schedule using a computational resource and typically input and output data nodes.</p><p>Preconditions A conditional statement that must be true before an action can run.</p><p>Scheduling Pipelines Defines the timing of a scheduled event, such as when an activity runs.</p><p>Resources The computational resource that performs the work that a pipeline defines.</p><p>Actions An action that is triggered when specified conditions are met, such as the failure of an activity.</p><p>For more information, see Pipeline Definition File Syntax.</p><hr /><h2 id="setup">setup</h2><hr /><h3 id="codepipeline-codecommit---manualappove---cloudformation">CodePipeline: CodeCommit - ManualAppove - CloudFormation</h3><p><img data-proofer-ignore data-src="https://i.imgur.com/DDhcJmb.png" alt="Screen Shot 2021-01-18 at 19.41.32" /></p><ol><li>Create an AWS IAM Role<ul><li>the service that will use this role: <code class="language-plaintext highlighter-rouge">CloudFormation</code><li>role name: <font color="blue"> pipeRoleFullAdminAcess </font><li>Click Next: Permissions:<ul><li><ul><li><code class="language-plaintext highlighter-rouge">AdministratorAccess</code> permissions policy.</ul><li>Allows CloudFormation to create and manage AWS stacks and resources on your behalf.</ul></ul><li>Create an AWS CodeCommit Repository and SNS Topic<ul><li>Create an AWS CodeCommit Repository<ul><li>Repository name: <font color="blue"> pipeTestsRepo </font></ul><li>Navigate to Simple Notification Service (SNS).<ul><li>Enter “manualapprove” as the topic name.<li>Click Next step &gt; Create topic.<li>Create subscription: Email as the protocol.<li>Enter your email address as the endpoint.<li>Click Create subscription.<li>Navigate to your inbox and Confirm subscription link.</ul></ul><li>Create an AWS CodePipeline Pipeline<ul><li>CodePipeline.<li>Create pipeline.<ul><li>pipeline name: “ManualApprove4CF”<ul><li>Ensure <code class="language-plaintext highlighter-rouge">New service role</code> is selected.<li>Ensure <code class="language-plaintext highlighter-rouge">Allow AWS CodePipeline to create service role so it can be used with this new pipeline</code> is checked.</ul><li>Advanced settings section<ul><li>ensure the <code class="language-plaintext highlighter-rouge">Default location</code> and <code class="language-plaintext highlighter-rouge">Default AWS Managed Key options</code> are selected.</ul><li>Add <font color="red"> source stage </font> page:<ul><li>Source provider: <font color="blue"> AWS CodeCommit </font><li>Repository name: <font color="blue"> pipeTestsRepo </font><li>Branch name: master<li>Change detection options: Amazon CloudWatch Events (recommended)</ul><li>Skip build stage<li>Add <font color="red"> deploy stage </font> page:<ul><li>Deploy provider: <font color="blue"> AWS CloudFormation </font><li>Region: US East - (N. Virginia)<li>Action mode: Create or update a stack<li>Stack name: deploywithmanualapprove<li>Artifact name: SourceArtifact<li>File name: S3Retain.yaml<li>Role name: <font color="blue"> pipeRoleFullAdminAcess </font><li>Click Next &gt; Create pipeline.</ul><li>Click the AWS CloudFormation link in the Deploy panel.<li>Once CloudFormation shows complete, return to the CodePipeline service and verify the manualapprove pipeline status shows Succeeded in the Deploy panel.</ul><li>Add stage between the Source and Deploy panels.<ul><li>stage name: <font color="blue"> manualapprove </font><li>Add action group.<ul><li>action name: <code class="language-plaintext highlighter-rouge">manualapproval</code><li>action provider: <code class="language-plaintext highlighter-rouge">Manual approval</code><li>Select the <code class="language-plaintext highlighter-rouge">SNS topic ARN</code> created earlier in the lab.</ul><li>Click Done &gt; Save &gt; Save.</ul><li>Click Release change to restart the pipeline.<li>Navigate to email, open the APPROVAL NEEDED… message.<li>Navigate back to Code Pipeline.<li>Click Review in the Manual approve panel.<li>Enter “Looks good — approved.” in the comments, and click Approve.</ul></ol><hr /><h3 id="codepipeline-s3---codedeploy---cloudformation">CodePipeline: S3 - CodeDeploy - CloudFormation</h3><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>cloudFormation.json

myapp1.zip
- appspec.yml
- index.html
- scripts/
  - scripts.sh

myapp2.zip
myapp3.zip

1. create s3 bucket
2. upload the cloudFormation file into a S3 bucket
3. setup the user
4. run the cloudformation to create the ec2
5. setup CodeDeploy and deploy
6. upload the next version of code (manually triggered)
7. setup the CodePipeline and triggered
8. upload the next version of code (auto triggered)
</pre></table></code></div></div><ol><li>create s3 bucket<ul><li>for the application:<ul><li>same region of the source<li>keep all the version<li>upload the reversion file: myapp1.zip</ul><li>for cloudFormation:<ul><li>upload the cloudFormation file: cloudFormation.json</ul></ul><li><p>upload the cloudFormation file into a S3 bucket</p><li>setup the user<ul><li>aws configure the key pair<div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre> aws iam get-user
 aws configure list
 aws configure
 <span class="c"># input access key id and secrect access key</span>
</pre></table></code></div></div><li>setup user permissions:<ul><li>attach needed policy<ul><li>S3FullAccess, CodeDeployFullAccess,<li>YouNewPolicy<div class="language-json highlighter-rouge"><div class="code-header" text-data="json"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="nl">"Version"</span><span class="p">:</span><span class="s2">"2012-10-17"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"Statement"</span><span class="p">:[</span><span class="w">
     </span><span class="p">{</span><span class="w">
       </span><span class="nl">"Sid"</span><span class="p">:</span><span class="s2">"VisualEditor0"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"Effect"</span><span class="p">:</span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"Action"</span><span class="p">:</span><span class="s2">"cloudformation:*"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"Resource"</span><span class="p">:</span><span class="s2">"*"</span><span class="w">
     </span><span class="p">},</span><span class="w">
     </span><span class="p">{</span><span class="w">
       </span><span class="nl">"Effect"</span><span class="p">:</span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"Action"</span><span class="p">:</span><span class="s2">"iam:*"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"Resource"</span><span class="p">:</span><span class="s2">"*"</span><span class="w">
     </span><span class="p">},</span><span class="w">
     </span><span class="p">{</span><span class="w">
       </span><span class="nl">"Effect"</span><span class="p">:</span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"Action"</span><span class="p">:</span><span class="s2">"ec2:*"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"Resource"</span><span class="p">:</span><span class="s2">"*"</span><span class="w">
     </span><span class="p">}</span><span class="w">
   </span><span class="p">]</span><span class="w">
 </span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div></ul></ul></ul><li>run the cloudformation to create the ec2<div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre> <span class="c"># cloudFormation.json</span>
 <span class="c"># create the ec2 instance</span>
 aws cloudformation create-stack <span class="nt">--stack-name</span> CodeDeployDemoStack <span class="se">\</span>
 <span class="nt">--template-url</span> http://s3-bucket-url/cloudFormation.json <span class="se">\</span>
 <span class="nt">--parameters</span> <span class="se">\</span>
 <span class="nv">ParameterKey</span><span class="o">=</span>InstanceCount, <span class="nv">ParameterValue</span><span class="o">=</span>1 <span class="se">\</span>
 <span class="nv">ParameterKey</span><span class="o">=</span>InstanceType, <span class="nv">ParameterValue</span><span class="o">=</span>t2.micro <span class="se">\</span>
 <span class="nv">ParameterKey</span><span class="o">=</span>KeyPairNamexxxx, <span class="nv">ParameterValue</span><span class="o">=</span>irkpyyyyyyyy <span class="se">\</span>
 <span class="nv">ParameterKey</span><span class="o">=</span>OperatingSystem, <span class="nv">ParameterValue</span><span class="o">=</span>Linux <span class="se">\</span>
 <span class="nv">ParameterKey</span><span class="o">=</span>SSHLocation, <span class="nv">ParameterValue</span><span class="o">=</span>0.0.0.0/0 <span class="se">\</span>
 <span class="nv">ParameterKey</span><span class="o">=</span>TagKey, <span class="nv">ParameterValue</span><span class="o">=</span>Name <span class="se">\</span>
 <span class="nv">ParameterKey</span><span class="o">=</span>TagValue, <span class="nv">ParameterValue</span><span class="o">=</span>CodeDepoloyDemo <span class="se">\</span>
 <span class="nt">--capabilities</span> CAPABILITY_IAM

 <span class="c"># verify the cloudfromation stack has completed using</span>
 aws cloudformation describe-stacks <span class="nt">--stack-name</span> CodeDeployDemoStack <span class="nt">--query</span> <span class="s2">"Stack[0].StackStatus"</span> <span class="nt">--output</span> <span class="nb">test</span>

 <span class="c"># login to instance to check the codedeploy agent</span>
 <span class="nb">sudo </span>service codedeploy-agent status
</pre></table></code></div></div><li> <font color="red"> CodeDeploy </font><p>: setup and deploy</p><ul><li> <font color="blue"> create application </font><ul><li>application name<li>compute plantform</ul><li> <font color="blue"> create deployment group </font><ul><li>deployment group name<li>service role<li>deployment type<li>environment configuration<ul><li>EC2 instance: Key&amp;Value of created EC2</ul><li>deployment setting<li>Load balancer</ul><li> <font color="blue"> create deployment &lt;- create the application </font><ul><li>select deployment group<li>revision type(S3/Github) and revision location.</ul><li>the application is installed and run</ul><li><p>upload the next version of code (manually triggered)</p><li> <font color="red"> Setup the CodePipeline and triggered</font><ul><li>pipeline setting:<ul><li>pipeline name<li>service role (create a new service role)<li>role name</ul><li>source stage<ul><li>source provider<ul><li>(S3/Github): bucket name</ul><li>detection option<ul><li>Cloudwatch: pipeline</ul></ul><li>build stage<ul><li>CodeBuild or Jenkins</ul><li>deploy stage<ul><li>deploy provider<li>region<li>application name<li>deployment group</ul><li>start building the application</ul><li>upload the next version of code (auto triggered)</ol><p>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/01aws/'>01AWS</a>, <a href='/categories/codedevelop/'>CodeDevelop</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/aws/" class="post-tag no-text-decoration" >AWS</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=AWS - CodeDevelop - CodePipeline - Grace&url=https://ocholuo.github.io//posts/0CodePipeline/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=AWS - CodeDevelop - CodePipeline - Grace&u=https://ocholuo.github.io//posts/0CodePipeline/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=AWS - CodeDevelop - CodePipeline - Grace&url=https://ocholuo.github.io//posts/0CodePipeline/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Amazon-CloudFront/">AWS Lab - AWS CloudFront</a><li><a href="/posts/Alexa-1stSkill/">AWS Alex First Skill - RedVelvet Time</a><li><a href="/posts/NetworkProtocol-SSL-TLS-Handshake/">NetworkProtocol SSL/TLS Handshake</a><li><a href="/posts/pythonCrash/">Python Crash</a><li><a href="/posts/%E4%B8%80%E5%8F%A5%E8%AF%9D%E8%A7%A3%E9%87%8AAWS/">AWS - 一句话解释AWS</a><li><a href="/posts/GKE/">GCP - Google Cloud Computing - Kubernetes and Kubernetes Engine</a><li><a href="/posts/Go-Note/">Go Note</a><li><a href="/posts/SCPs/">AWS - IdenAccessManage - SCPs (Service Control Policies)</a><li><a href="/posts/CompanyBenefit/">Company Benefit</a><li><a href="/posts/Encryption-SSL&TLS/">Cryptography - SSL/TLS Encryption</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/1CodeCommit/"><div class="card-body"> <span class="timeago small" >Jul 18, 2020<i class="unloaded">2020-07-18T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AWS - CodeDevelop - CodeCommit</h3><div class="text-muted small"><p> CodeCommit basic work flow setup CodeCommit a version control service hosted by Amazon Web Services tracks and manages code changes Ma...</p></div></div></a></div><div class="card"> <a href="/posts/2CodeBuild/"><div class="card-body"> <span class="timeago small" >Jul 18, 2020<i class="unloaded">2020-07-18T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AWS - CodeDevelop - CodeBuild</h3><div class="text-muted small"><p> CodeBuild How to run CodeBuild manually docker build process codebuild auto build docker CodeBuild 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # docker command to build,...</p></div></div></a></div><div class="card"> <a href="/posts/2CodeBuildTemplate-Dockerfile/"><div class="card-body"> <span class="timeago small" >Jul 18, 2020<i class="unloaded">2020-07-18T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AWS - CodeDevelop - CodeBuild - dockerfile Template</h3><div class="text-muted small"><p> [toc] dockerfile Template 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 # example from AWS WhitePaper, no real credential inside FROM ubuntu:12.04 # Install dependencies RUN apt-get u...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/SessionAffinity/" class="btn btn-outline-primary" prompt="Older"><p>AWS - Session Affinity, Load-Balanced, Session Fail Over, Sticky Sessions</p></a> <a href="/posts/1CodeCommit/" class="btn btn-outline-primary" prompt="Newer"><p>AWS - CodeDevelop - CodeCommit</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ocholuo">Grace JyL</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ocholuo.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script defer src="/assets/js/dist/pvreport.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-179830187-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-179830187-1'); }); </script>
