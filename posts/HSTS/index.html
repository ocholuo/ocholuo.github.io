<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="pv-proxy-endpoint" content="https://myochosite-291718.appspot.com/query?id=ahNwfm15b2Nob3NpdGUtMjkxNzE4chULEghBcGlRdWVyeRiAgIDo14eBCgw"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="HSTS - HTTP Strict Transport Security" /><meta property="og:locale" content="en" /><meta name="description" content="[toc]" /><meta property="og:description" content="[toc]" /><link rel="canonical" href="https://ocholuo.github.io//posts/HSTS/" /><meta property="og:url" content="https://ocholuo.github.io//posts/HSTS/" /><meta property="og:site_name" content="Grace" /><meta property="og:image" content="https://ocholuo.github.io//assets/img/note/tls-ssl-handshake.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-09-28T11:11:11-04:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://ocholuo.github.io//assets/img/note/tls-ssl-handshake.png" /><meta property="twitter:title" content="HSTS - HTTP Strict Transport Security" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-10-30T21:02:21-04:00","datePublished":"2020-09-28T11:11:11-04:00","description":"[toc]","headline":"HSTS - HTTP Strict Transport Security","image":"https://ocholuo.github.io//assets/img/note/tls-ssl-handshake.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://ocholuo.github.io//posts/HSTS/"},"url":"https://ocholuo.github.io//posts/HSTS/"}</script><title>HSTS - HTTP Strict Transport Security | Grace</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Grace"><meta name="application-name" content="Grace"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://myochosite-291718.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://myochosite-291718.appspot.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/huoye.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Grace</a></div><div class="site-subtitle font-italic">2023 Mar 14 updated</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/ocholuo" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HSTS - HTTP Strict Transport Security</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HSTS - HTTP Strict Transport Security</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Grace JyL </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Sep 28, 2020, 11:11 AM -0400" >Sep 28, 2020<i class="unloaded">2020-09-28T11:11:11-04:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Oct 30, 2022, 6:02 PM -0700" >Oct 30, 2022<i class="unloaded">2022-10-30T21:02:21-04:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1844 words">10 min read</span> <span id="pv" class="pageviews"> <i class="fas fa-spinner fa-spin fa-fw"></i> </span> views</div></div><div class="post-content"><p>[toc]</p><hr /><h1 id="hsts---http-strict-transport-security">HSTS - HTTP Strict Transport Security</h1><ul><li>The <code class="language-plaintext highlighter-rouge">HTTP Strict Transport Security (HSTS) header</code><li>a web security policy mechanism<li>web sites communicate to browsers that all traffic exchanged with a given domain must always be sent over <code class="language-plaintext highlighter-rouge">https</code><ul><li>protect the information from being passed over unencrypted requests.<li>ensure that all the data travels encrypted from the web browser to the server.</ul><li>The <code class="language-plaintext highlighter-rouge">HSTS Policy</code> is communicated by the server to the user agent via a <code class="language-plaintext highlighter-rouge">HTTP response header field</code> named <code class="language-plaintext highlighter-rouge">"Strict-Transport-Security"</code>.<ul><li>HSTS Policy specifies a period of time during which the user agent shall access the server in only secure fashion.<li>The <code class="language-plaintext highlighter-rouge">HTTP Strict Transport Security (HSTS)</code> feature lets a web application to inform the browser, through the use of a special response header, that it should never establish a connection to the the specified domain servers using HTTP. Instead it should automatically establish all connection requests to access the site through HTTPS.</ul></ul><p>The HSTS header uses two directives:</p><ul><li><code class="language-plaintext highlighter-rouge">-max-age</code>:<ul><li>the number of seconds that the browser should automatically convert all HTTP requests to HTTPS.</ul><li><code class="language-plaintext highlighter-rouge">includeSubDomains</code>:<ul><li>all web application’s sub-domains must use HTTPS.<li>If this parameter is set, then the HSTS policy applies to the visited domain and all the subdomains as well.<li>If not it only applies to the exact domain that the user has visited.</ul></ul><p>This header by web applications must be checked,</p><p>When a web application issues <code class="language-plaintext highlighter-rouge">HSTS Policy</code> to user agents, avoid following:</p><ol><li><code class="language-plaintext highlighter-rouge">Attackers sniffing the network traffic</code> and accessing the information transferred through an unencrypted channel.<li><code class="language-plaintext highlighter-rouge">Attackers exploiting a man in the middle attack</code> because of the problem of accepting certificates that are not trusted.<li>user <code class="language-plaintext highlighter-rouge">clicks on HTTP links</code> or even if the user type an HTTP link.<ul><li>Users <code class="language-plaintext highlighter-rouge">mistakenly entered an address</code> put HTTP instead of HTTPS<li>users click on a <code class="language-plaintext highlighter-rouge">link which mistakenly indicated the http protocol</code></ul><li><code class="language-plaintext highlighter-rouge">prevents an user from accepting self-signed or abnormally signed certificates</code>, since remember the certification authority (CA) that signed the previous seen certificate.</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>curl <span class="nt">--silent</span> <span class="nt">--head</span> https://us.com/ | <span class="nb">grep</span> <span class="nt">-i</span> strict
strict-transport-security: max-age<span class="o">=</span>7776000000<span class="p">;</span>
includeSubDomains
</pre></table></code></div></div><hr /><h1 id="remediation">Remediation</h1><p>Configure webserver to redirect HTTP requests to HTTPS.</p><ul><li>i.e. for Apache, you should have modification in the <code class="language-plaintext highlighter-rouge">httpd.conf</code>.</ul><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="c"># load module</span>
LoadModule headers_module modules/mod_headers.so

<span class="c"># redirect all HTTP to HTTPS (optional)</span>
&lt;VirtualHost <span class="k">*</span>:80&gt;
       ServerAlias <span class="k">*</span>
       RewriteEngine On
       RewriteRule ^<span class="o">(</span>.<span class="k">*</span><span class="o">)</span><span class="nv">$ </span>https://%<span class="o">{</span>HTTP_HOST<span class="o">}</span><span class="nv">$1</span> <span class="o">[</span><span class="nv">redirect</span><span class="o">=</span>301]
&lt;/VirtualHost&gt;

<span class="c"># HTTPS-Host-Configuration</span>
&lt;VirtualHost <span class="k">*</span>:443&gt;
      <span class="c"># Use HTTP Strict Transport Security to force client to use secure connections only</span>
      Header always <span class="nb">set </span>Strict-Transport-Security <span class="s2">"max-age=31536000; includeSubDomains"</span>

      <span class="c"># Further Configuration goes here</span>
      <span class="o">[</span>...]
&lt;/VirtualHost&gt;
</pre></table></code></div></div><hr /><h1 id="classifications">Classifications</h1><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>PCI v3.1-6.5.4,
CAPEC-217,
CWE-523,
ISO27001-A.14.1.2,
WASC-4,
OWASP 2013-A6,
OWASP 2017-A3
</pre></table></code></div></div><hr /><h1 id="test-hsts-http-strict-transport-security-otg-config-007">Test <code class="language-plaintext highlighter-rouge">HSTS HTTP Strict Transport Security</code> (OTG-CONFIG-007)</h1><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>curl <span class="nt">--silent</span> <span class="nt">--head</span> https://us.com/ | <span class="nb">grep</span> <span class="nt">-i</span> strict
strict-transport-security: max-age<span class="o">=</span>7776000000<span class="p">;</span>
includeSubDomains
</pre></table></code></div></div><h2 id="bypass">bypass</h2><p>NETWORK TIME PROTOCOL (NTP)</p><ul><li>The Operating Systems use the Internet for a big amount of internal tasks. One of those features is the Time Synchronization.<li>By default, almost all the desktop operating systems automatically synchronize its time with <code class="language-plaintext highlighter-rouge">Internet Servers</code> usually owned by the operating system provider<ul><li>for example ’time.windows.com’ for Microsoft operating systems<li>All of them use different versions (v3 or v4) of the<code class="language-plaintext highlighter-rouge"> Network Time Protocol (NTP)</code> which provide time synchronization between computers.</ul></ul><p>NTP messages are sent via UDP packets (<code class="language-plaintext highlighter-rouge">123/UDP</code>).</p><ul><li>The <code class="language-plaintext highlighter-rouge">message format is the same</code> for both requests and responses,<li>but each peer use a <code class="language-plaintext highlighter-rouge">different set of fields</code> and ignore the rest of them.</ul><p>Most important fields are:</p><p><img data-proofer-ignore data-src="https://i.imgur.com/pYX7uzy.png" alt="Screen Shot 2020-09-29 at 00.44.18" /></p><ul><li><code class="language-plaintext highlighter-rouge">Leap (LI)</code>:<ul><li>a warning indicator<li>should be usually set to zero.<li>Clients often set this value to 3 (clock unsynchronized) when request time synchronization.</ul><li><code class="language-plaintext highlighter-rouge">Version (VN)</code>: NTPv3 or NTPv4.<li><code class="language-plaintext highlighter-rouge">Mode</code>:<ul><li>Usually client (3) or server (4) depending if it is a request or a response.<li>Other values are also possible but they are not used in by default NTP configuration</ul><li><code class="language-plaintext highlighter-rouge">Stratum</code>:<ul><li>Usually from 2 to 15.<li>Values 0 and 1 are used by reference clocks and primary servers and shouldn’t be used by NTP servers.</ul><li><code class="language-plaintext highlighter-rouge">Precision</code>:<ul><li>Usually -18 or -20 (microseconds).<li>Precision of the system clock.<li>Value in log2 seconds.</ul><li><code class="language-plaintext highlighter-rouge">Root delay &amp; dispersion</code>:<ul><li>Total round-trip and dispersion from de reference clock. Value in NTP short format.</ul><li><code class="language-plaintext highlighter-rouge">Reference identifier</code>:<ul><li>Server identifier, usually his IP Address.</ul><li><code class="language-plaintext highlighter-rouge">Timestamps</code>:<ul><li>Different values that are used by the client in order to calculate the current date and time. Values in NTP format</ul></ul><p>NTPv4 supports authentication based on asymmetric cryptography.</p><ul><li>The server signs NTP messages using his own private key.<li>soclients can verify messages integrity, so Manin-the-Middle techniques shouldn’t be possible.<li>However, none operating system use authentication, so all of them would be vulnerable to Main-in-the-Middle attacks.</ul><hr /><h3 id="deloreanpy-an-ntp-mitm-tool"><code class="language-plaintext highlighter-rouge">Delorean.py</code>: AN NTP MITM TOOL</h3><ul><li>to perform NTP Man-in-the-Middle attacks,<li>a python script based on the kimifly’s tool ’ntpserver’ [11] but adding some additional options for onthe-fly manipulation.</ul><p>Delorean can be used in five different modes:</p><ul><li>Automatic:<ul><li>If not other mode is selected, Delorean works in an automatic mode.<li>find a date at least 1000 days in the future with the same month day and weekday than the current one.<li>It makes harder for the user to detect that something happened on his computer clock.</ul><li>Step mode (-s):<ul><li>Using this mode you can choose how many seconds, hours, days, etc to jump to the future.<li>The base date and time are the local date and time in the host that runs Delorean.</ul><li>Date mode (-d):<ul><li>choose the exact date and time when you want to jump to the future.</ul><li>Random mode (-r):<ul><li>This mode makes Delorean to answer with different date and time on each response.<li>Useful for testing integer overflows and other similar issues in NTP implementations.</ul><li>Skimming Attack (-k &amp; -t):<ul><li>This mode makes Delorean work in a different way. It is compatible with all the previous modes but it jumps to the future in several steps (-k) instead of a single one. The flag ’t’ makes Delorean to jump that amount of time before the ’-k’ time.</ul></ul><p>Delorean can’t intercept communications itself, so it should be used with other tools such as arpspoof + iptables, metasploit’s fakedns, etc.</p><h3 id="time-synchronization-in-major-os">TIME SYNCHRONIZATION IN MAJOR OS</h3><p>A. Ubuntu Linux</p><ul><li>It doesn’t run a NTP daemon itself but it is configured by default<li>synchronized via ’ntpdate’ command each time a network interface goes up.<li>It uses unauthenticated NTPv4 messages, so it is be vulnerable to MitM attacks.</ul><p>attacker could control the physical medium (fake AP, switch controlling, deauthentication) he could force an interface down and up. When going up, the time would be synchronized, so it could be intercepted and manipulated by Delorean.</p><p>B. Fedora Linux</p><ul><li>Fedora runs a NTP daemon called ’chronyd’ that synchronizes each minute.<li>It uses unauthenticated NTPv3 messages, so it is be vulnerable to MitM attacks.<li>The default chrony configuration use the parameter ’rtcsync’ witch means that the system time is copied to the real time clock each 11 minutes.</ul><p>Waiting up to one minute, an attacker could intercept and manipulate that communication with Delorean and control the desktop’s system time. After up to 11 minutes of intercepting those messages, the new time would be applied to the host.</p><p>C. Mac OS X Lion</p><ul><li>Mac OS X Lion (probably all pre-Mavericks versions) runs a NTP daemon called ’ntpd’ [12] that synchronizes each 9 minutes.<li>It uses unauthenticated NTPv4 messages<li>vulnerable to MitM attacks.<li>Waiting up to 9 minutes, an attacker could intercept and manipulate that communication with Delorean and control the desktop’s system time.</ul><p>D. Microsoft Windows</p><ul><li>Microsoft Windows is the securest NTP implementation from the major operating systems.<li>It doesn’t use authentication (in a standalone configuration) but it implements some additional security features that make more difficult a reliable exploitation.<ul><li>Windows by default only synchronizes once a week: Sunday at 02:00.<ul><li>If the computer is not running then, the synchronization is made in the next boot (if it’s in the next three days).</ul><li>the ’MaxPosPhaseCorrection’ and ’MinPosPhaseCorrection’<ul><li>parameters set in the windows registry (HKEY LOCAL MACHINESYSTEM\CurrentControlSet\Services\W32Time\Config). These parameters specify the maximum and minimum amount of seconds that the clock can be adjusted by the time synchronization.<li>Any time update greater is automaticallyignored.<li>In windows desktop systems such as Windows 7 or 8, these parameters are set to 15 hours, while in servers such as Windows Server 2012 they are set to 48 hours [14].</ul></ul><li>As a result, there is a narrow attack surface in a default configured windows computer. However, there are lots of non official articles in the Internet that recommend to synchronize the time more often, maybe each hour or even each 5 minutes.<li>If the user set up his computer in order to synchronize more often than his own <code class="language-plaintext highlighter-rouge">MaxPosPhaseCorretion</code> time then his computer would become vulnerable to Time Skimming attacks.<li>There is an exception in this process. When the user manually requests a time synchronization, when any security restriction is consider.</ul><h3 id="time-skimming-attack">TIME SKIMMING ATTACK</h3><ul><li>A Time Skimming Attack works in a similar way than a ’Stone Skimming’ effect.<li>Perhaps the attacker can’t jump to the proper date in the future, but if he can jump a few seconds before the next time synchronization then he could reach the proper date by doing multiple jumps to the future.</ul><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>Sent to 192.168.10.31:123 - Going to the future! 2014-09-27 01:32
Sent to 192.168.10.31:123 - Going to the future! 2014-09-27 13:32
Sent to 192.168.10.31:123 - Going to the future! 2014-09-28 01:32
Sent to 192.168.10.31:123 - Going to the future! 2014-09-28 13:32
Sent to 192.168.10.31:123 - Going to the future! 2014-09-29 01:32
Sent to 192.168.10.31:123 - Going to the future! 2014-09-29 13:32
Sent to 192.168.10.31:123 - Going to the future! 2014-09-30 01:32
Sent to 192.168.10.31:123 - Going to the future! 2014-09-30 13:32
Sent to 192.168.10.31:123 - Going to the future! 2014-09-01 01:32
Sent to 192.168.10.31:123 - Going to the future! 2014-09-01 13:32
[...]
</pre></table></code></div></div><p>Some Windows or Mac OS X configurations could be vulnerable to this kind of attacks.</p><h3 id="browsers--preloaded-hsts">BROWSERS &amp; PRELOADED HSTS</h3><p>Using the Delorean tool, under certain circumstances and configurations</p><ul><li>allow to manipulate the system time and force the HSTS policies to expire.<li>However, there is an extra security feature in browsers: the preloaded HSTS.<li>When reading its documentations it s eems that preloaded hosts are enforced by default so they wouldn’t be vulnerables to time manipulation attacks but the real truth is that those hosts are ’preloaded’ but not ’static’ on most browsers, so they would be vulnerable as well.<li>For example<ul><li>in Chrome, the enforced hosts in the ’Preloaded HSTS’ list are configured with a 1000 days policy.<li>These policies can be overwritten when the browser visits de host for the first time.<li><img data-proofer-ignore data-src="https://i.imgur.com/Hjyq2IF.png" alt="Screen Shot 2020-09-29 at 01.04.12" /></ul><li>Only one tested browser, Safari, seems to configure those preloaded hosts as a static values (’inf’/’-inf’), so hosts preloaded by Safari couldn’t be attacked using these techniques.</ul><p>on certain systems and under certain circumstances, an NTP MitM attack is possible and it could be used in order to force HSTS policies to expire. Delorean could be used to perform the proposed attacks.</p><hr /><p>.</p><p>ref</p><ul><li><a href="https://www.blackhat.com/docs/eu-14/materials/eu-14-Selvi-Bypassing-HTTP-Strict-Transport-Security-wp.pdf">1</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/10cyberattack/'>10CyberAttack</a>, <a href='/categories/vulnerability/'>Vulnerability</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/cyberattack/" class="post-tag no-text-decoration" >CyberAttack</a> <a href="/tags/vulnerability/" class="post-tag no-text-decoration" >Vulnerability</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HSTS - HTTP Strict Transport Security - Grace&url=https://ocholuo.github.io//posts/HSTS/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HSTS - HTTP Strict Transport Security - Grace&u=https://ocholuo.github.io//posts/HSTS/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HSTS - HTTP Strict Transport Security - Grace&url=https://ocholuo.github.io//posts/HSTS/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Amazon-CloudFront/">AWS Lab - AWS CloudFront</a><li><a href="/posts/Alexa-1stSkill/">AWS Alex First Skill - RedVelvet Time</a><li><a href="/posts/NetworkProtocol-SSL-TLS-Handshake/">NetworkProtocol SSL/TLS Handshake</a><li><a href="/posts/pythonCrash/">Python Crash</a><li><a href="/posts/%E4%B8%80%E5%8F%A5%E8%AF%9D%E8%A7%A3%E9%87%8AAWS/">AWS - 一句话解释AWS</a><li><a href="/posts/GKE/">GCP - Google Cloud Computing - Kubernetes and Kubernetes Engine</a><li><a href="/posts/Go-Note/">Go Note</a><li><a href="/posts/SCPs/">AWS - IdenAccessManage - SCPs (Service Control Policies)</a><li><a href="/posts/CompanyBenefit/">Company Benefit</a><li><a href="/posts/Encryption-SSL&TLS/">Cryptography - SSL/TLS Encryption</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/FireEye12/"><div class="card-body"> <span class="timeago small" >Dec 13, 2020<i class="unloaded">2020-12-13T10:11:11-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Vul - FireEye 20201213</h3><div class="text-muted small"><p> [toc] Vulnerability - FireEye 202012 SUNBURST Malware Overview 12142020 DESCRIPTION SUNBURST is a backdoor that has the ability to spawn and kill processes, write and d...</p></div></div></a></div><div class="card"> <a href="/posts/web-cache/"><div class="card-body"> <span class="timeago small" >Dec 21, 2020<i class="unloaded">2020-12-21T10:11:11-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Meow's CyberAttack - - Web cache posion</h3><div class="text-muted small"><p> Meow’s CyberAttack - Web cache posion 背景知识 User Browser Cache Poisoning 浏览器缓存投毒 攻击危害: 攻击实现: Server Cache Poisoning 服务器缓存 ...</p></div></div></a></div><div class="card"> <a href="/posts/CVE-2020-9484/"><div class="card-body"> <span class="timeago small" >Jan 9, 2021<i class="unloaded">2021-01-09T10:11:11-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Vul - CVE-2020-9484 Tomcat RCE漏洞分析</h3><div class="text-muted small"><p> CVE-2020-9484 Tomcat RCE漏洞分析 1. 漏洞简述 2. 条件 Tomcat PersistentManager Configuration The exploit 3. 漏洞详情 4. 漏洞复现 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/emoji/" class="btn btn-outline-primary" prompt="Older"><p>Emoji</p></a> <a href="/posts/Security-onepage/" class="btn btn-outline-primary" prompt="Newer"><p>Info security One Page</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ocholuo">Grace JyL</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ocholuo.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script defer src="/assets/js/dist/pvreport.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-179830187-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-179830187-1'); }); </script>
