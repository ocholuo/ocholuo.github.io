<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="pv-proxy-endpoint" content="https://myochosite-291718.appspot.com/query?id=ahNwfm15b2Nob3NpdGUtMjkxNzE4chULEghBcGlRdWVyeRiAgIDo14eBCgw"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="LFCE.1 Advanced Linux Networking" /><meta property="og:locale" content="en" /><meta name="description" content="LFCE: Advanced Linux Networking" /><meta property="og:description" content="LFCE: Advanced Linux Networking" /><link rel="canonical" href="https://ocholuo.github.io//posts/LFCE.1.AdvancedLinuxNetworking/" /><meta property="og:url" content="https://ocholuo.github.io//posts/LFCE.1.AdvancedLinuxNetworking/" /><meta property="og:site_name" content="Grace" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-07-16T11:11:11-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="LFCE.1 Advanced Linux Networking" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-10-30T21:02:21-04:00","datePublished":"2020-07-16T11:11:11-04:00","description":"LFCE: Advanced Linux Networking","headline":"LFCE.1 Advanced Linux Networking","mainEntityOfPage":{"@type":"WebPage","@id":"https://ocholuo.github.io//posts/LFCE.1.AdvancedLinuxNetworking/"},"url":"https://ocholuo.github.io//posts/LFCE.1.AdvancedLinuxNetworking/"}</script><title>LFCE.1 Advanced Linux Networking | Grace</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Grace"><meta name="application-name" content="Grace"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://myochosite-291718.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://myochosite-291718.appspot.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/huoye.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Grace</a></div><div class="site-subtitle font-italic">2023 Mar 14 updated</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/ocholuo" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>LFCE.1 Advanced Linux Networking</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>LFCE.1 Advanced Linux Networking</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Grace JyL </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Jul 16, 2020, 11:11 AM -0400" >Jul 16, 2020<i class="unloaded">2020-07-16T11:11:11-04:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Oct 30, 2022, 6:02 PM -0700" >Oct 30, 2022<i class="unloaded">2022-10-30T21:02:21-04:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="5156 words">28 min read</span> <span id="pv" class="pageviews"> <i class="fas fa-spinner fa-spin fa-fw"></i> </span> views</div></div><div class="post-content"><h1 id="lfce-advanced-linux-networking">LFCE: Advanced Linux Networking</h1><p>[toc]</p><h2 id="virtual-network-setup-between-centos">virtual network Setup between centos</h2><p><img data-proofer-ignore data-src="https://i.imgur.com/GPEB4aG.png" alt="Screen Shot 2020-04-13 at 18.59.36" /></p><p><strong>make a virtual network</strong></p><p>things you gotta do first</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="mi">1</span><span class="p">.</span> <span class="n">virtubalbox</span><span class="p">.</span> <span class="n">add</span> <span class="n">network</span> <span class="n">adapter</span><span class="p">.</span>

    <span class="n">server0</span> <span class="o">&gt;</span> <span class="n">adapter</span> <span class="mi">1</span><span class="o">:</span> <span class="err">`</span><span class="n">NAT</span><span class="err">`</span>
            <span class="o">&gt;</span> <span class="n">adapter</span> <span class="mi">2</span><span class="o">:</span> <span class="err">`</span><span class="n">Internal</span> <span class="n">Network</span><span class="err">`</span><span class="o">:</span> <span class="err">`</span><span class="n">intnet1</span><span class="err">`</span>
                <span class="o">&gt;</span> <span class="n">Advanced</span><span class="o">:</span> <span class="n">Promiscuous</span> <span class="n">Mode</span><span class="o">:</span> <span class="n">Allow</span> <span class="n">All</span>
    <span class="n">server0</span> <span class="o">&gt;</span> <span class="n">adapter</span> <span class="mi">1</span><span class="o">:</span> <span class="err">`</span><span class="n">NAT</span><span class="err">`</span>
            <span class="o">&gt;</span> <span class="n">adapter</span> <span class="mi">3</span><span class="o">:</span> <span class="err">`</span><span class="n">Internal</span> <span class="n">Network</span><span class="err">`</span><span class="o">:</span> <span class="err">`</span><span class="n">intnet2</span><span class="err">`</span>
                <span class="o">&gt;</span> <span class="n">Advanced</span><span class="o">:</span> <span class="n">Promiscuous</span> <span class="n">Mode</span><span class="o">:</span> <span class="n">Allow</span> <span class="n">All</span>

    <span class="n">server0</span><span class="o">:</span>
    <span class="n">enp0s3</span> <span class="n">ether</span> <span class="mi">08</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mi">63</span><span class="o">:</span><span class="n">e2</span><span class="o">:</span><span class="mi">88</span> <span class="n">NAT</span>
    <span class="n">enp0s8</span> <span class="n">ether</span> <span class="mi">08</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="mi">90</span><span class="o">:</span><span class="n">f2</span> <span class="n">intnet1</span>
    <span class="n">enp0s9</span> <span class="n">ether</span> <span class="mi">08</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="n">f9</span><span class="o">:</span><span class="n">e8</span><span class="o">:</span><span class="mi">12</span> <span class="n">intnet2</span>


<span class="mi">2</span><span class="p">.</span> <span class="n">open</span> <span class="n">network</span><span class="p">,</span> <span class="n">test</span> <span class="n">ping</span><span class="p">.</span>

<span class="mi">3</span><span class="p">.</span> <span class="n">add</span> <span class="n">config</span> <span class="n">file</span><span class="o">:</span>

    <span class="n">cd</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sysconfig</span><span class="o">/</span><span class="n">network</span><span class="o">-</span><span class="n">scripts</span>

    <span class="n">cp</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sysconfig</span><span class="o">/</span><span class="n">network</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">ifcfg</span><span class="o">-</span><span class="n">enp0s3</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sysconfig</span><span class="o">/</span><span class="n">network</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">ifcfg</span><span class="o">-</span><span class="n">enp0s8</span>

    <span class="n">vi</span> <span class="n">ifcfg</span><span class="o">-</span><span class="n">enp0s8</span>
    <span class="cp"># change
</span>    <span class="n">BOOTPROTO</span><span class="o">=</span><span class="k">static</span>
    <span class="n">ONBOOT</span><span class="o">=</span><span class="n">yes</span> <span class="c1">// interface activated at boot time.</span>
    <span class="cp"># delete
</span>    <span class="c1">// UUID, PREFIX</span>
    <span class="cp"># add
</span>    <span class="n">IPADDR0</span><span class="o">=</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>
    <span class="n">NETMASK</span><span class="o">=</span><span class="mi">255</span><span class="p">.</span><span class="mi">255</span><span class="p">.</span><span class="mi">255</span><span class="p">.</span><span class="mi">0</span>
    <span class="n">GATEWAY</span><span class="o">=</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>

<span class="mi">4</span><span class="p">.</span> <span class="n">restart</span>

<span class="mi">5</span><span class="p">.</span> <span class="n">GUI</span> <span class="n">setup</span> <span class="n">IP</span><span class="p">.</span>

</pre></table></code></div></div><p>修改里面的NAME、DEVICE、UUID、IPADDR、NETMASK，删除GATEWAY</p><p>如果BOOTPROTO设置为dhcp，代表接受dhcp服务器动态分配的ip，你就不需要配置ip，此情况下如果你的局域网路由器或者交换机没有dhcp功能，你就上不了网；如果BOOTPROTO设置为static，你就需要自己配置ip，此情况下如果你配置的ip已经被别人占用，你也上不了网； 通过uuidgen ens37可以生成新网卡的UUID，写到配置文件里面去，你可以不写，但是不能与其他网卡的UUID相同； 所有网卡的配置文件只能有一个配置GATEWAY，否则启动不了。虚拟机的出口网关都是这个GATEWAY，但是所有网卡配置的ip都可以被访问； NAME、DEVICE就是你的新网卡的名字； NETMASK子网掩码，不解释。</p><p>server0:</p><div class="language-shell highlighter-rouge"><div class="code-header" text-data="shell"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre><td class="rouge-code"><pre>
To start NetworkManager:
systemctl start NetworkManager

To <span class="nb">enable </span>NetworkManager automatically at boot <span class="nb">time</span>:
systemctl <span class="nb">enable </span>NetworkManager

yum <span class="nb">install </span>network-scripts


<span class="c"># change to root user</span>
su -

<span class="c"># config the networks</span>
nmtui
<span class="c">#or</span>
nmtooey
<span class="c">#</span>
<span class="o">&gt;</span> edit a connection
  <span class="o">&gt;</span> Ethernet
    <span class="o">&gt;</span> Wired connection 3
    <span class="o">&gt;</span> enp0s3              <span class="c"># the NAT network, a public address</span>
    <span class="o">&gt;</span> Wired connection 1 <span class="o">(</span>enp0s8<span class="o">)</span> <span class="c"># check the device name</span>
      <span class="o">&gt;</span> IPv4:
        <span class="o">&gt;</span> <span class="o">[</span>space] <span class="o">&gt;</span> <span class="s2">"Manual"</span>
        <span class="o">&gt;</span> &lt;show&gt;
          <span class="o">&gt;</span> Address: <span class="s2">"192.168.1.1/24"</span>
          <span class="o">&gt;</span> no gateway, use NAT adapter as default gateway.
        <span class="o">&gt;</span> <span class="o">[</span>tab] go <span class="k">done</span>
    <span class="o">&gt;</span> Wired connection 2 <span class="o">(</span>enp0s9<span class="o">)</span> <span class="c"># check the device name</span>
      <span class="o">&gt;</span> IPv4:
        <span class="o">&gt;</span> <span class="o">[</span>space] <span class="o">&gt;</span> <span class="s2">"Manual"</span>
        <span class="o">&gt;</span> &lt;show&gt;
          <span class="o">&gt;</span> Address: <span class="s2">"192.168.1.2/24"</span>
          <span class="o">&gt;</span> no gateway, will use NAT adapter as default gateway.
        <span class="o">&gt;</span> <span class="o">[</span>tab] go <span class="k">done</span>

<span class="c"># restart the network</span>
systemctl restart network
<span class="c"># confirm the network</span>
ip addr
<span class="c"># check new interface has ipaddress</span>



</pre></table></code></div></div><p>server1: &gt; adapter 1: <code class="language-plaintext highlighter-rouge">Internal Network</code>: <code class="language-plaintext highlighter-rouge">intnet1</code></p><div class="language-shell highlighter-rouge"><div class="code-header" text-data="shell"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>nmtui
<span class="o">&gt;</span> edit a connection
  <span class="o">&gt;</span> Ethernet
    <span class="o">&gt;</span> Wired connection 2
    <span class="o">&gt;</span> Wired connection 1 <span class="o">(</span>enp0s8<span class="o">)</span> <span class="c">#</span>
    <span class="o">&gt;</span> enp0s3
      <span class="o">&gt;</span> IPv4:
        <span class="o">&gt;</span> <span class="o">[</span>space] <span class="o">&gt;</span> <span class="s2">"Manual"</span>
        <span class="o">&gt;</span> &lt;show&gt;
          <span class="o">&gt;</span> Address: <span class="s2">"192.168.1.100"</span>
          <span class="o">&gt;</span> gateway: <span class="s2">"192.168.1.1"</span>

systemctl restart network
ping 192.168.1.1
</pre></table></code></div></div><p>server2:</p><div class="language-shell highlighter-rouge"><div class="code-header" text-data="shell"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>
<span class="o">&gt;</span> Address: <span class="s2">"192.168.1.200"</span>
<span class="o">&gt;</span> gateway: <span class="s2">"192.168.1.2"</span>

</pre></table></code></div></div><hr /><h2 id="encapsulation-of-data-with-wireshark-and-tcpdump">encapsulation of data with Wireshark and tcpdump</h2><p><strong>server0</strong> :</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre>
<span class="cp"># write scripts to install a Apache web server on the systems
# create it as normal user
</span>
<span class="n">touch</span> <span class="n">installWeb</span><span class="p">.</span><span class="n">sh</span>
<span class="c1">// add</span>
<span class="n">yum</span> <span class="n">install</span> <span class="n">httpd</span>
<span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">permanent</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">port</span><span class="o">=</span><span class="mi">80</span><span class="o">/</span><span class="n">tcp</span>
<span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">reload</span>
<span class="n">echo</span> <span class="s">"Hello World"</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">index</span><span class="p">.</span><span class="n">html</span>
<span class="n">systemctl</span> <span class="n">enable</span> <span class="n">httpd</span>
<span class="n">systemctl</span> <span class="n">start</span> <span class="n">httpd</span>


<span class="cp"># run the script as sudo
</span>
<span class="n">sh</span> <span class="n">installWeb</span><span class="p">.</span><span class="n">sh</span>



<span class="cp"># test the web server
</span><span class="c1">// download the index html file</span>
<span class="err">$</span> <span class="n">wget</span> <span class="n">http</span><span class="o">:</span><span class="c1">//192.168.1.1/index.html</span>

</pre></table></code></div></div><p><strong>server1</strong> :</p><p>install packet sniffers</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>
<span class="err">$</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">tcpdump</span> <span class="n">wireshark</span> <span class="n">wireshark</span><span class="o">-</span><span class="n">gnome</span>


<span class="n">Before</span> <span class="n">install</span> <span class="n">Wireshark</span><span class="p">,</span> <span class="n">make</span> <span class="n">sure</span> <span class="n">that</span> <span class="n">all</span> <span class="n">the</span> <span class="n">dependencies</span> <span class="k">for</span> <span class="n">Wireshark</span> <span class="n">are</span> <span class="n">present</span> <span class="n">on</span> <span class="n">the</span> <span class="n">system</span><span class="p">.</span>
<span class="n">Install</span> <span class="n">all</span> <span class="n">the</span> <span class="n">dependencies</span> <span class="n">using</span> <span class="n">the</span> <span class="n">following</span> <span class="n">command</span><span class="p">,</span>

<span class="err">$</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">gcc</span> <span class="n">gcc</span><span class="o">-</span><span class="n">c</span><span class="o">++</span> <span class="n">bison</span> <span class="n">flex</span> <span class="n">libpcap</span><span class="o">-</span><span class="n">devel</span> <span class="n">qt</span><span class="o">-</span><span class="n">devel</span> <span class="n">gtk3</span><span class="o">-</span><span class="n">devel</span> <span class="n">rpm</span><span class="o">-</span><span class="n">build</span> <span class="n">libtool</span> <span class="n">c</span><span class="o">-</span><span class="n">ares</span><span class="o">-</span><span class="n">devel</span> <span class="n">qt5</span><span class="o">-</span><span class="n">qtbase</span><span class="o">-</span><span class="n">devel</span> <span class="n">qt5</span><span class="o">-</span><span class="n">qtmultimedia</span><span class="o">-</span><span class="n">devel</span> <span class="n">qt5</span><span class="o">-</span><span class="n">linguist</span> <span class="n">desktop</span><span class="o">-</span><span class="n">file</span><span class="o">-</span><span class="n">utils</span>

<span class="n">Install</span> <span class="n">epel</span> <span class="n">using</span> <span class="n">the</span> <span class="n">following</span> <span class="n">command</span><span class="o">:</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="o">-</span><span class="n">y</span> <span class="n">install</span> <span class="n">epel</span><span class="o">-</span><span class="n">release</span>

<span class="n">Refresh</span> <span class="n">repo</span> <span class="n">by</span> <span class="n">typing</span> <span class="n">the</span> <span class="n">following</span> <span class="n">commad</span><span class="o">:</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">repolist</span>
<span class="n">Install</span> <span class="n">the</span> <span class="n">dpkg</span> <span class="n">rpm</span> <span class="n">packages</span><span class="o">:</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">dpkg</span><span class="o">-</span><span class="n">devel</span> <span class="n">dpkg</span><span class="o">-</span><span class="n">dev</span>


<span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">wireshark</span> <span class="n">wireshark</span><span class="o">-</span><span class="n">qt</span>

</pre></table></code></div></div><p>use tcpdump</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="c1">// run the tcpdump</span>
<span class="err">$</span> <span class="n">tcpdump</span>

<span class="c1">// new Window</span>
<span class="c1">// send 1 ping packet</span>
<span class="err">$</span> <span class="n">ping</span> <span class="o">-</span><span class="n">c</span> <span class="mi">1</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>

<span class="c1">// stop the capture</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">tcpdump</span>
<span class="n">tcpdump</span><span class="o">:</span> <span class="n">verbose</span> <span class="n">output</span> <span class="n">suppressed</span><span class="p">,</span> <span class="n">use</span> <span class="o">-</span><span class="n">v</span> <span class="n">or</span> <span class="o">-</span><span class="n">vv</span> <span class="k">for</span> <span class="n">full</span> <span class="n">protocol</span> <span class="n">decode</span>
<span class="n">listening</span> <span class="n">on</span> <span class="n">enp0s3</span><span class="p">,</span> <span class="n">link</span><span class="o">-</span><span class="n">type</span> <span class="n">EN10MB</span> <span class="p">(</span><span class="n">Ethernet</span><span class="p">),</span> <span class="n">capture</span> <span class="n">size</span> <span class="mi">262144</span> <span class="n">bytes</span>
<span class="c1">// here should be a ICMP echo request and reply</span>
<span class="mi">13</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mi">41</span><span class="p">.</span><span class="mi">727919</span> <span class="n">IP</span> <span class="n">server0</span><span class="p">.</span><span class="mi">57198</span> <span class="o">&gt;</span> <span class="n">time</span><span class="p">.</span><span class="n">richiemcintosh</span><span class="p">.</span><span class="n">com</span><span class="p">.</span><span class="n">ntp</span><span class="o">:</span> <span class="n">NTPv4</span><span class="p">,</span> <span class="n">Client</span><span class="p">,</span> <span class="n">length</span> <span class="mi">48</span>
<span class="c1">//rever DNS lookup</span>
<span class="c1">// take that IP address pinged and resolve it to its host name.</span>
<span class="mi">13</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mi">41</span><span class="p">.</span><span class="mi">728864</span> <span class="n">IP</span> <span class="n">server0</span><span class="p">.</span><span class="mi">48412</span> <span class="o">&gt;</span> <span class="n">dns</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">domain</span><span class="o">:</span> <span class="mi">11642</span><span class="o">+</span> <span class="n">PTR</span><span class="o">?</span> <span class="mi">136</span><span class="p">.</span><span class="mi">213</span><span class="p">.</span><span class="mi">164</span><span class="p">.</span><span class="mi">69</span><span class="p">.</span><span class="n">in</span><span class="o">-</span><span class="n">addr</span><span class="p">.</span><span class="n">arpa</span><span class="p">.</span> <span class="p">(</span><span class="mi">45</span><span class="p">)</span>
<span class="mi">13</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mi">41</span><span class="p">.</span><span class="mi">748362</span> <span class="n">IP</span> <span class="n">dns</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">domain</span> <span class="o">&gt;</span> <span class="n">server0</span><span class="p">.</span><span class="mi">48412</span><span class="o">:</span> <span class="mi">11642</span> <span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span> <span class="n">PTR</span> <span class="n">time</span><span class="p">.</span><span class="n">richiemcintosh</span><span class="p">.</span><span class="n">com</span><span class="p">.</span> <span class="p">(</span><span class="mi">82</span><span class="p">)</span>
<span class="mi">13</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mi">41</span><span class="p">.</span><span class="mi">748695</span> <span class="n">IP</span> <span class="n">server0</span><span class="p">.</span><span class="mi">46339</span> <span class="o">&gt;</span> <span class="n">dns</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">domain</span><span class="o">:</span> <span class="mi">2429</span><span class="o">+</span> <span class="n">PTR</span><span class="o">?</span> <span class="mi">15</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="n">in</span><span class="o">-</span><span class="n">addr</span><span class="p">.</span><span class="n">arpa</span><span class="p">.</span> <span class="p">(</span><span class="mi">40</span><span class="p">)</span>
<span class="mi">13</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mi">41</span><span class="p">.</span><span class="mi">749235</span> <span class="n">IP</span> <span class="n">time</span><span class="p">.</span><span class="n">richiemcintosh</span><span class="p">.</span><span class="n">com</span><span class="p">.</span><span class="n">ntp</span> <span class="o">&gt;</span> <span class="n">server0</span><span class="p">.</span><span class="mi">57198</span><span class="o">:</span> <span class="n">NTPv4</span><span class="p">,</span> <span class="n">Server</span><span class="p">,</span> <span class="n">length</span> <span class="mi">48</span>
<span class="mi">13</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mi">41</span><span class="p">.</span><span class="mi">772854</span> <span class="n">IP</span> <span class="n">dns</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">domain</span> <span class="o">&gt;</span> <span class="n">server0</span><span class="p">.</span><span class="mi">46339</span><span class="o">:</span> <span class="mi">2429</span> <span class="n">NXDomain</span> <span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span> <span class="p">(</span><span class="mi">40</span><span class="p">)</span>
<span class="mi">13</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mi">41</span><span class="p">.</span><span class="mi">773535</span> <span class="n">IP</span> <span class="n">server0</span><span class="p">.</span><span class="mi">41142</span> <span class="o">&gt;</span> <span class="n">dns</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">domain</span><span class="o">:</span> <span class="mi">58687</span><span class="o">+</span> <span class="n">PTR</span><span class="o">?</span> <span class="mi">8</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="n">in</span><span class="o">-</span><span class="n">addr</span><span class="p">.</span><span class="n">arpa</span><span class="p">.</span> <span class="p">(</span><span class="mi">38</span><span class="p">)</span>
<span class="mi">13</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mi">41</span><span class="p">.</span><span class="mi">799984</span> <span class="n">IP</span> <span class="n">dns</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">domain</span> <span class="o">&gt;</span> <span class="n">server0</span><span class="p">.</span><span class="mi">41142</span><span class="o">:</span> <span class="mi">58687</span> <span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span> <span class="n">PTR</span> <span class="n">dns</span><span class="p">.</span><span class="n">google</span><span class="p">.</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span>
<span class="mi">13</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mi">46</span><span class="p">.</span><span class="mi">922872</span> <span class="n">ARP</span><span class="p">,</span> <span class="n">Request</span> <span class="n">who</span><span class="o">-</span><span class="n">has</span> <span class="n">_gateway</span> <span class="n">tell</span> <span class="n">server0</span><span class="p">,</span> <span class="n">length</span> <span class="mi">28</span>
<span class="mi">13</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mi">46</span><span class="p">.</span><span class="mi">923139</span> <span class="n">ARP</span><span class="p">,</span> <span class="n">Reply</span> <span class="n">_gateway</span> <span class="n">is</span><span class="o">-</span><span class="n">at</span> <span class="mi">52</span><span class="o">:</span><span class="mi">54</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">12</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="mo">02</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">),</span> <span class="n">length</span> <span class="mi">46</span>
<span class="mi">13</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mi">46</span><span class="p">.</span><span class="mi">923370</span> <span class="n">IP</span> <span class="n">server0</span><span class="p">.</span><span class="mi">37657</span> <span class="o">&gt;</span> <span class="n">dns</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">domain</span><span class="o">:</span> <span class="mi">61893</span><span class="o">+</span> <span class="n">PTR</span><span class="o">?</span> <span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="n">in</span><span class="o">-</span><span class="n">addr</span><span class="p">.</span><span class="n">arpa</span><span class="p">.</span> <span class="p">(</span><span class="mi">39</span><span class="p">)</span>
<span class="mi">13</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mi">46</span><span class="p">.</span><span class="mi">941761</span> <span class="n">IP</span> <span class="n">dns</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">domain</span> <span class="o">&gt;</span> <span class="n">server0</span><span class="p">.</span><span class="mi">37657</span><span class="o">:</span> <span class="mi">61893</span> <span class="n">NXDomain</span> <span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span> <span class="p">(</span><span class="mi">39</span><span class="p">)</span>
<span class="o">^</span><span class="n">C</span>
<span class="mi">12</span> <span class="n">packets</span> <span class="n">captured</span>
<span class="mi">12</span> <span class="n">packets</span> <span class="n">received</span> <span class="n">by</span> <span class="n">filter</span>
<span class="mi">0</span> <span class="n">packets</span> <span class="n">dropped</span> <span class="n">by</span> <span class="n">kernel</span>
</pre></table></code></div></div><p>use Wireshark</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre>
<span class="n">change</span> <span class="n">permission</span> <span class="n">to</span> <span class="n">see</span> <span class="n">the</span> <span class="n">interfaces</span>

<span class="err">$</span> <span class="n">wireshark</span>
<span class="n">error</span><span class="o">:</span>
<span class="n">Couldnt</span> <span class="n">run</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">dumpcap</span> <span class="n">in</span> <span class="n">child</span> <span class="n">process</span><span class="o">:</span> <span class="n">Permission</span> <span class="n">denied</span>
<span class="c1">// change the privileges</span>
<span class="err">$</span> <span class="n">ls</span> <span class="o">-</span><span class="n">l</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">dumpcap</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">--</span> <span class="mi">1</span> <span class="n">root</span> <span class="n">wireshark</span> <span class="mi">96464</span> <span class="n">Jan</span> <span class="mi">24</span> <span class="mi">10</span><span class="o">:</span><span class="mi">31</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">dumpcap</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">server1</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">dumpcap</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">--</span> <span class="mi">1</span> <span class="n">server1</span> <span class="n">wireshark</span> <span class="mi">96464</span> <span class="n">Jan</span> <span class="mi">24</span> <span class="mi">10</span><span class="o">:</span><span class="mi">31</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">dumpcap</span>


<span class="n">change</span> <span class="n">permission</span> <span class="n">to</span> <span class="n">capture</span> <span class="n">the</span> <span class="n">interfaces</span>
<span class="c1">// for CentOS</span>
<span class="n">sudo</span> <span class="n">groupadd</span> <span class="n">wireshark</span>
<span class="n">sudo</span> <span class="n">usermod</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">G</span> <span class="n">wireshark</span> <span class="err">$</span><span class="n">USER</span>
<span class="n">sudo</span> <span class="n">chgrp</span> <span class="n">wireshark</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">dumpcap</span>
<span class="n">sudo</span> <span class="n">chmod</span> <span class="n">o</span><span class="o">-</span><span class="n">rx</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">dumpcap</span>
<span class="n">sudo</span> <span class="n">setcap</span> <span class="err">'</span><span class="n">CAP_NET_RAW</span><span class="o">+</span><span class="n">eip</span> <span class="n">CAP_NET_ADMIN</span><span class="o">+</span><span class="n">eip</span><span class="err">'</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">dumpcap</span>
<span class="n">sudo</span> <span class="n">getcap</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">dumpcap</span>

<span class="n">Then</span> <span class="n">log</span><span class="o">-</span><span class="n">out</span> <span class="n">and</span> <span class="n">log</span><span class="o">-</span><span class="n">in</span> <span class="n">again</span><span class="p">.</span>

<span class="c1">// for other system</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">dpkg</span><span class="o">-</span><span class="n">reconfigure</span> <span class="n">wireshark</span><span class="o">-</span><span class="n">common</span>
<span class="n">press</span> <span class="n">the</span> <span class="n">right</span> <span class="n">arrow</span> <span class="n">and</span> <span class="n">enter</span> <span class="k">for</span> <span class="n">yes</span>
<span class="c1">// add user to the "wireshark" group</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">chmod</span> <span class="o">+</span><span class="n">x</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">dumpcap</span>
</pre></table></code></div></div><p>server1: <code class="language-plaintext highlighter-rouge">ping -c 1 192.168.1.1</code></p><p><img data-proofer-ignore data-src="https://i.imgur.com/CV6M4mh.png" alt="Screen Shot 2020-04-16 at 14.50.22" /></p><p>server1: <code class="language-plaintext highlighter-rouge">wget http://192.168.1.1/index.html</code> package 6 is the content of that webpage. http all plain text. <img data-proofer-ignore data-src="https://i.imgur.com/0NSjNmX.png" alt="Screen Shot 2020-04-16 at 14.53.46" /></p><hr /><h2 id="configure-vlsm-nat">configure VLSM, NAT</h2><p><strong>subnet</strong></p><p>server0:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
</pre><td class="rouge-code"><pre>
<span class="err">$</span> <span class="n">ip</span> <span class="n">addr</span>
<span class="c1">// spit out the ip for each interface</span>
<span class="mi">1</span><span class="o">:</span> <span class="n">lo</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">LOOPBACK</span><span class="p">,</span><span class="n">UP</span><span class="p">,</span><span class="n">LOWER_UP</span><span class="o">&gt;</span> <span class="n">mtu</span> <span class="mi">65536</span> <span class="n">qdisc</span> <span class="n">noqueue</span> <span class="n">state</span> <span class="n">UNKNOWN</span> <span class="n">group</span> <span class="k">default</span> <span class="n">qlen</span> <span class="mi">1000</span>
    <span class="n">link</span><span class="o">/</span><span class="n">loopback</span> <span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span> <span class="n">brd</span> <span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span>
    <span class="n">inet</span> <span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span> <span class="n">scope</span> <span class="n">host</span> <span class="n">lo</span>
       <span class="n">valid_lft</span> <span class="n">forever</span> <span class="n">preferred_lft</span> <span class="n">forever</span>
    <span class="n">inet6</span> <span class="o">::</span><span class="mi">1</span><span class="o">/</span><span class="mi">128</span> <span class="n">scope</span> <span class="n">host</span>
       <span class="n">valid_lft</span> <span class="n">forever</span> <span class="n">preferred_lft</span> <span class="n">forever</span>
<span class="mi">2</span><span class="o">:</span> <span class="n">enp0s3</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">BROADCAST</span><span class="p">,</span><span class="n">MULTICAST</span><span class="p">,</span><span class="n">UP</span><span class="p">,</span><span class="n">LOWER_UP</span><span class="o">&gt;</span> <span class="n">mtu</span> <span class="mi">1500</span> <span class="n">qdisc</span> <span class="n">fq_codel</span> <span class="n">state</span> <span class="n">UP</span> <span class="n">group</span> <span class="k">default</span> <span class="n">qlen</span> <span class="mi">1000</span>
    <span class="n">link</span><span class="o">/</span><span class="n">ether</span> <span class="mi">08</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mi">63</span><span class="o">:</span><span class="n">e2</span><span class="o">:</span><span class="mi">88</span> <span class="n">brd</span> <span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span>
    <span class="n">inet</span> <span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">15</span><span class="o">/</span><span class="mi">24</span> <span class="n">brd</span> <span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">255</span> <span class="n">scope</span> <span class="n">global</span> <span class="n">dynamic</span> <span class="n">noprefixroute</span> <span class="n">enp0s3</span>
       <span class="n">valid_lft</span> <span class="mi">72419</span><span class="n">sec</span> <span class="n">preferred_lft</span> <span class="mi">72419</span><span class="n">sec</span>
    <span class="n">inet6</span> <span class="n">fe80</span><span class="o">::</span><span class="n">bde6</span><span class="o">:</span><span class="mi">813</span><span class="n">f</span><span class="o">:</span><span class="mi">17</span><span class="n">b4</span><span class="o">:</span><span class="mi">5952</span><span class="o">/</span><span class="mi">64</span> <span class="n">scope</span> <span class="n">link</span> <span class="n">noprefixroute</span>
       <span class="n">valid_lft</span> <span class="n">forever</span> <span class="n">preferred_lft</span> <span class="n">forever</span>
<span class="mi">3</span><span class="o">:</span> <span class="n">enp0s8</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">BROADCAST</span><span class="p">,</span><span class="n">MULTICAST</span><span class="p">,</span><span class="n">UP</span><span class="p">,</span><span class="n">LOWER_UP</span><span class="o">&gt;</span> <span class="n">mtu</span> <span class="mi">1500</span> <span class="n">qdisc</span> <span class="n">fq_codel</span> <span class="n">state</span> <span class="n">UP</span> <span class="n">group</span> <span class="k">default</span> <span class="n">qlen</span> <span class="mi">1000</span>
    <span class="n">link</span><span class="o">/</span><span class="n">ether</span> <span class="mi">08</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="n">f9</span><span class="o">:</span><span class="mi">1</span><span class="n">a</span><span class="o">:</span><span class="mi">97</span> <span class="n">brd</span> <span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span>
    <span class="n">inet</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span> <span class="n">brd</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">255</span> <span class="n">scope</span> <span class="n">global</span> <span class="n">noprefixroute</span> <span class="n">enp0s8</span>
       <span class="n">valid_lft</span> <span class="n">forever</span> <span class="n">preferred_lft</span> <span class="n">forever</span>
    <span class="n">inet6</span> <span class="n">fe80</span><span class="o">::</span><span class="mi">9</span><span class="n">af2</span><span class="o">:</span><span class="n">f7b0</span><span class="o">:</span><span class="n">b121</span><span class="o">:</span><span class="mi">65</span><span class="n">ce</span><span class="o">/</span><span class="mi">64</span> <span class="n">scope</span> <span class="n">link</span> <span class="n">noprefixroute</span>
       <span class="n">valid_lft</span> <span class="n">forever</span> <span class="n">preferred_lft</span> <span class="n">forever</span>
<span class="mi">4</span><span class="o">:</span> <span class="n">enp0s9</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">BROADCAST</span><span class="p">,</span><span class="n">MULTICAST</span><span class="p">,</span><span class="n">UP</span><span class="p">,</span><span class="n">LOWER_UP</span><span class="o">&gt;</span> <span class="n">mtu</span> <span class="mi">1500</span> <span class="n">qdisc</span> <span class="n">fq_codel</span> <span class="n">state</span> <span class="n">UP</span> <span class="n">group</span> <span class="k">default</span> <span class="n">qlen</span> <span class="mi">1000</span>
    <span class="n">link</span><span class="o">/</span><span class="n">ether</span> <span class="mi">08</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="mo">02</span> <span class="n">brd</span> <span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span>
    <span class="n">inet</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span> <span class="n">brd</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">255</span> <span class="n">scope</span> <span class="n">global</span> <span class="n">noprefixroute</span> <span class="n">enp0s9</span>
       <span class="n">valid_lft</span> <span class="n">forever</span> <span class="n">preferred_lft</span> <span class="n">forever</span>
    <span class="n">inet6</span> <span class="n">fe80</span><span class="o">::</span><span class="n">c02</span><span class="o">:</span><span class="n">f95b</span><span class="o">:</span><span class="mi">9174</span><span class="o">:</span><span class="mi">76</span><span class="n">a5</span><span class="o">/</span><span class="mi">64</span> <span class="n">scope</span> <span class="n">link</span> <span class="n">noprefixroute</span>
       <span class="n">valid_lft</span> <span class="n">forever</span> <span class="n">preferred_lft</span> <span class="n">forever</span>
<span class="c1">// virtual bridge</span>
<span class="c1">// come with the installation of the GNOME Desktop, which also installs delivery utilities.</span>
<span class="mi">5</span><span class="o">:</span> <span class="n">virbr0</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">NO</span><span class="o">-</span><span class="n">CARRIER</span><span class="p">,</span><span class="n">BROADCAST</span><span class="p">,</span><span class="n">MULTICAST</span><span class="p">,</span><span class="n">UP</span><span class="o">&gt;</span> <span class="n">mtu</span> <span class="mi">1500</span> <span class="n">qdisc</span> <span class="n">noqueue</span> <span class="n">state</span> <span class="n">DOWN</span> <span class="n">group</span> <span class="k">default</span> <span class="n">qlen</span> <span class="mi">1000</span>
    <span class="n">link</span><span class="o">/</span><span class="n">ether</span> <span class="mi">52</span><span class="o">:</span><span class="mi">54</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">44</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="mi">0</span><span class="n">d</span> <span class="n">brd</span> <span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span>
    <span class="n">inet</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">122</span><span class="p">.</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span> <span class="n">brd</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">122</span><span class="p">.</span><span class="mi">255</span> <span class="n">scope</span> <span class="n">global</span> <span class="n">virbr0</span>
       <span class="n">valid_lft</span> <span class="n">forever</span> <span class="n">preferred_lft</span> <span class="n">forever</span>
<span class="mi">6</span><span class="o">:</span> <span class="n">virbr0</span><span class="o">-</span><span class="n">nic</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">BROADCAST</span><span class="p">,</span><span class="n">MULTICAST</span><span class="o">&gt;</span> <span class="n">mtu</span> <span class="mi">1500</span> <span class="n">qdisc</span> <span class="n">fq_codel</span> <span class="n">master</span> <span class="n">virbr0</span> <span class="n">state</span> <span class="n">DOWN</span> <span class="n">group</span> <span class="k">default</span> <span class="n">qlen</span> <span class="mi">1000</span>
    <span class="n">link</span><span class="o">/</span><span class="n">ether</span> <span class="mi">52</span><span class="o">:</span><span class="mi">54</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">44</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="mi">0</span><span class="n">d</span> <span class="n">brd</span> <span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span>

<span class="o">================================================================================</span>

<span class="n">change</span> <span class="n">the</span> <span class="n">subnetmask</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sysconfig</span><span class="o">/</span><span class="n">network</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">ifcfg</span><span class="o">-</span><span class="n">enp0s9</span>

<span class="n">TYPE</span><span class="o">=</span><span class="n">Ethernet</span>
<span class="n">ONBOOT</span><span class="o">=</span><span class="n">yes</span>
<span class="n">IPADDR</span><span class="o">=</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span>
<span class="n">NETMASK</span><span class="o">=</span><span class="mi">255</span><span class="p">.</span><span class="mi">255</span><span class="p">.</span><span class="mi">255</span><span class="p">.</span><span class="mi">0</span>
<span class="c1">// change the PREFIX to 25</span>
<span class="n">PREFIX</span><span class="o">=</span><span class="mi">24</span>
<span class="n">UUID</span><span class="o">=</span><span class="mi">93</span><span class="n">d13955</span><span class="o">-</span><span class="n">e9e2</span><span class="o">-</span><span class="n">a6bd</span><span class="o">-</span><span class="n">df73</span><span class="o">-</span><span class="mf">12e3</span><span class="n">c747f122</span>

<span class="o">================================================================================</span>

<span class="n">restart</span> <span class="n">one</span> <span class="n">interfaces</span>

<span class="err">$</span> <span class="n">ifdown</span> <span class="n">enp0s9</span>
<span class="n">Device</span> <span class="err">'</span><span class="n">enp0s9</span><span class="err">'</span> <span class="n">successfully</span> <span class="n">disconnected</span><span class="p">.</span>
<span class="err">$</span> <span class="n">ifup</span> <span class="n">enp0s9</span>
<span class="n">Connection</span> <span class="n">successfully</span> <span class="n">activated</span> <span class="p">(</span><span class="n">D</span><span class="o">-</span><span class="n">Bus</span> <span class="n">active</span> <span class="n">path</span><span class="o">:</span> <span class="o">/</span><span class="n">org</span><span class="o">/</span><span class="n">freedesktop</span><span class="o">/</span><span class="n">NetworkManager</span><span class="o">/</span><span class="n">ActiveConnection</span><span class="o">/</span><span class="mi">12</span><span class="p">)</span>


<span class="n">check</span>

<span class="err">$</span> <span class="n">ip</span> <span class="n">addr</span>
<span class="mi">4</span><span class="o">:</span> <span class="n">enp0s9</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">BROADCAST</span><span class="p">,</span><span class="n">MULTICAST</span><span class="p">,</span><span class="n">UP</span><span class="p">,</span><span class="n">LOWER_UP</span><span class="o">&gt;</span> <span class="n">mtu</span> <span class="mi">1500</span> <span class="n">qdisc</span> <span class="n">fq_codel</span> <span class="n">state</span> <span class="n">UP</span> <span class="n">group</span> <span class="k">default</span> <span class="n">qlen</span> <span class="mi">1000</span>
    <span class="n">link</span><span class="o">/</span><span class="n">ether</span> <span class="mi">08</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="mo">02</span> <span class="n">brd</span> <span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span>
    <span class="n">inet</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span><span class="o">/</span><span class="mi">25</span> <span class="n">brd</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">127</span> <span class="n">scope</span> <span class="n">global</span> <span class="n">noprefixroute</span> <span class="n">enp0s9</span>
       <span class="n">valid_lft</span> <span class="n">forever</span> <span class="n">preferred_lft</span> <span class="n">forever</span>
    <span class="n">inet6</span> <span class="n">fe80</span><span class="o">::</span><span class="n">c02</span><span class="o">:</span><span class="n">f95b</span><span class="o">:</span><span class="mi">9174</span><span class="o">:</span><span class="mi">76</span><span class="n">a5</span><span class="o">/</span><span class="mi">64</span> <span class="n">scope</span> <span class="n">link</span> <span class="n">noprefixroute</span>
       <span class="n">valid_lft</span> <span class="n">forever</span> <span class="n">preferred_lft</span> <span class="n">forever</span>

</pre></table></code></div></div><p>server2</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre>
<span class="n">change</span> <span class="n">the</span> <span class="n">subnetmask</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sysconfig</span><span class="o">/</span><span class="n">network</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">ifcfg</span><span class="o">-</span><span class="n">enp0s9</span>
<span class="c1">// change the PREFIX to 25</span>
<span class="c1">// change the ip address 192.168.2.100</span>
<span class="n">IPADDR</span><span class="o">=</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">100</span>
<span class="n">PREFIX</span><span class="o">=</span><span class="mi">24</span>

<span class="o">================================================================================</span>

<span class="n">restart</span> <span class="n">one</span> <span class="n">interfaces</span>

<span class="err">$</span> <span class="n">ifdown</span> <span class="n">enp0s9</span>
<span class="err">$</span> <span class="n">ifup</span> <span class="n">enp0s9</span>

<span class="o">================================================================================</span>

<span class="n">check</span>

<span class="err">$</span> <span class="n">ip</span> <span class="n">addr</span>
<span class="mi">4</span><span class="o">:</span> <span class="n">enp0s9</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">BROADCAST</span><span class="p">,</span><span class="n">MULTICAST</span><span class="p">,</span><span class="n">UP</span><span class="p">,</span><span class="n">LOWER_UP</span><span class="o">&gt;</span> <span class="n">mtu</span> <span class="mi">1500</span> <span class="n">qdisc</span> <span class="n">fq_codel</span> <span class="n">state</span> <span class="n">UP</span> <span class="n">group</span> <span class="k">default</span> <span class="n">qlen</span> <span class="mi">1000</span>
    <span class="n">inet</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">100</span><span class="o">/</span><span class="mi">25</span> <span class="n">brd</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">127</span> <span class="n">scope</span> <span class="n">global</span> <span class="n">noprefixroute</span> <span class="n">enp0s9</span>

</pre></table></code></div></div><hr /><p><strong>NAT</strong></p><p>server1:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="c1">// no result</span>
<span class="c1">// no internet</span>
<span class="err">$</span> <span class="n">ping</span> <span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span>
<span class="n">PING</span> <span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span> <span class="p">(</span><span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="n">bytes</span> <span class="n">of</span> <span class="n">data</span><span class="p">.</span>
<span class="o">---</span> <span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span> <span class="n">ping</span> <span class="n">statistics</span> <span class="o">---</span>
<span class="mi">5</span> <span class="n">packets</span> <span class="n">transmitted</span><span class="p">,</span> <span class="mi">0</span> <span class="n">received</span><span class="p">,</span> <span class="mi">100</span><span class="o">%</span> <span class="n">packet</span> <span class="n">loss</span><span class="p">,</span> <span class="n">time</span> <span class="mi">88</span><span class="n">ms</span>

<span class="cp"># ping 192.168.1.1
</span><span class="n">PING</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span> <span class="p">(</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="n">bytes</span> <span class="n">of</span> <span class="n">data</span><span class="p">.</span>
<span class="mi">64</span> <span class="n">bytes</span> <span class="n">from</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span> <span class="n">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">365</span> <span class="n">ms</span>
<span class="mi">64</span> <span class="n">bytes</span> <span class="n">from</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span> <span class="n">icmp_seq</span><span class="o">=</span><span class="mi">2</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">519</span> <span class="n">ms</span>
</pre></table></code></div></div><p>server0:</p><p>https://linuxize.com/post/how-to-configure-and-manage-firewall-on-centos-8/</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="o">-------------</span><span class="n">error</span><span class="o">-------------</span>
<span class="n">error</span><span class="o">:</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="n">is</span> <span class="n">not</span> <span class="n">installed</span>
<span class="err">$</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">firewalld</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">firewalld</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">firewalld</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">is</span><span class="o">-</span><span class="n">enabled</span> <span class="n">firewalld</span>
<span class="n">enabled</span>

<span class="o">-------------</span><span class="n">error</span><span class="o">-------------</span>
<span class="n">root</span> <span class="err">#</span> <span class="n">firewall</span><span class="o">-</span><span class="n">config</span>
<span class="n">Unable</span> <span class="n">to</span> <span class="n">init</span> <span class="n">server</span><span class="o">:</span> <span class="n">Could</span> <span class="n">not</span> <span class="n">connect</span><span class="o">:</span> <span class="n">Connection</span> <span class="n">refused</span>
<span class="p">(</span><span class="n">firewall</span><span class="o">-</span><span class="n">config</span><span class="o">:</span><span class="mi">5000</span><span class="p">)</span><span class="o">:</span> <span class="n">Gtk</span><span class="o">-</span><span class="n">WARNING</span> <span class="o">**:</span> <span class="mi">19</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">32</span><span class="p">.</span><span class="mi">989</span><span class="o">:</span> <span class="n">cannot</span> <span class="n">open</span> <span class="n">display</span><span class="o">:</span>
<span class="n">Dont</span> <span class="n">run</span> <span class="n">sudo</span> <span class="n">su</span><span class="p">,</span> <span class="n">run</span> <span class="n">it</span> <span class="n">as</span> <span class="n">normal</span> <span class="n">user</span><span class="p">.</span>


<span class="c1">// easy configure the NAT</span>
<span class="cp"># firewall-config
</span><span class="n">zone</span> <span class="o">&gt;</span> <span class="n">public</span> <span class="o">&gt;</span>  <span class="n">masquerade</span> <span class="o">&gt;</span> <span class="n">mark</span>
<span class="n">Options</span> <span class="o">&gt;</span> <span class="n">runtime</span> <span class="n">to</span> <span class="n">permanent</span> <span class="p">(</span><span class="n">to</span> <span class="n">save</span> <span class="n">the</span> <span class="n">configuration</span><span class="p">)</span>

</pre></table></code></div></div><p>server1: now is able to ping.</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="cp"># ping 4.2.2.2
</span><span class="n">PING</span> <span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span> <span class="p">(</span><span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="n">bytes</span> <span class="n">of</span> <span class="n">data</span><span class="p">.</span>
<span class="mi">64</span> <span class="n">bytes</span> <span class="n">from</span> <span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="o">:</span> <span class="n">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">61</span> <span class="n">time</span><span class="o">=</span><span class="mi">20</span><span class="p">.</span><span class="mi">1</span> <span class="n">ms</span>
<span class="mi">64</span> <span class="n">bytes</span> <span class="n">from</span> <span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="o">:</span> <span class="n">icmp_seq</span><span class="o">=</span><span class="mi">2</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">61</span> <span class="n">time</span><span class="o">=</span><span class="mi">21</span><span class="p">.</span><span class="mi">3</span> <span class="n">ms</span>
</pre></table></code></div></div><hr /><h2 id="arp-wireshark">ARP Wireshark</h2><p>server1:</p><p><img data-proofer-ignore data-src="https://i.imgur.com/JBTHid9.png" alt="Screen Shot 2020-04-17 at 21.50.51" /></p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="cp"># arp -a
</span><span class="n">_gateway</span> <span class="p">(</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="n">at</span> <span class="mi">08</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="n">af</span><span class="o">:</span><span class="mi">6</span><span class="n">c</span><span class="o">:</span><span class="mi">25</span> <span class="p">[</span><span class="n">ether</span><span class="p">]</span> <span class="n">on</span> <span class="n">enp0s8</span>

<span class="cp"># arp -d 192.168.1.1
# arp -a
</span>
<span class="cp"># ping 192.168.1.1
</span>
<span class="cp"># arp -a
</span><span class="n">_gateway</span> <span class="p">(</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="n">at</span> <span class="mi">08</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="n">af</span><span class="o">:</span><span class="mi">6</span><span class="n">c</span><span class="o">:</span><span class="mi">25</span> <span class="p">[</span><span class="n">ether</span><span class="p">]</span> <span class="n">on</span> <span class="n">enp0s8</span>
</pre></table></code></div></div><hr /><h2 id="dns-wireshark">DNS Wireshark</h2><p>server1:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
</pre><td class="rouge-code"><pre><span class="cp"># vi /etc/resolv.conf
</span><span class="c1">//add line</span>
<span class="n">nameserver</span> <span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span>
<span class="n">nameserver</span> <span class="mi">8</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">8</span>


<span class="cp"># dig www.google.com
</span><span class="p">;</span> <span class="o">&lt;&lt;&gt;&gt;</span> <span class="n">DiG</span> <span class="mi">9</span><span class="p">.</span><span class="mi">11</span><span class="p">.</span><span class="mi">4</span><span class="o">-</span><span class="n">P2</span><span class="o">-</span><span class="n">RedHat</span><span class="o">-</span><span class="mi">9</span><span class="p">.</span><span class="mi">11</span><span class="p">.</span><span class="mi">4</span><span class="o">-</span><span class="mi">26</span><span class="p">.</span><span class="n">P2</span><span class="p">.</span><span class="n">el8</span> <span class="o">&lt;&lt;&gt;&gt;</span> <span class="n">www</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span>
<span class="p">;;</span> <span class="n">global</span> <span class="n">options</span><span class="o">:</span> <span class="o">+</span><span class="n">cmd</span>
<span class="p">;;</span> <span class="n">Got</span> <span class="n">answer</span><span class="o">:</span>
<span class="p">;;</span> <span class="o">-&gt;&gt;</span><span class="n">HEADER</span><span class="o">&lt;&lt;-</span> <span class="n">opcode</span><span class="o">:</span> <span class="n">QUERY</span><span class="p">,</span> <span class="n">status</span><span class="o">:</span> <span class="n">NOERROR</span><span class="p">,</span> <span class="n">id</span><span class="o">:</span> <span class="mi">48686</span>
<span class="p">;;</span> <span class="n">flags</span><span class="o">:</span> <span class="n">qr</span> <span class="n">rd</span> <span class="n">ra</span><span class="p">;</span> <span class="n">QUERY</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ANSWER</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">AUTHORITY</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ADDITIONAL</span><span class="o">:</span> <span class="mi">0</span>

<span class="p">;;</span> <span class="n">QUESTION</span> <span class="n">SECTION</span><span class="o">:</span>
<span class="p">;</span><span class="n">www</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span><span class="p">.</span>			<span class="n">IN</span>	<span class="n">A</span>

<span class="p">;;</span> <span class="n">ANSWER</span> <span class="n">SECTION</span><span class="o">:</span>
<span class="n">www</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span><span class="p">.</span>		<span class="mi">56</span>	<span class="n">IN</span>	<span class="n">A</span>	<span class="mi">172</span><span class="p">.</span><span class="mi">217</span><span class="p">.</span><span class="mi">12</span><span class="p">.</span><span class="mi">228</span>

<span class="p">;;</span> <span class="n">Query</span> <span class="n">time</span><span class="o">:</span> <span class="mi">25</span> <span class="n">msec</span>
<span class="p">;;</span> <span class="n">SERVER</span><span class="o">:</span> <span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="err">#</span><span class="mi">53</span><span class="p">(</span><span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span>
<span class="p">;;</span> <span class="n">WHEN</span><span class="o">:</span> <span class="n">Fri</span> <span class="n">Apr</span> <span class="mi">17</span> <span class="mi">21</span><span class="o">:</span><span class="mi">57</span><span class="o">:</span><span class="mi">42</span> <span class="n">EDT</span> <span class="mi">2020</span>
<span class="p">;;</span> <span class="n">MSG</span> <span class="n">SIZE</span>  <span class="n">rcvd</span><span class="o">:</span> <span class="mi">48</span>



<span class="cp"># host www.google.com
</span><span class="n">www</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span> <span class="n">has</span> <span class="n">address</span> <span class="mi">172</span><span class="p">.</span><span class="mi">217</span><span class="p">.</span><span class="mi">12</span><span class="p">.</span><span class="mi">228</span>
<span class="n">www</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span> <span class="n">has</span> <span class="n">IPv6</span> <span class="n">address</span> <span class="mi">2607</span><span class="o">:</span><span class="n">f8b0</span><span class="o">:</span><span class="mi">4004</span><span class="o">:</span><span class="mi">809</span><span class="o">::</span><span class="mi">2004</span>



<span class="cp"># Wireshark
</span>
<span class="mi">1</span>	<span class="mi">0</span><span class="p">.</span><span class="mo">000000000</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>	<span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span>	<span class="n">DNS</span>	<span class="mi">97</span>	<span class="n">Standard</span> <span class="n">query</span> <span class="mh">0xbe2e</span> <span class="n">A</span> <span class="n">www</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span> <span class="n">OPT</span>
<span class="mi">2</span>	<span class="mi">0</span><span class="p">.</span><span class="mo">025</span><span class="mi">825286</span>	<span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>	<span class="n">DNS</span>	<span class="mi">90</span>	<span class="n">Standard</span> <span class="n">query</span> <span class="n">response</span> <span class="mh">0xbe2e</span> <span class="n">A</span> <span class="n">www</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span> <span class="n">A</span> <span class="mi">172</span><span class="p">.</span><span class="mi">217</span><span class="p">.</span><span class="mi">12</span><span class="p">.</span><span class="mi">228</span>

<span class="n">Frame</span> <span class="mi">1</span><span class="o">:</span> <span class="mi">97</span> <span class="n">bytes</span> <span class="n">on</span> <span class="n">wire</span> <span class="p">(</span><span class="mi">776</span> <span class="n">bits</span><span class="p">),</span> <span class="mi">97</span> <span class="n">bytes</span> <span class="n">captured</span> <span class="p">(</span><span class="mi">776</span> <span class="n">bits</span><span class="p">)</span> <span class="n">on</span> <span class="n">interface</span> <span class="mi">0</span>
<span class="n">Ethernet</span> <span class="n">II</span><span class="p">,</span> <span class="n">Src</span><span class="o">:</span> <span class="n">PcsCompu_bf</span><span class="o">:</span><span class="n">ee</span><span class="o">:</span><span class="n">f8</span> <span class="p">(</span><span class="mi">08</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="n">bf</span><span class="o">:</span><span class="n">ee</span><span class="o">:</span><span class="n">f8</span><span class="p">),</span> <span class="n">Dst</span><span class="o">:</span> <span class="n">PcsCompu_af</span><span class="o">:</span><span class="mi">6</span><span class="n">c</span><span class="o">:</span><span class="mi">25</span> <span class="p">(</span><span class="mi">08</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="n">af</span><span class="o">:</span><span class="mi">6</span><span class="n">c</span><span class="o">:</span><span class="mi">25</span><span class="p">)</span>
<span class="n">Internet</span> <span class="n">Protocol</span> <span class="n">Version</span> <span class="mi">4</span><span class="p">,</span> <span class="n">Src</span><span class="o">:</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="p">,</span> <span class="n">Dst</span><span class="o">:</span> <span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span>
<span class="n">User</span> <span class="n">Datagram</span> <span class="n">Protocol</span><span class="p">,</span> <span class="n">Src</span> <span class="n">Port</span><span class="o">:</span> <span class="mi">57740</span><span class="p">,</span> <span class="n">Dst</span> <span class="n">Port</span><span class="o">:</span> <span class="mi">53</span>
<span class="n">Domain</span> <span class="n">Name</span> <span class="n">System</span> <span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="p">...</span>
    <span class="n">Queries</span>
        <span class="n">www</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span><span class="o">:</span> <span class="n">type</span> <span class="n">A</span><span class="p">,</span> <span class="n">class</span> <span class="n">IN</span>
            <span class="n">Name</span><span class="o">:</span> <span class="n">www</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span>
            <span class="p">[</span><span class="n">Name</span> <span class="n">Length</span><span class="o">:</span> <span class="mi">14</span><span class="p">]</span>
            <span class="p">[</span><span class="n">Label</span> <span class="n">Count</span><span class="o">:</span> <span class="mi">3</span><span class="p">]</span>
            <span class="n">Type</span><span class="o">:</span> <span class="n">A</span> <span class="p">(</span><span class="n">Host</span> <span class="n">Address</span><span class="p">)</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">Class</span><span class="o">:</span> <span class="n">IN</span> <span class="p">(</span><span class="mh">0x0001</span><span class="p">)</span>
    <span class="p">...</span>
    <span class="p">[</span><span class="n">Response</span> <span class="n">In</span><span class="o">:</span> <span class="mi">2</span><span class="p">]</span>


<span class="n">Frame</span> <span class="mi">2</span><span class="o">:</span> <span class="mi">90</span> <span class="n">bytes</span> <span class="n">on</span> <span class="n">wire</span> <span class="p">(</span><span class="mi">720</span> <span class="n">bits</span><span class="p">),</span> <span class="mi">90</span> <span class="n">bytes</span> <span class="n">captured</span> <span class="p">(</span><span class="mi">720</span> <span class="n">bits</span><span class="p">)</span> <span class="n">on</span> <span class="n">interface</span> <span class="mi">0</span>
<span class="n">Ethernet</span> <span class="n">II</span><span class="p">,</span> <span class="n">Src</span><span class="o">:</span> <span class="n">PcsCompu_af</span><span class="o">:</span><span class="mi">6</span><span class="n">c</span><span class="o">:</span><span class="mi">25</span> <span class="p">(</span><span class="mi">08</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="n">af</span><span class="o">:</span><span class="mi">6</span><span class="n">c</span><span class="o">:</span><span class="mi">25</span><span class="p">),</span> <span class="n">Dst</span><span class="o">:</span> <span class="n">PcsCompu_bf</span><span class="o">:</span><span class="n">ee</span><span class="o">:</span><span class="n">f8</span> <span class="p">(</span><span class="mi">08</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="n">bf</span><span class="o">:</span><span class="n">ee</span><span class="o">:</span><span class="n">f8</span><span class="p">)</span>
<span class="n">Internet</span> <span class="n">Protocol</span> <span class="n">Version</span> <span class="mi">4</span><span class="p">,</span> <span class="n">Src</span><span class="o">:</span> <span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span> <span class="n">Dst</span><span class="o">:</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>
<span class="n">User</span> <span class="n">Datagram</span> <span class="n">Protocol</span><span class="p">,</span> <span class="n">Src</span> <span class="n">Port</span><span class="o">:</span> <span class="mi">53</span><span class="p">,</span> <span class="n">Dst</span> <span class="n">Port</span><span class="o">:</span> <span class="mi">57740</span>
<span class="n">Domain</span> <span class="n">Name</span> <span class="n">System</span> <span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="n">Queries</span>
    <span class="n">Answers</span>
        <span class="n">www</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span><span class="o">:</span> <span class="n">type</span> <span class="n">A</span><span class="p">,</span> <span class="n">class</span> <span class="n">IN</span><span class="p">,</span> <span class="n">addr</span> <span class="mi">172</span><span class="p">.</span><span class="mi">217</span><span class="p">.</span><span class="mi">12</span><span class="p">.</span><span class="mi">228</span>
            <span class="n">Name</span><span class="o">:</span> <span class="n">www</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span>
            <span class="n">Type</span><span class="o">:</span> <span class="n">A</span> <span class="p">(</span><span class="n">Host</span> <span class="n">Address</span><span class="p">)</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">Class</span><span class="o">:</span> <span class="n">IN</span> <span class="p">(</span><span class="mh">0x0001</span><span class="p">)</span>
            <span class="n">Time</span> <span class="n">to</span> <span class="n">live</span><span class="o">:</span> <span class="mi">56</span>
            <span class="n">Data</span> <span class="n">length</span><span class="o">:</span> <span class="mi">4</span>
            <span class="n">Address</span><span class="o">:</span> <span class="mi">172</span><span class="p">.</span><span class="mi">217</span><span class="p">.</span><span class="mi">12</span><span class="p">.</span><span class="mi">228</span>
    <span class="p">[</span><span class="n">Request</span> <span class="n">In</span><span class="o">:</span> <span class="mi">1</span><span class="p">]</span>
    <span class="p">[</span><span class="n">Time</span><span class="o">:</span> <span class="mi">0</span><span class="p">.</span><span class="mo">025</span><span class="mi">825286</span> <span class="n">seconds</span><span class="p">]</span>

</pre></table></code></div></div><hr /><h2 id="check-the-fragement-packets">check the fragement packets</h2><p>server1:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre>
<span class="n">small</span> <span class="n">packets</span><span class="o">:</span>

<span class="cp"># ping -c 1 4.2.2.2
</span><span class="n">PING</span> <span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span> <span class="p">(</span><span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="n">bytes</span> <span class="n">of</span> <span class="n">data</span><span class="p">.</span>
<span class="mi">64</span> <span class="n">bytes</span> <span class="n">from</span> <span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="o">:</span> <span class="n">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">61</span> <span class="n">time</span><span class="o">=</span><span class="mi">18</span><span class="p">.</span><span class="mi">0</span> <span class="n">ms</span>
<span class="o">---</span> <span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span> <span class="n">ping</span> <span class="n">statistics</span> <span class="o">---</span>
<span class="mi">1</span> <span class="n">packets</span> <span class="n">transmitted</span><span class="p">,</span> <span class="mi">1</span> <span class="n">received</span><span class="p">,</span> <span class="mi">0</span><span class="o">%</span> <span class="n">packet</span> <span class="n">loss</span><span class="p">,</span> <span class="n">time</span> <span class="mi">0</span><span class="n">ms</span>
<span class="n">rtt</span> <span class="n">min</span><span class="o">/</span><span class="n">avg</span><span class="o">/</span><span class="n">max</span><span class="o">/</span><span class="n">mdev</span> <span class="o">=</span> <span class="mi">18</span><span class="p">.</span><span class="mo">016</span><span class="o">/</span><span class="mi">18</span><span class="p">.</span><span class="mo">016</span><span class="o">/</span><span class="mi">18</span><span class="p">.</span><span class="mo">016</span><span class="o">/</span><span class="mi">0</span><span class="p">.</span><span class="mo">000</span> <span class="n">ms</span>


<span class="err">$</span> <span class="n">wireshark</span>

<span class="mi">1</span>	<span class="mi">0</span><span class="p">.</span><span class="mo">000000000</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>	<span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span>	<span class="n">ICMP</span>	<span class="mi">98</span>	<span class="n">Echo</span> <span class="p">(</span><span class="n">ping</span><span class="p">)</span> <span class="n">request</span>  <span class="n">id</span><span class="o">=</span><span class="mh">0x132a</span><span class="p">,</span> <span class="n">seq</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">256</span><span class="p">,</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="p">(</span><span class="n">reply</span> <span class="n">in</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">Frame</span> <span class="mi">1</span><span class="o">:</span> <span class="mi">98</span> <span class="n">bytes</span> <span class="n">on</span> <span class="n">wire</span> <span class="p">(</span><span class="mi">784</span> <span class="n">bits</span><span class="p">),</span> <span class="mi">98</span> <span class="n">bytes</span> <span class="n">captured</span> <span class="p">(</span><span class="mi">784</span> <span class="n">bits</span><span class="p">)</span> <span class="n">on</span> <span class="n">interface</span> <span class="mi">0</span>
<span class="n">Ethernet</span> <span class="n">II</span><span class="p">,</span> <span class="n">Src</span><span class="o">:</span> <span class="n">PcsCompu_bf</span><span class="o">:</span><span class="n">ee</span><span class="o">:</span><span class="n">f8</span> <span class="p">(</span><span class="mi">08</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="n">bf</span><span class="o">:</span><span class="n">ee</span><span class="o">:</span><span class="n">f8</span><span class="p">),</span> <span class="n">Dst</span><span class="o">:</span> <span class="n">PcsCompu_af</span><span class="o">:</span><span class="mi">6</span><span class="n">c</span><span class="o">:</span><span class="mi">25</span> <span class="p">(</span><span class="mi">08</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="n">af</span><span class="o">:</span><span class="mi">6</span><span class="n">c</span><span class="o">:</span><span class="mi">25</span><span class="p">)</span>
<span class="n">Internet</span> <span class="n">Protocol</span> <span class="n">Version</span> <span class="mi">4</span><span class="p">,</span> <span class="n">Src</span><span class="o">:</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="p">,</span> <span class="n">Dst</span><span class="o">:</span> <span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span>
    <span class="mo">0100</span> <span class="p">....</span> <span class="o">=</span> <span class="n">Version</span><span class="o">:</span> <span class="mi">4</span>
<span class="o">-------------------------</span> <span class="n">IP</span> <span class="n">header</span><span class="o">:</span> <span class="mi">20</span> <span class="n">bytes</span>
    <span class="p">....</span> <span class="mo">0101</span> <span class="o">=</span> <span class="n">Header</span> <span class="n">Length</span><span class="o">:</span> <span class="mi">20</span> <span class="n">bytes</span> <span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">Differentiated</span> <span class="n">Services</span> <span class="n">Field</span><span class="o">:</span> <span class="mh">0x00</span> <span class="p">(</span><span class="n">DSCP</span><span class="o">:</span> <span class="n">CS0</span><span class="p">,</span> <span class="n">ECN</span><span class="o">:</span> <span class="n">Not</span><span class="o">-</span><span class="n">ECT</span><span class="p">)</span>
<span class="o">-------------------------</span> <span class="n">data</span><span class="o">:</span> <span class="mi">64</span> <span class="n">Bytes</span>
<span class="o">-------------------------</span> <span class="n">IP</span> <span class="n">header</span><span class="o">:</span> <span class="mi">20</span> <span class="n">bytes</span>
<span class="o">-------------------------</span> <span class="n">data</span><span class="o">+</span> <span class="n">IP</span> <span class="n">header</span><span class="o">:</span> <span class="mi">84</span> <span class="n">bytes</span>
    <span class="n">Total</span> <span class="n">Length</span><span class="o">:</span> <span class="mi">84</span>
    <span class="n">Identification</span><span class="o">:</span> <span class="mh">0x8fbc</span> <span class="p">(</span><span class="mi">36796</span><span class="p">)</span>
    <span class="n">Flags</span><span class="o">:</span> <span class="mh">0x4000</span><span class="p">,</span> <span class="n">Dont</span> <span class="n">fragment</span>
    <span class="n">Time</span> <span class="n">to</span> <span class="n">live</span><span class="o">:</span> <span class="mi">64</span>
    <span class="n">Protocol</span><span class="o">:</span> <span class="n">ICMP</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">Header</span> <span class="n">checksum</span><span class="o">:</span> <span class="mh">0xe2dc</span> <span class="p">[</span><span class="n">validation</span> <span class="n">disabled</span><span class="p">]</span>
    <span class="p">[</span><span class="n">Header</span> <span class="n">checksum</span> <span class="n">status</span><span class="o">:</span> <span class="n">Unverified</span><span class="p">]</span>
    <span class="n">Source</span><span class="o">:</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>
    <span class="n">Destination</span><span class="o">:</span> <span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span>
    <span class="p">[</span><span class="n">Destination</span> <span class="n">GeoIP</span><span class="o">:</span> <span class="n">US</span><span class="p">]</span>
<span class="n">Internet</span> <span class="n">Control</span> <span class="n">Message</span> <span class="n">Protocol</span>

</pre></table></code></div></div><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
</pre><td class="rouge-code"><pre>
<span class="n">large</span> <span class="n">packt</span>

<span class="cp"># make the package size as 1472
</span>
<span class="err">$</span> <span class="n">ping</span> <span class="o">-</span><span class="n">c</span> <span class="mi">1</span> <span class="o">-</span><span class="n">s</span> <span class="mi">1472</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>

<span class="mi">1</span>	<span class="mi">0</span><span class="p">.</span><span class="mo">000000000</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>	<span class="n">ICMP</span>	<span class="mi">1514</span>	<span class="n">Echo</span> <span class="p">(</span><span class="n">ping</span><span class="p">)</span> <span class="n">request</span>  <span class="n">id</span><span class="o">=</span><span class="mh">0x1363</span><span class="p">,</span> <span class="n">seq</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">256</span><span class="p">,</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="p">(</span><span class="n">reply</span> <span class="n">in</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">Frame</span> <span class="mi">1</span><span class="o">:</span> <span class="mi">1514</span> <span class="n">bytes</span> <span class="n">on</span> <span class="n">wire</span> <span class="p">(</span><span class="mi">12112</span> <span class="n">bits</span><span class="p">),</span> <span class="mi">1514</span> <span class="n">bytes</span> <span class="n">captured</span> <span class="p">(</span><span class="mi">12112</span> <span class="n">bits</span><span class="p">)</span> <span class="n">on</span> <span class="n">interface</span> <span class="mi">0</span>
<span class="n">Ethernet</span> <span class="n">II</span><span class="p">,</span> <span class="n">Src</span><span class="o">:</span> <span class="n">PcsCompu_bf</span><span class="o">:</span><span class="n">ee</span><span class="o">:</span><span class="n">f8</span> <span class="p">(</span><span class="mi">08</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="n">bf</span><span class="o">:</span><span class="n">ee</span><span class="o">:</span><span class="n">f8</span><span class="p">),</span> <span class="n">Dst</span><span class="o">:</span> <span class="n">PcsCompu_af</span><span class="o">:</span><span class="mi">6</span><span class="n">c</span><span class="o">:</span><span class="mi">25</span> <span class="p">(</span><span class="mi">08</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="n">af</span><span class="o">:</span><span class="mi">6</span><span class="n">c</span><span class="o">:</span><span class="mi">25</span><span class="p">)</span>
<span class="n">Internet</span> <span class="n">Protocol</span> <span class="n">Version</span> <span class="mi">4</span><span class="p">,</span> <span class="n">Src</span><span class="o">:</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="p">,</span> <span class="n">Dst</span><span class="o">:</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>

<span class="o">-------------------------</span> <span class="n">ping</span> <span class="n">packet</span> <span class="n">size</span><span class="o">:</span> <span class="mi">1472</span> <span class="n">Bytes</span>
<span class="o">-------------------------</span> <span class="n">ICMP</span> <span class="n">its</span> <span class="n">own</span> <span class="n">header</span><span class="o">:</span> <span class="mi">8</span> <span class="n">Bytes</span>
<span class="o">-------------------------</span> <span class="n">transmission</span> <span class="n">size</span><span class="o">:</span> <span class="mi">1480</span> <span class="n">Bytes</span>

    <span class="mo">0100</span> <span class="p">....</span> <span class="o">=</span> <span class="n">Version</span><span class="o">:</span> <span class="mi">4</span>
    <span class="p">....</span> <span class="mo">0101</span> <span class="o">=</span> <span class="n">Header</span> <span class="n">Length</span><span class="o">:</span> <span class="mi">20</span> <span class="n">bytes</span> <span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">Differentiated</span> <span class="n">Services</span> <span class="n">Field</span><span class="o">:</span> <span class="mh">0x00</span> <span class="p">(</span><span class="n">DSCP</span><span class="o">:</span> <span class="n">CS0</span><span class="p">,</span> <span class="n">ECN</span><span class="o">:</span> <span class="n">Not</span><span class="o">-</span><span class="n">ECT</span><span class="p">)</span>

<span class="o">-------------------------</span> <span class="n">data</span><span class="o">:</span> <span class="mi">1480</span> <span class="n">Bytes</span>
<span class="o">-------------------------</span> <span class="n">IP</span> <span class="n">header</span><span class="o">:</span> <span class="mi">20</span> <span class="n">bytes</span>
<span class="o">-------------------------</span> <span class="n">data</span><span class="o">+</span> <span class="n">IP</span> <span class="n">header</span><span class="o">:</span> <span class="mi">1500</span> <span class="n">bytes</span>

    <span class="n">Total</span> <span class="n">Length</span><span class="o">:</span> <span class="mi">1500</span>
    <span class="n">Identification</span><span class="o">:</span> <span class="mh">0x3e5d</span> <span class="p">(</span><span class="mi">15965</span><span class="p">)</span>
    <span class="n">Flags</span><span class="o">:</span> <span class="mh">0x4000</span><span class="p">,</span> <span class="n">Dont</span> <span class="n">fragment</span>
    <span class="n">Time</span> <span class="n">to</span> <span class="n">live</span><span class="o">:</span> <span class="mi">64</span>
    <span class="n">Protocol</span><span class="o">:</span> <span class="n">ICMP</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">Header</span> <span class="n">checksum</span><span class="o">:</span> <span class="mh">0x730e</span> <span class="p">[</span><span class="n">validation</span> <span class="n">disabled</span><span class="p">]</span>
    <span class="p">[</span><span class="n">Header</span> <span class="n">checksum</span> <span class="n">status</span><span class="o">:</span> <span class="n">Unverified</span><span class="p">]</span>
    <span class="n">Source</span><span class="o">:</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>
    <span class="n">Destination</span><span class="o">:</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>
<span class="n">Internet</span> <span class="n">Control</span> <span class="n">Message</span> <span class="n">Protocol</span>

<span class="c1">// check the MTU = 1500</span>
<span class="err">$</span> <span class="n">ip</span> <span class="n">addr</span>

<span class="mi">3</span><span class="o">:</span> <span class="n">enp0s8</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">BROADCAST</span><span class="p">,</span><span class="n">MULTICAST</span><span class="p">,</span><span class="n">UP</span><span class="p">,</span><span class="n">LOWER_UP</span><span class="o">&gt;</span> <span class="n">mtu</span> <span class="mi">1500</span> <span class="n">qdisc</span> <span class="n">fq_codel</span> <span class="n">state</span> <span class="n">UP</span> <span class="n">group</span> <span class="k">default</span> <span class="n">qlen</span> <span class="mi">1000</span>



<span class="cp"># make the package size as 1473
</span>
<span class="err">$</span> <span class="n">ping</span> <span class="o">-</span><span class="n">c</span> <span class="mi">1</span> <span class="o">-</span><span class="n">s</span> <span class="mi">1473</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>

<span class="mi">3</span>	<span class="mi">6</span><span class="p">.</span><span class="mi">254072263</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>	<span class="n">IPv4</span>	<span class="mi">1514</span>	<span class="n">Fragmented</span> <span class="n">IP</span> <span class="n">protocol</span> <span class="p">(</span><span class="n">proto</span><span class="o">=</span><span class="n">ICMP</span> <span class="mi">1</span><span class="p">,</span> <span class="n">off</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ID</span><span class="o">=</span><span class="mi">51</span><span class="n">d1</span><span class="p">)</span> <span class="p">[</span><span class="n">Reassembled</span> <span class="n">in</span> <span class="err">#</span><span class="mi">4</span><span class="p">]</span>
<span class="mi">4</span>	<span class="mi">6</span><span class="p">.</span><span class="mi">254193946</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>	<span class="n">ICMP</span>	<span class="mi">35</span>	<span class="n">Echo</span> <span class="p">(</span><span class="n">ping</span><span class="p">)</span> <span class="n">request</span>  <span class="n">id</span><span class="o">=</span><span class="mh">0x1364</span><span class="p">,</span> <span class="n">seq</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">256</span><span class="p">,</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="p">(</span><span class="n">reply</span> <span class="n">in</span> <span class="mi">6</span><span class="p">)</span>

<span class="n">Frame</span> <span class="mi">3</span><span class="o">:</span>
<span class="n">Ethernet</span> <span class="n">II</span><span class="p">,</span> <span class="n">Src</span><span class="o">:</span>
<span class="n">Internet</span> <span class="n">Protocol</span> <span class="n">Version</span> <span class="mi">4</span><span class="p">,</span> <span class="n">Src</span><span class="o">:</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="p">,</span> <span class="n">Dst</span><span class="o">:</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>
    <span class="p">...</span>
    <span class="p">....</span> <span class="mo">0101</span> <span class="o">=</span> <span class="n">Header</span> <span class="n">Length</span><span class="o">:</span> <span class="mi">20</span> <span class="n">bytes</span> <span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="o">-------------------------</span> <span class="n">ping</span> <span class="n">packet</span> <span class="n">size</span><span class="o">:</span> <span class="mi">1472</span> <span class="n">Bytes</span>
<span class="o">-------------------------</span> <span class="n">ICMP</span> <span class="n">its</span> <span class="n">own</span> <span class="n">header</span><span class="o">:</span> <span class="mi">8</span> <span class="n">Bytes</span>
<span class="o">-------------------------</span> <span class="n">data</span><span class="o">:</span> <span class="mi">1480</span> <span class="n">Bytes</span>

<span class="o">-------------------------</span> <span class="n">IP</span> <span class="n">header</span><span class="o">:</span> <span class="mi">20</span> <span class="n">bytes</span>
<span class="o">-------------------------</span> <span class="n">data</span><span class="o">+</span> <span class="n">IP</span> <span class="n">header</span><span class="o">:</span> <span class="mi">1500</span> <span class="n">bytes</span>
    <span class="n">Total</span> <span class="n">Length</span><span class="o">:</span> <span class="mi">1500</span>
    <span class="p">...</span>
<span class="n">Data</span> <span class="p">(</span><span class="mi">1480</span> <span class="n">bytes</span><span class="p">)</span>


<span class="n">Frame</span> <span class="mi">4</span><span class="o">:</span>
<span class="n">Ethernet</span> <span class="n">II</span><span class="p">,</span> <span class="n">Src</span><span class="o">:</span>
<span class="n">Internet</span> <span class="n">Protocol</span> <span class="n">Version</span> <span class="mi">4</span><span class="p">,</span> <span class="n">Src</span><span class="o">:</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="p">,</span> <span class="n">Dst</span><span class="o">:</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>
    <span class="p">...</span>
    <span class="p">....</span> <span class="mo">0101</span> <span class="o">=</span> <span class="n">Header</span> <span class="n">Length</span><span class="o">:</span> <span class="mi">20</span> <span class="n">bytes</span> <span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="o">-------------------------</span> <span class="n">ping</span> <span class="n">packet</span> <span class="n">size</span><span class="o">:</span> <span class="mi">1</span> <span class="n">Bytes</span>
<span class="o">-------------------------</span> <span class="n">IP</span> <span class="n">header</span><span class="o">:</span> <span class="mi">20</span> <span class="n">bytes</span>
<span class="o">-------------------------</span> <span class="n">data</span><span class="o">+</span> <span class="n">IP</span> <span class="n">header</span><span class="o">:</span> <span class="mi">21</span> <span class="n">bytes</span>
    <span class="n">Total</span> <span class="n">Length</span><span class="o">:</span> <span class="mi">21</span>
    <span class="p">...</span>
<span class="n">Internet</span> <span class="n">Control</span> <span class="n">Message</span> <span class="n">Protocol</span>

</pre></table></code></div></div><hr /><h2 id="manipulate-with-ttl">manipulate with TTL</h2><p>server1:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre><td class="rouge-code"><pre>
<span class="cp"># -n : donot do DNS lookup on all the routers along the way.
</span><span class="n">it</span> <span class="n">may</span> <span class="n">takes</span> <span class="kt">long</span> <span class="n">time</span><span class="p">.</span>

<span class="err">$</span> <span class="n">traceroute</span> <span class="o">-</span><span class="n">n</span> <span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span>

<span class="n">traceroute</span> <span class="n">to</span> <span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span> <span class="p">(</span><span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">),</span> <span class="mi">30</span> <span class="n">hops</span> <span class="n">max</span><span class="p">,</span> <span class="mi">60</span> <span class="n">byte</span> <span class="n">packets</span>
 <span class="mi">1</span>  <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">157</span> <span class="n">ms</span>  <span class="mi">1</span><span class="p">.</span><span class="mo">005</span> <span class="n">ms</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">952</span> <span class="n">ms</span>
 <span class="mi">2</span>  <span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">304</span> <span class="n">ms</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">397</span> <span class="n">ms</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">314</span> <span class="n">ms</span>
<span class="c1">// these are hop that doesnt Reply</span>
<span class="c1">// ignore, add 1 ttl, send again.</span>
 <span class="mi">3</span>  <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>
 <span class="mi">4</span>  <span class="mi">96</span><span class="p">.</span><span class="mi">120</span><span class="p">.</span><span class="mi">11</span><span class="p">.</span><span class="mi">225</span>  <span class="mi">12</span><span class="p">.</span><span class="mi">491</span> <span class="n">ms</span>  <span class="mi">12</span><span class="p">.</span><span class="mi">483</span> <span class="n">ms</span>  <span class="mi">12</span><span class="p">.</span><span class="mi">383</span> <span class="n">ms</span>
 <span class="mi">5</span>  <span class="mi">68</span><span class="p">.</span><span class="mi">87</span><span class="p">.</span><span class="mi">137</span><span class="p">.</span><span class="mi">189</span>  <span class="mi">12</span><span class="p">.</span><span class="mi">305</span> <span class="n">ms</span>  <span class="mi">14</span><span class="p">.</span><span class="mi">231</span> <span class="n">ms</span>  <span class="mi">14</span><span class="p">.</span><span class="mi">859</span> <span class="n">ms</span>
 <span class="mi">6</span>  <span class="mi">96</span><span class="p">.</span><span class="mi">110</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">221</span>  <span class="mi">24</span><span class="p">.</span><span class="mi">297</span> <span class="n">ms</span>  <span class="mi">24</span><span class="p">.</span><span class="mi">336</span> <span class="n">ms</span>  <span class="mi">24</span><span class="p">.</span><span class="mi">281</span> <span class="n">ms</span>
 <span class="mi">7</span>  <span class="mi">162</span><span class="p">.</span><span class="mi">151</span><span class="p">.</span><span class="mi">60</span><span class="p">.</span><span class="mi">233</span>  <span class="mi">20</span><span class="p">.</span><span class="mi">454</span> <span class="n">ms</span>  <span class="mi">20</span><span class="p">.</span><span class="mi">089</span> <span class="n">ms</span>  <span class="mi">19</span><span class="p">.</span><span class="mi">874</span> <span class="n">ms</span>
 <span class="mi">8</span>  <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>
 <span class="mi">9</span>  <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>
<span class="mi">10</span>  <span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">18</span><span class="p">.</span><span class="mi">461</span> <span class="n">ms</span>  <span class="mi">27</span><span class="p">.</span><span class="mi">538</span> <span class="n">ms</span>  <span class="mi">27</span><span class="p">.</span><span class="mi">466</span> <span class="n">ms</span>


<span class="n">wireshark</span> <span class="n">to</span> <span class="n">check</span>
<span class="n">ICMP</span> <span class="n">echo</span> <span class="n">request</span> <span class="n">TTL</span><span class="o">:</span> <span class="mi">64</span> <span class="p">(</span><span class="n">according</span> <span class="n">to</span> <span class="n">the</span> <span class="n">system</span><span class="p">.)</span>



<span class="cp"># -t : chenge the TTL in the IP header
</span><span class="c1">// ping the 4th hop</span>

<span class="cp"># ping -t 4 4.2.2.2
</span><span class="n">PING</span> <span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span> <span class="p">(</span><span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="n">bytes</span> <span class="n">of</span> <span class="n">data</span><span class="p">.</span>
<span class="n">From</span> <span class="mi">96</span><span class="p">.</span><span class="mi">120</span><span class="p">.</span><span class="mi">11</span><span class="p">.</span><span class="mi">225</span> <span class="n">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="n">Time</span> <span class="n">to</span> <span class="n">live</span> <span class="n">exceeded</span>
<span class="o">---</span> <span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span> <span class="n">ping</span> <span class="n">statistics</span> <span class="o">---</span>
<span class="mi">6</span> <span class="n">packets</span> <span class="n">transmitted</span><span class="p">,</span> <span class="mi">0</span> <span class="n">received</span><span class="p">,</span> <span class="o">+</span><span class="mi">6</span> <span class="n">errors</span><span class="p">,</span> <span class="mi">100</span><span class="o">%</span> <span class="n">packet</span> <span class="n">loss</span><span class="p">,</span> <span class="n">time</span> <span class="mi">25</span><span class="n">ms</span>



<span class="cp"># check the route table
</span>
<span class="cp"># route -n
</span><span class="n">Kernel</span> <span class="n">IP</span> <span class="n">routing</span> <span class="n">table</span>
<span class="n">Destination</span>     <span class="n">Gateway</span>         <span class="n">Genmask</span>         <span class="n">Flags</span> <span class="n">Metric</span> <span class="n">Ref</span>    <span class="n">Use</span> <span class="n">Iface</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span>         <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span>         <span class="n">UG</span>    <span class="mi">101</span>    <span class="mi">0</span>        <span class="mi">0</span> <span class="n">enp0s8</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span>         <span class="mi">255</span><span class="p">.</span><span class="mi">255</span><span class="p">.</span><span class="mi">255</span><span class="p">.</span><span class="mi">0</span>   <span class="n">U</span>     <span class="mi">101</span>    <span class="mi">0</span>        <span class="mi">0</span> <span class="n">enp0s8</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">122</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span>         <span class="mi">255</span><span class="p">.</span><span class="mi">255</span><span class="p">.</span><span class="mi">255</span><span class="p">.</span><span class="mi">0</span>   <span class="n">U</span>     <span class="mi">0</span>      <span class="mi">0</span>        <span class="mi">0</span> <span class="n">virbr0</span>

</pre></table></code></div></div><hr /><h2 id="configure-routes-setup-vlan">configure routes, setup VLAN</h2><p>server2:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre><td class="rouge-code"><pre>
<span class="cp"># add static route
</span>
<span class="err">$</span> <span class="n">ip</span> <span class="n">route</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">25</span> <span class="n">dev</span> <span class="n">enp0s8</span> <span class="n">proto</span> <span class="n">kernel</span> <span class="n">scope</span> <span class="n">link</span> <span class="n">src</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">100</span> <span class="n">metric</span> <span class="mi">101</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">122</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">24</span> <span class="n">dev</span> <span class="n">virbr0</span> <span class="n">proto</span> <span class="n">kernel</span> <span class="n">scope</span> <span class="n">link</span> <span class="n">src</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">122</span><span class="p">.</span><span class="mi">1</span> <span class="n">linkdown</span>

<span class="err">$</span> <span class="n">route</span> <span class="o">-</span><span class="n">n</span>
<span class="n">Kernel</span> <span class="n">IP</span> <span class="n">routing</span> <span class="n">table</span>
<span class="n">Destination</span>     <span class="n">Gateway</span>         <span class="n">Genmask</span>         <span class="n">Flags</span> <span class="n">Metric</span> <span class="n">Ref</span>    <span class="n">Use</span> <span class="n">Iface</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span>         <span class="mi">255</span><span class="p">.</span><span class="mi">255</span><span class="p">.</span><span class="mi">255</span><span class="p">.</span><span class="mi">128</span> <span class="n">U</span>     <span class="mi">101</span>    <span class="mi">0</span>        <span class="mi">0</span> <span class="n">enp0s8</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">122</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span>         <span class="mi">255</span><span class="p">.</span><span class="mi">255</span><span class="p">.</span><span class="mi">255</span><span class="p">.</span><span class="mi">0</span>   <span class="n">U</span>     <span class="mi">0</span>      <span class="mi">0</span>        <span class="mi">0</span> <span class="n">virbr0</span>


<span class="n">run</span> <span class="n">time</span> <span class="n">configuration</span><span class="o">:</span>
<span class="c1">// restart network, lose it</span>
<span class="err">$</span> <span class="n">ip</span> <span class="n">route</span> <span class="n">add</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span> <span class="n">via</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span> <span class="n">dev</span> <span class="n">enp0s3</span>

<span class="err">$</span> <span class="n">ip</span> <span class="n">route</span>
<span class="c1">// the line added</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span> <span class="n">via</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span> <span class="n">dev</span> <span class="n">enp0s3</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">25</span> <span class="n">dev</span> <span class="n">enp0s8</span> <span class="n">proto</span> <span class="n">kernel</span> <span class="n">scope</span> <span class="n">link</span> <span class="n">src</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">100</span> <span class="n">metric</span> <span class="mi">101</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">122</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">24</span> <span class="n">dev</span> <span class="n">virbr0</span> <span class="n">proto</span> <span class="n">kernel</span> <span class="n">scope</span> <span class="n">link</span> <span class="n">src</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">122</span><span class="p">.</span><span class="mi">1</span> <span class="n">linkdown</span>

<span class="err">$</span> <span class="n">ip</span> <span class="n">route</span> <span class="n">del</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>


<span class="n">add</span> <span class="n">a</span> <span class="n">persistent</span> <span class="n">route</span><span class="o">:</span>
<span class="err">$</span> <span class="n">vi</span> <span class="n">route</span><span class="o">-</span><span class="n">enp0s8</span>
<span class="c1">// add line</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span> <span class="n">via</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span> <span class="n">dev</span> <span class="n">enp0s3</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">restart</span> <span class="n">network</span>
<span class="err">$</span> <span class="n">ip</span> <span class="n">route</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">24</span> <span class="n">via</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span> <span class="n">dev</span> <span class="n">enp0s8</span> <span class="n">proto</span> <span class="k">static</span> <span class="n">metric</span> <span class="mi">101</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">25</span> <span class="n">dev</span> <span class="n">enp0s8</span> <span class="n">proto</span> <span class="n">kernel</span> <span class="n">scope</span> <span class="n">link</span> <span class="n">src</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">100</span> <span class="n">metric</span> <span class="mi">101</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">122</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">24</span> <span class="n">dev</span> <span class="n">virbr0</span> <span class="n">proto</span> <span class="n">kernel</span> <span class="n">scope</span> <span class="n">link</span> <span class="n">src</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">122</span><span class="p">.</span><span class="mi">1</span> <span class="n">linkdown</span>


<span class="cp"># ping 4.2.2.2
</span><span class="n">connect</span><span class="o">:</span> <span class="n">Network</span> <span class="n">is</span> <span class="n">unreachable</span>
<span class="err">$</span> <span class="n">vi</span> <span class="n">ifcfg</span><span class="o">-</span><span class="n">enp0s8</span>
<span class="c1">// add line</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span> <span class="n">via</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span> <span class="n">dev</span> <span class="n">enp0s3</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">restart</span> <span class="n">network</span>
<span class="err">$</span> <span class="n">ip</span> <span class="n">route</span>
<span class="c1">// default router added</span>
<span class="k">default</span> <span class="n">via</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span> <span class="n">dev</span> <span class="n">enp0s8</span> <span class="n">proto</span> <span class="k">static</span> <span class="n">metric</span> <span class="mi">101</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">24</span> <span class="n">via</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span> <span class="n">dev</span> <span class="n">enp0s8</span> <span class="n">proto</span> <span class="k">static</span> <span class="n">metric</span> <span class="mi">101</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">25</span> <span class="n">dev</span> <span class="n">enp0s8</span> <span class="n">proto</span> <span class="n">kernel</span> <span class="n">scope</span> <span class="n">link</span> <span class="n">src</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">100</span> <span class="n">metric</span> <span class="mi">101</span>
<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">122</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">24</span> <span class="n">dev</span> <span class="n">virbr0</span> <span class="n">proto</span> <span class="n">kernel</span> <span class="n">scope</span> <span class="n">link</span> <span class="n">src</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">122</span><span class="p">.</span><span class="mi">1</span> <span class="n">linkdown</span>
<span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">server2</span> <span class="n">network</span><span class="o">-</span><span class="n">scripts</span><span class="p">]</span><span class="err">#</span>

</pre></table></code></div></div><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre><td class="rouge-code"><pre>
<span class="cp"># add VLAN
</span>
<span class="err">$</span> <span class="n">vi</span> <span class="n">ifcfg</span><span class="o">-</span><span class="n">enp0s8</span><span class="p">.</span><span class="mi">42</span>
<span class="c1">// Edit</span>
<span class="n">TYPE</span><span class="o">=</span><span class="n">Ethernet</span>
<span class="n">BOOTPROTO</span><span class="o">=</span><span class="n">none</span>
<span class="n">NAME</span><span class="o">=</span><span class="n">enp0s8</span><span class="p">.</span><span class="mi">42</span>
<span class="n">DEVICE</span><span class="o">=</span><span class="n">enp0s8</span><span class="p">.</span><span class="mi">42</span>
<span class="n">ONBOOT</span><span class="o">=</span><span class="n">yes</span>
<span class="c1">// VLAN yes!</span>
<span class="n">VLAN</span><span class="o">=</span><span class="n">yes</span>
<span class="n">NETWORK</span><span class="o">=</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">42</span><span class="p">.</span><span class="mi">0</span>
<span class="n">IPADDR</span><span class="o">=</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">42</span><span class="p">.</span><span class="mi">100</span>
<span class="n">PREFIX</span><span class="o">=</span><span class="mi">24</span>

<span class="c1">// get network manager out of way.</span>
<span class="c1">// it wont accept</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">stop</span> <span class="n">NetworkManager</span>
<span class="c1">// avoid break the configuration when the system reboot</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">disable</span> <span class="n">NetworkManager</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="n">restart</span> <span class="n">network</span>


<span class="err">$</span> <span class="n">ip</span> <span class="o">-</span><span class="n">d</span> <span class="n">link</span> <span class="n">show</span>
<span class="p">...</span>
<span class="mi">3</span><span class="o">:</span> <span class="n">enp0s8</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">BROADCAST</span><span class="p">,</span><span class="n">MULTICAST</span><span class="p">,</span><span class="n">UP</span><span class="p">,</span><span class="n">LOWER_UP</span><span class="o">&gt;</span> <span class="n">mtu</span> <span class="mi">1500</span> <span class="n">qdisc</span> <span class="n">fq_codel</span> <span class="n">state</span> <span class="n">UP</span> <span class="n">mode</span> <span class="n">DEFAULT</span> <span class="n">group</span> <span class="k">default</span> <span class="n">qlen</span> <span class="mi">1000</span>
    <span class="n">link</span><span class="o">/</span><span class="n">ether</span> <span class="mi">08</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="n">e1</span><span class="o">:</span><span class="mi">1</span><span class="n">f</span><span class="o">:</span><span class="n">f1</span> <span class="n">brd</span> <span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span> <span class="n">promiscuity</span> <span class="mi">0</span> <span class="n">addrgenmode</span> <span class="n">eui64</span> <span class="n">numtxqueues</span> <span class="mi">1</span> <span class="n">numrxqueues</span> <span class="mi">1</span> <span class="n">gso_max_size</span> <span class="mi">65536</span> <span class="n">gso_max_segs</span> <span class="mi">65535</span>
<span class="c1">// VLAN</span>
<span class="c1">// VLAN id 42</span>
<span class="c1">// same physical address of enp0s8</span>
<span class="mi">6</span><span class="o">:</span> <span class="n">enp0s8</span><span class="p">.</span><span class="mi">42</span><span class="err">@</span><span class="n">enp0s8</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">BROADCAST</span><span class="p">,</span><span class="n">MULTICAST</span><span class="p">,</span><span class="n">UP</span><span class="p">,</span><span class="n">LOWER_UP</span><span class="o">&gt;</span> <span class="n">mtu</span> <span class="mi">1500</span> <span class="n">qdisc</span> <span class="n">noqueue</span> <span class="n">state</span> <span class="n">UP</span> <span class="n">mode</span> <span class="n">DEFAULT</span> <span class="n">group</span> <span class="k">default</span> <span class="n">qlen</span> <span class="mi">1000</span>
    <span class="n">link</span><span class="o">/</span><span class="n">ether</span> <span class="mi">08</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="n">e1</span><span class="o">:</span><span class="mi">1</span><span class="n">f</span><span class="o">:</span><span class="n">f1</span> <span class="n">brd</span> <span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span> <span class="n">promiscuity</span> <span class="mi">0</span>
    <span class="n">vlan</span> <span class="n">protocol</span> <span class="mi">802</span><span class="p">.</span><span class="mi">1</span><span class="n">Q</span> <span class="n">id</span> <span class="mi">42</span> <span class="o">&lt;</span><span class="n">REORDER_HDR</span><span class="o">&gt;</span> <span class="n">addrgenmode</span> <span class="n">eui64</span> <span class="n">numtxqueues</span> <span class="mi">1</span> <span class="n">numrxqueues</span> <span class="mi">1</span> <span class="n">gso_max_size</span> <span class="mi">65536</span> <span class="n">gso_max_segs</span> <span class="mi">65535</span>


<span class="err">$</span> <span class="n">ip</span> <span class="n">addr</span>
<span class="p">...</span>
<span class="mi">7</span><span class="o">:</span> <span class="n">enp0s8</span><span class="p">.</span><span class="mi">42</span><span class="err">@</span><span class="n">enp0s8</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">BROADCAST</span><span class="p">,</span><span class="n">MULTICAST</span><span class="p">,</span><span class="n">UP</span><span class="p">,</span><span class="n">LOWER_UP</span><span class="o">&gt;</span> <span class="n">mtu</span> <span class="mi">1500</span> <span class="n">qdisc</span> <span class="n">noqueue</span> <span class="n">state</span> <span class="n">UP</span> <span class="n">group</span> <span class="k">default</span> <span class="n">qlen</span> <span class="mi">1000</span>
    <span class="n">link</span><span class="o">/</span><span class="n">ether</span> <span class="mi">08</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="n">e1</span><span class="o">:</span><span class="mi">1</span><span class="n">f</span><span class="o">:</span><span class="n">f1</span> <span class="n">brd</span> <span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span>
    <span class="n">inet</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">42</span><span class="p">.</span><span class="mi">100</span><span class="o">/</span><span class="mi">24</span> <span class="n">brd</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">42</span><span class="p">.</span><span class="mi">255</span> <span class="n">scope</span> <span class="n">global</span> <span class="n">enp0s8</span><span class="p">.</span><span class="mi">42</span>
       <span class="n">valid_lft</span> <span class="n">forever</span> <span class="n">preferred_lft</span> <span class="n">forever</span>
    <span class="n">inet6</span> <span class="n">fe80</span><span class="o">::</span><span class="n">a00</span><span class="o">:</span><span class="mi">27</span><span class="n">ff</span><span class="o">:</span><span class="n">fee1</span><span class="o">:</span><span class="mi">1</span><span class="n">ff1</span><span class="o">/</span><span class="mi">64</span> <span class="n">scope</span> <span class="n">link</span>
       <span class="n">valid_lft</span> <span class="n">forever</span> <span class="n">preferred_lft</span> <span class="n">forever</span>
</pre></table></code></div></div><hr /><h2 id="establish-and-ternination-of-a-tcp-handshack">establish and ternination of a TCP handshack</h2><p>server1:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre><td class="rouge-code"><pre>
<span class="mi">1</span><span class="p">.</span> <span class="n">run</span> <span class="n">the</span> <span class="n">wireshark</span>


<span class="mi">2</span><span class="p">.</span> <span class="n">download</span> <span class="n">the</span> <span class="n">html</span> <span class="n">file</span> <span class="n">from</span> <span class="n">server0</span>

<span class="err">$</span> <span class="n">wget</span> <span class="n">http</span><span class="o">:</span><span class="c1">//192.168.1.1/index.html</span>
<span class="o">--</span><span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">18</span> <span class="mi">17</span><span class="o">:</span><span class="mi">29</span><span class="o">:</span><span class="mi">31</span><span class="o">--</span>  <span class="n">http</span><span class="o">:</span><span class="c1">//192.168.1.1/index.html</span>
<span class="n">Connecting</span> <span class="n">to</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">80</span><span class="p">...</span> <span class="n">connected</span><span class="p">.</span>
<span class="n">HTTP</span> <span class="n">request</span> <span class="n">sent</span><span class="p">,</span> <span class="n">awaiting</span> <span class="n">response</span><span class="p">...</span> <span class="mi">200</span> <span class="n">OK</span>
<span class="n">Length</span><span class="o">:</span> <span class="mi">12</span> <span class="p">[</span><span class="n">text</span><span class="o">/</span><span class="n">html</span><span class="p">]</span>
<span class="n">Saving</span> <span class="n">to</span><span class="o">:</span> <span class="err">‘</span><span class="n">index</span><span class="p">.</span><span class="n">html</span><span class="p">.</span><span class="mi">1</span><span class="err">’</span>
<span class="n">index</span><span class="p">.</span><span class="n">html</span><span class="p">.</span><span class="mi">1</span>         <span class="mi">100</span><span class="o">%</span><span class="p">[</span><span class="o">===================&gt;</span><span class="p">]</span>      <span class="mi">12</span>  <span class="o">--</span><span class="p">.</span><span class="o">-</span><span class="n">KB</span><span class="o">/</span><span class="n">s</span>    <span class="n">in</span> <span class="mi">0</span><span class="n">s</span>
<span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">18</span> <span class="mi">17</span><span class="o">:</span><span class="mi">29</span><span class="o">:</span><span class="mi">31</span> <span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mi">36</span> <span class="n">MB</span><span class="o">/</span><span class="n">s</span><span class="p">)</span> <span class="o">-</span> <span class="err">‘</span><span class="n">index</span><span class="p">.</span><span class="n">html</span><span class="p">.</span><span class="mi">1</span><span class="err">’</span> <span class="n">saved</span> <span class="p">[</span><span class="mi">12</span><span class="o">/</span><span class="mi">12</span><span class="p">]</span>



<span class="mi">3</span><span class="p">.</span> <span class="n">wireshark</span>

<span class="cp"># TCP three-way handshake
</span><span class="mi">1</span>	<span class="mi">0</span><span class="p">.</span><span class="mo">000000000</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>	<span class="n">TCP</span>	<span class="mi">74</span>	<span class="mi">33002</span> <span class="err">→</span> <span class="mi">80</span> <span class="p">[</span><span class="n">SYN</span><span class="p">]</span> <span class="n">Seq</span><span class="o">=</span><span class="mi">0</span> <span class="n">Win</span><span class="o">=</span><span class="mi">29200</span> <span class="n">Len</span><span class="o">=</span><span class="mi">0</span> <span class="n">MSS</span><span class="o">=</span><span class="mi">1460</span> <span class="n">SACK_PERM</span><span class="o">=</span><span class="mi">1</span> <span class="n">TSval</span><span class="o">=</span><span class="mi">2332931052</span> <span class="n">TSecr</span><span class="o">=</span><span class="mi">0</span> <span class="n">WS</span><span class="o">=</span><span class="mi">128</span>
<span class="cp"># the first flag set is the Syn flag with a sequence number of zero.
</span>

<span class="mi">2</span>	<span class="mi">0</span><span class="p">.</span><span class="mo">00047</span><span class="mi">9073</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>	<span class="n">TCP</span>	<span class="mi">74</span>	<span class="mi">80</span> <span class="err">→</span> <span class="mi">33002</span> <span class="p">[</span><span class="n">SYN</span><span class="p">,</span> <span class="n">ACK</span><span class="p">]</span> <span class="n">Seq</span><span class="o">=</span><span class="mi">0</span> <span class="n">Ack</span><span class="o">=</span><span class="mi">1</span> <span class="n">Win</span><span class="o">=</span><span class="mi">28960</span> <span class="n">Len</span><span class="o">=</span><span class="mi">0</span> <span class="n">MSS</span><span class="o">=</span><span class="mi">1460</span> <span class="n">SACK_PERM</span><span class="o">=</span><span class="mi">1</span> <span class="n">TSval</span><span class="o">=</span><span class="mi">3030758399</span> <span class="n">TSecr</span><span class="o">=</span><span class="mi">2332931052</span> <span class="n">WS</span><span class="o">=</span><span class="mi">128</span>
<span class="cp"># the initial response from the server back to the client
# acknowledge original Syn request, set its own Syn flag
# source port 80
# destination: ephemeral port on the client, 52166.
</span>
<span class="mi">3</span>	<span class="mi">0</span><span class="p">.</span><span class="mo">000546551</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>	<span class="n">TCP</span>	<span class="mi">66</span>	<span class="mi">33002</span> <span class="err">→</span> <span class="mi">80</span> <span class="p">[</span><span class="n">ACK</span><span class="p">]</span> <span class="n">Seq</span><span class="o">=</span><span class="mi">1</span> <span class="n">Ack</span><span class="o">=</span><span class="mi">1</span> <span class="n">Win</span><span class="o">=</span><span class="mi">29312</span> <span class="n">Len</span><span class="o">=</span><span class="mi">0</span> <span class="n">TSval</span><span class="o">=</span><span class="mi">2332931053</span> <span class="n">TSecr</span><span class="o">=</span><span class="mi">3030758399</span>
<span class="cp"># the original requesting client is going to acknowledge the second part of the connection to the ephemeral port
# the acknowledgement number is one
# transmitted from 192. 168. 1. 100, back over to 192. 168. 1. 1.
# Now we have a fully-built established TCP connection
# next, we can transmit data.
</span>

<span class="mi">4</span>	<span class="mi">0</span><span class="p">.</span><span class="mo">0160</span><span class="mi">81126</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>	<span class="n">HTTP</span>	<span class="mi">214</span>	<span class="n">GET</span> <span class="o">/</span><span class="n">index</span><span class="p">.</span><span class="n">html</span> <span class="n">HTTP</span><span class="o">/</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>
<span class="cp"># client requests from the web server, index. html
# transmitted from client to server
</span><span class="mi">5</span>	<span class="mi">0</span><span class="p">.</span><span class="mo">0165</span><span class="mi">86837</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>	<span class="n">TCP</span>	<span class="mi">66</span>	<span class="mi">80</span> <span class="err">→</span> <span class="mi">33002</span> <span class="p">[</span><span class="n">ACK</span><span class="p">]</span> <span class="n">Seq</span><span class="o">=</span><span class="mi">1</span> <span class="n">Ack</span><span class="o">=</span><span class="mi">149</span> <span class="n">Win</span><span class="o">=</span><span class="mi">30080</span> <span class="n">Len</span><span class="o">=</span><span class="mi">0</span> <span class="n">TSval</span><span class="o">=</span><span class="mi">3030758415</span> <span class="n">TSecr</span><span class="o">=</span><span class="mi">2332931068</span>
<span class="cp"># the server acknowledges transmission,
</span><span class="mi">6</span>	<span class="mi">0</span><span class="p">.</span><span class="mo">01</span><span class="mi">8881828</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>	<span class="n">HTTP</span>	<span class="mi">375</span>	<span class="n">HTTP</span><span class="o">/</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span> <span class="mi">200</span> <span class="n">OK</span>  <span class="p">(</span><span class="n">text</span><span class="o">/</span><span class="n">html</span><span class="p">)</span>
<span class="cp"># transmits the data, HTTP 200 OK request, the actual webpage being delivered back to the client.
</span><span class="mi">7</span>	<span class="mi">0</span><span class="p">.</span><span class="mo">01</span><span class="mi">8925135</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>	<span class="n">TCP</span>	<span class="mi">66</span>	<span class="mi">33002</span> <span class="err">→</span> <span class="mi">80</span> <span class="p">[</span><span class="n">ACK</span><span class="p">]</span> <span class="n">Seq</span><span class="o">=</span><span class="mi">149</span> <span class="n">Ack</span><span class="o">=</span><span class="mi">310</span> <span class="n">Win</span><span class="o">=</span><span class="mi">30336</span> <span class="n">Len</span><span class="o">=</span><span class="mi">0</span> <span class="n">TSval</span><span class="o">=</span><span class="mi">2332931071</span> <span class="n">TSecr</span><span class="o">=</span><span class="mi">3030758417</span>
<span class="cp"># client acknowledge that transmission of the page, and send an Ack from the client back over to the server.
</span>


<span class="mi">8</span>	<span class="mi">0</span><span class="p">.</span><span class="mo">02</span><span class="mi">8759547</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>	<span class="n">TCP</span>	<span class="mi">66</span>	<span class="mi">33002</span> <span class="err">→</span> <span class="mi">80</span> <span class="p">[</span><span class="n">FIN</span><span class="p">,</span> <span class="n">ACK</span><span class="p">]</span> <span class="n">Seq</span><span class="o">=</span><span class="mi">149</span> <span class="n">Ack</span><span class="o">=</span><span class="mi">310</span> <span class="n">Win</span><span class="o">=</span><span class="mi">30336</span> <span class="n">Len</span><span class="o">=</span><span class="mi">0</span> <span class="n">TSval</span><span class="o">=</span><span class="mi">2332931081</span> <span class="n">TSecr</span><span class="o">=</span><span class="mi">3030758417</span>
<span class="mi">9</span>	<span class="mi">0</span><span class="p">.</span><span class="mo">02</span><span class="mi">9264140</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>	<span class="n">TCP</span>	<span class="mi">66</span>	<span class="mi">80</span> <span class="err">→</span> <span class="mi">33002</span> <span class="p">[</span><span class="n">FIN</span><span class="p">,</span> <span class="n">ACK</span><span class="p">]</span> <span class="n">Seq</span><span class="o">=</span><span class="mi">310</span> <span class="n">Ack</span><span class="o">=</span><span class="mi">150</span> <span class="n">Win</span><span class="o">=</span><span class="mi">30080</span> <span class="n">Len</span><span class="o">=</span><span class="mi">0</span> <span class="n">TSval</span><span class="o">=</span><span class="mi">3030758428</span> <span class="n">TSecr</span><span class="o">=</span><span class="mi">2332931081</span>
<span class="mi">10</span>	<span class="mi">0</span><span class="p">.</span><span class="mo">02</span><span class="mi">9340848</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>	<span class="n">TCP</span>	<span class="mi">66</span>	<span class="mi">33002</span> <span class="err">→</span> <span class="mi">80</span> <span class="p">[</span><span class="n">ACK</span><span class="p">]</span> <span class="n">Seq</span><span class="o">=</span><span class="mi">150</span> <span class="n">Ack</span><span class="o">=</span><span class="mi">311</span> <span class="n">Win</span><span class="o">=</span><span class="mi">30336</span> <span class="n">Len</span><span class="o">=</span><span class="mi">0</span> <span class="n">TSval</span><span class="o">=</span><span class="mi">2332931082</span> <span class="n">TSecr</span><span class="o">=</span><span class="mi">3030758428</span>
<span class="cp"># client sends a Fin request and an acknowledgement
# the server replies back to that Fin request with an acknowledgement and its own Fin flag set
# finally client acknowledges the Fin request from the server, and the connection is now closed.
</span>
</pre></table></code></div></div><hr /><h2 id="tcp-connection-state">TCP connection state</h2><p>server1:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
</pre><td class="rouge-code"><pre>
<span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>
<span class="n">any</span> <span class="n">ip</span> <span class="n">any</span> <span class="n">port</span>


<span class="err">$</span> <span class="n">ss</span> <span class="o">-</span><span class="n">ltn</span> <span class="o">-</span><span class="mi">4</span>
<span class="c1">//                                  local port                in/out port</span>
<span class="n">State</span>    <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>    <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>        <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>         <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">LISTEN</span>   <span class="mi">0</span>         <span class="mi">128</span>                 <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span><span class="mi">111</span>               <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>
<span class="n">LISTEN</span>   <span class="mi">0</span>         <span class="mi">32</span>            <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">122</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">53</span>                <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>
<span class="n">LISTEN</span>   <span class="mi">0</span>         <span class="mi">128</span>                 <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span><span class="mi">22</span>                <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>
<span class="n">LISTEN</span>   <span class="mi">0</span>         <span class="mi">5</span>                 <span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">631</span>               <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>


<span class="err">$</span> <span class="n">ss</span> <span class="o">-</span><span class="n">ltn</span>
<span class="n">State</span>    <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>    <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>        <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>         <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">LISTEN</span>   <span class="mi">0</span>         <span class="mi">128</span>                 <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span><span class="mi">111</span>               <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>
<span class="n">LISTEN</span>   <span class="mi">0</span>         <span class="mi">32</span>            <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">122</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">53</span>                <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>
<span class="n">LISTEN</span>   <span class="mi">0</span>         <span class="mi">128</span>                 <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span><span class="mi">22</span>                <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>
<span class="n">LISTEN</span>   <span class="mi">0</span>         <span class="mi">5</span>                 <span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">631</span>               <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>
<span class="n">LISTEN</span>   <span class="mi">0</span>         <span class="mi">128</span>                    <span class="p">[</span><span class="o">::</span><span class="p">]</span><span class="o">:</span><span class="mi">111</span>                  <span class="p">[</span><span class="o">::</span><span class="p">]</span><span class="o">:*</span>
<span class="n">LISTEN</span>   <span class="mi">0</span>         <span class="mi">128</span>                    <span class="p">[</span><span class="o">::</span><span class="p">]</span><span class="o">:</span><span class="mi">22</span>                   <span class="p">[</span><span class="o">::</span><span class="p">]</span><span class="o">:*</span>
<span class="n">LISTEN</span>   <span class="mi">0</span>         <span class="mi">5</span>                     <span class="p">[</span><span class="o">::</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span><span class="mi">631</span>                  <span class="p">[</span><span class="o">::</span><span class="p">]</span><span class="o">:*</span>

<span class="err">$</span> <span class="n">ss</span> <span class="o">-</span><span class="n">all</span> <span class="o">-</span><span class="mi">4</span>
<span class="n">Netid</span> <span class="n">State</span>    <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>   <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>       <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>       <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">udp</span>   <span class="n">UNCONN</span>   <span class="mi">0</span>        <span class="mi">0</span>                  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span><span class="n">mdns</span>            <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>
<span class="n">udp</span>   <span class="n">UNCONN</span>   <span class="mi">0</span>        <span class="mi">0</span>            <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">122</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="n">domain</span>          <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>
<span class="n">udp</span>   <span class="n">UNCONN</span>   <span class="mi">0</span>        <span class="mi">0</span>           <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">%</span><span class="n">virbr0</span><span class="o">:</span><span class="n">bootps</span>          <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>
<span class="n">udp</span>   <span class="n">UNCONN</span>   <span class="mi">0</span>        <span class="mi">0</span>                  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span><span class="n">sunrpc</span>          <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>
<span class="n">udp</span>   <span class="n">UNCONN</span>   <span class="mi">0</span>        <span class="mi">0</span>                <span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">323</span>             <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>
<span class="n">udp</span>   <span class="n">UNCONN</span>   <span class="mi">0</span>        <span class="mi">0</span>                  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span><span class="mi">33439</span>           <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>
<span class="n">tcp</span>   <span class="n">LISTEN</span>   <span class="mi">0</span>        <span class="mi">128</span>                <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span><span class="n">sunrpc</span>          <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>
<span class="n">tcp</span>   <span class="n">LISTEN</span>   <span class="mi">0</span>        <span class="mi">32</span>           <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">122</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="n">domain</span>          <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>
<span class="n">tcp</span>   <span class="n">LISTEN</span>   <span class="mi">0</span>        <span class="mi">128</span>                <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span><span class="n">ssh</span>             <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>
<span class="n">tcp</span>   <span class="n">LISTEN</span>   <span class="mi">0</span>        <span class="mi">5</span>                <span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="n">ipp</span>             <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>



<span class="cp"># head : only a few
</span>
<span class="err">$</span> <span class="n">netstat</span> <span class="o">-</span><span class="n">an</span> <span class="o">|</span> <span class="n">head</span>
<span class="n">Active</span> <span class="n">Internet</span> <span class="n">connections</span> <span class="p">(</span><span class="n">servers</span> <span class="n">and</span> <span class="n">established</span><span class="p">)</span>
<span class="n">Proto</span> <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span> <span class="n">Send</span><span class="o">-</span><span class="n">Q</span> <span class="n">Local</span> <span class="n">Address</span>           <span class="n">Foreign</span> <span class="n">Address</span>         <span class="n">State</span>
<span class="n">tcp</span>        <span class="mi">0</span>      <span class="mi">0</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span><span class="mi">111</span>             <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>               <span class="n">LISTEN</span>
<span class="n">tcp</span>        <span class="mi">0</span>      <span class="mi">0</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">122</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">53</span>        <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>               <span class="n">LISTEN</span>
<span class="n">tcp</span>        <span class="mi">0</span>      <span class="mi">0</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span><span class="mi">22</span>              <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>               <span class="n">LISTEN</span>
<span class="n">tcp</span>        <span class="mi">0</span>      <span class="mi">0</span> <span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="mi">631</span>           <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>               <span class="n">LISTEN</span>
<span class="n">tcp6</span>       <span class="mi">0</span>      <span class="mi">0</span> <span class="o">:::</span><span class="mi">111</span>                  <span class="o">:::*</span>                    <span class="n">LISTEN</span>
<span class="n">tcp6</span>       <span class="mi">0</span>      <span class="mi">0</span> <span class="o">:::</span><span class="mi">22</span>                   <span class="o">:::*</span>                    <span class="n">LISTEN</span>
<span class="n">tcp6</span>       <span class="mi">0</span>      <span class="mi">0</span> <span class="o">::</span><span class="mi">1</span><span class="o">:</span><span class="mi">631</span>                 <span class="o">:::*</span>                    <span class="n">LISTEN</span>
<span class="n">udp</span>        <span class="mi">0</span>      <span class="mi">0</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span><span class="mi">5353</span>            <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:*</span>



<span class="mi">1</span><span class="p">.</span> <span class="n">ssh</span> <span class="n">to</span> <span class="n">a</span> <span class="n">host</span> <span class="n">that</span> <span class="n">deoesnt</span> <span class="n">exist</span>


<span class="err">$</span> <span class="n">ss</span> <span class="o">-</span><span class="n">t</span>
<span class="n">State</span>   <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>    <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>         <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>         <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>


<span class="err">$</span> <span class="n">ssh</span> <span class="n">root</span><span class="err">@</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>
<span class="n">The</span> <span class="n">authenticity</span> <span class="n">of</span> <span class="n">host</span> <span class="err">'</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span> <span class="p">(</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="err">'</span> <span class="n">cant</span> <span class="n">be</span> <span class="n">established</span><span class="p">.</span>
<span class="n">Activate</span> <span class="n">the</span> <span class="n">web</span> <span class="n">console</span> <span class="n">with</span><span class="o">:</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="o">--</span><span class="n">now</span> <span class="n">cockpit</span><span class="p">.</span><span class="n">socket</span>
<span class="n">Last</span> <span class="n">login</span><span class="o">:</span> <span class="n">Sat</span> <span class="n">Apr</span> <span class="mi">18</span> <span class="mi">17</span><span class="o">:</span><span class="mi">19</span><span class="o">:</span><span class="mo">02</span> <span class="mi">2020</span>
<span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">server0</span> <span class="o">~</span><span class="p">]</span><span class="err">#</span>

<span class="err">$</span> <span class="n">ss</span> <span class="o">-</span><span class="n">t</span>
<span class="n">State</span>   <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>    <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>        <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>          <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">ESTAB</span>   <span class="mi">0</span>         <span class="mi">0</span>             <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="o">:</span><span class="mi">44192</span>          <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span><span class="n">ssh</span>



<span class="mi">2</span><span class="p">.</span> <span class="n">to</span> <span class="n">a</span> <span class="n">host</span> <span class="n">that</span> <span class="n">deoesnt</span> <span class="n">exist</span>

<span class="err">$</span> <span class="n">ssh</span> <span class="n">root</span><span class="err">@</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>

<span class="err">$</span> <span class="n">ss</span> <span class="o">-</span><span class="n">t</span>
<span class="n">State</span>      <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>    <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>        <span class="n">Local</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>        <span class="n">Peer</span> <span class="n">Address</span><span class="o">:</span><span class="n">Port</span>
<span class="n">SYN</span><span class="o">-</span><span class="n">SENT</span>   <span class="mi">0</span>         <span class="mi">1</span>             <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="o">:</span><span class="mi">45160</span>       <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">13</span><span class="o">:</span><span class="n">ssh</span>
<span class="c1">// not ESTAB</span>
<span class="c1">// SYN-SENT, SYN-RECEIVED, ESTAB</span>
</pre></table></code></div></div><hr /><h2 id="manipulate-a-latency-of-the-network-congestion-control">manipulate a latency of the network, congestion control</h2><p><strong>normal downloads</strong></p><p>server0:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>
<span class="mi">1</span><span class="p">.</span> <span class="n">create</span> <span class="n">a</span> <span class="n">big</span> <span class="n">file</span><span class="p">.</span>

<span class="err">$</span> <span class="n">cd</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">fallocate</span> <span class="o">-</span><span class="n">l1G</span> <span class="n">largeFile</span><span class="p">.</span><span class="n">bin</span>
<span class="err">$</span> <span class="n">ls</span>
<span class="n">index</span><span class="p">.</span><span class="n">html</span>  <span class="n">largeFile</span><span class="p">.</span><span class="n">bin</span>

</pre></table></code></div></div><p>server1:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>
<span class="mi">1</span><span class="p">.</span> <span class="n">start</span> <span class="n">the</span> <span class="n">Wireshark</span>



<span class="mi">2</span><span class="p">.</span> <span class="n">download</span> <span class="n">the</span> <span class="n">big</span> <span class="n">file</span><span class="p">.</span>

<span class="err">$</span> <span class="n">scp</span> <span class="n">root</span><span class="err">@</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">largeFile</span><span class="p">.</span><span class="n">bin</span> <span class="p">.</span>
<span class="n">root</span><span class="err">@</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="n">s</span> <span class="n">password</span><span class="o">:</span>
<span class="n">largeFile</span><span class="p">.</span><span class="n">bin</span>                                  <span class="mi">100</span><span class="o">%</span> <span class="mi">1024</span><span class="n">MB</span>  <span class="mi">27</span><span class="p">.</span><span class="mi">7</span><span class="n">MB</span><span class="o">/</span><span class="n">s</span>   <span class="mo">00</span><span class="o">:</span><span class="mi">36</span>
</pre></table></code></div></div><p>open the wireshark:</p><p>static &gt; TCP streamGraph &gt; window scaling graph</p><p><img data-proofer-ignore data-src="https://i.imgur.com/JAqKwGa.png" alt="Screen Shot 2020-04-18 at 18.29.11" /></p><p>slow start, TCP starts out its connection with a very small window size, and as it proves the connection is more reliable, it increases the window size, and thus maximizing the throughput. download a file from the internet, it starts off slow and then speeds up. This is the reason why. It’s also the same reason why download one single large file, it downloads much quicker than many small files of the same size, because of the <code class="language-plaintext highlighter-rouge">startup costs of TCP</code> and getting from a small window size to the full window size for the connection.</p><p><strong>put lantency</strong></p><p>server0:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>
<span class="mi">1</span><span class="p">.</span>
<span class="n">use</span> <span class="n">tool</span> <span class="n">called</span> <span class="n">TC</span><span class="p">,</span> <span class="n">an</span> <span class="n">IP</span> <span class="n">traffic</span> <span class="n">shaper</span>
<span class="n">tell</span> <span class="n">that</span> <span class="n">server</span> <span class="n">to</span> <span class="n">add</span> <span class="n">a</span> <span class="mi">3</span><span class="p">,</span> <span class="mo">000</span> <span class="n">milliseconds</span> <span class="n">of</span> <span class="n">delay</span><span class="p">,</span>
<span class="n">and</span> <span class="n">drop</span> <span class="mi">5</span><span class="o">%</span> <span class="n">of</span> <span class="n">the</span> <span class="n">packets</span><span class="p">,</span>
<span class="n">so</span> <span class="n">a</span> <span class="n">very</span> <span class="n">slow</span><span class="p">,</span> <span class="n">a</span> <span class="n">very</span> <span class="n">unreliable</span> <span class="n">link</span><span class="p">,</span> <span class="n">and</span> <span class="n">try</span> <span class="n">the</span> <span class="n">transfer</span> <span class="n">again</span> <span class="p">.</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">tc</span> <span class="n">qdisc</span> <span class="n">add</span> <span class="n">dev</span> <span class="n">enp0s8</span> <span class="n">root</span> <span class="n">netem</span> <span class="n">delay</span> <span class="mi">3000</span><span class="n">ms</span> <span class="n">loss</span> <span class="mi">5</span><span class="o">%</span>

</pre></table></code></div></div><p>server1:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>
<span class="mi">1</span><span class="p">.</span> <span class="n">start</span> <span class="n">the</span> <span class="n">Wireshark</span>


<span class="mi">2</span><span class="p">.</span> <span class="n">download</span> <span class="n">the</span> <span class="n">big</span> <span class="n">file</span><span class="p">.</span>
<span class="c1">// extremely slow</span>
<span class="err">$</span> <span class="n">scp</span> <span class="n">root</span><span class="err">@</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">:/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">largeFile</span><span class="p">.</span><span class="n">bin</span> <span class="p">.</span>
<span class="n">root</span><span class="err">@</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="n">s</span> <span class="n">password</span><span class="o">:</span>
<span class="n">largeFile</span><span class="p">.</span><span class="n">bin</span>                                    <span class="mi">0</span><span class="o">%</span>   <span class="mi">112</span><span class="n">KB</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">9</span><span class="n">KB</span><span class="o">/</span><span class="n">s</span> <span class="mi">153</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mo">00</span> <span class="n">E</span>
</pre></table></code></div></div><p>server0:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="mi">1</span><span class="p">.</span> <span class="n">delete</span> <span class="n">the</span> <span class="n">modification</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">tc</span> <span class="n">qdisc</span> <span class="n">del</span> <span class="n">dev</span> <span class="n">enp0s8</span> <span class="n">root</span>
</pre></table></code></div></div><p>server1: download speed back to normal</p><p>open the wireshark:</p><p>static &gt; TCP streamGraph &gt; window scaling graph</p><p><img data-proofer-ignore data-src="https://i.imgur.com/ZFd63jD.png" alt="Screen Shot 2020-04-18 at 18.43.07" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/OxrroM6.png" alt="Screen Shot 2020-04-18 at 18.43.33" /></p><p>start off with a very small window size, and TCP struggles to increase it, but once delete that traffic policy, link reliability and performance increases, as window size goes way up, and start moving larger chunks of data more quickly.</p><p>static &gt; IO graph.</p><p>filter <code class="language-plaintext highlighter-rouge">tcp. analysis.window_update</code>: each of the times, during this transmission, that the window was updated.</p><p><img data-proofer-ignore data-src="https://i.imgur.com/cIKhie5.png" alt="Screen Shot 2020-04-18 at 18.49.46" /></p><p>filter <code class="language-plaintext highlighter-rouge">tcp. window_size</code>. when the link was dropping packets and really high latency, the window size was pretty fixed, and then once we removed it, it shoots up very quickly.</p><p>So you can see the big inflection point at 120 seconds, when we removed the policy, and the bandwidth shoots way up. So that covers us for <code class="language-plaintext highlighter-rouge">congestion control.</code> We were backing off the send rate, because of dropping packets and increased latency.</p><p><img data-proofer-ignore data-src="https://i.imgur.com/SFr0YmH.png" alt="Screen Shot 2020-04-18 at 18.50.18" /></p><p>filter <code class="language-plaintext highlighter-rouge">tcp.analysis.bytes_in_flight</code>: the amount of data in flight between the two hosts. These are unacknowledged TCP segments. Initially we didn’t have any data in flight due to the poor connection, except for the one segment in transmission, but once the link proved reliable, we started being able to send more unacknowledged segments, and thus helping us realize the full bandwidth of the link.</p><p><img data-proofer-ignore data-src="https://i.imgur.com/3lOIOmy.png" alt="Screen Shot 2020-04-18 at 18.51.54" /></p><hr /><h2 id="udp-connections">UDP connections</h2><p>server1:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>
<span class="mi">1</span><span class="p">.</span> <span class="n">send</span> <span class="n">a</span> <span class="n">udp</span> <span class="n">DNS</span> <span class="n">request</span>

<span class="err">$</span> <span class="n">dig</span> <span class="n">www</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span>


<span class="mi">2</span><span class="p">.</span> <span class="n">check</span> <span class="n">the</span> <span class="n">Wireshark</span>

<span class="mi">1</span>	<span class="mi">0</span><span class="p">.</span><span class="mo">000000000</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>	<span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">3</span>	<span class="n">DNS</span>	<span class="mi">97</span>	<span class="n">Standard</span> <span class="n">query</span> <span class="mh">0x6479</span> <span class="n">A</span> <span class="n">www</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span> <span class="n">OPT</span>
<span class="mi">2</span>	<span class="mi">1</span><span class="p">.</span><span class="mo">000204013</span>	<span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>	<span class="mi">8</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">8</span> 	<span class="n">DNS</span>	<span class="mi">97</span>	<span class="n">Standard</span> <span class="n">query</span> <span class="mh">0x6479</span> <span class="n">A</span> <span class="n">www</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span> <span class="n">OPT</span>
<span class="mi">3</span>	<span class="mi">1</span><span class="p">.</span><span class="mo">01</span><span class="mi">8508002</span>	<span class="mi">8</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">8</span>	        <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span>   <span class="n">DNS</span>	<span class="mi">101</span>	<span class="n">Standard</span> <span class="n">query</span> <span class="n">response</span> <span class="mh">0x6479</span> <span class="n">A</span> <span class="n">www</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span> <span class="n">A</span> <span class="mi">172</span><span class="p">.</span><span class="mi">217</span><span class="p">.</span><span class="mi">164</span><span class="p">.</span><span class="mi">164</span> <span class="n">OPT</span>

</pre></table></code></div></div><hr /><p>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/00codenote/'>00CodeNote</a>, <a href='/categories/linuxnote/'>LinuxNote</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linux/" class="post-tag no-text-decoration" >Linux</a> <a href="/tags/lfce/" class="post-tag no-text-decoration" >LFCE</a> <a href="/tags/pluralsight/" class="post-tag no-text-decoration" >Pluralsight</a> <a href="/tags/network/" class="post-tag no-text-decoration" >Network</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=LFCE.1 Advanced Linux Networking - Grace&url=https://ocholuo.github.io//posts/LFCE.1.AdvancedLinuxNetworking/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=LFCE.1 Advanced Linux Networking - Grace&u=https://ocholuo.github.io//posts/LFCE.1.AdvancedLinuxNetworking/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=LFCE.1 Advanced Linux Networking - Grace&url=https://ocholuo.github.io//posts/LFCE.1.AdvancedLinuxNetworking/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Amazon-CloudFront/">AWS Lab - AWS CloudFront</a><li><a href="/posts/Alexa-1stSkill/">AWS Alex First Skill - RedVelvet Time</a><li><a href="/posts/NetworkProtocol-SSL-TLS-Handshake/">NetworkProtocol SSL/TLS Handshake</a><li><a href="/posts/pythonCrash/">Python Crash</a><li><a href="/posts/%E4%B8%80%E5%8F%A5%E8%AF%9D%E8%A7%A3%E9%87%8AAWS/">AWS - 一句话解释AWS</a><li><a href="/posts/GKE/">GCP - Google Cloud Computing - Kubernetes and Kubernetes Engine</a><li><a href="/posts/Go-Note/">Go Note</a><li><a href="/posts/SCPs/">AWS - IdenAccessManage - SCPs (Service Control Policies)</a><li><a href="/posts/CompanyBenefit/">Company Benefit</a><li><a href="/posts/Encryption-SSL&TLS/">Cryptography - SSL/TLS Encryption</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/CentOSEnterpriseLinuxUserandGroupManagement/"><div class="card-body"> <span class="timeago small" >Jul 16, 2020<i class="unloaded">2020-07-16T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Linux - CentOS Enterprise User and Group Management</h3><div class="text-muted small"><p> CentOS Enterprise Linux User and Group Management [toc] PAM PAM: pluggable authentictaion module user login (SSH, Condole, GUI…) -&gt; PAM (Authentication, limits, home directory) -&gt; access ...</p></div></div></a></div><div class="card"> <a href="/posts/LFCE.2.AdvancedNetworkandSystemAdministration/"><div class="card-body"> <span class="timeago small" >Jul 16, 2020<i class="unloaded">2020-07-16T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>LFCE.2 Advanced Network and System Administration</h3><div class="text-muted small"><p> LFCE: Advanced Network and System Administration [toc] check the init daemons, Starting and Stopping Services server0: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28...</p></div></div></a></div><div class="card"> <a href="/posts/LFCE.3.NetworkandHostSecurity/"><div class="card-body"> <span class="timeago small" >Jul 16, 2020<i class="unloaded">2020-07-16T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>LFCE.3 Network and Host Security</h3><div class="text-muted small"><p> LFCE: Network and Host Security [toc] lab server0: network change to bridge. server0: 192.168.1.30 enp0s10 192.168.0.110 server1: 193.168.3.100 enp0s8 server2: 192.168.2.100/25 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/CentOSEnterpriseLinuxUserandGroupManagement/" class="btn btn-outline-primary" prompt="Older"><p>Linux - CentOS Enterprise User and Group Management</p></a> <a href="/posts/LFCE.2.AdvancedNetworkandSystemAdministration/" class="btn btn-outline-primary" prompt="Newer"><p>LFCE.2 Advanced Network and System Administration</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ocholuo">Grace JyL</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ocholuo.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script defer src="/assets/js/dist/pvreport.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-179830187-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-179830187-1'); }); </script>
