<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="pv-proxy-endpoint" content="https://myochosite-291718.appspot.com/query?id=ahNwfm15b2Nob3NpdGUtMjkxNzE4chULEghBcGlRdWVyeRiAgIDo14eBCgw"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Meow’s CyberAttack - Cross Site Scripting Prevention Cheat Sheet" /><meta property="og:locale" content="en" /><meta name="description" content="[toc]" /><meta property="og:description" content="[toc]" /><link rel="canonical" href="https://ocholuo.github.io//posts/XSS-Prevention-Cheat-Sheet/" /><meta property="og:url" content="https://ocholuo.github.io//posts/XSS-Prevention-Cheat-Sheet/" /><meta property="og:site_name" content="Grace" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-09-19T11:11:11-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Meow’s CyberAttack - Cross Site Scripting Prevention Cheat Sheet" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2020-09-19T11:11:11-04:00","datePublished":"2020-09-19T11:11:11-04:00","description":"[toc]","headline":"Meow’s CyberAttack - Cross Site Scripting Prevention Cheat Sheet","mainEntityOfPage":{"@type":"WebPage","@id":"https://ocholuo.github.io//posts/XSS-Prevention-Cheat-Sheet/"},"url":"https://ocholuo.github.io//posts/XSS-Prevention-Cheat-Sheet/"}</script><title>Meow's CyberAttack - Cross Site Scripting Prevention Cheat Sheet | Grace</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Grace"><meta name="application-name" content="Grace"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://myochosite-291718.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://myochosite-291718.appspot.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/huoye.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Grace</a></div><div class="site-subtitle font-italic">2023 Mar 14 updated</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/ocholuo" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Meow's CyberAttack - Cross Site Scripting Prevention Cheat Sheet</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Meow's CyberAttack - Cross Site Scripting Prevention Cheat Sheet</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Grace JyL </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Sep 19, 2020, 11:11 AM -0400" >Sep 19, 2020<i class="unloaded">2020-09-19T11:11:11-04:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3448 words">19 min read</span> <span id="pv" class="pageviews"> <i class="fas fa-spinner fa-spin fa-fw"></i> </span> views</div></div><div class="post-content"><p>[toc]</p><hr /><h1 id="cross-site-scripting-prevention-cheat-sheet">Cross Site Scripting Prevention Cheat Sheet</h1><hr /><h2 id="introduction">Introduction</h2><ul><li>Both <a href="https://owasp.org/www-community/attacks/xss/#stored-and-reflected-xss-attacks">reflected and stored XSS</a> can be addressed by performing the appropriate validation and encoding on the server-side.<li><a href="https://owasp.org/www-community/attacks/DOM_Based_XSS">DOM Based XSS</a> can be addressed with a special subset of rules described in the DOM based XSS Prevention Cheat Sheet.</ul><p>Relying on inbound input handling to prevent XSS is thus a very brittle solution that will be prone to errors. (The deprecated “magic quotes” feature of PHP is an example of such a solution.)</p><p>Instead, outbound input handling should be your primary line of defense against XSS, because it can take into account the specific context that user input will be inserted into.</p><h2 id="why-cant-just-html-entity-encode-untrusted-data">Why Can’t Just <code class="language-plaintext highlighter-rouge">HTML Entity Encode</code> Untrusted Data</h2><p><code class="language-plaintext highlighter-rouge">HTML entity encoding</code></p><ul><li>okay for untrusted data that you put in the body of the HTML document, such as inside a <code class="language-plaintext highlighter-rouge">&lt;div&gt;</code> tag.<li>or for untrusted data that goes into attributes, particularly if you’re religious about using quotes around your attributes.</ul><p>But <code class="language-plaintext highlighter-rouge">HTML entity encoding</code> doesn’t work if putting untrusted data inside a <code class="language-plaintext highlighter-rouge">&lt;script&gt;</code> tag anywhere, or an <code class="language-plaintext highlighter-rouge">event handler attribute</code> like <code class="language-plaintext highlighter-rouge">onmouseover</code>, or inside CSS, or in a URL.</p><ul><li><p>so even use <code class="language-plaintext highlighter-rouge">HTML entity encoding</code> method everywhere, still most likely vulnerable to XSS.</p><li><p><strong>You MUST use the encode syntax for the part of the HTML document you’re putting untrusted data into.</strong> That’s what the rules below are all about.</p></ul><h3 id="you-need-a-security-encoding-library">You Need a Security Encoding Library</h3><p>Writing these encoders is not tremendously difficult, but there are quite a few hidden pitfalls.</p><ul><li>For example, you might be tempted to use some of the escaping shortcuts like <code class="language-plaintext highlighter-rouge">\"</code> in JavaScript.<li>However, these values are dangerous and may be misinterpreted by the nested parsers in the browser. You might also forget to escape the escape character, which attackers can use to neutralize your attempts to be safe.<li>OWASP recommends using a security-focused encoding library to make sure these rules are properly implemented.</ul><p>Microsoft provides an encoding library named the <a href="https://archive.codeplex.com/?p=wpl">Microsoft Anti-Cross Site Scripting Library</a> for the .NET platform and ASP.NET Framework has built-in <a href="https://msdn.microsoft.com/en-us/library/ms972969.aspx#securitybarriers_topic6">ValidateRequest</a> function that provides <strong>limited</strong> sanitization.</p><p>The <a href="https://owasp.org/www-project-java-encoder/">OWASP Java Encoder Project</a> provides a high-performance encoding library for Java.</p><hr /><h2 id="xss-prevention-rules">XSS Prevention Rules</h2><ul><li>to prevent all XSS in application.<li>While these rules do not allow absolute freedom in putting untrusted data into an HTML document, they should cover the vast majority of common use cases.<li>You do not have to allow <strong>all</strong> the rules in your organization. Many organizations may find that <strong>allowing only Rule #1 and Rule #2 are sufficient for their needs</strong>.</ul><p><strong>Do NOT</strong> simply encode/escape the list of example characters provided in the various rules.</p><ul><li>It is NOT sufficient to encode/escape only that list.<li>Blacklist approaches are quite fragile.<li>The whitelist rules have been carefully designed to provide protection even against future vulnerabilities introduced by browser changes.</ul><hr /><h3 id="rule-0---never-insert-untrusted-data-except-in-allowed-locations">RULE #0 - Never Insert Untrusted Data Except in Allowed Locations</h3><ul><li>The first rule is to <strong>deny all</strong><li>don’t put untrusted data into HTML document<ul><li>unless it is within one of the slots defined in Rule #1 through Rule #5.<li>there are many strange contexts within HTML that the list of encoding rules gets very complicated.<li>no good reason to put untrusted data in these contexts.<ul><li>This includes “nested contexts” like a URL inside a JavaScript – the encoding rules for those locations are tricky and dangerous.</ul></ul><li>never accept actual JavaScript code from an untrusted source and then run it.<ul><li>For example<li>a parameter named “callback” that contains a JavaScript code snippet.<li>No amount of encoding/escaping can fix that.</ul></ul><p>Directly in a script:</p><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span><span class="p">...</span><span class="nx">NEVER</span> <span class="nx">PUT</span> <span class="nx">UNTRUSTED</span> <span class="nx">DATA</span> <span class="nx">HERE</span><span class="p">...</span><span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>Inside an HTML comment:</p><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="c">&lt;!--...NEVER PUT UNTRUSTED DATA HERE...--&gt;</span>
</pre></table></code></div></div><p>In an attribute name:</p><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;div</span> <span class="err">...</span><span class="na">NEVER</span> <span class="na">PUT</span> <span class="na">UNTRUSTED</span> <span class="na">DATA</span> <span class="na">HERE...=</span><span class="s">test</span> <span class="nt">/&gt;</span>
</pre></table></code></div></div><p>In a tag name:</p><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;NEVER</span> <span class="na">PUT</span> <span class="na">UNTRUSTED</span> <span class="na">DATA</span> <span class="na">HERE...</span> <span class="na">href=</span><span class="s">"/test"</span> <span class="nt">/&gt;</span>
</pre></table></code></div></div><p>Directly in CSS:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">style</span><span class="o">&gt;</span>
<span class="n">NEVER</span> <span class="n">PUT</span> <span class="n">UNTRUSTED</span> <span class="n">DATA</span> <span class="n">HERE</span>
<span class="o">&lt;/</span><span class="n">style</span><span class="o">&gt;</span>
</pre></table></code></div></div><hr /><h3 id="rule-1---html-encode-before-inserting-untrusted-data-into-html-element-content">RULE #1 - <code class="language-plaintext highlighter-rouge">HTML Encode</code> Before Inserting Untrusted Data into <code class="language-plaintext highlighter-rouge">HTML Element Content</code></h3><ul><li>when want to put untrusted data directly into the HTML body somewhere.<ul><li>This includes inside normal tags like <code class="language-plaintext highlighter-rouge">div</code>, <code class="language-plaintext highlighter-rouge">p</code>, <code class="language-plaintext highlighter-rouge">b</code>, <code class="language-plaintext highlighter-rouge">td</code>, etc.</ul><li>Most web frameworks have a method for <code class="language-plaintext highlighter-rouge">HTML encoding/escaping</code> for the characters detailed below.<li>However, this is <strong>absolutely not sufficient for other HTML contexts.</strong> You need to implement the other rules detailed here as well.</ul><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nt">&lt;body&gt;</span>
...ENCODE UNTRUSTED DATA BEFORE PUTTING HERE...
<span class="nt">&lt;/body&gt;</span>
</pre></table></code></div></div><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nt">&lt;div&gt;</span>
...ENCODE UNTRUSTED DATA BEFORE PUTTING HERE...
<span class="nt">&lt;/div&gt;</span>
</pre></table></code></div></div><ul><li>Encode the following characters with <code class="language-plaintext highlighter-rouge">HTML entity encoding</code> to prevent switching into any execution context<ul><li>such as script, style, or event handlers.<li>Using hex entities is recommended in the spec.</ul></ul><div class="language-text highlighter-rouge"><div class="code-header" text-data="text"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre> &amp; --&gt; &amp;amp;
 &lt; --&gt; &amp;lt;
 &gt; --&gt; &amp;gt;
 " --&gt; &amp;quot;
 ' --&gt; &amp;#x27;
 / --&gt; &amp;#x2F;  it helps to end an HTML entity.

 &amp;apos; not recommended because its not in the HTML spec (See: section 24.4.1)
 &amp;apos; is in the XML and XHTML specs.
</pre></table></code></div></div><hr /><h3 id="rule-2---attribute-encode-before-inserting-untrusted-data-into-html-common-attributes">RULE #2 - <code class="language-plaintext highlighter-rouge">Attribute Encode</code> Before Inserting Untrusted Data into <code class="language-plaintext highlighter-rouge">HTML Common Attributes</code></h3><ul><li>for putting untrusted data into typical attribute values like <code class="language-plaintext highlighter-rouge">width</code>, <code class="language-plaintext highlighter-rouge">name</code>, <code class="language-plaintext highlighter-rouge">value</code>, etc.<li>This should not be used for<ul><li>complex attributes like <code class="language-plaintext highlighter-rouge">href</code>, <code class="language-plaintext highlighter-rouge">src</code>, <code class="language-plaintext highlighter-rouge">style</code>,<li>or event handlers like <code class="language-plaintext highlighter-rouge">onmouseover</code>.</ul><li>It is extremely important that event handler attributes should follow Rule #3 for HTML JavaScript Data Values.</ul><p>Inside <strong>UNquoted</strong> attribute:</p><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;div</span> <span class="na">attr=</span><span class="s">...ENCODE</span> <span class="na">UNTRUSTED</span> <span class="na">DATA</span> <span class="na">BEFORE</span> <span class="na">PUTTING</span> <span class="na">HERE...</span><span class="nt">&gt;</span>content
</pre></table></code></div></div><p>Inside single quoted attribute:</p><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;div</span> <span class="na">attr=</span><span class="s">'...ENCODE UNTRUSTED DATA BEFORE PUTTING HERE...'</span><span class="nt">&gt;</span>content
</pre></table></code></div></div><p>Inside double quoted attribute :</p><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;div</span> <span class="na">attr=</span><span class="s">"...ENCODE UNTRUSTED DATA BEFORE PUTTING HERE..."</span><span class="nt">&gt;</span>content
</pre></table></code></div></div><ul><li>Except for alphanumeric characters<li>encode all characters with <code class="language-plaintext highlighter-rouge">ASCII values</code> less than 256 with the <code class="language-plaintext highlighter-rouge">&amp;#xHH;</code> format (or a named entity if available) to prevent switching out of the attribute.<li>developers frequently leave attributes unquoted.<li>Properly quoted attributes can only be escaped with the corresponding quote.<li>Unquoted attributes can be broken out of with many characters, including<ul><li><code class="language-plaintext highlighter-rouge">[space]</code> <code class="language-plaintext highlighter-rouge">%</code> <code class="language-plaintext highlighter-rouge">*</code> <code class="language-plaintext highlighter-rouge">+</code> <code class="language-plaintext highlighter-rouge">,</code> <code class="language-plaintext highlighter-rouge">-</code> <code class="language-plaintext highlighter-rouge">/</code> <code class="language-plaintext highlighter-rouge">;</code> <code class="language-plaintext highlighter-rouge">&lt;</code> <code class="language-plaintext highlighter-rouge">=</code> <code class="language-plaintext highlighter-rouge">&gt;</code> <code class="language-plaintext highlighter-rouge">^</code> <code class="language-plaintext highlighter-rouge">|</code>.</ul></ul><hr /><h3 id="rule-3---javascript-encode-before-inserting-untrusted-data-into-javascript-data-values">RULE #3 - <code class="language-plaintext highlighter-rouge">JavaScript Encode</code> Before Inserting Untrusted Data into <code class="language-plaintext highlighter-rouge">JavaScript Data Values</code></h3><ul><li>dynamically generated JavaScript code - both script blocks and event-handler attributes.<li>The only safe place to put untrusted data into this code is inside a quoted “data value.”<li>Including untrusted data inside any other JavaScript context is quite dangerous, as it is extremely easy to switch into an execution context with characters including (not limited to) <code class="language-plaintext highlighter-rouge">semi-colon ;</code>, <code class="language-plaintext highlighter-rouge">equals =</code>, <code class="language-plaintext highlighter-rouge">space</code>, <code class="language-plaintext highlighter-rouge">plus + </code>…</ul><p>Inside a quoted string:</p><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span><span class="nf">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">...ENCODE UNTRUSTED DATA BEFORE PUTTING HERE...</span><span class="dl">'</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>One side of a quoted expression:</p><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span><span class="nx">x</span><span class="o">=</span><span class="dl">'</span><span class="s1">...ENCODE UNTRUSTED DATA BEFORE PUTTING HERE...</span><span class="dl">'</span><span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>Inside quoted event handler:</p><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;div</span> <span class="na">onmouseover=</span><span class="s">"x='...ENCODE UNTRUSTED DATA BEFORE PUTTING HERE...'"</span><span class="err">&lt;/</span><span class="na">div</span><span class="nt">&gt;</span>
</pre></table></code></div></div><blockquote><p>note there are some JavaScript functions can never safely use untrusted data as input <strong>EVEN IF JAVASCRIPT ENCODED!</strong></p></blockquote><p>For example:</p><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span>
<span class="nb">window</span><span class="p">.</span><span class="nf">setInterval</span><span class="p">(</span><span class="dl">'</span><span class="s1">...EVEN IF YOU ENCODE UNTRUSTED DATA YOU ARE XSSED HERE...</span><span class="dl">'</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><ul><li>Except for alphanumeric characters, encode all characters less than 256 with the <code class="language-plaintext highlighter-rouge">\xHH</code> format to prevent switching out of the data value into the script context or into another attribute.<li><strong>DO NOT</strong> use any escaping shortcuts like <code class="language-plaintext highlighter-rouge">\"</code><ul><li>because the quote character may be matched by the HTML attribute parser which runs first.<li>These escaping shortcuts are also susceptible to <strong>escape-the-escape attacks</strong> where the attacker sends <code class="language-plaintext highlighter-rouge">\"</code> and the vulnerable code turns that into <code class="language-plaintext highlighter-rouge">\\"</code> which enables the quote.</ul><li><p>If an event handler is properly quoted, breaking out requires the corresponding quote.</p><li>However, we have intentionally made this rule quite broad because event handler attributes are often left unquoted.<li>Unquoted attributes can be broken out of with many characters including<ul><li><code class="language-plaintext highlighter-rouge">[space]</code> <code class="language-plaintext highlighter-rouge">%</code> <code class="language-plaintext highlighter-rouge">*</code> <code class="language-plaintext highlighter-rouge">+</code> <code class="language-plaintext highlighter-rouge">,</code> <code class="language-plaintext highlighter-rouge">-</code> <code class="language-plaintext highlighter-rouge">/</code> <code class="language-plaintext highlighter-rouge">;</code> <code class="language-plaintext highlighter-rouge">&lt;</code> <code class="language-plaintext highlighter-rouge">=</code> <code class="language-plaintext highlighter-rouge">&gt;</code> <code class="language-plaintext highlighter-rouge">^</code> <code class="language-plaintext highlighter-rouge">|</code>.</ul><li>Also, a <code class="language-plaintext highlighter-rouge">&lt;/script&gt;</code> closing tag will close a script block even though it is inside a quoted string<ul><li>because the HTML parser runs before the JavaScript parser.</ul><li>Please note this is an aggressive encoding policy that over-encodes.<li>If there is a guarantee that proper quoting is accomplished then a much smaller character set is needed.</ul><hr /><h4 id="rule-31---html-encode-json-values-in-an-html-context-and-read-the-data-with-jsonparse">RULE #3.1 - <code class="language-plaintext highlighter-rouge">HTML Encode JSON values</code> in an HTML context and read the data with <code class="language-plaintext highlighter-rouge">JSON.parse</code></h4><ul><li>having data dynamically generated by an application in a JavaScript context is common.<li>One strategy is to make an <code class="language-plaintext highlighter-rouge">AJAX call</code> to get the values<ul><li>this isn’t always performant.</ul><li>Often, an initial block of JSON is loaded into the page to act as a single place to store multiple values.<li>This data is tricky to encode/escape correctly without breaking the format and content of the values.</ul><p><strong>Ensure returned <code class="language-plaintext highlighter-rouge">Content-Type</code> header is <code class="language-plaintext highlighter-rouge">application/json</code> and not <code class="language-plaintext highlighter-rouge">text/html</code>.</strong></p><ul><li>This shall instruct the browser not misunderstand the context and execute injected script</ul><p><strong>Bad HTTP response:</strong></p><div class="language-text highlighter-rouge"><div class="code-header" text-data="text"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>HTTP/1.1 200
Date: Wed, 06 Feb 2013 10:28:54 GMT
Server: Microsoft-IIS/7.5....
Content-Type: text/html; charset=utf-8 &lt;-- bad
....
Content-Length: 373
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
{"Message":"No HTTP resource was found that matches the request URI 'dev.net.ie/api/pay/.html?HouseNumber=9&amp;AddressLine
=The+Gardens&lt;script&gt;alert(1)&lt;/script&gt;&amp;AddressLine2=foxlodge+woods&amp;TownName=Meath'." ,
"MessageDetail":"No type was found that matches the controller named 'pay'."}   &lt;-- this script will pop!!
</pre></table></code></div></div><p><strong>Good HTTP response:</strong></p><div class="language-text highlighter-rouge"><div class="code-header" text-data="text"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>HTTP/1.1 200
Date: Wed, 06 Feb 2013 10:28:54 GMT
Server: Microsoft-IIS/7.5....
Content-Type: application/json; charset=utf-8 &lt;--good
.....
</pre></table></code></div></div><p>A common <strong>anti-pattern</strong> one would see:</p><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span>
<span class="c1">// Do NOT do this without encoding the data with one of the techniques listed below.</span>
<span class="kd">var</span> <span class="nx">initData</span> <span class="o">=</span> <span class="o">&lt;%=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">to_json</span> <span class="o">%&gt;</span><span class="p">;</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><h5 id="json-serialization">JSON serialization</h5><p>A safe JSON serializer will allow developers to serialize JSON as string of literal JavaScript which can be embedded in an HTML in the contents of the <code class="language-plaintext highlighter-rouge">&lt;script&gt;</code> tag. HTML characters and JavaScript line terminators need be encoded. Consider the <a href="https://github.com/yahoo/serialize-javascript">Yahoo JavaScript Serializer</a> for this task.</p><h5 id="html-entity-encoding">HTML entity encoding</h5><p>This technique has the advantage that HTML entity encoding is widely supported and helps separate data from server side code without crossing any context boundaries. Consider placing the JSON block on the page as a normal element and then parsing the innerHTML to get the contents. The JavaScript that reads the span can live in an external file, thus making the implementation of <a href="https://content-security-policy.com/">CSP</a> enforcement easier.</p><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"init_data"</span> <span class="na">style=</span><span class="s">"display: none"</span><span class="nt">&gt;</span>
 <span class="nt">&lt;</span><span class="err">%=</span> <span class="na">html_encode</span><span class="err">(</span><span class="na">data.to_json</span><span class="err">)</span> <span class="err">%</span><span class="nt">&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></table></code></div></div><div class="language-javascript highlighter-rouge"><div class="code-header" text-data="javascript"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c1">// external js file</span>
<span class="kd">var</span> <span class="nx">dataElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">init_data</span><span class="dl">'</span><span class="p">);</span>
<span class="c1">// decode and parse the content of the div</span>
<span class="kd">var</span> <span class="nx">initData</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="nx">dataElement</span><span class="p">.</span><span class="nx">textContent</span><span class="p">);</span>
</pre></table></code></div></div><p>An alternative to encoding and decoding JSON directly in JavaScript, is to normalize JSON server-side by converting <code class="language-plaintext highlighter-rouge">&lt;</code> to <code class="language-plaintext highlighter-rouge">\u003c</code> before delivering it to the browser.</p><hr /><h3 id="rule-4---css-encode-and-strictly-validate-before-inserting-untrusted-data-into-html-style-property-values">RULE #4 - <code class="language-plaintext highlighter-rouge">CSS Encode And Strictly Validate</code> Before Inserting Untrusted Data into <code class="language-plaintext highlighter-rouge">HTML Style Property Values</code></h3><ul><li>to put untrusted data into a style sheet or a style tag.<li>CSS is surprisingly powerful, and can be used for numerous attacks. Therefore, it’s important to use untrusted data in a property <strong>value</strong> and not into other places in style data.<li>You should stay away from putting untrusted data into complex properties like <code class="language-plaintext highlighter-rouge">url</code>, <code class="language-plaintext highlighter-rouge">behavior</code>, and custom (<code class="language-plaintext highlighter-rouge">-moz-binding</code>).<li>You should also not put untrusted data into IE’s expression property value which allows JavaScript.</ul><p>Property value:</p><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nt">&lt;style&gt;</span>
<span class="nt">selector</span> <span class="p">{</span> <span class="py">property</span> <span class="p">:</span> <span class="p">...</span><span class="n">ENCODE</span> <span class="n">UNTRUSTED</span> <span class="n">DATA</span> <span class="n">BEFORE</span> <span class="n">PUTTING</span> <span class="n">HERE</span><span class="p">...;</span> <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
</pre></table></code></div></div><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nt">&lt;style&gt;</span>
<span class="nt">selector</span> <span class="p">{</span> <span class="py">property</span> <span class="p">:</span> <span class="s1">"...ENCODE UNTRUSTED DATA BEFORE PUTTING HERE..."</span><span class="p">;</span> <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
</pre></table></code></div></div><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;span</span> <span class="na">style=</span><span class="s">"property : ...ENCODE UNTRUSTED DATA BEFORE PUTTING HERE..."</span><span class="nt">&gt;</span>text<span class="nt">&lt;/span&gt;</span>
</pre></table></code></div></div><ul><li>there are some CSS contexts that can never safely use untrusted data as input - <strong>EVEN IF PROPERLY CSS ENCODED!</strong><li>You will have to ensure that<ul><li>URLs only start with <code class="language-plaintext highlighter-rouge">http</code> not <code class="language-plaintext highlighter-rouge">javascript</code><li>properties never start with <code class="language-plaintext highlighter-rouge">"expression"</code>.</ul></ul><p>For example:</p><div class="language-cs highlighter-rouge"><div class="code-header" text-data="cs"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="p">{</span> <span class="n">background</span><span class="p">-</span><span class="n">url</span> <span class="p">:</span> <span class="s">"javascript:alert(1)"</span><span class="p">;</span> <span class="p">}</span>  <span class="c1">//and all other URLs</span>
<span class="p">{</span> <span class="n">text</span><span class="p">-</span><span class="n">size</span><span class="p">:</span> <span class="s">"expression(alert('XSS'))"</span><span class="p">;</span> <span class="p">}</span>   <span class="c1">//only in IE</span>
</pre></table></code></div></div><ul><li>Except for alphanumeric characters, encode all characters with ASCII values less than 256 with the <code class="language-plaintext highlighter-rouge">\HH</code> encoding format.<li><p><strong>DO NOT</strong> use any escaping shortcuts like <code class="language-plaintext highlighter-rouge">\"</code> because the quote character may be matched by the HTML attribute parser which runs first. These escaping shortcuts are also susceptible to <strong>escape-the-escape attacks</strong> where the attacker sends <code class="language-plaintext highlighter-rouge">\"</code> and the vulnerable code turns that into <code class="language-plaintext highlighter-rouge">\\"</code> which enables the quote.</p><li><p>If attribute is quoted, breaking out requires the corresponding quote. All attributes should be quoted but your encoding should be strong enough to prevent XSS when untrusted data is placed in unquoted contexts.</p><li><p>Unquoted attributes can be broken out of with many characters including <code class="language-plaintext highlighter-rouge">[space]</code> <code class="language-plaintext highlighter-rouge">%</code> <code class="language-plaintext highlighter-rouge">*</code> <code class="language-plaintext highlighter-rouge">+</code> <code class="language-plaintext highlighter-rouge">,</code> <code class="language-plaintext highlighter-rouge">-</code> <code class="language-plaintext highlighter-rouge">/</code> <code class="language-plaintext highlighter-rouge">;</code> <code class="language-plaintext highlighter-rouge">&lt;</code> <code class="language-plaintext highlighter-rouge">=</code> <code class="language-plaintext highlighter-rouge">&gt;</code> <code class="language-plaintext highlighter-rouge">^</code> and <code class="language-plaintext highlighter-rouge">|</code>.</p><li>Also, the <code class="language-plaintext highlighter-rouge">&lt;/style&gt;</code> tag will close the style block even though it is inside a quoted string<ul><li>because the HTML parser runs before the JavaScript parser.</ul><li>recommend <code class="language-plaintext highlighter-rouge">aggressive CSS encoding and validation</code> to prevent XSS attacks for both quoted and unquoted attributes.</ul><hr /><h3 id="rule-5---url-encode-before-inserting-untrusted-data-into-html-url-parameter-values">RULE #5 - <code class="language-plaintext highlighter-rouge">URL Encode</code> Before Inserting Untrusted Data into <code class="language-plaintext highlighter-rouge">HTML URL Parameter Values</code></h3><ul><li>to put untrusted data into HTTP GET parameter value.</ul><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"http://www.somesite.com?test=...ENCODE UNTRUSTED DATA BEFORE PUTTING HERE..."</span><span class="nt">&gt;</span>link<span class="nt">&lt;/a</span> <span class="nt">&gt;</span>
</pre></table></code></div></div><ul><li><p>Except for alphanumeric characters, encode all characters with ASCII values less than 256 with the <code class="language-plaintext highlighter-rouge">%HH</code> encoding format. Including untrusted data in <code class="language-plaintext highlighter-rouge">data:</code> URLs should not be allowed as there is no good way to disable attacks with encoding/escaping to prevent switching out of the URL.</p><li>All attributes should be quoted.<li>Unquoted attributes can be broken out of with many characters including <code class="language-plaintext highlighter-rouge">[space]</code> <code class="language-plaintext highlighter-rouge">%</code> <code class="language-plaintext highlighter-rouge">*</code> <code class="language-plaintext highlighter-rouge">+</code> <code class="language-plaintext highlighter-rouge">,</code> <code class="language-plaintext highlighter-rouge">-</code> <code class="language-plaintext highlighter-rouge">/</code> <code class="language-plaintext highlighter-rouge">;</code> <code class="language-plaintext highlighter-rouge">&lt;</code> <code class="language-plaintext highlighter-rouge">=</code> <code class="language-plaintext highlighter-rouge">&gt;</code> <code class="language-plaintext highlighter-rouge">^</code> and <code class="language-plaintext highlighter-rouge">|</code>.<ul><li>Note that <code class="language-plaintext highlighter-rouge">entity encoding</code> is useless in this context.</ul><li>WARNING: Do not encode complete or relative URLs with URL encoding!<li>If untrusted input is meant to be placed into <code class="language-plaintext highlighter-rouge">href</code>, <code class="language-plaintext highlighter-rouge">src</code> or other URL-based attributes,<ul><li>it should be validated<li>to make sure it does not point to an unexpected protocol, especially <code class="language-plaintext highlighter-rouge">javascript</code> links.<li>URLs should then be encoded based on the context of display like any other piece of data.</ul><li>For example<ul><li>user driven URLs in <code class="language-plaintext highlighter-rouge">HREF</code> links should be attribute encoded.</ul></ul><p>For example:</p><div class="language-java highlighter-rouge"><div class="code-header" text-data="java"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nc">String</span> <span class="n">userURL</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span> <span class="s">"userURL"</span> <span class="o">)</span>
<span class="kt">boolean</span> <span class="n">isValidURL</span> <span class="o">=</span> <span class="nc">Validator</span><span class="o">.</span><span class="na">IsValidURL</span><span class="o">(</span><span class="n">userURL</span><span class="o">,</span> <span class="mi">255</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">isValidURL</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">"&lt;%=encoder.encodeForHTMLAttribute(userURL)%&gt;"</span><span class="o">&gt;</span><span class="n">link</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
<span class="o">}</span>
</pre></table></code></div></div><hr /><h3 id="rule-6---sanitize-html-markup-with-a-library-designed-for-the-job">RULE #6 - <code class="language-plaintext highlighter-rouge">Sanitize HTML Markup</code> with a Library Designed for the Job</h3><ul><li>If your application handles markup – untrusted input that is supposed to contain HTML – it can be very difficult to validate.<li>Encoding is also difficult, since it would break all the tags that are supposed to be in the input.<li>Therefore, you need a library that can parse and clean HTML formatted text.<li>There are several available at OWASP that are simple to use:</ul><p><strong><a href="https://github.com/mganss/HtmlSanitizer">HtmlSanitizer</a></strong></p><p>An open-source .Net library. The HTML is cleaned with a white list approach. All allowed tags and attributes can be configured. The library is unit tested with the OWASP <a href="https://owasp.org/www-community/xss-filter-evasion-cheatsheet">XSS Filter Evasion Cheat Sheet</a></p><div class="language-csharp highlighter-rouge"><div class="code-header" text-data="csharp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kt">var</span> <span class="n">sanitizer</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HtmlSanitizer</span><span class="p">();</span>
<span class="n">sanitizer</span><span class="p">.</span><span class="n">AllowedAttributes</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"class"</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">sanitized</span> <span class="p">=</span> <span class="n">sanitizer</span><span class="p">.</span><span class="nf">Sanitize</span><span class="p">(</span><span class="n">html</span><span class="p">);</span>
</pre></table></code></div></div><p><strong><a href="https://owasp.org/www-project-java-html-sanitizer/">OWASP Java HTML Sanitizer</a></strong></p><div class="language-java highlighter-rouge"><div class="code-header" text-data="java"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">org.owasp.html.Sanitizers</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.owasp.html.PolicyFactory</span><span class="o">;</span>
<span class="nc">PolicyFactory</span> <span class="n">sanitizer</span> <span class="o">=</span> <span class="nc">Sanitizers</span><span class="o">.</span><span class="na">FORMATTING</span><span class="o">.</span><span class="na">and</span><span class="o">(</span><span class="nc">Sanitizers</span><span class="o">.</span><span class="na">BLOCKS</span><span class="o">);</span>
<span class="nc">String</span> <span class="n">cleanResults</span> <span class="o">=</span> <span class="n">sanitizer</span><span class="o">.</span><span class="na">sanitize</span><span class="o">(</span><span class="s">"&lt;p&gt;Hello, &lt;b&gt;World!&lt;/b&gt;"</span><span class="o">);</span>
</pre></table></code></div></div><p>For more information on OWASP Java HTML Sanitizer policy construction, see <a href="https://github.com/OWASP/java-html-sanitizer">here</a>.</p><p><strong><a href="http://api.rubyonrails.org/classes/ActionView/Helpers/SanitizeHelper.html">Ruby on Rails SanitizeHelper</a></strong></p><p>The <code class="language-plaintext highlighter-rouge">SanitizeHelper</code> module provides a set of methods for scrubbing text of undesired HTML elements.</p><pre><code class="language-rub">&lt;%= sanitize @comment.body, tags: %w(strong em a), attributes: %w(href) %&gt;
</code></pre><p><strong>Other libraries that provide HTML Sanitization include:</strong></p><ul><li><a href="https://github.com/google/closure-library/blob/master/closure/goog/html/sanitizer/htmlsanitizer.js">HTML sanitizer</a> from <a href="https://developers.google.com/closure/library/">Google Closure Library</a> (JavaScript/Node.js, <a href="https://google.github.io/closure-library/api/goog.html.sanitizer.HtmlSanitizer.html">docs</a>)<li><a href="https://github.com/cure53/DOMPurify">DOMPurify</a> (JavaScript, requires <a href="https://github.com/jsdom/jsdom">jsdom</a> for Node.js)<li><a href="http://htmlpurifier.org/">PHP HTML Purifier</a><li><a href="https://pypi.python.org/pypi/bleach">Python Bleach</a></ul><hr /><h3 id="rule-7---avoid-javascript-urls">RULE #7 - Avoid JavaScript URLs</h3><ul><li>Untrusted URLs that include the protocol javascript: will execute JavaScript code when used in URL DOM locations such as anchor tag HREF attributes or iFrame src locations.<li>Be sure to validate all untrusted URLs to ensure they only contain safe schemes such as HTTPS.</ul><hr /><h3 id="rule-8---prevent-dom-based-xss">RULE #8 - Prevent DOM-based XSS</h3><ul><li>For details on what DOM-based XSS is, and defenses against this type of XSS flaw, please see the OWASP article on <code class="language-plaintext highlighter-rouge">DOM based XSS Prevention Cheat Sheet</code> .</ul><hr /><h3 id="bonus-rule-1-use-httponly-cookie-flag">Bonus Rule #1: <code class="language-plaintext highlighter-rouge">Use HTTPOnly cookie flag</code></h3><ul><li>set the <code class="language-plaintext highlighter-rouge">HTTPOnly</code> flag on session cookie and any custom cookies that are not accessed by any JavaScript you wrote.<li>This cookie flag is typically on by default in <code class="language-plaintext highlighter-rouge">.NET</code> apps, but in other languages you have to set it manually.<li>For more details <a href="https://owasp.org/www-community/HttpOnly">HTTPOnly</a>.</ul><hr /><h3 id="bonus-rule-2-implement-content-security-policy">Bonus Rule #2: Implement <code class="language-plaintext highlighter-rouge">Content Security Policy</code></h3><ul><li>a browser side mechanism<li>create source whitelists for client side resources of your web application,<ul><li>e.g. JavaScript, CSS, images, etc.</ul><li>CSP via special HTTP header instructs the browser to only execute or render resources from those sources.</ul><p>For example this CSP:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Content</span><span class="o">-</span><span class="n">Security</span><span class="o">-</span><span class="n">Policy</span><span class="o">:</span> <span class="k">default</span><span class="o">-</span><span class="n">src</span><span class="o">:</span> <span class="err">'</span><span class="n">self</span><span class="err">'</span><span class="p">;</span> <span class="n">script</span><span class="o">-</span><span class="n">src</span><span class="o">:</span> <span class="err">'</span><span class="n">self</span><span class="err">'</span> <span class="k">static</span><span class="p">.</span><span class="n">domain</span><span class="p">.</span><span class="n">tld</span>
</pre></table></code></div></div><p>Will instruct web browser to load</p><ul><li>all resources only from the page’s origin<li>and JavaScript source code files additionally from <code class="language-plaintext highlighter-rouge">static.domain.tld</code>.<li>For more details <a href="https://content-security-policy.com">Content Security Policy</a>.</ul><hr /><h3 id="bonus-rule-3-use-an-auto-escaping-template-system">Bonus Rule #3: Use an Auto-Escaping Template System</h3><ul><li>Many web application frameworks provide automatic contextual escaping functionality such as <a href="https://docs.angularjs.org/api/ng/service/$sce">AngularJS strict contextual escaping</a> and <a href="https://golang.org/pkg/html/template/">Go Templates</a>.</ul><hr /><h3 id="bonus-rule-4-properly-use-modern-js-frameworks">Bonus Rule #4: Properly use <code class="language-plaintext highlighter-rouge">modern JS frameworks</code></h3><ul><li>Modern JavaScript frameworks have pretty good XSS protection built in.<li>Usually framework API allows bypassing that protection in order to render unescaped HTML or include executable code.<li><p>keep framework updated to the latest version with all possible bugfixes.</p><li>The following API methods and props in the table below are considered dangerous<ul><li>potentially exposing users to an XSS vulnerability.<li>If <strong>really</strong> have to use them, now all the data must be <a href="#rule-6---sanitize-html-markup-with-a-library-designed-for-the-job">sanitized</a> by yourself.</ul></ul><div class="table-wrapper"><table><thead><tr><th>JavaScript framework<th>Dangerous methods / props<tbody><tr><td>Angular (2+)<td><a href="https://angular.io/guide/security#bypass-security-apis">bypassSecurityTrust</a><tr><td>React<td><a href="https://reactjs.org/docs/dom-elements.html#dangerouslysetinnerhtml"><code class="language-plaintext highlighter-rouge">dangerouslySetInnerHTML</code></a><tr><td>Svelte<td><a href="https://svelte.dev/docs#html"><code class="language-plaintext highlighter-rouge">{@html ...}</code></a><tr><td>Vue (2+)<td><a href="https://vuejs.org/v2/api/#v-html"><code class="language-plaintext highlighter-rouge">v-html</code></a></table></div><p>Avoid template injection in Angular by building with <code class="language-plaintext highlighter-rouge">--prod</code> parameter (<code class="language-plaintext highlighter-rouge">ng build --prod</code>).</p><hr /><h3 id="x-xss-protection-header">X-XSS-Protection Header</h3><p>The <code class="language-plaintext highlighter-rouge">X-XSS-Protection</code> header has been deprecated by modern browsers and its use can introduce <strong>additional</strong> security issues on the client side.</p><ul><li>As such, it is recommended to set the header as <code class="language-plaintext highlighter-rouge">X-XSS-Protection: 0</code> in order to disable the XSS Auditor, and not allow it to take the default behavior of the browser handling the response.<li><p>Check the below references for a better understanding on this topic:</p><li><a href="https://portswigger.net/daily-swig/google-chromes-xss-auditor-goes-back-to-filter-mode">Google Chrome’s XSS Auditor goes back to filter mode</a><li><a href="https://www.chromestatus.com/feature/5021976655560704">Chrome removed the XSS Auditor</a><li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=528661">Firefox does not implement the XSSAuditor</a><li><a href="https://blogs.windows.com/windowsexperience/2018/07/25/announcing-windows-10-insider-preview-build-17723-and-build-18204/">Edge retired their XSS filter</a><li><a href="https://github.com/zaproxy/zaproxy/issues/5849">OWASP ZAP deprecated the scan for the header</a><li><a href="https://scotthelme.co.uk/security-headers-updates/#removing-the-x-xss-protection-header">SecurityHeaders.com no longer scans for the header</a></ul><hr /><h2 id="xss-prevention-rules-summary">XSS Prevention Rules Summary</h2><div class="table-wrapper"><table><thead><tr><th>DataType<th>Context<th>Code Sample<th>Defense<tbody><tr><td>String<td>HTML Body<td><code class="language-plaintext highlighter-rouge">&lt;span&gt;BAD DATA&lt;/span&gt;</code><td>HTML Entity Encoding (rule #1)<tr><td>String<td>Safe HTML Attributes<td><code class="language-plaintext highlighter-rouge">&lt;input type="text" name="fname" value="BAD DATA"&gt;</code><td>Aggressive HTML Entity Encoding (rule #2) <br /> Only place untrusted data into a whitelist of safe attributes (listed below), Strictly validate unsafe attributes such as background, ID and name.<tr><td>String<td>GET Parameter<td><code class="language-plaintext highlighter-rouge">&lt;a href="/site/search?value=BAD DATA"&gt;clickme&lt;/a&gt;</code> <br /> 📌 <code class="language-plaintext highlighter-rouge">BAD DATA"&gt;clickme&lt;/a&gt;</code><td>URL Encoding (rule #5)<tr><td>String<td>Untrusted URL in a SRC or HREF attribute<td><code class="language-plaintext highlighter-rouge">&lt;a href="BAD URL"&gt;clickme&lt;/a&gt;</code> <br /> <code class="language-plaintext highlighter-rouge">&lt;iframe src="BAD URL" /&gt;</code><td>Canonicalize input, URL Validation, Safe URL verification, Whitelist http and HTTPS URLs only (Avoid the JavaScript Protocol to Open a new Window), Attribute encoder.<tr><td>String<td>CSS Value<td><code class="language-plaintext highlighter-rouge">html &lt;div style="width:BAD DATA;"&gt;Selection&lt;/div&gt;</code><td>Strict structural validation (rule #4), CSS Hex encoding, Good design of CSS Features.<tr><td>String<td>JavaScript Variable<td><code class="language-plaintext highlighter-rouge">&lt;script&gt;var currentValue='BAD DATA';&lt;/script&gt; &lt;script&gt;someFunction('BAD DATA');&lt;/script&gt;</code><td>Ensure JavaScript variables are quoted, JavaScript Hex Encoding, JavaScript Unicode Encoding, Avoid backslash encoding (<code class="language-plaintext highlighter-rouge">\"</code> or <code class="language-plaintext highlighter-rouge">\'</code> or <code class="language-plaintext highlighter-rouge">\\</code>)<tr><td>HTML<td>HTML Body<td><code class="language-plaintext highlighter-rouge">&lt;div&gt;BAD HTML&lt;/div&gt;</code><td>HTML Validation (JSoup, AntiSamy, HTML Sanitizer…)<tr><td>String<td>DOM XSS<td><code class="language-plaintext highlighter-rouge">&lt;script&gt;document.write("BAD INPUT: " + document.location.hash );&lt;script/&gt;</code><td><code class="language-plaintext highlighter-rouge">DOM based XSS Prevention Cheat Sheet</code></table></div><p>The following snippets of HTML demonstrate how to safely render untrusted data in a variety of different contexts.</p><ul><li><strong>Safe HTML Attributes include:</strong><li><code class="language-plaintext highlighter-rouge">align</code>, <code class="language-plaintext highlighter-rouge">alink</code>, <code class="language-plaintext highlighter-rouge">alt</code>, <code class="language-plaintext highlighter-rouge">bgcolor</code>, <code class="language-plaintext highlighter-rouge">border</code>, <code class="language-plaintext highlighter-rouge">cellpadding</code>, <code class="language-plaintext highlighter-rouge">cellspacing</code>, <code class="language-plaintext highlighter-rouge">class</code>, <code class="language-plaintext highlighter-rouge">color</code>, <code class="language-plaintext highlighter-rouge">cols</code>, <code class="language-plaintext highlighter-rouge">colspan</code>, <code class="language-plaintext highlighter-rouge">coords</code>, <code class="language-plaintext highlighter-rouge">dir</code>, <code class="language-plaintext highlighter-rouge">face</code>, <code class="language-plaintext highlighter-rouge">height</code>, <code class="language-plaintext highlighter-rouge">hspace</code>, <code class="language-plaintext highlighter-rouge">ismap</code>, <code class="language-plaintext highlighter-rouge">lang</code>, <code class="language-plaintext highlighter-rouge">marginheight</code>, <code class="language-plaintext highlighter-rouge">marginwidth</code>, <code class="language-plaintext highlighter-rouge">multiple</code>, <code class="language-plaintext highlighter-rouge">nohref</code>, <code class="language-plaintext highlighter-rouge">noresize</code>, <code class="language-plaintext highlighter-rouge">noshade</code>, <code class="language-plaintext highlighter-rouge">nowrap</code>, <code class="language-plaintext highlighter-rouge">ref</code>, <code class="language-plaintext highlighter-rouge">rel</code>, <code class="language-plaintext highlighter-rouge">rev</code>, <code class="language-plaintext highlighter-rouge">rows</code>, <code class="language-plaintext highlighter-rouge">rowspan</code>, <code class="language-plaintext highlighter-rouge">scrolling</code>, <code class="language-plaintext highlighter-rouge">shape</code>, <code class="language-plaintext highlighter-rouge">span</code>, <code class="language-plaintext highlighter-rouge">summary</code>, <code class="language-plaintext highlighter-rouge">tabindex</code>, <code class="language-plaintext highlighter-rouge">title</code>, <code class="language-plaintext highlighter-rouge">usemap</code>, <code class="language-plaintext highlighter-rouge">valign</code>, <code class="language-plaintext highlighter-rouge">value</code>, <code class="language-plaintext highlighter-rouge">vlink</code>, <code class="language-plaintext highlighter-rouge">vspace</code>, <code class="language-plaintext highlighter-rouge">width</code>.</ul><hr /><h2 id="output-encoding-rules-summary">Output Encoding Rules Summary</h2><p>The purpose of output encoding (as it relates to Cross Site Scripting) is to convert untrusted input into a safe form where the input is displayed as <strong>data</strong> to the user without executing as <strong>code</strong> in the browser. The following charts details a list of critical output encoding methods needed to stop Cross Site Scripting.</p><div class="table-wrapper"><table><thead><tr><th>Encoding Type<th>Encoding Mechanism<tbody><tr><td><strong>HTML Entity Encoding</strong><td><code class="language-plaintext highlighter-rouge">&amp; = &amp;amp;</code>, <code class="language-plaintext highlighter-rouge">&lt; = &amp;lt;</code>, <code class="language-plaintext highlighter-rouge">&gt; = &amp;gt;</code>, <code class="language-plaintext highlighter-rouge">" = &amp;quot;</code>, <code class="language-plaintext highlighter-rouge">' = &amp;#x27;</code>, <code class="language-plaintext highlighter-rouge">/ = &amp;#x2F;</code><tr><td><strong>HTML Attribute Encoding</strong><td>Except for alphanumeric characters, encode all characters with the HTML Entity <code class="language-plaintext highlighter-rouge">&amp;#xHH;</code> format, including spaces. (<strong>HH</strong> = Hex Value)<tr><td><strong>URL Encoding</strong><td>Standard percent encoding, see <a href="http://www.w3schools.com/tags/ref_urlencode.asp">here</a>. URL encoding should only be used to encode parameter values, not the entire URL or path fragments of a URL.<tr><td><strong>JavaScript Encoding</strong><td>Except for alphanumeric characters, encode all characters with the <code class="language-plaintext highlighter-rouge">\uXXXX</code> unicode encoding format (<strong>X</strong> = Integer).<tr><td><strong>CSS Hex Encoding</strong><td>CSS encoding supports <code class="language-plaintext highlighter-rouge">\XX</code> and <code class="language-plaintext highlighter-rouge">\XXXXXX</code>. Using a two character encode can cause problems if the next character continues the encode sequence. There are two solutions (a) Add a space after the CSS encode (will be ignored by the CSS parser) (b) use the full amount of CSS encoding possible by zero padding the value.</table></div><h2 id="related-articles">Related Articles</h2><p><strong>XSS Attack Cheat Sheet:</strong></p><ul><li><a href="https://owasp.org/www-community/xss-filter-evasion-cheatsheet">XSS Filter Evasion Cheat Sheet</a>.</ul><p>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/10cyberattack/'>10CyberAttack</a>, <a href='/categories/xss/'>XSS</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/cyberattack/" class="post-tag no-text-decoration" >CyberAttack</a> <a href="/tags/xss/" class="post-tag no-text-decoration" >XSS</a> <a href="/tags/cheatsheet/" class="post-tag no-text-decoration" >CheatSheet</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Meow's CyberAttack - Cross Site Scripting Prevention Cheat Sheet - Grace&url=https://ocholuo.github.io//posts/XSS-Prevention-Cheat-Sheet/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Meow's CyberAttack - Cross Site Scripting Prevention Cheat Sheet - Grace&u=https://ocholuo.github.io//posts/XSS-Prevention-Cheat-Sheet/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Meow's CyberAttack - Cross Site Scripting Prevention Cheat Sheet - Grace&url=https://ocholuo.github.io//posts/XSS-Prevention-Cheat-Sheet/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Amazon-CloudFront/">AWS Lab - AWS CloudFront</a><li><a href="/posts/Alexa-1stSkill/">AWS Alex First Skill - RedVelvet Time</a><li><a href="/posts/NetworkProtocol-SSL-TLS-Handshake/">NetworkProtocol SSL/TLS Handshake</a><li><a href="/posts/pythonCrash/">Python Crash</a><li><a href="/posts/%E4%B8%80%E5%8F%A5%E8%AF%9D%E8%A7%A3%E9%87%8AAWS/">AWS - 一句话解释AWS</a><li><a href="/posts/GKE/">GCP - Google Cloud Computing - Kubernetes and Kubernetes Engine</a><li><a href="/posts/Go-Note/">Go Note</a><li><a href="/posts/SCPs/">AWS - IdenAccessManage - SCPs (Service Control Policies)</a><li><a href="/posts/CompanyBenefit/">Company Benefit</a><li><a href="/posts/Encryption-SSL&TLS/">Cryptography - SSL/TLS Encryption</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/XSS-Filter-Evasion-Cheat-Sheet/"><div class="card-body"> <span class="timeago small" >Sep 19, 2020<i class="unloaded">2020-09-19T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Meow's CyberAttack - Cross Site Scripting Filter Evasion Cheat Sheet</h3><div class="text-muted small"><p> Cross Site Scripting Filter Evasion Cheat Sheet [toc] __∧_∧__ ~~~~~ 　／(*´O｀)／＼ ／|￣∪∪￣|＼／ 　|＿＿ ＿|／ por favor, no lo usar para hacer algo malo just learning note, please don't use it to do ...</p></div></div></a></div><div class="card"> <a href="/posts/XSS/"><div class="card-body"> <span class="timeago small" >Sep 19, 2020<i class="unloaded">2020-09-19T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Meow's CyberAttack - Cross Site Scripting</h3><div class="text-muted small"><p> [toc] Meow’s CyberAttack - Cross Site Scripting 跨站脚本 Part One: Overview web application vulnerability 是代码注入的一种。 将代码注入到网页上，其他用户在观看网页时就会受到影响。 the basics of this a...</p></div></div></a></div><div class="card"> <a href="/posts/SEED-Labs-CrossSiteScripting-Attack-Lab/"><div class="card-body"> <span class="timeago small" >Aug 20, 2020<i class="unloaded">2020-08-20T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>SEED Labs – Cross-Site Scripting Attack Lab</h3><div class="text-muted small"><p> SEED Labs – Cross-Site Scripting Attack Lab [toc] Brief The tasks are based on a web application called ELGG which is open source. The prebuilt vm called seedubuntu is used to host the web...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/XSS-Filter-Evasion-Cheat-Sheet/" class="btn btn-outline-primary" prompt="Older"><p>Meow's CyberAttack - Cross Site Scripting Filter Evasion Cheat Sheet</p></a> <a href="/posts/XSS/" class="btn btn-outline-primary" prompt="Newer"><p>Meow's CyberAttack - Cross Site Scripting</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ocholuo">Grace JyL</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ocholuo.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script defer src="/assets/js/dist/pvreport.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-179830187-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-179830187-1'); }); </script>
