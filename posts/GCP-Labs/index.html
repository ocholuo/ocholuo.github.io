<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="pv-proxy-endpoint" content="https://myochosite-291718.appspot.com/query?id=ahNwfm15b2Nob3NpdGUtMjkxNzE4chULEghBcGlRdWVyeRiAgIDo14eBCgw"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="GCP - LABs" /><meta property="og:locale" content="en" /><meta name="description" content="Fundamental Lab 1 lab1 - Google Cloud Fundamentals: Cloud Marketplace Task 1: Sign in to the Google Cloud Platform (GCP) Console Task 2: Use Cloud Marketplace to deploy a LAMP stack Task 3: Verify your deployment lab2 - Google Cloud Fundamentals: Compute Engine Task 1: Sign in to the Google Cloud Platform (GCP) Console Task 2: Create a virtual machine using the GCP Console Task 3: Create a virtual machine using the gcloud command line Task 4: Connect between VM instances lab3 - Google Cloud Fundamentals: Cloud Storage and Cloud SQL Task 1: Sign in to the Google Cloud Platform (GCP) Console Task 2: Deploy a web server VM instance Task 3: Create a Cloud Storage bucket using the gsutil command line Task 4: Create the Cloud SQL instance Task 5: Configure an application in a Compute Engine instance to use Cloud SQL Task 6: Configure an application in a Compute Engine instance to use a Cloud Storage object lab4 - Google Cloud Fundamentals: GKE Task 1: Sign in to the Google Cloud Platform (GCP) Console Task 2: Confirm that needed APIs are enabled Task 3: Start a Kubernetes Engine cluster Task 4: Run and deploy a container lab5 - Google Cloud Fundamentals: App Engine Set up your lab environment Task 1: Initialize App Engine Task 2: Run Hello World application locally Task 3: Deploy and run Hello World on App Engine Task 4: Disable the application lab6 - Google Cloud Fundamentals: Deployment Manager and Cloud Monitoring Task 1: Sign in to the Google Cloud Platform (GCP) Console Task 2: Confirm that needed APIs are enabled Task 3: Create a Deployment Manager deployment Task 4: Update a Deployment Manager deployment Task 5: View the Load on a VM using Cloud Monitoring Create a Monitoring workspace lab7 - Google Cloud Fundamentals: BigQuery Task 1: Sign in to the Google Cloud Platform (GCP) Console Task 2: Load data from Cloud Storage into BigQuery Task 3: Perform a query on the data using the BigQuery web UI Task 4: Perform a query on the data using the bq command Kubernetes Lab lab1 - Accessing the Google Cloud Console and Cloud Shell Task 0. Lab Setup Task 1. Explore the Google Cloud Console Cloud Storage: create a bucket Create a virtual machine (VM) instance Explore the VM details Create an IAM service account Task 2. Explore Cloud Shell Open Cloud Shell and explore its features Use Cloud Shell to set up the environment variables Move the credentials file into Cloud Shell Create a second Cloud Storage bucket Use the gcloud command line to create a second virtual machine create a second service account Task 3. Work with Cloud Storage in Cloud Shell Download a file to Cloud Shell and copy it to Cloud Storage Set the access control list for a Cloud Storage object Authenticate as a service account in Cloud Shell Task 4. Explore the Cloud Shell code editor Open the Cloud Shell code editor lab2 - Working with Cloud Build Task 0. Lab Setup Task 1: Confirm that needed APIs are enabled Task 2. Building Containers with DockerFile and Cloud Build Task 3. Building Containers with a build configuration file and Cloud Build Task 4. Building and Testing Containers with a build configuration file and Cloud Build" /><meta property="og:description" content="Fundamental Lab 1 lab1 - Google Cloud Fundamentals: Cloud Marketplace Task 1: Sign in to the Google Cloud Platform (GCP) Console Task 2: Use Cloud Marketplace to deploy a LAMP stack Task 3: Verify your deployment lab2 - Google Cloud Fundamentals: Compute Engine Task 1: Sign in to the Google Cloud Platform (GCP) Console Task 2: Create a virtual machine using the GCP Console Task 3: Create a virtual machine using the gcloud command line Task 4: Connect between VM instances lab3 - Google Cloud Fundamentals: Cloud Storage and Cloud SQL Task 1: Sign in to the Google Cloud Platform (GCP) Console Task 2: Deploy a web server VM instance Task 3: Create a Cloud Storage bucket using the gsutil command line Task 4: Create the Cloud SQL instance Task 5: Configure an application in a Compute Engine instance to use Cloud SQL Task 6: Configure an application in a Compute Engine instance to use a Cloud Storage object lab4 - Google Cloud Fundamentals: GKE Task 1: Sign in to the Google Cloud Platform (GCP) Console Task 2: Confirm that needed APIs are enabled Task 3: Start a Kubernetes Engine cluster Task 4: Run and deploy a container lab5 - Google Cloud Fundamentals: App Engine Set up your lab environment Task 1: Initialize App Engine Task 2: Run Hello World application locally Task 3: Deploy and run Hello World on App Engine Task 4: Disable the application lab6 - Google Cloud Fundamentals: Deployment Manager and Cloud Monitoring Task 1: Sign in to the Google Cloud Platform (GCP) Console Task 2: Confirm that needed APIs are enabled Task 3: Create a Deployment Manager deployment Task 4: Update a Deployment Manager deployment Task 5: View the Load on a VM using Cloud Monitoring Create a Monitoring workspace lab7 - Google Cloud Fundamentals: BigQuery Task 1: Sign in to the Google Cloud Platform (GCP) Console Task 2: Load data from Cloud Storage into BigQuery Task 3: Perform a query on the data using the BigQuery web UI Task 4: Perform a query on the data using the bq command Kubernetes Lab lab1 - Accessing the Google Cloud Console and Cloud Shell Task 0. Lab Setup Task 1. Explore the Google Cloud Console Cloud Storage: create a bucket Create a virtual machine (VM) instance Explore the VM details Create an IAM service account Task 2. Explore Cloud Shell Open Cloud Shell and explore its features Use Cloud Shell to set up the environment variables Move the credentials file into Cloud Shell Create a second Cloud Storage bucket Use the gcloud command line to create a second virtual machine create a second service account Task 3. Work with Cloud Storage in Cloud Shell Download a file to Cloud Shell and copy it to Cloud Storage Set the access control list for a Cloud Storage object Authenticate as a service account in Cloud Shell Task 4. Explore the Cloud Shell code editor Open the Cloud Shell code editor lab2 - Working with Cloud Build Task 0. Lab Setup Task 1: Confirm that needed APIs are enabled Task 2. Building Containers with DockerFile and Cloud Build Task 3. Building Containers with a build configuration file and Cloud Build Task 4. Building and Testing Containers with a build configuration file and Cloud Build" /><link rel="canonical" href="https://ocholuo.github.io//posts/GCP-Labs/" /><meta property="og:url" content="https://ocholuo.github.io//posts/GCP-Labs/" /><meta property="og:site_name" content="Grace" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-01-02T10:11:11-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="GCP - LABs" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-02T18:18:23-05:00","datePublished":"2021-01-02T10:11:11-05:00","description":"Fundamental Lab 1 lab1 - Google Cloud Fundamentals: Cloud Marketplace Task 1: Sign in to the Google Cloud Platform (GCP) Console Task 2: Use Cloud Marketplace to deploy a LAMP stack Task 3: Verify your deployment lab2 - Google Cloud Fundamentals: Compute Engine Task 1: Sign in to the Google Cloud Platform (GCP) Console Task 2: Create a virtual machine using the GCP Console Task 3: Create a virtual machine using the gcloud command line Task 4: Connect between VM instances lab3 - Google Cloud Fundamentals: Cloud Storage and Cloud SQL Task 1: Sign in to the Google Cloud Platform (GCP) Console Task 2: Deploy a web server VM instance Task 3: Create a Cloud Storage bucket using the gsutil command line Task 4: Create the Cloud SQL instance Task 5: Configure an application in a Compute Engine instance to use Cloud SQL Task 6: Configure an application in a Compute Engine instance to use a Cloud Storage object lab4 - Google Cloud Fundamentals: GKE Task 1: Sign in to the Google Cloud Platform (GCP) Console Task 2: Confirm that needed APIs are enabled Task 3: Start a Kubernetes Engine cluster Task 4: Run and deploy a container lab5 - Google Cloud Fundamentals: App Engine Set up your lab environment Task 1: Initialize App Engine Task 2: Run Hello World application locally Task 3: Deploy and run Hello World on App Engine Task 4: Disable the application lab6 - Google Cloud Fundamentals: Deployment Manager and Cloud Monitoring Task 1: Sign in to the Google Cloud Platform (GCP) Console Task 2: Confirm that needed APIs are enabled Task 3: Create a Deployment Manager deployment Task 4: Update a Deployment Manager deployment Task 5: View the Load on a VM using Cloud Monitoring Create a Monitoring workspace lab7 - Google Cloud Fundamentals: BigQuery Task 1: Sign in to the Google Cloud Platform (GCP) Console Task 2: Load data from Cloud Storage into BigQuery Task 3: Perform a query on the data using the BigQuery web UI Task 4: Perform a query on the data using the bq command Kubernetes Lab lab1 - Accessing the Google Cloud Console and Cloud Shell Task 0. Lab Setup Task 1. Explore the Google Cloud Console Cloud Storage: create a bucket Create a virtual machine (VM) instance Explore the VM details Create an IAM service account Task 2. Explore Cloud Shell Open Cloud Shell and explore its features Use Cloud Shell to set up the environment variables Move the credentials file into Cloud Shell Create a second Cloud Storage bucket Use the gcloud command line to create a second virtual machine create a second service account Task 3. Work with Cloud Storage in Cloud Shell Download a file to Cloud Shell and copy it to Cloud Storage Set the access control list for a Cloud Storage object Authenticate as a service account in Cloud Shell Task 4. Explore the Cloud Shell code editor Open the Cloud Shell code editor lab2 - Working with Cloud Build Task 0. Lab Setup Task 1: Confirm that needed APIs are enabled Task 2. Building Containers with DockerFile and Cloud Build Task 3. Building Containers with a build configuration file and Cloud Build Task 4. Building and Testing Containers with a build configuration file and Cloud Build","headline":"GCP - LABs","mainEntityOfPage":{"@type":"WebPage","@id":"https://ocholuo.github.io//posts/GCP-Labs/"},"url":"https://ocholuo.github.io//posts/GCP-Labs/"}</script><title>GCP - LABs | Grace</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Grace"><meta name="application-name" content="Grace"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://myochosite-291718.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://myochosite-291718.appspot.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/huoye.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Grace</a></div><div class="site-subtitle font-italic">2023 Mar 14 updated</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/ocholuo" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>GCP - LABs</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>GCP - LABs</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Grace JyL </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Jan 2, 2021, 10:11 AM -0500" >Jan 2, 2021<i class="unloaded">2021-01-02T10:11:11-05:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Jan 2, 2023, 3:18 PM -0800" >Jan 2<i class="unloaded">2023-01-02T18:18:23-05:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="9797 words">54 min read</span> <span id="pv" class="pageviews"> <i class="fas fa-spinner fa-spin fa-fw"></i> </span> views</div></div><div class="post-content"><ul><li><a href="#fundamental-lab-1">Fundamental Lab 1</a><ul><li><a href="#lab1---google-cloud-fundamentals-cloud-marketplace">lab1 - Google Cloud Fundamentals: Cloud Marketplace</a><ul><li><a href="#task-1-sign-in-to-the-google-cloud-platform-gcp-console">Task 1: Sign in to the Google Cloud Platform (GCP) Console</a><li><a href="#task-2-use-cloud-marketplace-to-deploy-a-lamp-stack">Task 2: Use Cloud Marketplace to deploy a LAMP stack</a><li><a href="#task-3-verify-your-deployment">Task 3: Verify your deployment</a></ul><li><a href="#lab2---google-cloud-fundamentals-compute-engine">lab2 - Google Cloud Fundamentals: Compute Engine</a><ul><li><a href="#task-1-sign-in-to-the-google-cloud-platform-gcp-console-1">Task 1: Sign in to the Google Cloud Platform (GCP) Console</a><li><a href="#task-2-create-a-virtual-machine-using-the-gcp-console">Task 2: Create a virtual machine using the GCP Console</a><li><a href="#task-3-create-a-virtual-machine-using-the-gcloud-command-line">Task 3: Create a virtual machine using the gcloud command line</a><li><a href="#task-4-connect-between-vm-instances">Task 4: Connect between VM instances</a></ul><li><a href="#lab3---google-cloud-fundamentals-cloud-storage-and-cloud-sql">lab3 - Google Cloud Fundamentals: Cloud Storage and Cloud SQL</a><ul><li><a href="#task-1-sign-in-to-the-google-cloud-platform-gcp-console-2">Task 1: Sign in to the Google Cloud Platform (GCP) Console</a><li><a href="#task-2-deploy-a-web-server-vm-instance">Task 2: Deploy a web server VM instance</a><li><a href="#task-3-create-a-cloud-storage-bucket-using-the-gsutil-command-line">Task 3: Create a Cloud Storage bucket using the gsutil command line</a><li><a href="#task-4-create-the-cloud-sql-instance">Task 4: Create the Cloud SQL instance</a><li><a href="#task-5-configure-an-application-in-a-compute-engine-instance-to-use-cloud-sql">Task 5: Configure an application in a Compute Engine instance to use Cloud SQL</a><li><a href="#task-6-configure-an-application-in-a-compute-engine-instance-to-use-a-cloud-storage-object">Task 6: Configure an application in a Compute Engine instance to use a Cloud Storage object</a></ul><li><a href="#lab4---google-cloud-fundamentals-gke">lab4 - Google Cloud Fundamentals: GKE</a><ul><li><a href="#task-1-sign-in-to-the-google-cloud-platform-gcp-console-3">Task 1: Sign in to the Google Cloud Platform (GCP) Console</a><li><a href="#task-2-confirm-that-needed-apis-are-enabled">Task 2: Confirm that needed APIs are enabled</a><li><a href="#task-3-start-a-kubernetes-engine-cluster">Task 3: Start a Kubernetes Engine cluster</a><li><a href="#task-4-run-and-deploy-a-container">Task 4: Run and deploy a container</a></ul><li><a href="#lab5---google-cloud-fundamentals-app-engine">lab5 - Google Cloud Fundamentals: App Engine</a><li><a href="#set-up-your-lab-environment">Set up your lab environment</a><ul><li><a href="#task-1-initialize-app-engine">Task 1: Initialize App Engine</a><li><a href="#task-2-run-hello-world-application-locally">Task 2: Run Hello World application locally</a><li><a href="#task-3-deploy-and-run-hello-world-on-app-engine">Task 3: Deploy and run Hello World on App Engine</a><li><a href="#task-4-disable-the-application">Task 4: Disable the application</a></ul><li><a href="#lab6---google-cloud-fundamentals-deployment-manager-and-cloud-monitoring">lab6 - Google Cloud Fundamentals: Deployment Manager and Cloud Monitoring</a><ul><li><a href="#task-1-sign-in-to-the-google-cloud-platform-gcp-console-4">Task 1: Sign in to the Google Cloud Platform (GCP) Console</a><li><a href="#task-2-confirm-that-needed-apis-are-enabled-1">Task 2: Confirm that needed APIs are enabled</a><li><a href="#task-3-create-a-deployment-manager-deployment">Task 3: Create a Deployment Manager deployment</a><li><a href="#task-4-update-a-deployment-manager-deployment">Task 4: Update a Deployment Manager deployment</a><li><a href="#task-5-view-the-load-on-a-vm-using-cloud-monitoring">Task 5: View the Load on a VM using Cloud Monitoring</a></ul><li><a href="#create-a-monitoring-workspace">Create a Monitoring workspace</a><li><a href="#lab7---google-cloud-fundamentals-bigquery">lab7 - Google Cloud Fundamentals: BigQuery</a><ul><li><a href="#task-1-sign-in-to-the-google-cloud-platform-gcp-console-5">Task 1: Sign in to the Google Cloud Platform (GCP) Console</a><li><a href="#task-2-load-data-from-cloud-storage-into-bigquery">Task 2: Load data from Cloud Storage into BigQuery</a><li><a href="#task-3-perform-a-query-on-the-data-using-the-bigquery-web-ui">Task 3: Perform a query on the data using the BigQuery web UI</a><li><a href="#task-4-perform-a-query-on-the-data-using-the-bq-command">Task 4: Perform a query on the data using the bq command</a></ul></ul><li><a href="#kubernetes-lab">Kubernetes Lab</a><ul><li><a href="#lab1---accessing-the-google-cloud-console-and-cloud-shell">lab1 - Accessing the Google Cloud Console and Cloud Shell</a><ul><li><a href="#task-0-lab-setup">Task 0. Lab Setup</a><li><a href="#task-1-explore-the-google-cloud-console">Task 1. Explore the Google Cloud Console</a><li><a href="#cloud-storage-create-a-bucket">Cloud Storage: create a bucket</a><li><a href="#create-a-virtual-machine-vm-instance">Create a virtual machine (VM) instance</a><li><a href="#explore-the-vm-details">Explore the VM details</a><li><a href="#create-an-iam-service-account">Create an IAM service account</a><li><a href="#task-2-explore-cloud-shell">Task 2. Explore Cloud Shell</a><li><a href="#open-cloud-shell-and-explore-its-features">Open Cloud Shell and explore its features</a><li><a href="#use-cloud-shell-to-set-up-the-environment-variables">Use Cloud Shell to set up the environment variables</a><li><a href="#move-the-credentials-file-into-cloud-shell">Move the credentials file into Cloud Shell</a><li><a href="#create-a-second-cloud-storage-bucket">Create a second Cloud Storage bucket</a><li><a href="#use-the-gcloud-command-line-to-create-a-second-virtual-machine">Use the gcloud command line to create a second virtual machine</a><li><a href="#create-a-second-service-account">create a second service account</a><li><a href="#task-3-work-with-cloud-storage-in-cloud-shell">Task 3. Work with Cloud Storage in Cloud Shell</a><li><a href="#download-a-file-to-cloud-shell-and-copy-it-to-cloud-storage">Download a file to Cloud Shell and copy it to Cloud Storage</a><li><a href="#set-the-access-control-list-for-a-cloud-storage-object">Set the access control list for a Cloud Storage object</a><li><a href="#authenticate-as-a-service-account-in-cloud-shell">Authenticate as a service account in Cloud Shell</a><li><a href="#task-4-explore-the-cloud-shell-code-editor">Task 4. Explore the Cloud Shell code editor</a><li><a href="#open-the-cloud-shell-code-editor">Open the Cloud Shell code editor</a></ul><li><a href="#lab2---working-with-cloud-build">lab2 - Working with Cloud Build</a><ul><li><a href="#task-0-lab-setup-1">Task 0. Lab Setup</a><li><a href="#task-1-confirm-that-needed-apis-are-enabled">Task 1: Confirm that needed APIs are enabled</a><li><a href="#task-2-building-containers-with-dockerfile-and-cloud-build">Task 2. Building Containers with DockerFile and Cloud Build</a><li><a href="#task-3-building-containers-with-a-build-configuration-file-and-cloud-build">Task 3. Building Containers with a build configuration file and Cloud Build</a><li><a href="#task-4-building-and-testing-containers-with-a-build-configuration-file-and-cloud-build">Task 4. Building and Testing Containers with a build configuration file and Cloud Build</a></ul></ul></ul><hr /><h1 id="fundamental-lab-1">Fundamental Lab 1</h1><p>Lab for <a href="https://www.coursera.org/learn/gcp-fundamentals/home/welcome">Google Cloud Platform Fundamentals: Core Infrastructure</a></p><hr /><h2 id="lab1---google-cloud-fundamentals-cloud-marketplace">lab1 - Google Cloud Fundamentals: Cloud Marketplace</h2><p>use Cloud Marketplace to quickly and easily deploy a LAMP stack on a Compute Engine instance.</p><ul><li>The Bitnami LAMP Stack provides a complete web development environment for Linux that can be launched in one click.</ul><div class="table-wrapper"><table><tbody><tr><td>Component<td>Role<tr><td>Linux<td>Operating system<tr><td>Apache HTTP Server<td>Web server<tr><td>MySQL<td>Relational database<tr><td>PHP<td>Web application framework<tr><td>phpMyAdmin<td>PHP administration tool</table></div><p><a href="https://docs.bitnami.com/google/infrastructure/lamp">Bitnami LAMP Stack Documentation</a>.</p><hr /><h3 id="task-1-sign-in-to-the-google-cloud-platform-gcp-console">Task 1: Sign in to the Google Cloud Platform (GCP) Console</h3><h3 id="task-2-use-cloud-marketplace-to-deploy-a-lamp-stack">Task 2: Use Cloud Marketplace to deploy a LAMP stack</h3><ol><li><p>GCP Console &gt; <strong>Navigation menu</strong> &gt; <strong>Marketplace</strong>.</p><li>In the search bar<ul><li>type and click <strong>LAMP Certified by Bitnami</strong>.<li>On the LAMP page, click <strong>Launch</strong>.</ul><li><p>Leave the remaining settings as their defaults.</p><li>Click <strong>Deploy</strong>.</ol><h3 id="task-3-verify-your-deployment">Task 3: Verify your deployment</h3><ol><li><p>When the deployment is complete, click the <strong>Site address</strong> link in the right pane.</p><li><p>On the GCP Console, under <strong>Get started with LAMP Certified by Bitnami</strong>, click <strong>SSH</strong>.</p><ul><li>a secure login shell session on your virtual machine appears.</ul></ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="c"># change the current working directory to `/opt/bitnami`, execute the following command:</span>
<span class="nb">cd</span> /opt/bitnami


<span class="c"># To copy the `phpinfo.php` script from the installation directory to a publicly accessible location under the web server document root</span>
<span class="nb">sudo </span>sh <span class="nt">-c</span> <span class="s1">'echo "&lt;?php phpinfo(); ?&gt;" &gt; apache2/htdocs/phpinfo.php'</span>

<span class="c"># The phpinfo.php script displays your PHP configuration.</span>
<span class="c"># It is often used to verify a new PHP installation.</span>

<span class="c"># close the SSH window</span>
<span class="nb">exit</span>
</pre></table></code></div></div><ol><li>Open a new browser tab. <code class="language-plaintext highlighter-rouge">http://SITE_ADDRESS/phpinfo.php</code><ul><li>A summary of the PHP configuration of your server is displayed.</ul><li>Close the <strong>phpinfo</strong> tab.</ol><hr /><h2 id="lab2---google-cloud-fundamentals-compute-engine">lab2 - Google Cloud Fundamentals: Compute Engine</h2><p>perform the following tasks:</p><ul><li><p>Create a Compute Engine virtual machine using the Google Cloud Platform (GCP) Console.</p><li><p>Create a Compute Engine virtual machine using the gcloud command-line interface.</p><li><p>Connect between the two instances.</p></ul><hr /><h3 id="task-1-sign-in-to-the-google-cloud-platform-gcp-console-1">Task 1: Sign in to the Google Cloud Platform (GCP) Console</h3><h3 id="task-2-create-a-virtual-machine-using-the-gcp-console">Task 2: Create a virtual machine using the GCP Console</h3><ol><li>In the <strong>Navigation menu</strong> &gt; <strong>Compute Engine</strong> &gt; <strong>VM instances</strong>.<li>Click <strong>Create</strong>.<li>On the <strong>Create an Instance</strong> page<li>for <strong>Name</strong>, type <code class="language-plaintext highlighter-rouge">my-vm-1</code><li>For <strong>Region</strong> and <strong>Zone</strong>, select the region and zone assigned by Qwiklabs.<li>For <strong>Machine type</strong>, accept the default.<li>For <strong>Boot disk</strong>, if the <strong>Image</strong> shown is not <strong>Debian GNU/Linux 9 (stretch)</strong>, click <strong>Change</strong> and select <strong>Debian GNU/Linux 9 (stretch)</strong>.<li>Leave the defaults for <strong>Identity and API access</strong> unmodified.<li>For Firewall, click <strong>Allow HTTP traffic</strong>.<li>Leave all other defaults unmodified.<li>To create and launch the VM, click <strong>Create</strong>.</ol><h3 id="task-3-create-a-virtual-machine-using-the-gcloud-command-line">Task 3: Create a virtual machine using the gcloud command line</h3><ol><li>In GCP console, on the top right toolbar, click the <strong>Open Cloud Shell button</strong> &gt; <strong>Continue</strong></ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="c"># display a list of all the zones in the region to which Qwiklabs assigned you</span>
gcloud compute zones list | <span class="nb">grep </span>us-central1
<span class="c"># us-central1-c  us-central1  UP</span>
<span class="c"># us-central1-a  us-central1  UP</span>
<span class="c"># us-central1-f  us-central1  UP</span>
<span class="c"># us-central1-b  us-central1  UP</span>

<span class="c"># Choose a zone from that list other than the zone to which Qwiklabs assigned you. For example, if Qwiklabs assigned you to region `us-central1` and zone `us-central1-a` you might choose zone `us-central1-b`.</span>

<span class="c"># To set your default zone to the one you just chose, enter this partial command `gcloud config set compute/zone` followed by the zone you chose.</span>
gcloud config <span class="nb">set </span>compute/zone us-central1-b


<span class="c"># To create a VM instance called **my-vm-2** in that zone, execute this command:</span>

gcloud compute instances create <span class="s2">"my-vm-2"</span>
  <span class="nt">--machine-type</span> <span class="s2">"n1-standard-1"</span>
  <span class="nt">--image-project</span> <span class="s2">"debian-cloud"</span>
  <span class="nt">--image</span> <span class="s2">"debian-9-stretch-v20190213"</span>
  <span class="nt">--subnet</span> <span class="s2">"default"</span>
<span class="c"># NAME ZONE   MACHINE_TYPE PREEMPTIBLE  INTERNAL_IP  EXTERNAL_IP  STATUS</span>
<span class="c"># my-vm-2  us-central1-b  n1-standard-1   10.128.0.3 35.184.46.186  RUNNING</span>

<span class="c"># To close the Cloud Shell, execute the following command:</span>
<span class="nb">exit</span>
</pre></table></code></div></div><h3 id="task-4-connect-between-vm-instances">Task 4: Connect between VM instances</h3><ol><li>In the <strong>Navigation menu</strong> &gt; <strong>Compute Engine &gt; VM instances</strong>.<ul><li>two VM instances in a different zone.<li>Notice that the Internal IP addresses of these two instances share the first three bytes in common.<li>They reside on the same subnet in their Google Cloud VPC even though they are in different zones.</ul><li>To open a command prompt on the <strong>my-vm-2</strong> instance, click <strong>SSH</strong> in its row in the <strong>VM instances</strong> list.</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre>
<span class="c"># confirm that **my-vm-2** can reach **my-vm-1** over the network:</span>
ping my-vm-1.us-central1-a
<span class="c"># the complete hostname of **my-vm-1** is **my-vm-1.us-central1-a.c.PROJECT_ID.internal**, where PROJECT_ID is the name of your Google Cloud Platform project. GCP automatically supplies Domain Name Service (DNS) resolution for the internal IP addresses of VM instances.</span>

<span class="c"># Use the **ssh** command to open a command prompt on **my-vm-1**:</span>
ssh my-vm-1.us-central1-a

<span class="c"># install the Nginx web server:</span>
<span class="nb">sudo </span>apt-get <span class="nb">install </span>nginx-light <span class="nt">-y</span>


<span class="c"># add a custom message to the home page of the web server:</span>
<span class="nb">sudo </span>nano /var/www/html/index.nginx-debian.html


<span class="c"># below the `h1` header. Add text like this, and replace YOUR_NAME with your name:</span>
Hi from YOUR_NAME
<span class="c"># Press **Ctrl+O** and then press **Enter** to save your edited file, and then press **Ctrl+X** to exit the nano text editor.</span>

<span class="c"># Confirm that the web server is serving your new page.</span>
<span class="c"># At the command prompt on **my-vm-1**, execute this command:</span>
curl http://localhost/

<span class="c"># exit the command prompt on **my-vm-1**, execute this command:</span>
<span class="nb">exit</span>


<span class="c"># return to the command prompt on **my-vm-2**</span>


<span class="c"># confirm that **my-vm-2** can reach the web server on **my-vm-1**, at the command prompt on **my-vm-2**, execute this command:</span>
curl http://my-vm-1.us-central1-a/
</pre></table></code></div></div><ol><li><p>In the <strong>Navigation menu</strong> &gt; <strong>Compute Engine &gt; VM instances</strong>.</p><li><p>Copy the External IP address for <strong>my-vm-1</strong> and paste it into the address bar of a new browser tab. You will see your web server’s home page, including your custom text.</p><ul><li>If you forgot to click <strong>Allow HTTP traffic</strong> when you created the <strong>my-vm-1</strong> VM instance, your attempt to reach your web server’s home page will fail. You can add a <a href="https://cloud.google.com/vpc/docs/firewalls">firewall rule</a> to allow inbound traffic to your instances, although this topic is out of scope for this course.</ul></ol><hr /><h2 id="lab3---google-cloud-fundamentals-cloud-storage-and-cloud-sql">lab3 - Google Cloud Fundamentals: Cloud Storage and Cloud SQL</h2><ul><li><p>Create a Cloud Storage bucket and place an image into it.</p><li><p>configure an application running in Compute Engine to use a database managed by Cloud SQL.</p><li><p>configure a web server with PHP, a web development environment that is the basis for popular blogging softwar, Connect to the Cloud SQL instance from a web server.</p><li><p>Use the image in the Cloud Storage bucket on a web page.</p></ul><hr /><h3 id="task-1-sign-in-to-the-google-cloud-platform-gcp-console-2">Task 1: Sign in to the Google Cloud Platform (GCP) Console</h3><h3 id="task-2-deploy-a-web-server-vm-instance">Task 2: Deploy a web server VM instance</h3><ol><li><p>GCP Console &gt; <strong>Navigation menu</strong> &gt; <strong>Compute Engine</strong> &gt; <strong>VM instances</strong>.</p><li><p>Click <strong>Create</strong>.</p><li><p>On the <strong>Create an Instance</strong> page,</p><ol><li>for <strong>Name</strong>, type <code class="language-plaintext highlighter-rouge">bloghost</code><li>For <strong>Region</strong> and <strong>Zone</strong>, select the region and zone assigned by Qwiklabs.<li>For <strong>Machine type</strong>, accept the default.<li>For <strong>Boot disk</strong>, if the <strong>Image</strong> shown is not <strong>Debian GNU/Linux 9 (stretch)</strong>, click <strong>Change</strong> and select <strong>Debian GNU/Linux 9 (stretch)</strong>.<li>Leave the defaults for <strong>Identity and API access</strong> unmodified.<li>For <strong>Firewall</strong>, click <strong>Allow HTTP traffic</strong>.<li>Click <strong>Management, security, disks, networking, sole tenancy</strong> to open that section of the dialog.<li>Enter the following script as the value for <strong>Startup script</strong>:</ol></ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>apt-get update
apt-get <span class="nb">install </span>apache2 php php-mysql <span class="nt">-y</span>
service apache2 restart
</pre></table></code></div></div><ol><li><p>Leave the remaining settings as their defaults, and click <strong>Create</strong>.</p><li><p>On the <strong>VM instances</strong> page, copy the <strong>bloghost</strong> VM instance’s internal and external IP addresses:</p><ul><li>Internal IP 10.128.0.2 (nic0)<li>External IP 35.232.96.34</ul></ol><h3 id="task-3-create-a-cloud-storage-bucket-using-the-gsutil-command-line">Task 3: Create a Cloud Storage bucket using the gsutil command line</h3><p>All Cloud Storage bucket names must be globally unique.</p><ul><li>To ensure that your bucket name is unique, these instructions will guide you to give your bucket the same name as your Cloud Platform project ID, which is also globally unique.<li>Cloud Storage buckets can be associated with either a region or a multi-region location: <strong>US</strong>, <strong>EU</strong>, or <strong>ASIA</strong>.<li>In this activity, you associate your bucket with the multi-region closest to the region and zone that Qwiklabs or your instructor assigned you to.</ul><ol><li>On the <strong>Google Cloud Platform</strong> menu, click <strong>Activate Cloud Shell</strong> <img data-proofer-ignore data-src="https://cdn.qwiklabs.com/sqKx45X8b2P7ygEtesyerKaHyXQGXOYNqXOqo%2Bl8nDA%3D" alt="Activate Cloud Shell" />. If a dialog box appears, click <strong>Start Cloud Shell</strong>.</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="c"># enter your chosen location into an environment variable called LOCATION. Enter one of these commands:</span>
<span class="nb">export </span><span class="nv">LOCATION</span><span class="o">=</span>US
<span class="c"># export LOCATION=EU</span>
<span class="c"># export LOCATION=ASIA</span>


<span class="c"># In Cloud Shell, the DEVSHELL_PROJECT_ID environment variable contains your project ID.</span>
<span class="nb">echo</span> <span class="nv">$$</span>DEVSHELL_PROJECT_ID


<span class="c"># to make a bucket named after your project ID:</span>
gsutil mb <span class="nt">-l</span> <span class="nv">$LOCATION</span> gs://<span class="nv">$DEVSHELL_PROJECT_ID</span>
<span class="c"># Creating gs://qwiklabs-gcp-00-9740a5240906/...</span>


<span class="c"># Retrieve a banner image from a publicly accessible Cloud Storage location:</span>
gsutil <span class="nb">cp </span>gs://cloud-training/gcpfci/my-excellent-blog.png my-excellent-blog.png


<span class="c"># Copy the banner image to your newly created Cloud Storage bucket:</span>
gsutil <span class="nb">cp </span>my-excellent-blog.png gs://<span class="nv">$DEVSHELL_PROJECT_ID</span>/my-excellent-blog.png


<span class="c"># Modify the Access Control List of the object you just created so that it is readable by everyone:</span>
gsutil acl ch <span class="nt">-u</span> allUsers:R gs://<span class="nv">$DEVSHELL_PROJECT_ID</span>/my-excellent-blog.png
</pre></table></code></div></div><h3 id="task-4-create-the-cloud-sql-instance">Task 4: Create the Cloud SQL instance</h3><ol><li><p>GCP Console &gt; <strong>Navigation menu</strong> &gt; <strong>SQL</strong>.</p><li>Click <strong>Create instance</strong>.<li>For <strong>Choose a database engine</strong>, select <strong>MySQL</strong>.<li>For <strong>Instance ID,</strong> type <strong>blog-db</strong>,<li>for <strong>Root password</strong> type a password of your choice. <code class="language-plaintext highlighter-rouge">root</code><li>Set the region and zone assigned by Qwiklabs.<ul><li>same region and zone into which you launched the <strong>bloghost</strong> instance.<li>The best performance is achieved by placing the client and the database close to each other.</ul><li><p>Click <strong>Create</strong>.</p><li><p>Click on the name of the instance, <strong>blog-db</strong>, to open its details page.</p><li>From the SQL instances details page<ul><li>the <strong>Public IP address</strong> for your SQL instance: <code class="language-plaintext highlighter-rouge">34.69.146.67</code></ul><li><p>Click on <strong>Users</strong> menu on the left-hand side, click <strong>ADD USER ACCOUNT</strong>.</p><li><p>For <strong>User name</strong>, type <code class="language-plaintext highlighter-rouge">blogdbuser</code></p><li><p>For <strong>Password</strong>, type a password of your choice. <code class="language-plaintext highlighter-rouge">dbuser</code></p><li><p>Click <strong>ADD</strong> to add the user account in the database.</p><li>Click the <strong>Connections</strong> tab<ul><li>click <strong>Add network</strong>.<li>If you are offered the choice between a <strong>Private IP</strong> connection and a <strong>Public IP</strong> connection, choose <strong>Public IP</strong> for purposes of this lab.</ul><li><p>For <strong>Name</strong>, type <code class="language-plaintext highlighter-rouge">web front end</code></p><li>For <strong>Network</strong>, type the external IP address of your <strong>bloghost</strong> VM instance, followed by <code class="language-plaintext highlighter-rouge">/32</code><ul><li><code class="language-plaintext highlighter-rouge">35.232.96.34/32</code><li>Be sure to use the external IP address of your VM instance followed by <code class="language-plaintext highlighter-rouge">/32</code>.<li>Do not use the VM instance’s internal IP address.<li>Do not use the sample IP address shown here.</ul><li><p>Click <strong>Done</strong> to finish defining the authorized network.</p><li>Click <strong>Save</strong> to save the configuration change.</ol><h3 id="task-5-configure-an-application-in-a-compute-engine-instance-to-use-cloud-sql">Task 5: Configure an application in a Compute Engine instance to use Cloud SQL</h3><ol><li><p>On the <strong>Navigation menu</strong> &gt; <strong>Compute Engine</strong> &gt; <strong>VM instances</strong>.</p><li><p>In the VM instances list, click <strong>SSH</strong> in the row for your VM instance <strong>bloghost</strong>.</p></ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
</pre><td class="rouge-code"><pre><span class="c"># In your ssh session on **bloghost**</span>

<span class="c"># change your working directory to the document root of the web server:</span>
<span class="nb">cd</span> /var/www/html


<span class="c"># Use the **nano** text editor to edit a file called **index.php**:</span>
<span class="nb">sudo </span>nano index.php


<span class="c"># Paste the content below into the file:</span>
<span class="c"># &lt;html&gt;</span>
<span class="c"># &lt;head&gt;&lt;title&gt;Welcome to my excellent blog&lt;/title&gt;&lt;/head&gt;</span>
<span class="c"># &lt;body&gt;</span>
<span class="c"># &lt;h1&gt;Welcome to my excellent blog&lt;/h1&gt;</span>
<span class="c"># &lt;?php</span>
<span class="c">#  $dbserver = "CLOUDSQLIP";</span>
<span class="c"># $dbuser = "blogdbuser";</span>
<span class="c"># $dbpassword = "DBPASSWORD";</span>
<span class="c"># // In a production blog, we would not store the MySQL</span>
<span class="c"># // password in the document root. Instead, we would store it in a</span>
<span class="c"># // configuration file elsewhere on the web server VM instance.</span>

<span class="c"># $conn = new mysqli($dbserver, $dbuser, $dbpassword);</span>

<span class="c"># if (mysqli_connect_error()) {</span>
<span class="c"># echo ("Database connection failed: " . mysqli_connect_error());</span>
<span class="c"># } else {</span>
<span class="c"># echo ("Database connection succeeded.");</span>
<span class="c"># }</span>
<span class="c"># ?&gt;</span>
<span class="c"># &lt;/body&gt;&lt;/html&gt;</span>
<span class="c"># Press **Ctrl+O**, and then press **Enter** to save your edited file.</span>
<span class="c"># Press **Ctrl+X** to exit the nano text editor.</span>


<span class="c"># In a later step, you will insert your Cloud SQL instance's IP address and your database password into this file.</span>

<span class="c"># Restart the web server:</span>
<span class="nb">sudo </span>service apache2 restart


<span class="c"># Open a new web browser tab and paste into the address bar your **bloghost** VM instance's external IP address followed by **/index.php**.</span>
<span class="c"># The URL will look like this:</span>
35.232.96.34/index.php
<span class="c"># Be sure to use the external IP address of your VM instance followed by /index.php.</span>
<span class="c"># Do not use the VM instance's internal IP address. Do not use the sample IP address shown here.</span>


<span class="c"># When you load the page, you will see that its content includes an error message beginning with the words:</span>
Database connection failed: php_network_getaddresses: getaddrinfo failed: Name or service not known
<span class="c"># This message occurs because you have not yet configured PHP's connection to your Cloud SQL instance.</span>


<span class="c"># Return to your ssh session on **bloghost**. Use the **nano** text editor to edit **index.php** again.</span>
<span class="nb">sudo </span>nano index.php


<span class="c"># replace `CLOUDSQLIP` with the Cloud SQL instance Public IP address 34.69.146.67</span>

<span class="c"># replace `DBPASSWORD` with the Cloud SQL database password that you defined above. Leave the quotation marks around the value in place.</span>

<span class="c"># Press **Ctrl+O**, and then press **Enter** to save your edited file.</span>

<span class="c"># Press **Ctrl+X** to exit the nano text editor.</span>

<span class="c"># Restart the web server:</span>
<span class="nb">sudo </span>service apache2 restart


<span class="c"># Return to the web browser tab in which you opened your **bloghost** VM instance's external IP address. When you load the page, the following message appears:</span>
Database connection succeeded.
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://i.imgur.com/mzmZ1nf.png" alt="Screen Shot 2021-02-10 at 02.17.27" /></p><blockquote><p>In an actual blog, the database connection status would not be visible to blog visitors. Instead, the database connection would be managed solely by the administrator.</p></blockquote><h3 id="task-6-configure-an-application-in-a-compute-engine-instance-to-use-a-cloud-storage-object">Task 6: Configure an application in a Compute Engine instance to use a Cloud Storage object</h3><ol><li><p>In the GCP Console, click <strong>Storage &gt; Browser</strong>.</p><li><p>Click on the bucket that is named after your GCP project.</p><li>In this bucket, there is an object called <strong>my-excellent-blog.png</strong>.<ul><li>Copy the URL behind the link icon that appears in that object’s <strong>Public access</strong> column, or behind the words “Public link” if shown.</ul><li>Return to your ssh session on your <strong>bloghost</strong> VM instance.</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="c"># set your working directory to the document root of the web server:</span>
<span class="nb">cd</span> /var/www/html


<span class="c"># Use the **nano** text editor to edit **index.php**:</span>
<span class="nb">sudo </span>nano index.php


<span class="c"># Use the arrow keys to move the cursor to the line that contains the **h1** element. Press **Enter** to open up a new, blank screen line, and then paste the URL you copied earlier into the line.</span>

<span class="c"># Paste this HTML markup immediately before the URL:</span>
&lt;img <span class="nv">src</span><span class="o">=</span><span class="s1">'https://storage.googleapis.com/qwiklabs-gcp-00-9740a5240906/my-excellent-blog.png'</span><span class="o">&gt;</span>

<span class="c"># The effect of these steps is to place the line containing `&lt;img src='...'&gt;` immediately before the line containing `&lt;h1&gt;...&lt;/h1&gt;`</span>

<span class="c"># Press **Ctrl+O**, and then press **Enter** to save your edited file.</span>
<span class="c"># Press **Ctrl+X** to exit the nano text editor.</span>


<span class="c"># Restart the web server:</span>
<span class="nb">sudo </span>service apache2 restart
</pre></table></code></div></div><ol><li>Return to the web browser tab in which you opened your <strong>bloghost</strong> VM instance’s external IP address. When you load the page, its content now includes a banner image. 35.232.96.34/index.php</ol><hr /><h2 id="lab4---google-cloud-fundamentals-gke">lab4 - Google Cloud Fundamentals: GKE</h2><ul><li>Provision a <a href="http://kubernetes.io">Kubernetes</a> cluster using <a href="https://cloud.google.com/container-engine">Kubernetes Engine.</a>, which containing several containers,<li>Deploy and manage Docker containers using <code class="language-plaintext highlighter-rouge">kubectl</code>.<li>each containing a web server.<li>place a load balancer in front of the cluster and view its contents.</ul><h3 id="task-1-sign-in-to-the-google-cloud-platform-gcp-console-3">Task 1: Sign in to the Google Cloud Platform (GCP) Console</h3><h3 id="task-2-confirm-that-needed-apis-are-enabled">Task 2: Confirm that needed APIs are enabled</h3><ol><li><p>GCP Console &gt; <strong>Navigation menu</strong> &gt; <strong>APIs &amp; Services</strong>.</p><li><p>confirm that both of these APIs are enabled:</p><ul><li>Kubernetes Engine API<li>Container Registry API</ul></ol><blockquote><p>If either API is missing, click <strong>Enable APIs and Services</strong> at the top. Search for the above APIs by name and enable each for your current project. (You noted the name of your GCP project above.)</p></blockquote><h3 id="task-3-start-a-kubernetes-engine-cluster">Task 3: Start a Kubernetes Engine cluster</h3><ol><li>In GCP console, Open Cloud Shell button.</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="c"># place the zone that Qwiklabs assigned you to into an environment variable called MY\_ZONE.</span>
<span class="nb">export </span><span class="nv">MY_ZONE</span><span class="o">=</span>us-central1-a

<span class="c"># Start a Kubernetes cluster managed by Kubernetes Engine.</span>
<span class="c"># Name the cluster **webfrontend** and configure it to run 2 nodes:</span>
<span class="c"># The `gcloud container clusters create` command automatically authenticated `kubectl` for you</span>
gcloud container clusters create webfrontend <span class="se">\</span>
  <span class="nt">--zone</span> <span class="nv">$MY_ZONE</span> <span class="se">\</span>

<span class="c"># check your installed version of Kubernetes using the `kubectl version` command:</span>
kubectl version
<span class="c"># Client Version: version.Info{Major:"1", Minor:"20", GitVersion:"v1.20.2", GitCommit:"faecb196815e248d3ecfb03c680a4507229c2a56", GitTreeState:"clean", BuildDate:"2021-01-13T13:28:09Z", GoVersion:"go1.15.5", Compiler:"gc", Platform:"linux/amd64"}</span>
<span class="c"># Server Version: version.Info{Major:"1", Minor:"17+", GitVersion:"v1.17.14-gke.1600", GitCommit:"7c407f5cc8632f9af5a2657f220963aa7f1c46e7", GitTreeState:"clean", BuildDate:"2020-12-07T09:22:27Z", GoVersion:"go1.13.15b4", Compiler:"gc", Platform:"linux/amd64"}</span>
</pre></table></code></div></div><ol><li>View your running nodes in the GCP Console.<ul><li>On the <strong>Navigation menu</strong> &gt; <strong>Compute Engine &gt; VM Instances</strong><li>Your Kubernetes cluster is now ready for use.</ul></ol><h3 id="task-4-run-and-deploy-a-container">Task 4: Run and deploy a container</h3><ol><li>From your Cloud Shell prompt</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre><td class="rouge-code"><pre>
<span class="c"># launch a single instance of the nginx container. (Nginx is a popular web server.)</span>
kubectl create deploy nginx <span class="nt">--image</span><span class="o">=</span>nginx:1.17.10

<span class="c"># In Kubernetes, all containers run in pods.</span>
<span class="c"># `kubectl create` command caused Kubernetes to create a deployment consisting of a single pod containing the nginx container.</span>
<span class="c"># A Kubernetes deployment keeps a given number of pods up and running even in the event of failures among the nodes on which they run.</span>
<span class="c"># In this command, you launched the default number of pods, which is 1.</span>


<span class="c"># View the pod running the nginx container:</span>
kubectl get pods


<span class="c"># Expose the nginx container to the Internet:</span>
kubectl expose deployment nginx <span class="se">\</span>
  <span class="nt">--port</span> 80 <span class="se">\</span>
  <span class="nt">--type</span> LoadBalancer
<span class="c"># Kubernetes created a service and an external load balancer with a public IP address attached to it.</span>
<span class="c"># The IP address remains the same for the life of the service.</span>
<span class="c"># Any network traffic to that public IP address is routed to pods behind the service: in this case, the nginx pod.</span>


<span class="c"># View the new service:</span>
kubectl get services
<span class="c"># NAME   TYPE     CLUSTER-IP   EXTERNAL-IP  PORT(S)    AGE</span>
<span class="c"># kubernetes ClusterIP  10.51.240.1  &lt;none&gt;   443/TCP    2m56s</span>
<span class="c"># nginx    LoadBalancer 10.51.240.74 35.238.104.4 80:32037/TCP 72s</span>

<span class="c"># use the displayed cluster external IP address to test and contact the nginx container remotely.</span>
<span class="c"># The default home page of the Nginx browser is displayed.</span>


<span class="c"># Scale up the number of pods running on your service:</span>
kubectl scale deployment nginx <span class="se">\</span>
  <span class="nt">--replicas</span> 3

<span class="c"># Confirm that Kubernetes has updated the number of pods:</span>
kubectl get pods
<span class="c"># NAME       READY STATUS      RESTARTS AGE</span>
<span class="c"># nginx-5df596bbf9-f44rf 1/1   Running     0    4s</span>
<span class="c"># nginx-5df596bbf9-jv5tl 0/1   ContainerCreating 0    4s</span>
<span class="c"># nginx-5df596bbf9-lw72z 1/1   Running     0    65s</span>

<span class="c"># Confirm that your external IP address has not changed:</span>
kubectl get services
</pre></table></code></div></div><ol><li>Return to the web browser tab in which you viewed your cluster’s external IP address. Refresh the page to confirm that the nginx web server is still responding.</ol><p><img data-proofer-ignore data-src="https://i.imgur.com/Sdz4hc7.png" alt="Screen Shot 2021-02-10 at 13.14.27" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/L6qokci.png" alt="Screen Shot 2021-02-10 at 13.13.53" /></p><hr /><h2 id="lab5---google-cloud-fundamentals-app-engine">lab5 - Google Cloud Fundamentals: App Engine</h2><ul><li>create and deploy a simple App Engine application using a virtual environment in the Google Cloud Shell.<li>Initialize App Engine.<li>Preview an App Engine application running locally in Cloud Shell.<li>Deploy an App Engine application, so that others can reach it.<li>Disable an App Engine application, when you no longer want it to be visible.</ul><h2 id="set-up-your-lab-environment">Set up your lab environment</h2><blockquote><p>Google Cloud Shell is a virtual machine that is loaded with development tools. It offers a persistent 5GB home directory and runs on the Google Cloud. Google Cloud Shell provides command-line access to your GCP resources.</p></blockquote><ol><li>In GCP console &gt; Open Cloud Shell button</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="c"># **gcloud** is the command-line tool for Google Cloud Platform.</span>
<span class="c"># It comes pre-installed on Cloud Shell and supports tab-completion.</span>

<span class="c"># You can list the active account name with this command:</span>
gcloud auth list
<span class="c"># Credentialed Accounts</span>
<span class="c"># ACTIVE  ACCOUNT</span>
<span class="c"># *   student-01-6fde9fef7b3f@qwiklabs.net</span>


<span class="c"># list the project ID with this command:</span>
gcloud config list project
<span class="c"># [core]</span>
<span class="c"># project = qwiklabs-gcp-01-6b2d0e98cfd3</span>
<span class="c"># Your active configuration is: [cloudshell-21125]</span>
</pre></table></code></div></div><h3 id="task-1-initialize-app-engine">Task 1: Initialize App Engine</h3><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="c"># 1. Initialize your App Engine app with your project and choose its region:</span>
gcloud app create <span class="se">\</span>
    <span class="nt">--project</span><span class="o">=</span><span class="nv">$DEVSHELL_PROJECT_ID</span>

<span class="c"># 2. Clone the source code repository for a sample application in the **hello\_world** directory:</span>
git clone https://github.com/GoogleCloudPlatform/python-docs-samples


<span class="c"># 3. Navigate to the source directory:</span>
<span class="nb">cd </span>python-docs-samples/appengine/standard_python3/hello_world
</pre></table></code></div></div><h3 id="task-2-run-hello-world-application-locally">Task 2: Run Hello World application locally</h3><ol><li>run the Hello World application in a local, virtual environment in Cloud Shell.</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c"># Cloud Shell command prompt.</span>

<span class="c"># 1. Execute the following command to download and update the packages list.</span>
<span class="nb">sudo </span>apt-get update <span class="nt">-y</span>

<span class="c"># 2. Set up a virtual environment in which you will run your application. Python virtual environments are used to isolate package installations from the system.</span>
<span class="nb">sudo </span>apt-get <span class="nb">install </span>virtualenv <span class="nt">-y</span>
virtualenv <span class="nt">-p</span> python3 venv

<span class="c"># 3. Activate the virtual environment.</span>
<span class="nb">source </span>venv/bin/activate

<span class="c"># 4. Navigate to your project directory and install dependencies.</span>
pip <span class="nb">install</span> <span class="nt">-r</span> requirements.txt

<span class="c"># 5. Run the application:</span>
python main.py
</pre></table></code></div></div><ol><li>In <strong>Cloud Shell</strong>, click <strong>Web preview</strong> (<img data-proofer-ignore data-src="https://cdn.qwiklabs.com/7b9oXblGsiFuNK7hmDZjFB%2B7Lrwdv5T64bbmo8X9FAo%3D" alt="Web Preview" />) &gt; <strong>Preview on port 8080</strong> to preview the application.</ol><p>Result:</p><p><img data-proofer-ignore data-src="https://cdn.qwiklabs.com/vTRhzjVoW3LX%2BaFG6ox7ZExJHDQvTdMK8fAyRGBQCDQ%3D" alt="hello_world.png" /></p><ol><li><p>To end the test, return to Cloud Shell and press <strong>Ctrl+C</strong> to abort the deployed service.</p><li><p>Using the Cloud Console, verify that the app is not deployed.</p><ul><li>In the Cloud Console, on the <strong>Navigation menu</strong> &gt; click <strong>App Engine</strong> &gt; <strong>Dashboard</strong>.<li>Notice that no resources are deployed.</ul></ol><h3 id="task-3-deploy-and-run-hello-world-on-app-engine">Task 3: Deploy and run Hello World on App Engine</h3><p>deploy your application to the App Engine Standard environment:</p><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c"># 1. Navigate to the source directory:</span>
<span class="nb">cd</span> ~/python-docs-samples/appengine/standard_python3/hello_world


<span class="c"># 2. Deploy your Hello World application.</span>
gcloud app deploy
<span class="c"># If prompted "Do you want to continue (Y/n)?", press `Y` and then `Enter`.</span>
<span class="c"># This **app deploy** command uses the _app.yaml_ file to identify project configuration.</span>


<span class="c"># 3. Launch your browser to view the app at http://YOUR\_PROJECT\_ID.appspot.com</span>
gcloud app browse
<span class="c"># Did not detect your browser. Go to this link to view your app:</span>
<span class="c"># https://qwiklabs-gcp-01-cb45b5df9cfb.uc.r.appspot.com</span>


<span class="c"># Copy and paste the URL into a new browser window.</span>
</pre></table></code></div></div><ul><li>Result:<ul><li><img data-proofer-ignore data-src="https://cdn.qwiklabs.com/fnmJeOzuz%2BgxMdMg175OIbQRE84kwir5fKVcB1kXihg%3D" alt="disable-app.png" /></ul></ul><h3 id="task-4-disable-the-application">Task 4: Disable the application</h3><blockquote><p>App Engine offers no option to <strong>Undeploy</strong> an application. After an application is deployed, it remains deployed, although you could instead replace the application with a simple page that says something like “not in service.” However, you can disable the application, which causes it to no longer be accessible to users.</p></blockquote><ol><li><p>Cloud Console,&gt; <strong>Navigation menu</strong> &gt; click <strong>App Engine</strong> &gt; <strong>Settings</strong>.</p><li><p>Click <strong>Disable application</strong>.</p><li>Read the dialog message.<ul><li>Enter the <strong>App ID</strong> and click <strong>DISABLE</strong>.</ul><li>If you refresh the browser window you used to view to the application site, you’ll get a 404 error.<ul><li><img data-proofer-ignore data-src="https://cdn.qwiklabs.com/jVzvehqMDLGdJxcGG6aHjrT1zG6SRd443bZo%2BTO383I%3D" alt="f17c85cf862ddae3.png" /></ul></ol><hr /><h2 id="lab6---google-cloud-fundamentals-deployment-manager-and-cloud-monitoring">lab6 - Google Cloud Fundamentals: Deployment Manager and Cloud Monitoring</h2><ul><li>Create a Deployment Manager deployment.<li>Update a Deployment Manager deployment.<li>use it to maintain a consistent state of your deployment<li>View the load on a VM instance using Cloud Monitoring.</ul><h3 id="task-1-sign-in-to-the-google-cloud-platform-gcp-console-4">Task 1: Sign in to the Google Cloud Platform (GCP) Console</h3><h3 id="task-2-confirm-that-needed-apis-are-enabled-1">Task 2: Confirm that needed APIs are enabled</h3><ol><li>GCP Console, on the <strong>Navigation menu</strong> &gt; click <strong>APIs &amp; services</strong><ul><li>confirm that these APIs are enabled:<ul><li>Cloud Deployment Manager v2 API<li>Cloud Runtime Configuration API<li>Cloud Monitoring API</ul></ul></ol><blockquote><p>If one or more APIs is missing, click the <strong>Enable APIs and Services</strong> button at top. Search for the above APIs by name and enable each for your current project. (You noted the name of your GCP project above.)</p></blockquote><h3 id="task-3-create-a-deployment-manager-deployment">Task 3: Create a Deployment Manager deployment</h3><ol><li>GCP console &gt; Open Cloud Shell button &gt; <strong>Continue</strong></ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre><td class="rouge-code"><pre><span class="c"># place the zone that Qwiklabs assigned you to into an environment variable called MY\_ZONE.</span>
<span class="nb">export </span><span class="nv">MY_ZONE</span><span class="o">=</span>us-central1-a


<span class="c"># download an editable Deployment Manager template:</span>
gsutil <span class="nb">cp </span>gs://cloud-training/gcpfcoreinfra/mydeploy.yaml mydeploy.yaml


<span class="c"># use the sed command to</span>
<span class="c"># replace the `PROJECT_ID` placeholder string with your Google Cloud Platform project ID</span>
<span class="nb">sed</span> <span class="nt">-i</span> <span class="nt">-e</span> <span class="s2">"s/PROJECT_ID/</span><span class="nv">$DEVSHELL_PROJECT_ID</span><span class="s2">/"</span> mydeploy.yaml

<span class="c"># replace the `ZONE` placeholder string with your Google Cloud Platform zone</span>
<span class="nb">sed</span> <span class="nt">-i</span> <span class="nt">-e</span> <span class="s2">"s/ZONE/</span><span class="nv">$MY_ZONE</span><span class="s2">/"</span> mydeploy.yaml

<span class="c"># View the `mydeploy.yaml` file, with your modifications, with this command:</span>
<span class="nb">cat </span>mydeploy.yaml


<span class="c"># The file will look something like this:</span>
resources:
- name: my-vm
  <span class="nb">type</span>: compute.v1.instance
  properties:
    zone: us-central1-a
    machineType: zones/us-central1-a/machineTypes/n1-standard-1
    metadata:
      items:
      - key: startup-script
        value: <span class="s2">"apt-get update"</span>
    disks:
    - deviceName: boot
      <span class="nb">type</span>: PERSISTENT
      boot: <span class="nb">true
      </span>autoDelete: <span class="nb">true
      </span>initializeParams:
        sourceImage: https://www.googleapis.com/compute/v1/projects/debian-cloud/global/images/debian-9-stretch-v20201216
    networkInterfaces:
    - network: https://www.googleapis.com/compute/v1/projects/qwiklabs-gcp-00-45b1c5d64828/global/networks/default
      accessConfigs:
      - name: External NAT
        <span class="nb">type</span>: ONE_TO_ONE_NAT


<span class="c"># Build a deployment from the template:</span>
gcloud deployment-manager deployments create my-first-depl <span class="se">\</span>
    <span class="nt">--config</span> mydeploy.yaml
<span class="c"># When the deployment operation is complete</span>
<span class="c"># the **gcloud** command displays a list of the resources named in the template and their current state.</span>
<span class="c"># NAME   TYPE                 STATE      ERRORS  INTENT</span>
<span class="c"># my-vm  compute.v1.instance  COMPLETED  []</span>


</pre></table></code></div></div><ol><li>Confirm that the deployment was successful.<ul><li>In the GCP Console, on the <strong>Navigation menu</strong> &gt; click <strong>Compute Engine &gt; VM instances</strong><li>see that a VM instance called <strong>my-vm</strong> has been created<li>Click on the VM instance’s name to open its VM instance details screen.<li><strong>Custom metadata</strong> section<li>Confirm that the startup script you specified in your Deployment Manager template has been installed.</ul></ol><h3 id="task-4-update-a-deployment-manager-deployment">Task 4: Update a Deployment Manager deployment</h3><ol><li>Return to your Cloud Shell prompt.</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="c"># Launch the `nano` text editor to edit the **mydeploy.yaml** file:</span>
nano mydeploy.yaml

<span class="c"># Find the line that sets the value of the startup script</span>
<span class="s2">"apt-get update; apt-get install nginx-light -y"</span>

<span class="c"># Press **Ctrl+O** and then press **Enter** to save your edited file.</span>
<span class="c"># Press **Ctrl+X** to exit the **nano** text editor.</span>


<span class="c"># let Deployment Manager to update the deployment to install the new startup script:</span>
gcloud deployment-manager deployments update my-first-depl <span class="se">\</span>
    <span class="nt">--config</span> mydeploy.yaml
</pre></table></code></div></div><ol><li>GCP console &gt; <strong>Navigation menu</strong> &gt; click <strong>Compute Engine &gt; VM instances</strong><ul><li>Click on the <strong>my-vm</strong> VM instance’s name to open its <strong>VM instance details</strong> pane<li><strong>Custom metadata</strong> section.<li>Confirm that the startup script has been updated to the value you declared in your Deployment Manager template.</ul></ol><h3 id="task-5-view-the-load-on-a-vm-using-cloud-monitoring">Task 5: View the Load on a VM using Cloud Monitoring</h3><ol><li><p>GCP Console &gt; <strong>Navigation menu</strong> &gt; click <strong>Compute Engine</strong> &gt; <strong>VM instances</strong>.</p><li>Select the checkbox for <strong>my-vm</strong> and click on <strong>STOP</strong>.<ul><li>Click on <strong>STOP</strong> again to confirm.</ul><li>Click on the VM instance’s name to open its VM instance details screen.<ul><li>Click on <strong>EDIT (pencil icon)</strong>.<li>Scroll down to the bottom of the page<li>Service account dropdown.<ul><li>select <strong>Compute Engine default service account</strong></ul><li>Access scopes.<ul><li>Select <strong>Allow full access to all Cloud APIs</strong></ul><li>Click on <strong>Save</strong>.</ul><li><p>restart the VM by clicking on <strong>Start</strong> at the top of the VM instance details screen page.</p><li><p>Click on <strong>START</strong> again to confirm.</p><li><p>GCP Console &gt; <strong>Navigation menu</strong> &gt; click <strong>Compute Engine</strong> &gt; <strong>VM instances</strong>.</p><li>To open a command prompt on the <strong>my-vm</strong> instance<ul><li>click <strong>SSH</strong> in its row in the <strong>VM instances</strong> list.</ul><li>In the ssh session on <strong>my-vm</strong>, execute this command to create a CPU load:</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">dd </span><span class="k">if</span><span class="o">=</span>/dev/urandom | <span class="nb">gzip</span> <span class="nt">-9</span> <span class="o">&gt;&gt;</span> /dev/null &amp;
<span class="c"># This Linux pipeline forces the CPU to work on compressing a continuous stream of random data.</span>
</pre></table></code></div></div><p>Leave the window containing your SSH session open while you proceed with the lab.</p><h2 id="create-a-monitoring-workspace">Create a Monitoring workspace</h2><p>You will now setup a Monitoring workspace that’s tied to your Qwiklabs GCP Project. The following steps create a new account that has a free trial of Monitoring.</p><ol><li><p>Google Cloud Platform Console &gt; <strong>Navigation menu</strong> &gt; <strong>Monitoring</strong>.</p><li>When the Monitoring dashboard opens, your workspace is ready.<ul><li><img data-proofer-ignore data-src="https://cdn.qwiklabs.com/FfS7W1mNXshxngUuea%2BFUBXoXedgDHt0YWk1aZKHiIk%3D" alt="Overview.png" /></ul><li>Click on <strong>Settings</strong> option<ul><li>confirm that the GCP project which Qwiklabs created for you is shown under the <strong>GCP Projects</strong> section.<li><img data-proofer-ignore data-src="https://cdn.qwiklabs.com/P7B0m0egv1%2Br%2Fh4jrrz2IxaaoKyaGvlwsrus%2FmUDjLI%3D" alt="allocated_projects" /></ul><li>Run the commands shown on screen in the SSH window of your VM instance to install both the Monitoring and Logging agents.</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>curl <span class="nt">-sSO</span> https://dl.google.com/cloudagents/install-monitoring-agent.sh
<span class="nb">sudo </span>bash install-monitoring-agent.sh

curl <span class="nt">-sSO</span> https://dl.google.com/cloudagents/install-logging-agent.sh
<span class="nb">sudo </span>bash install-logging-agent.sh
</pre></table></code></div></div><ol><li>Once both of the agents have been installed on your project’s VM,<ul><li>click <strong>Metrics Explorer</strong> under the main Cloud Monitoring menu on the far left.</ul><li>In the <strong>Metric</strong> pane of <strong>Metrics Explorer</strong>, select the resource type <strong>VM instance</strong> and the metric <strong>CPU usage</strong>.<ul><li>In the resulting graph, notice that CPU usage increased sharply a few minutes ago.<li><img data-proofer-ignore data-src="https://i.imgur.com/Fm2mmg9.png" alt="Screen Shot 2021-02-10 at 18.13.43" /></ul><li><p>Terminate your workload generator.</p><li>Return to your ssh session on <strong>my-vm</strong> and enter this command:</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">kill</span> %1
</pre></table></code></div></div><hr /><h2 id="lab7---google-cloud-fundamentals-bigquery">lab7 - Google Cloud Fundamentals: BigQuery</h2><ul><li>Load data from Cloud Storage into BigQuery.<li><p>load a web server log into a BigQuery table</p><li>Perform a query on the data in BigQuery.<li>query it using the BigQuery web user interface and the BigQuery CLI</ul><h3 id="task-1-sign-in-to-the-google-cloud-platform-gcp-console-5">Task 1: Sign in to the Google Cloud Platform (GCP) Console</h3><h3 id="task-2-load-data-from-cloud-storage-into-bigquery">Task 2: Load data from Cloud Storage into BigQuery</h3><ol><li><p>Google Console &gt; <strong>Navigation menu</strong> &gt; click <strong>BigQuery</strong> &gt; click <strong>Done</strong>.</p><li>Create a new dataset within your project<ol><li>selecting your project in the Resources section, then clicking on <strong>CREATE DATASET</strong> on the right.<li>for <strong>Dataset ID</strong>, type <strong>logdata</strong>.<li>For <strong>Data location</strong>, select the continent closest to the region your project was created in.<li>click <strong>Create dataset</strong>.</ol><li>Create a new table in the <strong>logdata</strong> to store the data from the CSV file.<ol><li>Click on <strong>Create Table</strong>.<li>the <strong>Source</strong> section:<ol><li>choose select <strong>Google Cloud Storage</strong>, and in the field, type <code class="language-plaintext highlighter-rouge">gs://cloud-training/gcpfci/access_log.csv</code>.<li>Verify <strong>File format</strong> is set to <strong>CSV</strong>.</ol><li><strong>Note:</strong> When you have created a table previously, the Create from Previous Job option allows you to quickly use your settings to create similar tables.</ol><li>In the <strong>Destination</strong> section:<ul><li>For <strong>Dataset name</strong>, leave <strong>logdata</strong> selected.<li>For <strong>Table name</strong>, type <strong>accesslog</strong>.<li>For <strong>Table type</strong>, <strong>Native table</strong> should be selected.</ul><li>Under <strong>Schema</strong> section<ol><li>for <strong>Auto detect</strong> check the <strong>Schema and input Parameters</strong>.</ol><li>Accept the remaining default values and click <strong>Create Table</strong>.<ul><li>BigQuery creates a load job to create the table and upload data into the table (this may take a few seconds).</ul><li><p>(Optional) To track job progress, click <strong>Job History</strong>.</p><li><p>When the load job is complete, click <strong>logdata</strong> &gt; <strong>accesslog</strong>.</p><li>On the table details page<ol><li>click <strong>Details</strong> to view the table properties<li>click <strong>Preview</strong> to view the table data.</ol></ol><blockquote><p>Each row in this table logs a hit on a web server. The first field, <strong>string_field_0</strong>, is the IP address of the client. The fourth through ninth fields log the day, month, year, hour, minute, and second at which the hit occurred. In this activity, you will learn about the daily pattern of load on this web server.</p></blockquote><h3 id="task-3-perform-a-query-on-the-data-using-the-bigquery-web-ui">Task 3: Perform a query on the data using the BigQuery web UI</h3><blockquote><p>use the BigQuery web UI to query the <strong>accesslog</strong> table you created previously.</p></blockquote><ol><li><p>In the <strong>Query editor</strong> window, type (or copy-and-paste) the following query:</p><li><p>Because you told BigQuery to automatically discover the schema when you load the data, the hour of the day during which each web hit arrived is in a field called <strong>int_field_6</strong>.</p></ol><p>select int64_field_6 as hour, count(*) as hitcount from logdata.accesslog group by hour order by hour</p><blockquote><p>Notice that the Query Validator tells you that the query syntax is valid (indicated by the green check mark) and indicates how much data the query will process. The amount of data processed allows you to determine the price of the query using the <a href="https://cloud.google.com/products/calculator/">Cloud Platform Pricing Calculator</a>.</p></blockquote><ol><li>Click <strong>Run</strong> and examine the results.</ol><h3 id="task-4-perform-a-query-on-the-data-using-the-bq-command">Task 4: Perform a query on the data using the bq command</h3><blockquote><p>use the bq command in Cloud Shell to query the <strong>accesslog</strong> table you created previously.</p></blockquote><ol><li><strong>Google Cloud Platform</strong> Console &gt; click <strong>Activate Cloud Shell</strong> &gt; click <strong>Continue</strong>.</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>bq query <span class="s2">"select string_field_10 as request, count(*) as requestcount from logdata.accesslog group by request order by requestcount desc"</span>
<span class="c"># Waiting on bqjob_r22b5bce3efe1ba12_000001778e4a262f_1 ... (0s) Current status: DONE</span>
<span class="c"># |                request                 | requestcount |</span>
<span class="c"># | GET /store HTTP/1.0                    |       337293 |</span>
<span class="c"># | GET /index.html HTTP/1.0               |       336193 |</span>
<span class="c"># | GET /products HTTP/1.0                 |       280937 |</span>
<span class="c"># | GET /services HTTP/1.0                 |       169090 |</span>
<span class="c"># | GET /products/desserttoppings HTTP/1.0 |        56580 |</span>
<span class="c"># | GET /products/floorwaxes HTTP/1.0      |        56451 |</span>
<span class="c"># | GET /careers HTTP/1.0                  |        56412 |</span>
<span class="c"># | GET /services/turnipwinding HTTP/1.0   |        56401 |</span>
<span class="c"># | GET /services/spacetravel HTTP/1.0     |        56176 |</span>
<span class="c"># | GET /favicon.ico HTTP/1.0              |        55845 |</span>
</pre></table></code></div></div><hr /><h1 id="kubernetes-lab">Kubernetes Lab</h1><p>Lab for <a href="https://www.coursera.org/learn/foundations-google-kubernetes-engine-gke/home/welcome">Architecting with Google Kubernetes Engine: Foundations</a></p><hr /><h2 id="lab1---accessing-the-google-cloud-console-and-cloud-shell">lab1 - Accessing the Google Cloud Console and Cloud Shell</h2><ul><li><p>Learn how to access the Google Cloud Console and Cloud Shell</p><li><p>Become familiar with the Google Cloud Console</p><li><p>Become familiar with Cloud Shell features, including the Cloud Shell code editor</p><li><p>Use the Google Cloud Console and Cloud Shell to create buckets and VMs and service accounts</p><li><p>Perform other commands in Cloud Shell</p></ul><h3 id="task-0-lab-setup">Task 0. Lab Setup</h3><h3 id="task-1-explore-the-google-cloud-console">Task 1. Explore the Google Cloud Console</h3><hr /><h3 id="cloud-storage-create-a-bucket">Cloud Storage: create a bucket</h3><blockquote><p>Cloud Storage buckets must have a globally unique name. easily get a unique name for our bucket by using the ID of the Google Cloud project that Qwiklabs created for us, because Google Cloud project IDs are also globally unique.</p></blockquote><ol><li>Google Cloud Console &gt; <strong>Storage</strong> &gt; <strong>Browser</strong>.<li>Click <strong>Create bucket</strong>.<ol><li>For <strong>Name</strong>, paste in the Google Cloud project ID string you copied in an earlier step.<li>Leave all other values as their defaults.</ol><li>Click <strong>Create</strong>.<ul><li><img data-proofer-ignore data-src="https://i.imgur.com/9IBkRsg.png" alt="Screen Shot 2021-02-11 at 13.52.24" /></ul></ol><blockquote><p>The Google Cloud Console has a <strong>Notifications</strong> (<img data-proofer-ignore data-src="https://cdn.qwiklabs.com/F5kQGlErW%2BjJRPG8ZwXMUKHhAaugHazVETpa1WSg8aM%3D" alt="notifications icon" />) icon. Feedback from the underlying commands is sometimes provided there. You can click the icon to check the notifications for additional information and history.</p></blockquote><hr /><h3 id="create-a-virtual-machine-vm-instance">Create a virtual machine (VM) instance</h3><ol><li>click <strong>Compute Engine</strong> &gt; <strong>VM instances</strong>.<li>Click <strong>Create Instance</strong>.<ol><li>For <strong>Name</strong>: <code class="language-plaintext highlighter-rouge">first-vm</code><li>For <strong>Region</strong>: <code class="language-plaintext highlighter-rouge">us-central1</code>.<li>For <strong>Zone</strong>: <code class="language-plaintext highlighter-rouge">us-central1-c</code>.<li>For <strong>Machine type</strong>, examine the options.<ul><li>The <strong>Machine type:</strong> menu lists the number of virtual CPUs, the amount of memory, and a symbolic name such as <em>e1-standard-1</em>.<li>The symbolic name is the parameter you use to select the machine type when using the <code class="language-plaintext highlighter-rouge">gcloud</code> command to create a VM.<li>To the right of the region, zone, and machine type is a per-month estimated cost.<li>To see the breakdown of estimated costs, click <strong>Details</strong> to the right of the <strong>Machine type</strong> list underneath the estimated costs.<ol><li>For <strong>Machine type</strong>, click <strong>2 vCPUs (e2-standard-2)</strong><li>For <strong>Machine type,</strong> click <strong>e2-micro (2 shared vCPU)</strong>.</ol><li>The micro type is a shared-core VM that is inexpensive.</ul><li>For <strong>Firewall</strong>, click <strong>Allow HTTP traffic</strong>.</ol><li>Leave the remaining settings as their defaults, and click <strong>Create</strong>.</ol><hr /><h3 id="explore-the-vm-details">Explore the VM details</h3><ol><li><strong>VM instances</strong> page, click <code class="language-plaintext highlighter-rouge">first-vm</code>.<li>Locate <strong>CPU platform</strong>, click <strong>Edit</strong>.<ul><li>can’t change the machine type, the CPU platform, or the zone of a running Google Cloud VM.<li>can add network tags and allow specific network traffic from the internet through firewalls.<li>can add disks, determine whether the boot disk is deleted when the instance is deleted.</ul><li>Scroll down and examine<li>Click <strong>Cancel</strong>.</ol><hr /><h3 id="create-an-iam-service-account">Create an IAM service account</h3><ol><li><p><strong>IAM &amp; admin</strong> &gt; <strong>Service accounts</strong>.</p><li>Click <strong>+ Create service account</strong>.<li><strong>Service account details</strong> page,<ol><li><strong>Service account name</strong>: <code class="language-plaintext highlighter-rouge">test-service-account</code>.<li>Click <strong>Create</strong>.</ol><li><strong>Service account permissions</strong> page<ol><li>role as <strong>Project</strong> &gt; <strong>Editor</strong>.<li>Click <strong>Continue</strong>.</ol><li><p>Click <strong>Done</strong>.</p><li><strong>Service accounts</strong> &gt; <code class="language-plaintext highlighter-rouge">test-service-account</code> &gt; click three dots <code class="language-plaintext highlighter-rouge">Action</code>.<ol><li>Click <strong>Create Key</strong>.<li>Select <strong>JSON</strong> as the key type.<li>Click <strong>Create</strong>.<li>Click <strong>Close</strong>.</ol></ol><hr /><h3 id="task-2-explore-cloud-shell">Task 2. Explore Cloud Shell</h3><hr /><h3 id="open-cloud-shell-and-explore-its-features">Open Cloud Shell and explore its features</h3><ol><li><p>click <strong>Activate Cloud Shell</strong> &gt; click <strong>Continue</strong>.</p><ul><li><p><strong>Hide/Restore:</strong> This icon hides and restores the window, giving you full access to the Google Cloud Console without closing Cloud Shell.</p><li><p><strong>Open in new window:</strong> Having Cloud Shell at the bottom of the Google Cloud Console is useful when you are issuing individual commands. But when you edit files or want to see the full output of a command, clicking this icon displays Cloud Shell in a full-sized terminal window.</p><li><p><strong>Close all tabs:</strong> This icon closes Cloud Shell. Every time you close Cloud Shell, the virtual machine is recycled and all machine context is lost. However, data that you stored in your home directory is still available to you the next time you start Cloud Shell.</p></ul></ol><hr /><h3 id="use-cloud-shell-to-set-up-the-environment-variables">Use Cloud Shell to set up the environment variables</h3><blockquote><p>use the following commands to define the environment variables used in this task.</p></blockquote><ol><li>Replace [BUCKET_NAME] with the name of the first bucket from task 1.<li>Replace [BUCKET_NAME_2] with a globally unique name.</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">MY_BUCKET_NAME_1</span><span class="o">=</span>qwiklabs-gcp-03-529929a89c8f
<span class="nv">MY_BUCKET_NAME_2</span><span class="o">=</span>qwiklabs-gcp-03-529929a89c8f_2
<span class="nv">MY_REGION</span><span class="o">=</span>us-central1
</pre></table></code></div></div><hr /><h3 id="move-the-credentials-file-into-cloud-shell">Move the credentials file into Cloud Shell</h3><blockquote><p>You downloaded a JSON-encoded credentials file in an earlier task when you created your first Cloud IAM service account.</p></blockquote><ol><li>On your local workstation<ul><li>locate the JSON key<li>rename the file to <code class="language-plaintext highlighter-rouge">credentials.json</code>.</ul><li><p>In Cloud Shell, click the three dots (<img data-proofer-ignore data-src="https://cdn.qwiklabs.com/5OEwfJEfsSg8zDSsYjmqhsK7fRiAcDrW50FJ0Axw%2Fk8%3D" alt="Three-dot menu icon" />) icon</p><li>Click <strong>Upload file</strong><ul><li>upload the <code class="language-plaintext highlighter-rouge">credentials.json</code> file to the Cloud Shell VM.</ul><li>In Cloud Shell, type <strong>ls</strong> to confirm that the file was uploaded.</ol><hr /><h3 id="create-a-second-cloud-storage-bucket">Create a second Cloud Storage bucket</h3><ol><li>In Cloud Shell<ul><li>use the <code class="language-plaintext highlighter-rouge">gsutil</code> command to create a bucket.<li><code class="language-plaintext highlighter-rouge">gsutil mb gs://$MY_BUCKET_NAME_2</code></ul><li>Google Cloud Console &gt; <strong>Storage</strong> &gt; <strong>Browser</strong> &gt; click <strong>Refresh</strong> if you are already in the Storage Browser.<ul><li>The second bucket should appear in the <strong>Buckets</strong> list.</ul></ol><hr /><h3 id="use-the-gcloud-command-line-to-create-a-second-virtual-machine">Use the gcloud command line to create a second virtual machine</h3><ol><li>create the VM</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="c"># 1. to list all the zones in a given region:</span>
gcloud compute zones list | <span class="nb">grep</span> <span class="nv">$MY_REGION</span>


<span class="c"># 2. Select a zone from the first column of the list.</span>

<span class="c"># 3. store your chosen zone in an environment variable.</span>
<span class="nv">MY_ZONE</span><span class="o">=</span>us-central1-c

<span class="c"># 4. Set this zone to be your default zone by executing the following command.</span>
gcloud config <span class="nb">set </span>compute/zone <span class="nv">$MY_ZONE</span>


<span class="c"># 5. store a name in an environment variable you will use to create a VM.</span>
<span class="nv">MY_VMNAME</span><span class="o">=</span>second-vm


<span class="c"># 6. Create a VM in the default zone that you set earlier in this task using the new environment variable to assign the VM name.</span>
gcloud compute instances create <span class="nv">$MY_VMNAME</span> <span class="se">\</span>
  <span class="nt">--machine-type</span> <span class="s2">"e2-standard-2"</span> <span class="se">\</span>
  <span class="nt">--image-project</span> <span class="s2">"debian-cloud"</span> <span class="se">\</span>
  <span class="nt">--image-family</span> <span class="s2">"debian-9"</span> <span class="se">\</span>
  <span class="nt">--subnet</span> <span class="s2">"default"</span>


<span class="c"># 7. List the virtual machine instances in your project.</span>
gcloud compute instances list
<span class="c"># both your newly created and your first virtual machine in the list.</span>
<span class="c"># NAME       ZONE           MACHINE_TYPE   PREEMPTIBLE  INTERNAL_IP  EXTERNAL_IP    STATUS</span>
<span class="c"># first-vm   us-central1-c  e2-micro                    10.128.0.2   35.239.43.203  RUNNING</span>
<span class="c"># second-vm  us-central1-c  e2-standard-2               10.128.0.3   35.226.88.66   RUNNING</span>
</pre></table></code></div></div><ol><li>Google Cloud Console &gt; <strong>Navigation menu</strong> , click <strong>Compute Engine</strong> &gt; <strong>VM Instances</strong>.<ul><li>see both of the virtual machines created.</ul><li>Look at the <code class="language-plaintext highlighter-rouge">External IP</code> column.<ul><li>the external IP address of the first VM you created is shown as a link. (If necessary, click the <code class="language-plaintext highlighter-rouge">HIDE INFO PANEL</code> button to reveal the <code class="language-plaintext highlighter-rouge">External IP</code> column.)<li>The Google Cloud Console offers the link because you configured this VM’s firewall to allow HTTP traffic.</ul><li>Click the link you found in your VM’s <code class="language-plaintext highlighter-rouge">External IP</code> column.<ul><li>Your browser will present a <code class="language-plaintext highlighter-rouge">Connection refused</code> message in a new browser tab.<li>This message occurs because, although there is a firewall port open for HTTP traffic to your VM, no Web server is running there.<li>Close the browser tab you just created.</ul></ol><hr /><h3 id="create-a-second-service-account">create a second service account</h3><ol><li>In Cloud Shell</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c"># create a new service account:</span>
gcloud iam service-accounts create test-service-account2 <span class="se">\</span>
   <span class="nt">--display-name</span> <span class="s2">"test-service-account2"</span>


<span class="c"># If you see the following output, type **y** and press **ENTER**:</span>
<span class="c"># API [iam.googleapis.com] not enabled on project [560255523887]. Would you like to enable and retry (this will take a few minutes)? (y/N)?</span>
</pre></table></code></div></div><ol><li>Google Cloud Console &gt; <strong>IAM &amp; admin</strong> &gt; <strong>Service accounts</strong>.<ul><li>Refresh the page till you see <strong>test-service-account2</strong>.</ul></ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c"># to grant the second service account the Project viewer role:</span>
gcloud projects add-iam-policy-binding <span class="nv">$GOOGLE_CLOUD_PROJECT</span> <span class="se">\</span>
   <span class="nt">--member</span> serviceAccount:test-service-account2@<span class="k">${</span><span class="nv">GOOGLE_CLOUD_PROJECT</span><span class="k">}</span>.iam.gserviceaccount.com <span class="se">\</span>
   <span class="nt">--role</span> roles/viewer

<span class="c"># `GOOGLE_CLOUD_PROJECT` is an environment variable that is automatically populated in Cloud Shell and is set to the project ID of the current context.</span>
</pre></table></code></div></div><ol><li>Google Cloud Console &gt; <strong>IAM &amp; admin</strong> &gt; <strong>IAM</strong>.<ul><li>Select the new service account called <strong>test-service-account2</strong>.</ul><li>right hand side of the page, click on pencil icon and expand the Viewer role.<ul><li>see <strong>test-service-account2</strong> listed as a member of the Viewer role.</ul></ol><h3 id="task-3-work-with-cloud-storage-in-cloud-shell">Task 3. Work with Cloud Storage in Cloud Shell</h3><h3 id="download-a-file-to-cloud-shell-and-copy-it-to-cloud-storage">Download a file to Cloud Shell and copy it to Cloud Storage</h3><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="c"># 1. Copy a picture of a cat from a Google-provided Cloud Storage bucket to your Cloud Shell.</span>
gsutil <span class="nb">cp </span>gs://cloud-training/ak8s/cat.jpg cat.jpg


<span class="c"># 2. Copy the file into one of the buckets that you created earlier.</span>
gsutil <span class="nb">cp </span>cat.jpg gs://<span class="nv">$MY_BUCKET_NAME_1</span>


<span class="c"># 3. Copy the file from the first bucket into the second bucket:</span>
gsutil <span class="nb">cp </span>gs://<span class="nv">$MY_BUCKET_NAME_1</span>/cat.jpg gs://<span class="nv">$MY_BUCKET_NAME_2</span>/cat.jpg
</pre></table></code></div></div><ol><li>Google Cloud Console &gt; <strong>Storage</strong> &gt; <strong>Browser</strong><ul><li>select the buckets that you created, and verify that both contain the <code class="language-plaintext highlighter-rouge">cat.jpg</code> file.</ul></ol><hr /><h3 id="set-the-access-control-list-for-a-cloud-storage-object">Set the access control list for a Cloud Storage object</h3><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
</pre><td class="rouge-code"><pre><span class="c"># 1. To get the default access list that's been assigned to `cat.jpg`</span>
gsutil acl get gs://<span class="nv">$MY_BUCKET_NAME_1</span>/cat.jpg  <span class="o">&gt;</span> acl.txt
<span class="nb">cat </span>acl.txt
<span class="c"># output shows that anyone with a Project Owner, Editor, or Viewer role for the project has access (Owner access for Owners/Editors and Reader access for Viewers).</span>
<span class="c">#   [</span>
<span class="c">#   {</span>
<span class="c">#     "entity": "project-owners-560255523887",</span>
<span class="c">#     "projectTeam": {</span>
<span class="c">#     "projectNumber": "560255523887",</span>
<span class="c">#     "team": "owners"</span>
<span class="c">#     },</span>
<span class="c">#   gsutil cp gs://cloud-training/ak8s/cat.jpg cat.jpg  "role": "OWNER"</span>
<span class="c">#   },</span>
<span class="c">#   {</span>
<span class="c">#     "entity": "project-editors-560255523887",</span>
<span class="c">#     "projectTeam": {</span>
<span class="c">#     "projectNumber": "560255523887",</span>
<span class="c">#     "team": "editors"</span>
<span class="c">#     },</span>
<span class="c">#     "role": "OWNER"</span>
<span class="c">#   },</span>
<span class="c">#   {</span>
<span class="c">#     "entity": "project-viewers-560255523887",</span>
<span class="c">#     "projectTeam": {</span>
<span class="c">#     "projectNumber": "560255523887",</span>
<span class="c">#     "team": "viewers"</span>
<span class="c">#     },</span>
<span class="c">#     "role": "READER"</span>
<span class="c">#   },</span>
<span class="c">#   {</span>
<span class="c">#     "email": "google12345678_student@qwiklabs.net",</span>
<span class="c">#     "entity": "user-google12345678_student@qwiklabs.net",</span>
<span class="c">#     "role": "OWNER"</span>
<span class="c">#   }</span>
<span class="c">#   ]</span>


<span class="c"># 2. To change the object to have private access, execute the following command:</span>
gsutil acl <span class="nb">set </span>private gs://<span class="nv">$MY_BUCKET_NAME_1</span>/cat.jpg


<span class="c"># 3. To verify the new ACL that's been assigned to `cat.jpg`, execute the following two commands:</span>
gsutil acl get gs://<span class="nv">$MY_BUCKET_NAME_1</span>/cat.jpg  <span class="o">&gt;</span> acl-2.txt
<span class="nb">cat </span>acl-2.txt


<span class="c"># The output should look similar to the following example. Now only the original creator of the object (your lab account) has Owner access.</span>
  <span class="o">[</span>
  <span class="o">{</span>
    <span class="s2">"email"</span>: <span class="s2">"google12345678_student@qwiklabs.net"</span>,
    <span class="s2">"entity"</span>: <span class="s2">"user-google12345678_student@qwiklabs.net"</span>,
    <span class="s2">"role"</span>: <span class="s2">"OWNER"</span>
  <span class="o">}</span>
  <span class="o">]</span>
</pre></table></code></div></div><hr /><h3 id="authenticate-as-a-service-account-in-cloud-shell">Authenticate as a service account in Cloud Shell</h3><ol><li>In Cloud Shell</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
</pre><td class="rouge-code"><pre><span class="c"># 1. execute the following command to view the current configuration:</span>
gcloud config list
<span class="c"># output</span>
<span class="c">#   [component_manager]</span>
<span class="c">#   disable_update_check = True</span>
<span class="c">#   [compute]</span>
<span class="c">#   gce_metadata_read_timeout_sec = 5</span>
<span class="c">#   zone = us-central1-a</span>
<span class="c">#   [core]</span>
<span class="c">#   account = google12345678_student@qwiklabs.net</span>
<span class="c">#   disable_usage_reporting = False</span>
<span class="c">#   project = qwiklabs-Google Cloud-1aeffbc5d0acb416</span>
<span class="c">#   [metrics]</span>
<span class="c">#   environment = devshell</span>
<span class="c">#   Your active configuration is: [cloudshell-16441]</span>


<span class="c"># 2. change the authenticated user to the first service account through the credentials uploaded into Cloud Shell (`credentials.json`).</span>
gcloud auth activate-service-account <span class="nt">--key-file</span> credentials.json
<span class="c"># Cloud Shell is now authenticated as `test-service-account`.</span>


<span class="c"># 3. To verify the active account, execute the following command:</span>
gcloud config list
<span class="c"># output</span>
<span class="c"># The account is now set to the `test-service-account` service account.</span>
<span class="c">#   [component_manager]</span>
<span class="c">#   disable_update_check = True</span>
<span class="c">#   [compute]</span>
<span class="c">#   gce_metadata_read_timeout_sec = 5</span>
<span class="c">#   zone = us-central1-a</span>
<span class="c">#   [core]</span>
<span class="c">#   account = test-service-account@qwiklabs-Google Cloud-1aeffbc5d0acb416.iam.gserviceaccount.com</span>
<span class="c">#   disable_usage_reporting = False</span>
<span class="c">#   project = qwiklabs-Google Cloud-1aeffbc5d0acb416</span>
<span class="c">#   [metrics]</span>
<span class="c">#   environment = devshell</span>
<span class="c">#   Your active configuration is: [cloudshell-16441]</span>


<span class="c"># 4. To verify the list of authorized accounts in Cloud Shell, execute the following command:</span>
gcloud auth list
<span class="c"># **Output**</span>
<span class="c">#                               Credentialed Accounts</span>
<span class="c"># ACTIVE  ACCOUNT</span>
<span class="c">#         student-03-8f6a8a61dece@qwiklabs.net</span>
<span class="c"># *     test-service-account@qwiklabs-gcp-03-529929a89c8f.iam.gserviceaccount.com</span>
<span class="c"># To set the active account, run:</span>
<span class="c">#     $ gcloud config set account `ACCOUNT`</span>


<span class="c"># 5. To verify that the current account (`test-service-account`) cannot access the `cat.jpg` file in the first bucket</span>
gsutil <span class="nb">cp </span>gs://<span class="nv">$MY_BUCKET_NAME_1</span>/cat.jpg ./cat-copy.jpg
<span class="c"># Because you restricted access to this file to the owner earlier in this task you should see output that looks like the following example.</span>
<span class="c"># **Output**</span>
<span class="c">#   Copying gs://test-bucket-123/cat.jpg...</span>
<span class="c">#   AccessDeniedException: 403  KiB]</span>


<span class="c"># 6. Verify that the current account (`test-service-account`) can access the `cat.jpg` file in the second bucket that you created:</span>
gsutil <span class="nb">cp </span>gs://<span class="nv">$MY_BUCKET_NAME_2</span>/cat.jpg ./cat-copy.jpg
<span class="c"># **Output**</span>
<span class="c">#   Copying gs://test-bucket-123/cat.jpg...</span>
<span class="c">#   - [1 files][ 81.7 KiB/ 81.7 KiB]</span>
<span class="c">#   Operation completed over 1 objects/81.7 KiB.</span>


<span class="c"># 7. To switch to the lab account, execute the following command.</span>
<span class="c"># replace `[USERNAME]` with the username provided in the Qwiklabs Connection Details pane left of the lab instructions page. .</span>
gcloud config <span class="nb">set </span>account student-03-8f6a8a61dece@qwiklabs.net


<span class="c"># 8. To verify that you can access the `cat.jpg` file in the [BUCKET_NAME] bucket (the first bucket that you created), execute the following command.</span>
gsutil <span class="nb">cp </span>gs://<span class="nv">$MY_BUCKET_NAME_1</span>/cat.jpg ./copy2-of-cat.jpg
<span class="c"># The lab account created the bucket and object and remained an Owner when the object access control list (ACL) was converted to private, so the lab account can still access the object.</span>
<span class="c"># **Output**</span>
<span class="c">#   Copying gs://test-bucket-123/cat.jpg...</span>
<span class="c">#   - [1 files][ 81.7 KiB/ 81.7 KiB]</span>
<span class="c">#   Operation completed over 1 objects/81.7 KiB.</span>


<span class="c"># 9. Make the first Cloud Storage bucket readable by everyone, including unauthenticated users.</span>
gsutil iam ch allUsers:objectViewer gs://<span class="nv">$MY_BUCKET_NAME_1</span>
<span class="c"># This is an appropriate setting for hosting public website content in Cloud Storage.</span>
</pre></table></code></div></div><ol><li>Google Cloud Console &gt; <strong>Storage</strong> &gt; <strong>Browser</strong>,<ul><li>select the first storage bucket that you created. Notice that the <code class="language-plaintext highlighter-rouge">cat.jpg</code> file has a <code class="language-plaintext highlighter-rouge">Public link</code>. Copy this link.</ul><li>Open an incognito browser tab and paste the link into its address bar.<ul><li>see a picture of a cat.<li>Leave this browser tab open.</ul></ol><h3 id="task-4-explore-the-cloud-shell-code-editor">Task 4. Explore the Cloud Shell code editor</h3><h3 id="open-the-cloud-shell-code-editor">Open the Cloud Shell code editor</h3><ol><li>In Cloud Shell, click the Open in new window icon top right. Then click the pencil icon to open the Cloud Shell code editor.</ol><p><img data-proofer-ignore data-src="https://cdn.qwiklabs.com/%2F0PU9XwgGWyf%2B%2Buf9AiL%2BMqc9SUkbRf1CiEB4fBZl58%3D" alt="Cloud Shell Code Editor icon" /></p><ol><li>In Cloud Shell</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c"># execute the following command to clone a `git` repository:</span>
git clone https://github.com/googlecodelabs/orchestrate-with-kubernetes.git

<span class="c"># create a test directory:</span>
<span class="nb">mkdir test</span>
</pre></table></code></div></div><ul><li>The <code class="language-plaintext highlighter-rouge">orchestrate-with-kubernetes</code> folder appears in the left pane of the Cloud Shell code editor window.<li>The <code class="language-plaintext highlighter-rouge">test</code> folder now appears in the left pane of the Cloud Shell code editor window.<li><img data-proofer-ignore data-src="https://cdn.qwiklabs.com/fIQEgM2apf0RdT0NaGMykEFUnHIOOf0tg0%2BXROt38b4%3D" alt="test-folder-revealed" /></ul><ol><li>In the Cloud Shell code editor, click the arrow to the left of <code class="language-plaintext highlighter-rouge">orchestrate-with-kubernetes</code> to expand the folder.<ul><li><img data-proofer-ignore data-src="https://cdn.qwiklabs.com/sFNhGK6RcH66%2FcbULKE%2Bw2W%2B4CeoAFTFQPWe3M%2F0KeI%3D" alt="expand-folder" /></ul><li>Click the <code class="language-plaintext highlighter-rouge">cleanup.sh</code> file to open it in the right pane of the Cloud Shell code editor window.<ul><li><img data-proofer-ignore data-src="https://cdn.qwiklabs.com/nze4h0R82UGn%2F%2FT%2B9TeGdPHSJbbfHebBnnFvZ39itwc%3D" alt="cleanup" /></ul><li>Add the following text as the last line of the <code class="language-plaintext highlighter-rouge">cleanup.sh</code> file:<ul><li><code class="language-plaintext highlighter-rouge">echo Finished cleanup!</code></ul><li>In Cloud Shell</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c"># execute the following commands to change directory</span>
<span class="nb">cd </span>orchestrate-with-kubernetes

<span class="c"># display the contents of `cleanup.sh`</span>
<span class="nb">cat </span>cleanup.sh
</pre></table></code></div></div><ol><li>In the Cloud Shell code editor, click to open the <code class="language-plaintext highlighter-rouge">File</code> menu and choose <code class="language-plaintext highlighter-rouge">New File</code>.<ul><li>Name the file <code class="language-plaintext highlighter-rouge">index.html</code>.</ul><li>In the right hand pane, paste in this HTML text</ol><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="nt">&lt;html&gt;&lt;head&gt;&lt;title&gt;</span>Cat<span class="nt">&lt;/title&gt;&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;h1&gt;</span>Cat<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"REPLACE_WITH_CAT_URL"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/body&gt;&lt;/html&gt;</span>


<span class="nt">&lt;html&gt;&lt;head&gt;&lt;title&gt;</span>Cat<span class="nt">&lt;/title&gt;&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;h1&gt;</span>Cat<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"https://storage.googleapis.com/qwiklabs-gcp-03-529929a89c8f/cat.jpg"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/body&gt;&lt;/html&gt;</span>


<span class="c">&lt;!-- Replace the string `REPLACE_WITH_CAT_URL` with the URL of the cat image from an earlier task. The URL will look like this: --&gt;</span>
</pre></table></code></div></div><ol><li><p>click <strong>Compute Engine</strong> &gt; <strong>VM instances</strong>.</p><li><p>first VM, click the <code class="language-plaintext highlighter-rouge">SSH</code> button.</p><li><p>In the SSH login window, install the <code class="language-plaintext highlighter-rouge">nginx</code> Web server:</p></ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt-get update
<span class="nb">sudo </span>apt-get <span class="nb">install </span>nginx <span class="nt">-y</span>
</pre></table></code></div></div><ol><li>In your Cloud Shell window,</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="c"># copy the HTML file you created using the Code Editor to your virtual machine:</span>
gcloud compute scp index.html first-vm:index.nginx-debian.html <span class="se">\</span>
   <span class="nt">--zone</span><span class="o">=</span>us-central1-c

<span class="c"># If you are prompted whether to add a host key to your list of known hosts, answer **y**.</span>

<span class="c"># If you are prompted to enter a passphrase, press the **Enter** key to respond with an empty passphrase.</span>
<span class="c"># Press the **Enter** key again when prompted to confirm the empty passphrase.</span>
<span class="c"># Generating public/private rsa key pair.</span>
<span class="c"># Enter passphrase (empty for no passphrase):</span>
<span class="c"># Enter same passphrase again:</span>
<span class="c"># Your identification has been saved in /home/student-03-8f6a8a61dece/.ssh/google_compute_engine.</span>
<span class="c"># Your public key has been saved in /home/student-03-8f6a8a61dece/.ssh/google_compute_engine.pub.</span>
<span class="c"># The key fingerprint is:</span>
<span class="c"># SHA256:6FS+lmJQZ/hVXAI47IvRLpVJUODu4Uk4R5csSGMbYVw student-03-8f6a8a61dece@first-vm</span>
<span class="c"># The key's randomart image is:</span>

<span class="c"># |   .BoE=...oo.. |</span>
<span class="c"># |   +.* o=. ...  |</span>
<span class="c"># |    o *+B+.     |</span>
<span class="c"># |     =.X*.      |</span>
<span class="c"># |    + B=S.      |</span>
<span class="c"># |     Xoooo       |</span>
<span class="c"># |      B.+        |</span>
<span class="c"># |     . o         |</span>
<span class="c"># |                 |</span>

</pre></table></code></div></div><ol><li>In the <strong>SSH</strong> login window for your VM, copy the HTML file from your home directory to the document root of the <code class="language-plaintext highlighter-rouge">nginx</code> Web server:</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo cp </span>index.nginx-debian.html /var/www/html
</pre></table></code></div></div><ol><li>click <strong>Compute Engine</strong> &gt; <strong>VM instances</strong>.<ul><li>Click the link in the <code class="language-plaintext highlighter-rouge">External IP</code> column for your first VM.<li>A new browser tab opens, containing a Web page that contains the cat image.</ul></ol><hr /><h2 id="lab2---working-with-cloud-build">lab2 - Working with Cloud Build</h2><ul><li>Use Cloud Build to build and push containers<li>Use Container Registry to store and deploy containers</ul><hr /><h3 id="task-0-lab-setup-1">Task 0. Lab Setup</h3><hr /><h3 id="task-1-confirm-that-needed-apis-are-enabled">Task 1: Confirm that needed APIs are enabled</h3><ol><li><p>Google Cloud Console &gt; <strong>Navigation menu</strong> &gt; click <strong>APIs &amp; Services</strong>.</p><li><p>Click <strong>Enable APIs and Services</strong>.</p><li><p>In the <strong>Search for APIs &amp; Services</strong> box</p><ul><li>Cloud Build API, <code class="language-plaintext highlighter-rouge">ENABLE</code><li>Container Registry, <code class="language-plaintext highlighter-rouge">ENABLE</code></ul></ol><hr /><h3 id="task-2-building-containers-with-dockerfile-and-cloud-build">Task 2. Building Containers with DockerFile and Cloud Build</h3><ol><li>Google Cloud Console &gt; <strong>Activate Cloud Shell</strong> &gt; <strong>Continue</strong>.</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="c"># Create an empty `quickstart.sh` file using the nano text editor.</span>
nano quickstart.sh
<span class="c">#!/bin/sh</span>
<span class="nb">echo</span> <span class="s2">"Hello, world! The time is </span><span class="si">$(</span><span class="nb">date</span><span class="si">)</span><span class="s2">."</span>
<span class="c"># Save the file and close nano by pressing the **CTRL+X** key, then press **Y** and **Enter**.</span>


<span class="c"># Create an empty `Dockerfile` file using the nano text editor.</span>
nano Dockerfile

FROM alpine
<span class="c"># use the Alpine Linux base image.</span>
COPY quickstart.sh /
<span class="c"># adds the `quickstart.sh` script to the / directory in the image.</span>
CMD <span class="o">[</span><span class="s2">"/quickstart.sh"</span><span class="o">]</span>
<span class="c"># execute the `/quickstart.sh` script when the associated container is created and run.</span>

<span class="c"># to make the `quickstart.sh` script executable.</span>
<span class="nb">chmod</span> +x quickstart.sh


<span class="c"># build the Docker container image in Cloud Build.</span>
gcloud builds submit <span class="se">\</span>
   <span class="nt">--tag</span> gcr.io/<span class="k">${</span><span class="nv">GOOGLE_CLOUD_PROJECT</span><span class="k">}</span>/quickstart-image <span class="nb">.</span>
<span class="c"># **Important**</span>
<span class="c"># Don't miss the dot (".") at the end of the command.</span>
<span class="c"># The dot specifies that the source code is in the current working directory at build time.</span>


<span class="c"># When the build completes, your Docker image is built and pushed to Container Registry.</span>
ID                                    CREATE_TIME                DURATION  SOURCE
            IMAGES                                                          STATUS
e52cca0d-6072-47d9-b3b1-721b4b98413c  2021-02-12T03:42:00+00:00  18S       gs://qwiklabs-gcp-00-49456f0372f9_cloudbuild/source/1613101317.916576-fc83f987943e40a19b0148c1c9
a30352.tgz  gcr.io/qwiklabs-gcp-00-49456f0372f9/quickstart-image <span class="o">(</span>+1 more<span class="o">)</span>  SUCCESS

</pre></table></code></div></div><ol><li>Google Cloud Console &gt; <strong>Navigation menu</strong> &gt; click <strong>Container Registry</strong> &gt; <strong>Images</strong>.<ul><li><img data-proofer-ignore data-src="https://cdn.qwiklabs.com/Qj7SNdo1E4nLPdSjRNkyhEiFDD7wDpfrFR%2BXqJ75GGY%3D" alt="5ea63873c5756db4.png" /><li>The <code class="language-plaintext highlighter-rouge">quickstart-image</code> Docker image appears in the list</ul></ol><h3 id="task-3-building-containers-with-a-build-configuration-file-and-cloud-build">Task 3. Building Containers with a build configuration file and Cloud Build</h3><p>Cloud Build also supports custom build configuration files. In this task you will incorporate an existing Docker container using a custom YAML-formatted build file with Cloud Build.</p><ol><li>In Cloud Shell</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="c"># to clone the repository to the lab Cloud Shell.</span>
git clone https://github.com/GoogleCloudPlatform/training-data-analyst

<span class="c"># Create a soft link as a shortcut to the working directory.</span>
<span class="nb">ln</span> <span class="nt">-s</span> ~/training-data-analyst/courses/ak8s/v1.1 ~/ak8s


<span class="c"># Change to the directory that contains the sample files for this lab.</span>
<span class="nb">cd</span> ~/ak8s/Cloud_Build/a


<span class="c"># A sample custom cloud build configuration file called `cloudbuild.yaml` has been provided for you in this directory as well as copies of the `Dockerfile` and the `quickstart.sh` script you created in the first task.</span>

<span class="c"># view the contents of `cloudbuild.yaml`.</span>
<span class="nb">cat </span>cloudbuild.yaml
<span class="c"># steps:</span>
<span class="c"># - name: 'gcr.io/cloud-builders/docker'</span>
<span class="c">#   args: [ 'build', '-t', 'gcr.io/$PROJECT_ID/quickstart-image', '.' ]</span>
<span class="c"># images:</span>
<span class="c"># - 'gcr.io/$PROJECT_ID/quickstart-image'</span>


<span class="c"># This file instructs Cloud Build to</span>
<span class="c"># use Docker to build an image using the Dockerfile specification in the current local directory, tag it with `gcr.io/$PROJECT_ID/quickstart-image` and then push that image to Container Registry.</span>


<span class="c"># start a Cloud Build using `cloudbuild.yaml` as the build configuration file:</span>
gcloud builds submit <span class="nt">--config</span> cloudbuild.yaml <span class="nb">.</span>
<span class="c"># The build output to Cloud Shell should be the same as before.</span>
<span class="c"># When the build completes, a new version of the same image is pushed to Container Registry.</span>
</pre></table></code></div></div><ol><li>Google Cloud Console &gt; <strong>Navigation menu</strong> &gt; click <strong>Container Registry</strong> &gt; <strong>Images</strong> &gt; click <code class="language-plaintext highlighter-rouge">quickstart-image</code>.<ul><li><img data-proofer-ignore data-src="https://cdn.qwiklabs.com/mylH9Pp%2BcYlbRpVp5HOjGthybnn717ZJhGNy%2BfLA70M%3D" alt="20760c66fe33e5c7.png" /><li>Two versions of <code class="language-plaintext highlighter-rouge">quickstart-image</code> are now in the list.</ul><li>Google Cloud Console &gt; <strong>Navigation menu</strong> &gt; click <strong>Cloud Build</strong> &gt; <strong>History</strong>.<ul><li><img data-proofer-ignore data-src="https://cdn.qwiklabs.com/mqUXBAq%2ByIuDVyD8BONP%2FFdGUQ2tZIx54TnQtTsAhEs%3D" alt="build1.png" /><li>Two builds appear in the list.</ul><li>Click the build ID for the build at the top of the list.<ul><li><img data-proofer-ignore data-src="https://cdn.qwiklabs.com/sFxkQJqyhLEDPzkL12IRlPTETIPOMoV83f3AbQjrZjo%3D" alt="build2.png" /><li>The details of the build, including the build log, are displayed.</ul></ol><h3 id="task-4-building-and-testing-containers-with-a-build-configuration-file-and-cloud-build">Task 4. Building and Testing Containers with a build configuration file and Cloud Build</h3><ol><li>In Cloud Shell</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre><td class="rouge-code"><pre><span class="c"># change to the directory that contains the sample files for this lab.</span>
<span class="nb">cd</span> ~/ak8s/Cloud_Build/b

<span class="nb">cat </span>Dockerfile
<span class="c"># FROM alpine</span>
<span class="c"># COPY quickstart.sh /</span>
<span class="c"># CMD ["/quickstart.sh"]</span>

<span class="nb">cat </span>quickstart.sh
<span class="c"># #!/bin/sh</span>
<span class="c"># if [ -z "$1" ]</span>
<span class="c"># then</span>
<span class="c">#         echo "Hello, world! The time is $(date)."</span>
<span class="c">#         exit 0</span>
<span class="c"># else</span>
<span class="c">#         exit 1</span>
<span class="c"># fi</span>

<span class="nb">cat </span>cloudbuild.yaml
<span class="c"># steps:</span>
<span class="c"># - name: 'gcr.io/cloud-builders/docker'</span>
<span class="c">#   args: [ 'build', '-t', 'gcr.io/$PROJECT_ID/quickstart-image', '.' ]</span>
<span class="c"># - name: 'gcr.io/$PROJECT_ID/quickstart-image'</span>
<span class="c">#   args: ['fail']</span>
<span class="c"># images:</span>
<span class="c"># - 'gcr.io/$PROJECT_ID/quickstart-image'</span>


<span class="c"># In addition to its previous actions, this build configuration file runs the `quickstart-image` it has created.</span>
<span class="c"># In this task, the `quickstart.sh` script has been modified so that it simulates a test failure when an argument `['fail']` is passed to it.</span>


<span class="c"># start a Cloud Build using `cloudbuild.yaml` as the build configuration file:</span>
gcloud builds submit <span class="se">\</span>
   <span class="nt">--config</span> cloudbuild.yaml <span class="nb">.</span>
<span class="c"># **Output (do not copy)**</span>
<span class="c">#     Finished Step #1</span>
<span class="c">#     ERROR</span>
<span class="c">#     ERROR: build step 1 "gcr.io/ivil-charmer-227922klabs-gcp-49ab2930eea05/quickstart-image" failed: exit status 127</span>
<span class="c">#</span>
<span class="c">#     ERROR: (gcloud.builds.submit) build f3e94c28-fba4-4012-a419-48e90fca7491 completed with status "FAILURE"</span>


<span class="c"># 4. Confirm that your command shell knows that the build failed:</span>
<span class="nb">echo</span> <span class="nv">$?</span>


<span class="c"># The command will reply with a non-zero value.</span>
<span class="c"># If you had embedded this build in a script, your script would be able to act up on the build's failure.</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/21gcp/'>21GCP</a>, <a href='/categories/gcplab/'>GCPlab</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/gcp/" class="post-tag no-text-decoration" >GCP</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=GCP - LABs - Grace&url=https://ocholuo.github.io//posts/GCP-Labs/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=GCP - LABs - Grace&u=https://ocholuo.github.io//posts/GCP-Labs/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=GCP - LABs - Grace&url=https://ocholuo.github.io//posts/GCP-Labs/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Amazon-CloudFront/">AWS Lab - AWS CloudFront</a><li><a href="/posts/Alexa-1stSkill/">AWS Alex First Skill - RedVelvet Time</a><li><a href="/posts/NetworkProtocol-SSL-TLS-Handshake/">NetworkProtocol SSL/TLS Handshake</a><li><a href="/posts/pythonCrash/">Python Crash</a><li><a href="/posts/%E4%B8%80%E5%8F%A5%E8%AF%9D%E8%A7%A3%E9%87%8AAWS/">AWS - 一句话解释AWS</a><li><a href="/posts/GKE/">GCP - Google Cloud Computing - Kubernetes and Kubernetes Engine</a><li><a href="/posts/Go-Note/">Go Note</a><li><a href="/posts/SCPs/">AWS - IdenAccessManage - SCPs (Service Control Policies)</a><li><a href="/posts/CompanyBenefit/">Company Benefit</a><li><a href="/posts/Encryption-SSL&TLS/">Cryptography - SSL/TLS Encryption</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/GCP/"><div class="card-body"> <span class="timeago small" >Jan 1, 2021<i class="unloaded">2021-01-01T10:11:11-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GCP - Google Cloud Platform Fundamentals - Core Infrastructure</h3><div class="text-muted small"><p> GCP Google Cloud Platform Fundamentals - Core Infrastructure overview security pricing interact with Google Cloud Open APIs ...</p></div></div></a></div><div class="card"> <a href="/posts/GCP-BigData/"><div class="card-body"> <span class="timeago small" >Jan 1, 2021<i class="unloaded">2021-01-01T10:11:11-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GCP - Big Data</h3><div class="text-muted small"><p> Big Data Google Cloud Big Data Platform Data Ingest Cloud Pub/Sub Store ...</p></div></div></a></div><div class="card"> <a href="/posts/GCP-ML/"><div class="card-body"> <span class="timeago small" >Jan 1, 2021<i class="unloaded">2021-01-01T10:11:11-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GCP - Machine Learning</h3><div class="text-muted small"><p> GCP - Machine Learning overview Machine learning APIs Sight The Cloud Vision API The Cloud Video Intelligence API ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Resource-Manager/" class="btn btn-outline-primary" prompt="Older"><p>GCP - Resource Manager</p></a> <a href="/posts/enable-google-pv/" class="btn btn-outline-primary" prompt="Newer"><p>Enable Google Page Views</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ocholuo">Grace JyL</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ocholuo.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script defer src="/assets/js/dist/pvreport.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-179830187-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-179830187-1'); }); </script>
