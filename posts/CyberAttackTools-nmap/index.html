<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="pv-proxy-endpoint" content="https://myochosite-291718.appspot.com/query?id=ahNwfm15b2Nob3NpdGUtMjkxNzE4chULEghBcGlRdWVyeRiAgIDo14eBCgw"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Meow’s Testing Tools - nmap" /><meta property="og:locale" content="en" /><meta name="description" content="[toc]" /><meta property="og:description" content="[toc]" /><link rel="canonical" href="https://ocholuo.github.io//posts/CyberAttackTools-nmap/" /><meta property="og:url" content="https://ocholuo.github.io//posts/CyberAttackTools-nmap/" /><meta property="og:site_name" content="Grace" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-09-17T11:11:11-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Meow’s Testing Tools - nmap" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-10-30T21:02:21-04:00","datePublished":"2019-09-17T11:11:11-04:00","description":"[toc]","headline":"Meow’s Testing Tools - nmap","mainEntityOfPage":{"@type":"WebPage","@id":"https://ocholuo.github.io//posts/CyberAttackTools-nmap/"},"url":"https://ocholuo.github.io//posts/CyberAttackTools-nmap/"}</script><title>Meow's Testing Tools - nmap | Grace</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Grace"><meta name="application-name" content="Grace"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://myochosite-291718.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://myochosite-291718.appspot.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/huoye.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Grace</a></div><div class="site-subtitle font-italic">2023 Mar 14 updated</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/ocholuo" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Meow's Testing Tools - nmap</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Meow's Testing Tools - nmap</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Grace JyL </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Sep 17, 2019, 11:11 AM -0400" >Sep 17, 2019<i class="unloaded">2019-09-17T11:11:11-04:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Oct 30, 2022, 6:02 PM -0700" >Oct 30, 2022<i class="unloaded">2022-10-30T21:02:21-04:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2930 words">16 min read</span> <span id="pv" class="pageviews"> <i class="fas fa-spinner fa-spin fa-fw"></i> </span> views</div></div><div class="post-content"><p>[toc]</p><hr /><p><img data-proofer-ignore data-src="https://i.imgur.com/a0IeE5F.png" alt="Screen Shot 2020-10-30 at 19.45.35" /></p><h1 id="nmap">Nmap</h1><ul><li>free download, port scan machines.<li>can reveal what services are running as well as info about the target machine’s operating system.<li>17-20 sec<li>can scan a range of IP addresses as well as a single IP.<li><p>set a number of flags (either with the command-line version of nmap or the Windows version) that customize your scan.</p><li>can perform many different types of scans (from simply identifying active machines to port scanning and enumeration)<li>can be configured to control the speed at which a scan operates. In general, the slower the scan, the less likely you are to be discovered.<li>It comes in both a command-line version and a GUI version (Zenmap), works on multiple OS platforms, and can even scan over TCP and UDP.<li>The target can besingle IP address, multiple individual IPs separated by spaces, or an entire subnet range (using CIDR notation).</ul><p><img data-proofer-ignore data-src="https://i.imgur.com/6j7WGaA.png" alt="Screen Shot 2020-09-22 at 21.20.11" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/HgcDLxE.jpg" alt="Nmap-Cheat-Sheet-1" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/6mO8lhp.jpg" alt="page88image152923104" /></p><hr /><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
</pre><td class="rouge-code"><pre>nmap 0.0.0.0
nmap 0.0.0.0 0.0.0.1 0.0.0.2 scanme.nmap.org
nmap 0.0.0.1-125
nmap 0.0.0.0/24
nmap 0.0.0.0/24 <span class="nt">--exclude</span> 0.0.0.3
nmap 0.0.0.0/24 <span class="nt">--excludefile</span> list.txt
nmap scanme.nmap.org
nmap nmap.org/29
nmap <span class="nt">-O</span> scanme.nmap.org
nmap <span class="nt">-iL</span> targetlist.txt
nmap <span class="nt">-iR</span> 20  <span class="c"># random select 20</span>

Nmap                              Port Selection
Scan a single Port	              nmap <span class="nt">-p</span> 22 192.168.1.1
Scan a range of ports	            nmap <span class="nt">-p</span> 1-100 192.168.1.1
Scan 100 most common ports <span class="o">(</span>Fast<span class="o">)</span>	nmap <span class="nt">-F</span> 192.168.1.1
Scan all 65535 ports            	nmap <span class="nt">-p-</span> 192.168.1.1


<span class="c"># Nmap Output Formats</span>
nmap 0.0.0.1 <span class="nt">-oN</span> output.txt <span class="c"># normal output</span>
nmap 0.0.0.1 <span class="nt">-oX</span> output.xml <span class="c"># xml</span>
nmap 0.0.0.1 <span class="nt">-oG</span> output.txt
nmap 0.0.0.1 <span class="nt">-oA</span> output     <span class="c"># 3 mainfile type, gnmap, nmap, xml</span>
nmap <span class="nt">-oA</span> output.txt 0.0.0.1 <span class="nt">-O</span>


nmap <span class="nt">-sO</span> <span class="c"># IP protocol scan</span>


nmap <span class="nt">-O</span> <span class="nt">-v</span> 0.0.0.1 <span class="nt">-oA</span> output.txt   <span class="c"># detail, verbositive level</span>
nmap <span class="nt">-O</span> <span class="nt">-vv</span> 0.0.0.1 <span class="nt">-oA</span> output.txt

nmap <span class="nt">-F</span> 0.0.0.1-50      <span class="c"># fast mode. 100 most popular port</span>
nmap <span class="nt">-T4</span> <span class="nt">-A</span> <span class="nt">-v</span> 0.0.0.0  <span class="c"># advanced</span>

nmap <span class="nt">-sn</span> 0.0.0.0 <span class="c"># fast ping swipe</span>
nmap <span class="nt">-sS</span> <span class="c"># TCP SYN scan</span>
nmap <span class="nt">-sS</span> <span class="nt">-p</span> 80 <span class="nt">-T2</span> <span class="nt">-iR</span> 50
nmap <span class="nt">-sA</span> <span class="c"># TCP ACK scan</span>
nmap <span class="nt">-sT</span> <span class="c"># TCP connection scan</span>
nmap <span class="nt">-sY</span> <span class="c"># SCTP INIT scan</span>
nmap <span class="nt">-sW</span> <span class="c"># TCP Window scan</span>
nmap <span class="nt">-sM</span> <span class="c"># TCP Maimon scan</span>

nmap <span class="nt">-sU</span> <span class="c"># UDP scan</span>
nmap <span class="nt">-sU</span> <span class="nt">-p</span> 53,88,123,137,138 0.0.0.0

nmap <span class="nt">-sN</span> <span class="c"># Null scan</span>
nmap <span class="nt">-sF</span> <span class="c"># FIN scan REST=livehost</span>
nmap <span class="nt">-sX</span> 0.0.0.0 <span class="c"># Xmas scan push urgent=1</span>
nmap <span class="nt">-b</span> <span class="c"># FTP Bounce scan</span>

<span class="nt">-Pn</span> <span class="c"># don't ping before scanning</span>
nmap <span class="nt">-sn</span> <span class="nt">-PE</span> <span class="c"># ICMP ping</span>
<span class="nt">-PP</span> <span class="c"># ICMP timestamp request</span>
<span class="nt">-PM</span> <span class="c"># ICMP netmask request</span>
<span class="nt">-PA</span> <span class="c"># ACK ping</span>
<span class="nt">-PS</span> <span class="c"># SYN ping</span>
<span class="nt">-PU</span> <span class="c"># UDP probes</span>
<span class="nt">-PY</span> <span class="c"># SCTP INIT ping probes</span>

<span class="nt">-d</span>             <span class="c"># debugging level</span>
<span class="nt">--packet-trace</span> <span class="c"># Packet trace</span>
<span class="nt">-r</span>             <span class="c"># disable randomizing scanned ports</span>
<span class="nt">--traceroute</span>   <span class="c"># traceroute to targets</span>
<span class="nt">--max-retries</span>  <span class="c"># Max Retries</span>


nmap <span class="nt">-v</span> <span class="nt">--script</span> whois-ip emailheaderip
nmap <span class="nt">-v</span> <span class="nt">--script</span> whois-domain header.from<span class="o">(</span>trophtdepot.com<span class="o">)</span>
nmap <span class="nt">-T4</span> <span class="nt">-O</span> <span class="nt">--script</span> smb-os-discovery, whois-domain header.from<span class="o">(</span>0.0.0.0<span class="o">)</span>
<span class="c"># A scan to search for DDOS reflection UDP services</span>
Scan <span class="k">for </span>UDP DDOS reflectors	nmap –sU –A –PN –n –pU:19,53,123,161 –script<span class="o">=</span>ntp-monlist,dns-recursion,snmp-sysdescr 192.168.1.0/24
<span class="c"># HTTP Service Information</span>
Gather page titles from HTTP services	nmap <span class="nt">--script</span><span class="o">=</span>http-title 192.168.1.0/24
Get HTTP headers of web services     	nmap <span class="nt">--script</span><span class="o">=</span>http-headers 192.168.1.0/24
Find web apps from known paths       	nmap <span class="nt">--script</span><span class="o">=</span>http-enum 192.168.1.0/24
<span class="c"># Detect Heartbleed SSL Vulnerability</span>
nmap <span class="nt">-sV</span> <span class="nt">-p</span> 443 <span class="nt">--script</span><span class="o">=</span>ssl-heartbleed 192.168.1.0/24
<span class="c"># Find Information about IP address</span>
nmap <span class="nt">--script</span><span class="o">=</span>asn-query,whois,ip-geolocation-maxmind 192.168.1.0/24

nmap <span class="nt">-6</span> <span class="nt">--hop-limit</span>
nmap <span class="nt">-6</span> <span class="nt">-S</span> <span class="nb">source </span>target
nmap <span class="nt">-6</span> 0.0.0.0
nmap <span class="nt">--ipv6</span> 0.0.0.0


<span class="c"># Service and OS Detection</span>
Detect OS and Services	          nmap <span class="nt">-A</span> 192.168.1.1
Standard service detection       	nmap <span class="nt">-sV</span> 192.168.1.1
More aggressive Service Detection	nmap <span class="nt">-sV</span> <span class="nt">--version-intensity</span> 5 192.168.1.1
Lighter banner grabbing detection	nmap <span class="nt">-sV</span> <span class="nt">--version-intensity</span> 0 192.168.1.1

</pre></table></code></div></div><hr /><ul><li><code class="language-plaintext highlighter-rouge">s</code>: determine the type of scan to perform,<ul><li>run a SYN port scan on a target as quietly as possible. ￼<ul><li><code class="language-plaintext highlighter-rouge">namap 111.111.11.1/24 -sS T0</code></ul><li>wanted an aggressive XMAS scan. ￼<ul><li><code class="language-plaintext highlighter-rouge">namap 111.111.11.1/24 -sX T4</code></ul></ul><li><code class="language-plaintext highlighter-rouge">P</code>: set up ping sweep options,<li><code class="language-plaintext highlighter-rouge">o</code>: deal with output.<li><code class="language-plaintext highlighter-rouge">T</code>: deal with speed and stealth, with the serial methods taking the longest amount of time.<ul><li>Parallel methods are much faster because they run multiple scans simultaneously.<li>Again, the slower you run scans, the less likely you are to be discovered. The choice of which one to run is yours.<li>slower being better, paranoid and sneaky scans can take exceedingly long times to complete.<li>Nmap at very fast (-T5) speeds, you’ll overwhelm your NIC and start getting some really weird results.<li>default: -T3, “normal.”</ul><li>Upon successful response from the targeted host,<ul><li>If the command successfully finds a live host, it returns a message indicating that the IP address of the targeted host is up, along with the media access control (MAC) address and the network card vendor.<li><code class="language-plaintext highlighter-rouge">nmap –sn –v &lt;target IP address&gt;</code></ul><li>Nmap in a nutshell, offers Host discovery, Port discovery, Service discovery. Operating system version information. Hardware (MAC) address information, Service version detection, Vulnerability &amp; exploit detection using Nmap scripts (NGE).<ul><li><code class="language-plaintext highlighter-rouge">nmap –sn –PE –PA &lt;port numbers&gt; &lt;Starting IP/ending IP&gt;</code></ul><li>output to a file:<ul><li><code class="language-plaintext highlighter-rouge">nmap 1.1.1.1 &gt; result.txt</code></ul></ul><p>Nmap handles all scan types we discussed in the previous section, using switches identified earlier. In addition to those listed, Nmap offers a “Windows” scan.</p><ul><li>It works like the ACK scan but is intended for use on Windows networks<li>provides all sorts of information on open ports.<li>Many more switches and options are available for the tool.</ul><p>NOTE Port sweeping and enumeration on a machine is also known as fingerprinting, although the term is normally associated with examining the OS itself. You can fingerprint operating systems with several tools we’ve discussed already, along with goodies such as SolarWinds, Netcraft, and HTTrack.</p><hr /><h2 id="install">install</h2><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c"># for mac</span>
<span class="nb">install </span>homebrew
brew update
brew upgrade
brew <span class="nb">install </span>wget
brew <span class="nb">install </span>nmap
brew <span class="nb">install </span>Zenmap

</pre></table></code></div></div><hr /><h2 id="os-detect-nmap-o">os detect [nmap –O]</h2><p><code class="language-plaintext highlighter-rouge">nmap –O [目標IP]</code></p><ul><li>作業系統偵測的方式<li>使用TTL來大致判斷作業系統的類型<li>NMAP也可使用<code class="language-plaintext highlighter-rouge">TCP/IP stack fingerprinting</code>進行遠端作業系統識別<ul><li>NMAP會送出一系列的 TCP 和 UDP 封包到目標主機<li>檢驗回傳(response)的每一個bit。<li>在一連串的測試結果回傳後，NMAP會把這些資料拿去 nmap-os-db 的資料庫比對，他的資料庫中有超過2600種以上類型的作業系統資料，<li>NMAP若在資料庫中找到相符資訊，就會顯示出來。</ul></ul><p>每一個fingerprint都包含了一些作業系統的文字描述，並可以用來分類供應商(Sun/Microsoft), 作業系統(Solaris/Microsoft Windows), 版本 (10/2016), 及設備類型(route/switch..) 最常見的包含Common Platform Enumeration (CPE) representation例如: cpe:/o:linux:linux_kernel:2.6.</p><p>作業系統偵測會採用其他蒐集資料的方式</p><ul><li>例如<code class="language-plaintext highlighter-rouge">TCP Sequence Predictability Classification</code>，這個測量標準取決於TCP的連線有多難建立。<li>另外一個作業系統探測的方式，目標主機的開機的時間，使用了TCP的時間戳記來判斷機器上次是何時重新啟動。雖然這種方式有可能因為計數器沒有歸零而不準確，但仍舊是判斷的標準之一。</ul><p><img data-proofer-ignore data-src="https://i.imgur.com/UVlEJMN.jpg" alt="20119885QKelRVIEdE" /></p><p>Windows 上面開啟的 WireShark也可以看到不同的封包送過來</p><p><img data-proofer-ignore data-src="https://i.imgur.com/V2XpawD.jpg" alt="201198859tIIAzVaG3" /></p><p>掃描 RedHat 的結果</p><p><img data-proofer-ignore data-src="https://i.imgur.com/gRls3fj.jpg" alt="201198850drjWEiMmG" /></p><p>結果會用「猜的」並配上百分比,非常準確。</p><p><img data-proofer-ignore data-src="https://i.imgur.com/ZWbXAiQ.jpg" alt="20119885iaQWJN3ocm" /></p><hr /><h2 id="nmap-output">Nmap output</h2><ul><li>The GUI version of the tool, <code class="language-plaintext highlighter-rouge">Zenmap</code>, makes reading this output easy<li>the output is available via several methods.<li>The default is called interactive, and it is sent to standard output (text sent to the terminal). Normal output displays less run-time information and fewer warnings because it is expected to be analyzed after the scan completes rather than interactively.<li>You can also send output as XML (which can be parsed by graphical user interfaces or imported into databases) or in a “greppable” format (for easy searching).</ul><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>
<span class="nv">$ </span>nmap scanme.nmap.org
Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-10-30 19:39 EDT
Nmap scan report <span class="k">for </span>scanme.nmap.org <span class="o">(</span>45.33.32.156<span class="o">)</span>
Host is up <span class="o">(</span>0.11s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 992 closed ports
PORT      STATE    SERVICE
22/tcp    open     ssh
25/tcp    filtered smtp
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>23.08 seconds

nmap <span class="nt">-sS</span> 127.0.0.1
Starting Nmap 4.01 at 2006-07-06 17:23 BST
Interesting ports on chaos <span class="o">(</span>127.0.0.1<span class="o">)</span>:
<span class="o">(</span>The 1668 ports scanned but not shown below are <span class="k">in </span>state: closed<span class="o">)</span>
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
Nmap finished: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>0.207 seconds

</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://i.imgur.com/ZaGR0fp.jpg" alt="page89image152295312" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/Gk9c2A8.png" alt="Screen Shot 2020-09-22 at 21.22.01" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/p0btjP5.png" alt="Screen Shot 2020-09-22 at 21.23.12" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/5yeUsUI.png" alt="Screen Shot 2020-09-22 at 21.23.26" /></p><hr /><h2 id="basic-scan-types--st--ss">Basic Scan Types [-sT, -sS]</h2><p>The two basic scan types used most in Nmap are</p><ol><li>TCP connect() scanning [-sT]<li>SYN scanning (half-open / stealth scanning) [-sS].</ol><p>The sample below shows a SYN scan and a FIN scan, performed against a Linux system.</p><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>nmap <span class="nt">-sS</span> 127.0.0.1
Starting Nmap 4.01 at 2006-07-06 17:23 BST
Interesting ports on chaos <span class="o">(</span>127.0.0.1<span class="o">)</span>:
<span class="o">(</span>The 1668 ports scanned but not shown below are <span class="k">in </span>state: closed<span class="o">)</span>
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
Nmap finished: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>0.207 seconds


nmap <span class="nt">-sF</span> 127.0.0.1
Starting Nmap 4.01 at 2006-07-06 17:23 BST
Interesting ports on chaos <span class="o">(</span>127.0.0.1<span class="o">)</span>:
<span class="o">(</span>The 1668 ports scanned but not shown below are <span class="k">in </span>state:closed<span class="o">)</span>
PORT     STATE         SERVICE
21/tcp   open|filtered ftp
22/tcp   open|filtered ssh
Nmap finished: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>1.284
</pre></table></code></div></div><hr /><h3 id="tcp-connect-scan--st">TCP connect() Scan [-sT]</h3><ul><li>These scans are so called because UNIX sockets programming uses a system call named <code class="language-plaintext highlighter-rouge">connect()</code> to begin a TCP connection to a remote site.<ul><li>If <code class="language-plaintext highlighter-rouge">connect()</code> succeeds, connection made.<li>If it fails, the connection could not be made<ul><li>the remote system is offline<li>the port is closed<li>some other error occurred along the way</ul></ul><li>This allows a basic type of port scan<ul><li>attempts to connect to every port in turn<li>notes whether or not the connection succeeded.<li>Once the scan is completed<ul><li>ports to which a connection could be established are listed as <code class="language-plaintext highlighter-rouge">open</code><li>the rest are said to be <code class="language-plaintext highlighter-rouge">closed</code>.</ul></ul></ul><p>pros:</p><ol><li>very effective, provides a clear picture of the ports you can and cannot access.<ul><li>If a connect() scan lists a port as open, you can definitely connect to it</ul></ol><p>major drawback</p><ol><li>very easy to detect on the system being scanned.<ul><li>If a firewall or intrusion detection system is running on the victim<li>attempts to <code class="language-plaintext highlighter-rouge">connect()</code> to every port on the system will almost always trigger a warning.<li>modern firewalls, attempt to connect to a single port (which has been blocked or has not been specifically “opened”) will usually result in the <code class="language-plaintext highlighter-rouge">connection attempt being logged</code>.<li>most servers will log connections and their source IP<li>it would be easy to detect the source of a <code class="language-plaintext highlighter-rouge">TCP connect() scan</code>.</ul></ol><hr /><h3 id="syn-stealth-scan--ss">SYN Stealth Scan [-sS]</h3><p>For this reason, the TCP Stealth Scan was developed.</p><ul><li>When a TCP connection is made between two systems, a process known as a “three way handshake” occurs. This involves the exchange of three packets, and synchronises the systems with each other (necessary for the error correction built into TCP.<li>The system initiating the connection sends a packet to the system it wants to connect to. TCP packets have a header section with a flags field. Flags tell the receiving end something about the type of packet, and thus what the correct response is.<li>four possible flags.<ul><li>SYN (Synchronise), ACK (Acknowledge), FIN (Finished) and RST (Reset).<li><code class="language-plaintext highlighter-rouge">SYN</code> packets include a <code class="language-plaintext highlighter-rouge">TCP sequence number</code>: lets the remote system know what sequence numbers to expect in subsequent communication.<li><code class="language-plaintext highlighter-rouge">ACK</code> acknowledges receipt of a packet or set of packets,<li><code class="language-plaintext highlighter-rouge">FIN</code>: when a communication is finished, requesting that the connection be closed<li><code class="language-plaintext highlighter-rouge">RST</code>: when the connection is to be reset (closed immediately)</ul></ul><p><strong>SYN / Stealth scanning</strong> makes use of this procedure by sending a SYN packet and looking at the response.</p><ol><li>the port is open<ul><li><code class="language-plaintext highlighter-rouge">SYN/ACK</code> is sent back<li>the remote end is trying to open a TCP connection.<li>The scanner then sends an <code class="language-plaintext highlighter-rouge">RST</code> to tear down the connection before it can be established fully; often preventing the connection attempt appearing in application logs.</ul><li>the port is closed<ul><li><code class="language-plaintext highlighter-rouge">RST</code> will be sent back</ul><li>it is filtered<ul><li><code class="language-plaintext highlighter-rouge">no response</code> will be sent back<li>the SYN packet will have been dropped and no response will be sent.</ul></ol><p>In this way, Nmap can detect three port states</p><ul><li>open, closed and filtered.<li>Filtered ports may require further probing since they could be subject to firewall rules which render them open to some IPs or conditions, and closed to others.</ul><p>Modern firewalls and Intrusion Detection Systems can detect SYN scans, but in combination with other features of Nmap, it is possible to create a virtually undetectable SYN scan by altering timing and other options (explained later).</p><hr /><h3 id="fin-null-and-xmas-tree-scans--sf--sn--sx">FIN, Null and Xmas Tree Scans [-sF, -sN, -sX]</h3><p>Each scan type refers to the flags set in the TCP header.</p><ul><li>a <strong>closed port</strong> should respond with an <code class="language-plaintext highlighter-rouge">RST</code> upon receiving packets<li>an <strong>open port</strong> should <code class="language-plaintext highlighter-rouge">just drop them</code> (it’s listening for packets with SYN set).<li>This way, you never make even part of a connection, and never send a SYN packet (what most IDS’ look out for).</ul><ol><li>The FIN scan sends a packet with only the <code class="language-plaintext highlighter-rouge">FIN</code> flag set,<li>the Xmas Tree scan sets the <code class="language-plaintext highlighter-rouge">FIN, URG and PUSH</code> flags<li>the Null scan sends a packet <code class="language-plaintext highlighter-rouge">with no flags</code> switched on.</ol><p>These scan types will work against any system where the TCP/IP implementation follows RFC 793.</p><ul><li>Microsoft Windows does not follow the RFC, and will ignore these packets even on closed ports.<li>to detect an MS Windows system<ul><li>running SYN along with one of these scans.<li>If the SYN scan shows open ports, and the FIN/NUL/XMAS does not, chances are you’re looking at a Windows box<li>(OS Fingerprinting is much more reliable way)</ul></ul><hr /><h2 id="ping-scan--sp">Ping Scan [-sP]</h2><ul><li>lists the hosts within the specified range that responded to a ping.<li>to detect which computers are online, rather than which ports are open.</ul><p>Four methods exist within Nmap for ping sweeping.</p><ol><li>sends an <code class="language-plaintext highlighter-rouge">ICMP ECHO REQUEST (ping request) packet</code> to the destination system.<ul><li><code class="language-plaintext highlighter-rouge">ICMP ECHO REPLY</code> received, the system is up, and ICMP packets are not blocked.<li><code class="language-plaintext highlighter-rouge">no response</code> to the ICMP ping, Nmap will try a “TCP Ping”, to determine whether ICMP is blocked, or if the host is really not online.</ul><li>sends either a <code class="language-plaintext highlighter-rouge">SYN or an ACK packet</code> to any port (80 default) on the remote system.<ul><li><code class="language-plaintext highlighter-rouge">RST or a SYN/ACK</code> is returned, then the remote system is online.<li>If the remote system <code class="language-plaintext highlighter-rouge">does not respond</code>, either it is offline, or the chosen port is filtered, and thus not responding to anything.</ul><li>run an Nmap ping scan as root, the default is to use the <code class="language-plaintext highlighter-rouge">ICMP and ACK methods</code>.<li>Non-root users will use the <code class="language-plaintext highlighter-rouge">connect() method</code>, which attempts to connect to a machine, waiting for a response, and tearing down the connection as soon as it has been established (similar to the SYN/ACK method for root users, but this one establishes a full TCP connection!)</ol><p>The ICMP scan type can be disabled by setting <code class="language-plaintext highlighter-rouge">-P0</code></p><hr /><h2 id="udp-scan--su">UDP Scan [-sU]</h2><p>Nmap sends 0-byte UDP packets to each target port on the victim.</p><ul><li>Receipt of an <code class="language-plaintext highlighter-rouge">ICMP Port Unreachable</code> message signifies the port is closed<li>otherwise it is assumed open.</ul><p>disadvantage</p><ol><li>when a firewall blocks outgoing ICMP Port Unreachable messages, the port will appear open.<ul><li>false-positives are hard to distinguish from real open ports.</ul><li>the speed at which it can be performed.<ul><li>Most operating systems limit the number of <code class="language-plaintext highlighter-rouge">ICMP Port Unreachable messages</code> which can be generated in a certain time period<ul><li>thus slowing the speed of a UDP scan.</ul><li>Nmap adjusts its scan speed accordingly to avoid flooding a network with useless packets.<li><strong>Microsoft do not limit the <code class="language-plaintext highlighter-rouge">Port Unreachable error</code> generation frequency</strong><ul><li>thus it is easy to scan a Windows machine’s 65,535 UDP Ports in very little time!!</ul></ul></ol><p>UDP Scanning is not usually useful for most types of attack, but it can reveal information about services or trojans which rely on UDP, for example SNMP, NFS, the Back Orifice trojan backdoor and many other exploitable services.</p><p>Most modern services utilise TCP, and thus UDP scanning is not usually included in a pre-attack information gathering exercise unless a TCP scan or other sources indicate that it would be worth the time taken to perform a UDP scan.</p><hr /><p>ref:</p><ul><li><a href="https://nmap.org/bennieston-tutorial/">nmap</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/10cyberattack/'>10CyberAttack</a>, <a href='/categories/cyberattacktools/'>CyberAttackTools</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/cyberattack/" class="post-tag no-text-decoration" >CyberAttack</a> <a href="/tags/cyberattacktools/" class="post-tag no-text-decoration" >CyberAttackTools</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Meow's Testing Tools - nmap - Grace&url=https://ocholuo.github.io//posts/CyberAttackTools-nmap/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Meow's Testing Tools - nmap - Grace&u=https://ocholuo.github.io//posts/CyberAttackTools-nmap/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Meow's Testing Tools - nmap - Grace&url=https://ocholuo.github.io//posts/CyberAttackTools-nmap/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Amazon-CloudFront/">AWS Lab - AWS CloudFront</a><li><a href="/posts/Alexa-1stSkill/">AWS Alex First Skill - RedVelvet Time</a><li><a href="/posts/NetworkProtocol-SSL-TLS-Handshake/">NetworkProtocol SSL/TLS Handshake</a><li><a href="/posts/pythonCrash/">Python Crash</a><li><a href="/posts/%E4%B8%80%E5%8F%A5%E8%AF%9D%E8%A7%A3%E9%87%8AAWS/">AWS - 一句话解释AWS</a><li><a href="/posts/GKE/">GCP - Google Cloud Computing - Kubernetes and Kubernetes Engine</a><li><a href="/posts/Go-Note/">Go Note</a><li><a href="/posts/SCPs/">AWS - IdenAccessManage - SCPs (Service Control Policies)</a><li><a href="/posts/CompanyBenefit/">Company Benefit</a><li><a href="/posts/Encryption-SSL&TLS/">Cryptography - SSL/TLS Encryption</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/CyberAttackTools-Burpsuite/"><div class="card-body"> <span class="timeago small" >Sep 17, 2019<i class="unloaded">2019-09-17T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Meow's Testing Tools - Burpsuite</h3><div class="text-muted small"><p> [toc] Burpsuite test web: www.dvwa.co.uk Testing workflow SQL injection UPDATE, INSERT, SELECT, ORDER BY retrieve hidden data: input: Gifts http://web/products...</p></div></div></a></div><div class="card"> <a href="/posts/CyberAttackTools-CainandAbel/"><div class="card-body"> <span class="timeago small" >Sep 17, 2019<i class="unloaded">2019-09-17T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Meow's Testing Tools - Cain and Abel</h3><div class="text-muted small"><p> Cain and Abel [toc] basic Cain and Abel a Windows-based password recovery tool. have many features that can allow Network Sniffing and Hijacking of IP traffic between hosts. Many other ...</p></div></div></a></div><div class="card"> <a href="/posts/CyberAttackTools-JohntheRipper/"><div class="card-body"> <span class="timeago small" >Sep 17, 2019<i class="unloaded">2019-09-17T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Meow's Testing Tools - John the Ripper</h3><div class="text-muted small"><p> John the Ripper [toc] John the Ripper [toc] John the Ripper offline password cracking tool works on files that have been grabbed from original source. different modes used to crack ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/CyberAttackTools-nikto/" class="btn btn-outline-primary" prompt="Older"><p>Meow's Testing Tools - Nikto</p></a> <a href="/posts/CyberAttackTools-postman/" class="btn btn-outline-primary" prompt="Newer"><p>Meow's Testing Tools - Postman</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ocholuo">Grace JyL</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ocholuo.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script defer src="/assets/js/dist/pvreport.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-179830187-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-179830187-1'); }); </script>
