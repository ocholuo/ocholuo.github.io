<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="pv-proxy-endpoint" content="https://myochosite-291718.appspot.com/query?id=ahNwfm15b2Nob3NpdGUtMjkxNzE4chULEghBcGlRdWVyeRiAgIDo14eBCgw"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="LFCE.3 Network and Host Security" /><meta property="og:locale" content="en" /><meta name="description" content="LFCE: Network and Host Security" /><meta property="og:description" content="LFCE: Network and Host Security" /><link rel="canonical" href="https://ocholuo.github.io//posts/LFCE.3.NetworkandHostSecurity/" /><meta property="og:url" content="https://ocholuo.github.io//posts/LFCE.3.NetworkandHostSecurity/" /><meta property="og:site_name" content="Grace" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-07-16T11:11:11-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="LFCE.3 Network and Host Security" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-02T18:58:52-05:00","datePublished":"2020-07-16T11:11:11-04:00","description":"LFCE: Network and Host Security","headline":"LFCE.3 Network and Host Security","mainEntityOfPage":{"@type":"WebPage","@id":"https://ocholuo.github.io//posts/LFCE.3.NetworkandHostSecurity/"},"url":"https://ocholuo.github.io//posts/LFCE.3.NetworkandHostSecurity/"}</script><title>LFCE.3 Network and Host Security | Grace</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Grace"><meta name="application-name" content="Grace"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://myochosite-291718.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://myochosite-291718.appspot.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/huoye.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Grace</a></div><div class="site-subtitle font-italic">2023 Mar 14 updated</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/ocholuo" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>LFCE.3 Network and Host Security</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>LFCE.3 Network and Host Security</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Grace JyL </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Jul 16, 2020, 11:11 AM -0400" >Jul 16, 2020<i class="unloaded">2020-07-16T11:11:11-04:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Jan 2, 2023, 3:58 PM -0800" >Jan 2<i class="unloaded">2023-01-02T18:58:52-05:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3149 words">17 min read</span> <span id="pv" class="pageviews"> <i class="fas fa-spinner fa-spin fa-fw"></i> </span> views</div></div><div class="post-content"><h1 id="lfce-network-and-host-security">LFCE: Network and Host Security</h1><p>[toc]</p><hr /><h2 id="lab">lab</h2><p>server0: network change to <code class="language-plaintext highlighter-rouge">bridge</code>.</p><p>server0: 192.168.1.30 enp0s10 192.168.0.110 server1: 193.168.3.100 enp0s8 server2: 192.168.2.100/25 enp0s9</p><p>script: <code class="language-plaintext highlighter-rouge">firewall.sh</code></p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">permanent</span> <span class="o">--</span><span class="n">change</span><span class="o">-</span><span class="n">interface</span><span class="o">=</span><span class="n">enp0s10</span> <span class="o">--</span><span class="n">zone</span><span class="o">=</span><span class="n">external</span>
<span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">permanent</span> <span class="o">--</span><span class="n">change</span><span class="o">-</span><span class="n">interface</span><span class="o">=</span><span class="n">enp0s8</span> <span class="o">--</span><span class="n">zone</span><span class="o">=</span><span class="n">internal</span>
<span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">permanent</span> <span class="o">--</span><span class="n">change</span><span class="o">-</span><span class="n">interface</span><span class="o">=</span><span class="n">enp0s9</span> <span class="o">--</span><span class="n">zone</span><span class="o">=</span><span class="n">internal</span>

<span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">permanent</span> <span class="o">--</span><span class="n">zone</span><span class="o">=</span><span class="n">external</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">masquerade</span>

<span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">permanent</span> <span class="o">--</span><span class="n">direct</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">rule</span> <span class="n">ipv4</span> <span class="n">filter</span> <span class="n">FORWARD</span> <span class="mi">0</span> <span class="o">-</span><span class="n">s</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">25</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span>
<span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">permanent</span> <span class="o">--</span><span class="n">direct</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">rule</span> <span class="n">ipv4</span> <span class="n">filter</span> <span class="n">FORWARD</span> <span class="mi">0</span> <span class="o">-</span><span class="n">s</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">24</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span>

<span class="n">systemctl</span> <span class="n">reload</span> <span class="n">firewalld</span>
</pre></table></code></div></div><hr /><h3 id="configuring-local-and-remote-logging-with-rsyslog">Configuring Local and Remote Logging with rsyslog</h3><p>server1: server-side</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="c1">// show the package that syslog actually comes from.</span>
<span class="err">$</span> <span class="n">rpmquery</span> <span class="o">--</span><span class="n">all</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">rsyslog</span>
<span class="n">rsyslog</span><span class="o">-</span><span class="mi">8</span><span class="p">.</span><span class="mi">37</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">13</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">x86_64</span>
<span class="n">rsyslog</span><span class="o">-</span><span class="n">relp</span><span class="o">-</span><span class="mi">8</span><span class="p">.</span><span class="mi">37</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">13</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">x86_64</span>
<span class="n">rsyslog</span><span class="o">-</span><span class="n">gnutls</span><span class="o">-</span><span class="mi">8</span><span class="p">.</span><span class="mi">37</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">13</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">x86_64</span>
<span class="n">rsyslog</span><span class="o">-</span><span class="n">gssapi</span><span class="o">-</span><span class="mi">8</span><span class="p">.</span><span class="mi">37</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">13</span><span class="p">.</span><span class="n">el8</span><span class="p">.</span><span class="n">x86_64</span>

<span class="c1">// start the service</span>
<span class="n">systemctl</span> <span class="n">status</span> <span class="n">rsyslog</span>
</pre></table></code></div></div><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre><td class="rouge-code"><pre>
<span class="mf">1.</span> <span class="n">modify</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">rsyslog</span><span class="p">.</span><span class="n">config</span> <span class="n">configure</span> <span class="nb">file</span> <span class="n">an</span> <span class="n">restart</span> <span class="n">the</span> <span class="n">server</span>
<span class="n">info</span><span class="p">:</span> <span class="n">man</span><span class="o">/</span><span class="n">rsyslog</span><span class="p">.</span><span class="n">d</span>

<span class="err">$</span> <span class="n">cat</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">rsyslog</span><span class="p">.</span><span class="n">conf</span>

<span class="p">...</span> <span class="n">uncomment</span> <span class="n">these</span>
<span class="c1"># Provides TCP syslog reception
# for remote syslog, send from one server to another
# for parameters see http://www.rsyslog.com/doc/imtcp.html
</span><span class="nf">module</span><span class="p">(</span><span class="n">load</span><span class="o">=</span><span class="s">"imtcp"</span><span class="p">)</span>              <span class="c1"># needs to be done just once
</span><span class="nf">input</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s">"imtcp"</span> <span class="n">port</span><span class="o">=</span><span class="s">"514"</span><span class="p">)</span>

<span class="c1">#### RULES ####
# Log all kernel messages to the console.
# logging message from certain place, facility + priority = selector      file / devices = action
</span>
<span class="c1"># Logging much else clutters up the screen.
#kern.*                                                 /dev/console
# Log anything (except mail) of level info or higher.
# Don't log private authentication messages!
</span><span class="o">*</span><span class="p">.</span><span class="n">info</span><span class="p">;</span><span class="n">mail</span><span class="p">.</span><span class="n">none</span><span class="p">;</span><span class="n">authpriv</span><span class="p">.</span><span class="n">none</span><span class="p">;</span><span class="n">cron</span><span class="p">.</span><span class="n">none</span>                <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">messages</span>
<span class="c1"># The authpriv file has restricted access.
</span><span class="n">authpriv</span><span class="p">.</span><span class="o">*</span>                                              <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">secure</span>
<span class="c1"># Log all the mail messages in one place.
</span><span class="n">mail</span><span class="p">.</span><span class="o">*</span>                                                  <span class="o">-/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">maillog</span>
<span class="c1"># Log cron stuff
</span><span class="n">cron</span><span class="p">.</span><span class="o">*</span>                                                  <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">cron</span>
<span class="c1"># Everybody gets emergency messages
</span><span class="o">*</span><span class="p">.</span><span class="n">emerg</span>                                                 <span class="p">:</span><span class="n">omusrmsg</span><span class="p">:</span><span class="o">*</span>
<span class="c1"># Save news errors of level crit and higher in a special file.
</span><span class="n">uucp</span><span class="p">,</span><span class="n">news</span><span class="p">.</span><span class="n">crit</span>                                          <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">spooler</span>
<span class="c1"># Save boot messages also to boot.log
</span><span class="n">local7</span><span class="p">.</span><span class="o">*</span>                                                <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">boot</span><span class="p">.</span><span class="n">log</span>



<span class="mf">2.</span> <span class="n">let</span> <span class="n">firewell</span> <span class="n">allow</span> <span class="n">receive</span> <span class="n">message</span> <span class="n">on</span> <span class="n">TCP</span> <span class="mi">514</span>

<span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">permanent</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">port</span> <span class="mi">514</span><span class="o">/</span><span class="n">tcp</span>
<span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="nb">reload</span>



<span class="mf">3.</span> <span class="n">setup</span> <span class="n">SELinux</span> <span class="k">for</span> <span class="n">rsyslog</span>

<span class="n">semanage</span> <span class="n">port</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">t</span> <span class="n">syslogd_port_t</span> <span class="o">-</span><span class="n">p</span> <span class="n">tcp</span> <span class="mi">514</span>
</pre></table></code></div></div><hr /><p>server2: client-side</p><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>
<span class="mf">1.</span> <span class="n">modify</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">rsyslog</span><span class="p">.</span><span class="n">config</span> <span class="n">configure</span> <span class="nb">file</span> <span class="n">an</span> <span class="n">restart</span> <span class="n">the</span> <span class="n">server</span>

<span class="c1"># Remote Logging (we use TCP for reliable delivery)
# remote_host is: name/ip, e.g. 192.168.0.1, port optional e.g. 10514
## @@=tcp @=udp
#Target="remote_host" Port="XXX" Protocol="tcp")
</span><span class="o">*</span><span class="p">.</span><span class="o">*</span>  <span class="o">@</span><span class="nd">@server1.demo.local</span><span class="p">:</span><span class="mi">514</span>


<span class="n">systemctl</span> <span class="n">restart</span> <span class="n">rsyslog</span>

<span class="mf">2.</span> <span class="n">generate</span> <span class="n">a</span> <span class="n">log</span><span class="p">:</span>

<span class="n">logger</span> <span class="s">"Test Message"</span>
</pre></table></code></div></div><hr /><p>server1: server-side</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">tail</span> <span class="o">-</span><span class="n">f</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">messages</span>
<span class="n">May</span> <span class="mi">21</span> <span class="mi">16</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span><span class="mo">03</span> <span class="n">server2</span> <span class="n">server</span><span class="p">[</span><span class="mi">14255</span><span class="p">]</span><span class="o">:</span> <span class="n">Test</span> <span class="n">Message</span>
</pre></table></code></div></div><p>using remote syslogging, can have a centralized server for all logs</p><ul><li>great for auditing and security to time correlate events, across multiple systems.<li>isn’t limited to just Linux systems as well.<li>Most network devices (firewalls, switches and routers), also have syslog capabilities. stream logs, from those devices, to logging hosts, for analysis. very, very powerful stuff.</ul><hr /><h2 id="lab2---securing-hosts-and-services">lab2 - securing hosts and Services</h2><h3 id="iptables">iptables</h3><p>server1:</p><ol><li><p>stope and disable the firewalld</p><li>install and start the iptables<div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>yum install iptables-services -y
systemctl start iptables
</pre></table></code></div></div><li>check the default rule</ol><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">iptables</span> <span class="o">-</span><span class="n">L</span>
<span class="n">Chain</span> <span class="nc">INPUT </span><span class="p">(</span><span class="n">policy</span> <span class="n">ACCEPT</span><span class="p">)</span>
<span class="n">target</span>     <span class="n">prot</span> <span class="n">opt</span> <span class="n">source</span>               <span class="n">destination</span>
<span class="n">ACCEPT</span>     <span class="n">udp</span>  <span class="o">--</span>  <span class="n">anywhere</span>             <span class="n">anywhere</span>             <span class="n">udp</span> <span class="n">dpt</span><span class="p">:</span><span class="n">domain</span>
<span class="n">ACCEPT</span>     <span class="n">tcp</span>  <span class="o">--</span>  <span class="n">anywhere</span>             <span class="n">anywhere</span>             <span class="n">tcp</span> <span class="n">dpt</span><span class="p">:</span><span class="n">domain</span>
<span class="n">ACCEPT</span>     <span class="n">udp</span>  <span class="o">--</span>  <span class="n">anywhere</span>             <span class="n">anywhere</span>             <span class="n">udp</span> <span class="n">dpt</span><span class="p">:</span><span class="n">bootps</span>
<span class="n">ACCEPT</span>     <span class="n">tcp</span>  <span class="o">--</span>  <span class="n">anywhere</span>             <span class="n">anywhere</span>             <span class="n">tcp</span> <span class="n">dpt</span><span class="p">:</span><span class="n">bootps</span>

<span class="n">Chain</span> <span class="nc">FORWARD </span><span class="p">(</span><span class="n">policy</span> <span class="n">ACCEPT</span><span class="p">)</span>
<span class="n">target</span>     <span class="n">prot</span> <span class="n">opt</span> <span class="n">source</span>               <span class="n">destination</span>
<span class="n">ACCEPT</span>     <span class="nb">all</span>  <span class="o">--</span>  <span class="n">anywhere</span>             <span class="mf">192.168</span><span class="p">.</span><span class="mf">122.0</span><span class="o">/</span><span class="mi">24</span>     <span class="n">ctstate</span> <span class="n">RELATED</span><span class="p">,</span><span class="n">ESTABLISHED</span>
<span class="n">ACCEPT</span>     <span class="nb">all</span>  <span class="o">--</span>  <span class="mf">192.168</span><span class="p">.</span><span class="mf">122.0</span><span class="o">/</span><span class="mi">24</span>     <span class="n">anywhere</span>
<span class="n">ACCEPT</span>     <span class="nb">all</span>  <span class="o">--</span>  <span class="n">anywhere</span>             <span class="n">anywhere</span>
<span class="n">REJECT</span>     <span class="nb">all</span>  <span class="o">--</span>  <span class="n">anywhere</span>             <span class="n">anywhere</span>             <span class="n">reject</span><span class="o">-</span><span class="k">with</span> <span class="n">icmp</span><span class="o">-</span><span class="n">port</span><span class="o">-</span><span class="n">unreachable</span>
<span class="n">REJECT</span>     <span class="nb">all</span>  <span class="o">--</span>  <span class="n">anywhere</span>             <span class="n">anywhere</span>             <span class="n">reject</span><span class="o">-</span><span class="k">with</span> <span class="n">icmp</span><span class="o">-</span><span class="n">port</span><span class="o">-</span><span class="n">unreachable</span>

<span class="n">Chain</span> <span class="nc">OUTPUT </span><span class="p">(</span><span class="n">policy</span> <span class="n">ACCEPT</span><span class="p">)</span>
<span class="n">target</span>     <span class="n">prot</span> <span class="n">opt</span> <span class="n">source</span>               <span class="n">destination</span>
<span class="n">ACCEPT</span>     <span class="n">udp</span>  <span class="o">--</span>  <span class="n">anywhere</span>             <span class="n">anywhere</span>             <span class="n">udp</span> <span class="n">dpt</span><span class="p">:</span><span class="n">bootpc</span>



<span class="err">$</span> <span class="n">iptables</span> <span class="o">-</span><span class="n">L</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">n</span>           <span class="c1"># with number
</span><span class="err">$</span> <span class="n">iptables</span> <span class="o">-</span><span class="n">L</span> <span class="o">--</span><span class="n">line</span><span class="o">-</span><span class="n">numbers</span>  <span class="c1"># with details
</span>

<span class="err">$</span> <span class="n">iptables</span> <span class="o">-</span><span class="n">L</span> <span class="o">-</span><span class="n">v</span>
<span class="n">Chain</span> <span class="nc">INPUT </span><span class="p">(</span><span class="n">policy</span> <span class="n">ACCEPT</span> <span class="mi">0</span> <span class="n">packets</span><span class="p">,</span> <span class="mi">0</span> <span class="nb">bytes</span><span class="p">)</span>   <span class="c1"># default policy of accept
</span> <span class="n">pkts</span> <span class="nb">bytes</span> <span class="n">target</span>     <span class="n">prot</span> <span class="n">opt</span> <span class="ow">in</span>     <span class="n">out</span>     <span class="n">source</span>               <span class="n">destination</span>
   <span class="mi">27</span>  <span class="mi">5637</span> <span class="n">ACCEPT</span>     <span class="nb">all</span>  <span class="o">--</span>  <span class="nb">any</span>    <span class="nb">any</span>     <span class="n">anywhere</span>             <span class="n">anywhere</span>             <span class="n">state</span> <span class="n">RELATED</span><span class="p">,</span><span class="n">ESTABLISHED</span>
<span class="c1"># allows all connections that have been previously allowed by rules further down in the chain. And it also allows any connections that are related.
</span>    <span class="mi">0</span>     <span class="mi">0</span> <span class="n">ACCEPT</span>     <span class="n">icmp</span> <span class="o">--</span>  <span class="nb">any</span>    <span class="nb">any</span>     <span class="n">anywhere</span>             <span class="n">anywhere</span>
<span class="c1">#                            input adapter loop
</span>    <span class="mi">0</span>     <span class="mi">0</span> <span class="n">ACCEPT</span>     <span class="nb">all</span>  <span class="o">--</span>  <span class="n">lo</span>     <span class="nb">any</span>     <span class="n">anywhere</span>             <span class="n">anywhere</span>
    <span class="mi">0</span>     <span class="mi">0</span> <span class="n">ACCEPT</span>     <span class="n">tcp</span>  <span class="o">--</span>  <span class="nb">any</span>    <span class="nb">any</span>     <span class="n">anywhere</span>             <span class="n">anywhere</span>             <span class="n">state</span> <span class="n">NEW</span> <span class="n">tcp</span> <span class="n">dpt</span><span class="p">:</span><span class="n">ssh</span>
    <span class="mi">6</span>   <span class="mi">402</span> <span class="n">REJECT</span>     <span class="nb">all</span>  <span class="o">--</span>  <span class="nb">any</span>    <span class="nb">any</span>     <span class="n">anywhere</span>             <span class="n">anywhere</span>             <span class="n">reject</span><span class="o">-</span><span class="k">with</span> <span class="n">icmp</span><span class="o">-</span><span class="n">host</span><span class="o">-</span><span class="n">prohibited</span>
<span class="c1"># sniiff, connect to any other port other than 22, simply reply "icmp-host-prohibited"
</span>
<span class="n">Chain</span> <span class="nc">FORWARD </span><span class="p">(</span><span class="n">policy</span> <span class="n">ACCEPT</span> <span class="mi">0</span> <span class="n">packets</span><span class="p">,</span> <span class="mi">0</span> <span class="nb">bytes</span><span class="p">)</span>
 <span class="n">pkts</span> <span class="nb">bytes</span> <span class="n">target</span>     <span class="n">prot</span> <span class="n">opt</span> <span class="ow">in</span>     <span class="n">out</span>     <span class="n">source</span>               <span class="n">destination</span>
    <span class="mi">0</span>     <span class="mi">0</span> <span class="n">REJECT</span>     <span class="nb">all</span>  <span class="o">--</span>  <span class="nb">any</span>    <span class="nb">any</span>     <span class="n">anywhere</span>             <span class="n">anywhere</span>             <span class="n">reject</span><span class="o">-</span><span class="k">with</span> <span class="n">icmp</span><span class="o">-</span><span class="n">host</span><span class="o">-</span><span class="n">prohibited</span>

<span class="n">Chain</span> <span class="nc">OUTPUT </span><span class="p">(</span><span class="n">policy</span> <span class="n">ACCEPT</span> <span class="mi">33</span> <span class="n">packets</span><span class="p">,</span> <span class="mi">3644</span> <span class="nb">bytes</span><span class="p">)</span>
 <span class="n">pkts</span> <span class="nb">bytes</span> <span class="n">target</span>     <span class="n">prot</span> <span class="n">opt</span> <span class="ow">in</span>     <span class="n">out</span>     <span class="n">source</span>               <span class="n">destination</span>
</pre></table></code></div></div><ol><li>check the config file <code class="language-plaintext highlighter-rouge">/etc/sysconfig/iptables"</code></ol><p>直接修改这里没用</p><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="c1"># sample configuration for iptables service
# you can edit this manually or use system-config-firewall
# please do not ask us to add additional ports/services to this default configuration
</span><span class="o">*</span><span class="nb">filter</span>   <span class="c1"># define the table
</span><span class="p">:</span><span class="n">INPUT</span> <span class="n">ACCEPT</span> <span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span>
<span class="p">:</span><span class="n">FORWARD</span> <span class="n">ACCEPT</span> <span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span>
<span class="p">:</span><span class="n">OUTPUT</span> <span class="n">ACCEPT</span> <span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span>

<span class="o">-</span><span class="n">A</span> <span class="n">INPUT</span> <span class="o">-</span><span class="n">m</span> <span class="n">state</span> <span class="o">--</span><span class="n">state</span> <span class="n">RELATED</span><span class="p">,</span><span class="n">ESTABLISHED</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span>
<span class="o">-</span><span class="n">A</span> <span class="n">INPUT</span> <span class="o">-</span><span class="n">p</span> <span class="n">icmp</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span>
<span class="o">-</span><span class="n">A</span> <span class="n">INPUT</span> <span class="o">-</span><span class="n">i</span> <span class="n">lo</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span>
<span class="o">-</span><span class="n">A</span> <span class="n">INPUT</span> <span class="o">-</span><span class="n">p</span> <span class="n">tcp</span> <span class="o">-</span><span class="n">m</span> <span class="n">state</span> <span class="o">--</span><span class="n">state</span> <span class="n">NEW</span> <span class="o">-</span><span class="n">m</span> <span class="n">tcp</span> <span class="o">--</span><span class="n">dport</span> <span class="mi">22</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span>
<span class="o">-</span><span class="n">A</span> <span class="n">INPUT</span> <span class="o">-</span><span class="n">j</span> <span class="n">REJECT</span> <span class="o">--</span><span class="n">reject</span><span class="o">-</span><span class="k">with</span> <span class="n">icmp</span><span class="o">-</span><span class="n">host</span><span class="o">-</span><span class="n">prohibited</span>
<span class="o">-</span><span class="n">A</span> <span class="n">FORWARD</span> <span class="o">-</span><span class="n">j</span> <span class="n">REJECT</span> <span class="o">--</span><span class="n">reject</span><span class="o">-</span><span class="k">with</span> <span class="n">icmp</span><span class="o">-</span><span class="n">host</span><span class="o">-</span><span class="n">prohibited</span>
<span class="n">COMMIT</span>
</pre></table></code></div></div><p>iptables -I INPUT -s 192.168.2.0/25 -j ACCEPT iptables -I INPUT -s 192.168.3.0/24 -j ACCEPT</p><p>iptables -I INPUT -s 192.168.3.100 -p tcp -m tcp –dport 22 -j ACCEPT</p><p>iptables -I FORWARD -s 192.168.3.0/24 -j ACCEPT iptables -I FORWARD -s 192.168.2.0/25 -j ACCEPT</p><ol><li>define rules on runtime (delete new rule when finished)</ol><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="c1"># block traffic from specific network.
</span><span class="err">$</span> <span class="n">iptables</span> <span class="o">-</span><span class="n">I</span> <span class="n">INPUT</span> <span class="o">-</span><span class="n">s</span> <span class="mf">192.168</span><span class="p">.</span><span class="mf">2.0</span><span class="o">/</span><span class="mi">24</span> <span class="o">-</span><span class="n">j</span> <span class="n">REJECT</span>
<span class="c1"># but all particular server on that subnet.
</span><span class="err">$</span> <span class="n">iptables</span> <span class="o">-</span><span class="n">I</span> <span class="n">INPUT</span> <span class="o">-</span><span class="n">s</span> <span class="mf">192.168</span><span class="p">.</span><span class="mf">2.100</span> <span class="o">-</span><span class="n">p</span> <span class="n">tcp</span> <span class="o">-</span><span class="n">m</span> <span class="n">tcp</span> <span class="o">--</span><span class="n">dport</span> <span class="mi">22</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span>
<span class="c1"># delete it
</span><span class="err">$</span> <span class="n">iptables</span> <span class="o">-</span><span class="n">D</span> <span class="n">INPUT</span> <span class="mi">1</span>
<span class="err">$</span> <span class="n">iptables</span> <span class="o">-</span><span class="n">D</span> <span class="n">FORWARD</span> <span class="mi">4</span>

<span class="err">$</span> <span class="n">iptables</span> <span class="o">-</span><span class="n">L</span>
<span class="n">Chain</span> <span class="nc">INPUT </span><span class="p">(</span><span class="n">policy</span> <span class="n">ACCEPT</span><span class="p">)</span>
<span class="n">target</span>     <span class="n">prot</span> <span class="n">opt</span> <span class="n">source</span>               <span class="n">destination</span>
<span class="n">ACCEPT</span>     <span class="n">tcp</span>  <span class="o">--</span>  <span class="n">server2</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">local</span>   <span class="n">anywhere</span>             <span class="n">tcp</span> <span class="n">dpt</span><span class="p">:</span><span class="n">ssh</span>
<span class="n">REJECT</span>     <span class="nb">all</span>  <span class="o">--</span>  <span class="mf">192.168</span><span class="p">.</span><span class="mf">2.0</span><span class="o">/</span><span class="mi">24</span>       <span class="n">anywhere</span>             <span class="n">reject</span><span class="o">-</span><span class="k">with</span> <span class="n">icmp</span><span class="o">-</span><span class="n">port</span><span class="o">-</span><span class="n">unreachable</span>


<span class="err">$</span> <span class="n">iptable</span> <span class="o">-</span><span class="n">F</span>                  <span class="c1"># temporary flush out rule
</span><span class="err">$</span> <span class="n">service</span> <span class="n">iptables</span> <span class="nb">reload</span>     <span class="c1"># reload from config file
</span><span class="n">Redirecting</span> <span class="n">to</span> <span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">systemctl</span> <span class="nb">reload</span> <span class="n">iptables</span><span class="p">.</span><span class="n">service</span>
<span class="err">$</span> <span class="n">service</span> <span class="n">iptables</span> <span class="n">save</span>       <span class="c1"># save runtime config
</span><span class="n">iptables</span><span class="p">:</span> <span class="n">Saving</span> <span class="n">firewall</span> <span class="n">rules</span> <span class="n">to</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sysconfig</span><span class="o">/</span><span class="n">iptables</span><span class="p">:[</span>  <span class="n">OK</span>  <span class="p">]</span>
</pre></table></code></div></div><hr /><h3 id="tcp-wrappers-centos-not-used">TCP wrappers (centos not used)</h3><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c1"># add hosts.deny
</span><span class="n">sshd</span> <span class="p">:</span> <span class="mf">192.168</span><span class="p">.</span><span class="mf">2.</span>
<span class="c1"># add hosts.allow
</span><span class="n">sshd</span> <span class="p">:</span> <span class="mf">192.168</span><span class="p">.</span><span class="mf">2.</span>         <span class="c1"># allow win
# change hosts.allow
</span><span class="n">sshd</span> <span class="p">:</span> <span class="mf">192.168</span><span class="p">.</span><span class="mf">2.</span> <span class="p">:</span> <span class="n">DENY</span>  <span class="c1"># deny again
</span></pre></table></code></div></div><hr /><h3 id="troubleshooting">troubleshooting</h3><p>netstat / ss: if port is open nmap: if remote port is open tcpdump / wireshark: responses from remote host</p><hr /><h2 id="lab3---securing-hosts-and-services">lab3 - securing hosts and Services</h2><h3 id="firewalld">firewalld</h3><p><code class="language-plaintext highlighter-rouge">/etc/firewalld/firewalld.conf</code> - basic global config</p><p><code class="language-plaintext highlighter-rouge">/usr/lib/firewalld</code> - default configuration files</p><ul><li>zone configuration files<li>services configuration files</ul><p><code class="language-plaintext highlighter-rouge">/etc/firewalld/</code> - system specific configuration files</p><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="mf">1.</span> <span class="n">reinstall</span> <span class="n">the</span> <span class="n">firewalld</span>

<span class="err">$</span> <span class="n">systemctl</span> <span class="n">disable</span> <span class="n">iptables</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">stop</span> <span class="n">iptables</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">firewalld</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">firewalld</span>

<span class="err">$</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">state</span>
<span class="n">running</span>


<span class="mf">2.</span> <span class="n">zone</span>

<span class="err">$</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">get</span><span class="o">-</span><span class="n">zones</span>
<span class="err">$</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="nb">list</span><span class="o">-</span><span class="nb">all</span><span class="o">-</span><span class="n">zones</span>
<span class="err">$</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">zone</span><span class="o">=</span><span class="n">public</span> <span class="o">--</span><span class="nb">list</span><span class="o">-</span><span class="nb">all</span>
<span class="err">$</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">get</span><span class="o">-</span><span class="n">active</span><span class="o">-</span><span class="n">zones</span>

<span class="c1"># service
</span><span class="err">$</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">get</span><span class="o">-</span><span class="n">service</span>
<span class="err">$</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">zone</span><span class="o">=</span><span class="n">public</span> <span class="o">--</span><span class="nb">list</span><span class="o">-</span><span class="n">services</span>
<span class="err">$</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">zone</span><span class="o">=</span><span class="n">public</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">service</span><span class="o">=</span><span class="n">http</span>

<span class="c1"># port
</span><span class="err">$</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="nb">list</span><span class="o">-</span><span class="n">ports</span>
<span class="err">$</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">zone</span><span class="o">=</span><span class="n">public</span> <span class="o">--</span><span class="n">remove</span><span class="o">-</span><span class="n">port</span><span class="o">=</span><span class="mi">514</span><span class="o">/</span><span class="n">tcp</span>
<span class="err">$</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">zone</span><span class="o">=</span><span class="n">public</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">port</span><span class="o">=</span><span class="mi">514</span><span class="o">/</span><span class="n">tcp</span>

<span class="c1"># change zone for interface
</span><span class="err">$</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">change</span><span class="o">-</span><span class="n">interface</span><span class="o">=</span><span class="n">enp0s3</span> <span class="o">--</span><span class="n">zone</span><span class="o">=</span><span class="n">internal</span>
</pre></table></code></div></div><p>firewall-cmd –zone=public –add-service=http –permanent firewall-cmd –zone=public –add-service=http</p><p>firewall-cmd –zone=public –add-service=ssh</p><p>config file</p><ol><li><code class="language-plaintext highlighter-rouge">/usr/lib/firewalld/</code></ol><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">ls</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">firewalld</span><span class="o">/</span>  <span class="c1"># the dir that contains all the config files
</span><span class="n">helpers</span>  <span class="n">icmptypes</span>  <span class="n">ipsets</span>  <span class="n">services</span>  <span class="n">zones</span>
</pre></table></code></div></div><p>services: amanda-client.xml isns.xml rdp.xml amanda-k5-client.xml jenkins.xml redis-sentinel.xml amqps.xml kadmin.xml redis.xml amqp.xml kdeconnect.xml RH-Satellite-6.xml</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>$ cat /usr/lib/firewalld/services/ssh.xml

&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;service&gt;
  &lt;short&gt;SSH&lt;/short&gt;
  &lt;description&gt;&lt;/description&gt;
  &lt;port protocol="tcp" port="22"/&gt;
&lt;/service&gt;
</pre></table></code></div></div><p>$ ls /usr/lib/firewalld/zones/ block.xml drop.xml home.xml libvirt.xml trusted.xml dmz.xml external.xml internal.xml public.xml work.xml</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>$ cat /usr/lib/firewalld/zones/public.xml
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;zone&gt;
  &lt;short&gt;Public&lt;/short&gt;
  &lt;description&gt;For use in public areas. You do not trust the other computers on networks to not harm your computer. Only selected incoming connections are accepted.&lt;/description&gt;
  &lt;service name="ssh"/&gt;
  &lt;service name="dhcpv6-client"/&gt;
  &lt;service name="cockpit"/&gt;
&lt;/zone&gt;
</pre></table></code></div></div><ol><li><code class="language-plaintext highlighter-rouge">/etc/firewalld</code></ol><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre># ls /etc/firewalld
firewalld.conf  icmptypes  lockdown-whitelist.xml  zones
helpers         ipsets     services
</pre></table></code></div></div><ol><li>command<div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ firewall-cmd --runtime-to-permanent   # store the runtime
</pre></table></code></div></div><li>GUI<div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ firewall-config
</pre></table></code></div></div></ol><h3 id="nat">NAT</h3><p>server0:</p><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">zone</span><span class="o">=</span><span class="n">external</span> <span class="o">--</span><span class="nb">list</span><span class="o">-</span><span class="nb">all</span>
<span class="n">external</span>
  <span class="n">target</span><span class="p">:</span> <span class="n">default</span>
  <span class="n">icmp</span><span class="o">-</span><span class="n">block</span><span class="o">-</span><span class="n">inversion</span><span class="p">:</span> <span class="n">no</span>
  <span class="n">interfaces</span><span class="p">:</span>
  <span class="n">sources</span><span class="p">:</span>
  <span class="n">services</span><span class="p">:</span> <span class="n">ssh</span>
  <span class="n">ports</span><span class="p">:</span>
  <span class="n">protocols</span><span class="p">:</span>
  <span class="n">masquerade</span><span class="p">:</span> <span class="n">yes</span>
  <span class="n">forward</span><span class="o">-</span><span class="n">ports</span><span class="p">:</span>
  <span class="n">source</span><span class="o">-</span><span class="n">ports</span><span class="p">:</span>
  <span class="n">icmp</span><span class="o">-</span><span class="n">blocks</span><span class="p">:</span>
  <span class="n">rich</span> <span class="n">rules</span><span class="p">:</span>

<span class="c1">#                                       --add-forward-port = port=2233: proto=tcp: toport=22: toaddr=192.168.3.100
</span><span class="err">$</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">permanent</span> <span class="o">--</span><span class="n">zone</span><span class="o">=</span><span class="n">external</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">forward</span><span class="o">-</span><span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="o">=</span><span class="mi">2223</span><span class="p">:</span><span class="n">proto</span><span class="o">=</span><span class="n">tcp</span><span class="p">:</span><span class="n">toport</span><span class="o">=</span><span class="mi">22</span><span class="p">:</span><span class="n">toaddr</span><span class="o">=</span><span class="mf">192.168</span><span class="p">.</span><span class="mf">3.100</span>
<span class="err">$</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">permanent</span> <span class="o">--</span><span class="n">zone</span><span class="o">=</span><span class="n">external</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">forward</span><span class="o">-</span><span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="o">=</span><span class="mi">2222</span><span class="p">:</span><span class="n">proto</span><span class="o">=</span><span class="n">tcp</span><span class="p">:</span><span class="n">toport</span><span class="o">=</span><span class="mi">22</span>
<span class="err">$</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">zone</span><span class="o">=</span><span class="n">external</span> <span class="o">--</span><span class="nb">list</span><span class="o">-</span><span class="n">forward</span><span class="o">-</span><span class="n">port</span>  <span class="c1"># is permanent, not it runtime, need reload
</span><span class="err">$</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="nb">reload</span>
<span class="err">$</span> <span class="n">firewall</span><span class="o">-</span><span class="n">cmd</span> <span class="o">--</span><span class="n">zone</span><span class="o">=</span><span class="n">external</span> <span class="o">--</span><span class="nb">list</span><span class="o">-</span><span class="n">forward</span><span class="o">-</span><span class="n">port</span>
<span class="n">port</span><span class="o">=</span><span class="mi">2223</span><span class="p">:</span><span class="n">proto</span><span class="o">=</span><span class="n">tcp</span><span class="p">:</span><span class="n">toport</span><span class="o">=</span><span class="mi">22</span><span class="p">:</span><span class="n">toaddr</span><span class="o">=</span><span class="mf">192.168</span><span class="p">.</span><span class="mf">3.100</span>
<span class="n">port</span><span class="o">=</span><span class="mi">2222</span><span class="p">:</span><span class="n">proto</span><span class="o">=</span><span class="n">tcp</span><span class="p">:</span><span class="n">toport</span><span class="o">=</span><span class="mi">22</span><span class="p">:</span><span class="n">toaddr</span><span class="o">=</span>
</pre></table></code></div></div><p>mac terminal:</p><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">ssh</span> <span class="n">server</span><span class="o">@</span><span class="mf">192.168</span><span class="p">.</span><span class="mf">1.30</span> <span class="o">-</span><span class="n">p</span> <span class="mi">2223</span>
<span class="p">[</span><span class="n">server</span><span class="nd">@server1</span> <span class="o">~</span><span class="p">]</span><span class="err">$</span> <span class="nb">exit</span>

<span class="err">$</span> <span class="n">ssh</span> <span class="n">server</span><span class="o">@</span><span class="mf">192.168</span><span class="p">.</span><span class="mf">1.30</span> <span class="o">-</span><span class="n">p</span> <span class="mi">2222</span>
<span class="p">[</span><span class="n">server</span><span class="nd">@server0</span> <span class="o">~</span><span class="p">]</span><span class="err">$</span>
</pre></table></code></div></div><hr /><h2 id="lab4---remote-access">lab4 - remote access</h2><h3 id="openssh">openSSH</h3><p><code class="language-plaintext highlighter-rouge">/etc/ssh/sshd_config</code> server <code class="language-plaintext highlighter-rouge">/etc/ssh/ssh_config</code> client</p><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
</pre><td class="rouge-code"><pre><span class="mf">1.</span> <span class="n">disable</span> <span class="n">the</span> <span class="n">key</span> <span class="n">cache</span>

<span class="err">$</span> <span class="n">ps</span> <span class="o">-</span><span class="n">aux</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">gnome</span><span class="o">-</span><span class="n">key</span>
<span class="n">server</span>    <span class="mi">2530</span>  <span class="mf">0.0</span>  <span class="mf">0.2</span> <span class="mi">307120</span>  <span class="mi">6696</span> <span class="err">?</span>        <span class="n">Sl</span>   <span class="n">May21</span>   <span class="mi">0</span><span class="p">:</span><span class="mi">00</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">gnome</span><span class="o">-</span><span class="n">keyring</span><span class="o">-</span><span class="n">daemon</span> <span class="o">--</span><span class="n">daemonize</span> <span class="o">--</span><span class="n">login</span>
<span class="n">root</span>     <span class="mi">26226</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mi">12108</span>  <span class="mi">1100</span> <span class="n">pts</span><span class="o">/</span><span class="mi">1</span>    <span class="n">R</span><span class="o">+</span>   <span class="mi">21</span><span class="p">:</span><span class="mi">57</span>   <span class="mi">0</span><span class="p">:</span><span class="mi">00</span> <span class="n">grep</span> <span class="o">--</span><span class="n">color</span><span class="o">=</span><span class="n">auto</span> <span class="n">gnome</span><span class="o">-</span><span class="n">key</span>
<span class="err">$</span> <span class="n">kill</span> <span class="mi">2530</span>



<span class="mf">2.</span> <span class="n">generate</span> <span class="n">a</span> <span class="n">public</span> <span class="n">key</span>

<span class="err">$</span> <span class="n">ssh</span><span class="o">-</span><span class="n">keygen</span>
<span class="n">Generating</span> <span class="n">public</span><span class="o">/</span><span class="n">private</span> <span class="n">rsa</span> <span class="n">key</span> <span class="n">pair</span><span class="p">.</span>
<span class="n">Enter</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">which</span> <span class="n">to</span> <span class="n">save</span> <span class="n">the</span> <span class="nf">key </span><span class="p">(</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">server</span><span class="o">/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_rsa</span><span class="p">):</span>
<span class="n">Enter</span> <span class="nf">passphrase </span><span class="p">(</span><span class="n">empty</span> <span class="k">for</span> <span class="n">no</span> <span class="n">passphrase</span><span class="p">):</span> <span class="n">passwd</span>
<span class="n">Enter</span> <span class="n">same</span> <span class="n">passphrase</span> <span class="n">again</span><span class="p">:</span><span class="n">passwd</span> <span class="ow">or</span> <span class="n">passwdssh</span>
<span class="n">Your</span> <span class="n">identification</span> <span class="n">has</span> <span class="n">been</span> <span class="n">saved</span> <span class="ow">in</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">server</span><span class="o">/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_rsa</span><span class="p">.</span>
<span class="n">Your</span> <span class="n">public</span> <span class="n">key</span> <span class="n">has</span> <span class="n">been</span> <span class="n">saved</span> <span class="ow">in</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">server</span><span class="o">/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_rsa</span><span class="p">.</span><span class="n">pub</span><span class="p">.</span>
<span class="n">The</span> <span class="n">key</span> <span class="n">fingerprint</span> <span class="ow">is</span><span class="p">:</span>
<span class="n">SHA256</span><span class="p">:</span><span class="n">msvPScL5</span><span class="o">+</span><span class="n">EUYbEfrA6ALiQ7YcJI4UuMlkc</span><span class="o">+</span><span class="n">nUVC11Cw</span> <span class="n">server</span><span class="nd">@server1.demo.local</span>
<span class="n">The</span> <span class="n">key</span><span class="s">'s randomart image is:
+---[RSA 3072]----+
|+o*oooo.oo.      |
|*B.= ..+Eoo.     |
|=.=o..  *.o      |
|o  .+... *       |
| .  .+  S +      |
|    .. + . .     |
|      * . .      |
|     . B o       |
|      +o*        |
+----[SHA256]-----+
$ ll .ssh/
-rw-------. 1 server server 2655 May 22 22:01 id_rsa      # identification, private key
-rw-r--r--. 1 server server  579 May 22 22:01 id_rsa.pub  # public key
-rw-r--r--. 1 server server  350 May 21 23:20 known_hosts

$ more id_rsa
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABAN4dOb39...
$ more id_rsa.pub
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJO7BA/zm6bFWZs0ShZCsS/AhRm4yVjvgY1+bRVe...



2. scp copy the public key to server:
$ ssh-copy-id -i id_rsa.pub server1.demo.local
$ ssh-copy-id -i id_rsa.pub server2.demo.local
#/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "id_rsa.pub"
#The authenticity of host '</span><span class="n">server2</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="nf">local </span><span class="p">(</span><span class="mf">192.168</span><span class="p">.</span><span class="mf">2.100</span><span class="p">)</span><span class="s">' can'</span><span class="n">t</span> <span class="n">be</span> <span class="n">established</span><span class="p">.</span>
<span class="c1">#ECDSA key fingerprint is SHA256:Q9hEc4ZwxWuH1Fd7FO55YpsPRRdwbbtPWbk0lWkMLqI.
#Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
#/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
#/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
</span><span class="n">root</span><span class="nd">@server2.demo.local</span> <span class="n">password</span><span class="p">:</span>   <span class="c1"># ask server passwd
</span><span class="n">Number</span> <span class="n">of</span> <span class="nf">key</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">added</span><span class="p">:</span> <span class="mi">1</span>


<span class="mf">3.</span> <span class="n">login</span> <span class="n">to</span> <span class="n">the</span> <span class="n">server</span><span class="p">,</span> <span class="n">no</span> <span class="n">longer</span> <span class="n">ask</span> <span class="n">user</span> <span class="n">passwd</span> <span class="n">but</span> <span class="n">key</span> <span class="n">passwd</span>

<span class="n">ssh</span> <span class="n">server</span><span class="nd">@server2.demo.local</span>
<span class="n">Enter</span> <span class="n">key</span> <span class="n">password</span><span class="p">:</span>
</pre></table></code></div></div><hr /><h2 id="lab5">lab5:</h2><h2 id="remote-control-tools">remote control: tools</h2><p>transfer file securely via network.</p><ol><li>ssh:<ul><li><code class="language-plaintext highlighter-rouge">scp</code>: securely copy files</ul><ul><li><code class="language-plaintext highlighter-rouge">scp file.txt server@server2.demo.local:destipath</code> - execute remote pc: output is send back - tunneling TCP service - SOCKS proxy (client - [ssh server - Server])</ul><li>SFTP</ol><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
</pre><td class="rouge-code"><pre><span class="mf">1.</span> <span class="n">secure</span> <span class="n">copy</span><span class="p">:</span>
<span class="c1"># copy file
</span><span class="err">$</span> <span class="n">scp</span> <span class="nb">file</span><span class="p">.</span><span class="n">txt</span> <span class="n">server</span><span class="nd">@server2.demo.local</span><span class="p">:</span><span class="o">~/</span>
<span class="n">server</span><span class="nd">@server2.demo.local</span><span class="s">'s password:
file.txt                                    100%    6     1.8KB/s   00:00
# copy dir
$ scp -r ./demos/ server@server2.demo.local:~/
server@server2.demo.local'</span><span class="n">s</span> <span class="n">password</span><span class="p">:</span>
<span class="mi">1</span>                                   <span class="mi">100</span><span class="o">%</span>    <span class="mi">6</span>     <span class="mf">1.8</span><span class="n">KB</span><span class="o">/</span><span class="n">s</span>   <span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
<span class="mi">2</span>                                   <span class="mi">100</span><span class="o">%</span>    <span class="mi">6</span>     <span class="mf">1.8</span><span class="n">KB</span><span class="o">/</span><span class="n">s</span>   <span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
<span class="mi">3</span>                                   <span class="mi">100</span><span class="o">%</span>    <span class="mi">6</span>     <span class="mf">1.8</span><span class="n">KB</span><span class="o">/</span><span class="n">s</span>   <span class="mi">00</span><span class="p">:</span><span class="mi">00</span>



<span class="mf">2.</span> <span class="n">execute</span> <span class="n">rcommand</span> <span class="n">on</span> <span class="n">remote</span> <span class="n">pc</span>

<span class="c1"># command
</span><span class="err">$</span> <span class="n">ssh</span> <span class="n">server</span><span class="nd">@server2.demo.local</span> <span class="n">ls</span>
<span class="n">server</span><span class="nd">@server2.demo.local</span><span class="s">'s password:
Desktop
Documents
Downloads
file.txt
Music
Pictures
Public
Templates
Videos

# bash script
$ vi myhosts
server0.demo.local
server1.demo.local
server2.demo.local

$ vi remotecmd.sh
while read name
do
  ssh -l server $name -n "ps -aux --noheaders | sort -nrk 3 | head"
done &lt; myhosts
# execute the command: take all of the output of ps, sort it by the third column (CPU), and then give the top 10.


$ sh remotecmd.sh  # can use public key login with no passwd
server@server0.demo.local'</span><span class="n">s</span> <span class="n">password</span><span class="p">:</span>
<span class="n">server</span>    <span class="mi">2611</span>  <span class="mf">0.5</span> <span class="mf">11.9</span> <span class="mi">2945612</span> <span class="mi">294332</span> <span class="n">tty2</span>   <span class="n">Sl</span><span class="o">+</span>  <span class="n">May22</span>   <span class="mi">7</span><span class="p">:</span><span class="mi">35</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">gnome</span><span class="o">-</span><span class="n">shell</span>
<span class="n">root</span>      <span class="mi">2084</span>  <span class="mf">0.3</span>  <span class="mf">0.3</span> <span class="mi">159480</span>  <span class="mi">9488</span> <span class="err">?</span>        <span class="n">Ss</span>   <span class="mi">12</span><span class="p">:</span><span class="mi">19</span>   <span class="mi">0</span><span class="p">:</span><span class="mi">00</span> <span class="n">sshd</span><span class="p">:</span> <span class="n">server</span> <span class="p">[</span><span class="n">priv</span><span class="p">]</span>
<span class="n">server</span>    <span class="mi">7575</span>  <span class="mf">0.1</span> <span class="mf">11.3</span> <span class="mi">2985364</span> <span class="mi">280268</span> <span class="n">tty2</span>   <span class="n">Sl</span><span class="o">+</span>  <span class="n">May22</span>   <span class="mi">1</span><span class="p">:</span><span class="mi">32</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib64</span><span class="o">/</span><span class="n">firefox</span><span class="o">/</span><span class="n">firefox</span>
<span class="p">...</span>
<span class="n">server</span><span class="nd">@server1.demo.local</span><span class="s">'s password:
server    2611  0.5 11.9 2945612 294332 tty2   Sl+  May22   7:35 /usr/bin/gnome-shell
root      2084  0.3  0.3 159480  9488 ?        Ss   12:19   0:00 sshd: server [priv]
server    7575  0.1 11.3 2985364 280268 tty2   Sl+  May22   1:32 /usr/lib64/firefox/firefox
...
server@server2.demo.local'</span><span class="n">s</span> <span class="n">password</span><span class="p">:</span>
<span class="n">root</span>      <span class="mi">5720</span>  <span class="mf">0.4</span>  <span class="mf">0.3</span> <span class="mi">159480</span>  <span class="mi">9700</span> <span class="err">?</span>        <span class="n">Ss</span>   <span class="mi">12</span><span class="p">:</span><span class="mi">19</span>   <span class="mi">0</span><span class="p">:</span><span class="mi">00</span> <span class="n">sshd</span><span class="p">:</span> <span class="n">server</span> <span class="p">[</span><span class="n">priv</span><span class="p">]</span>
<span class="n">server</span>    <span class="mi">2599</span>  <span class="mf">0.3</span> <span class="mf">10.5</span> <span class="mi">2901520</span> <span class="mi">260392</span> <span class="n">tty2</span>   <span class="n">Sl</span><span class="o">+</span>  <span class="mi">11</span><span class="p">:</span><span class="mi">12</span>   <span class="mi">0</span><span class="p">:</span><span class="mi">12</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">gnome</span><span class="o">-</span><span class="n">shell</span>
<span class="p">...</span>

</pre></table></code></div></div><hr /><h2 id="lab6">lab6:</h2><h3 id="configure-ssh-tunnel">configure SSH tunnel</h3><p>server2:</p><ol><li><p>install httpd</p><li><p>systemctl start httpd</p><li>create file:<div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>echo "hello from server2" &gt; /var/www/html.index.html
more /var/www/html.index.html
</pre></table></code></div></div><li>check firewelld ```py $ firewall-cmd –get-active-zones libvirt interfaces: virbr0 public interfaces: enp0s8</ol><p>$ firewall-cmd –zone=public –list-all public (active) target: default icmp-block-inversion: no interfaces: enp0s8 sources: services: cockpit dhcpv6-client http ssh ports: 22/tcp protocols: masquerade: no forward-ports: source-ports: icmp-blocks: rich rules:</p><p>$ firewall-cmd –permanent –remove-service=http</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>

server1:

```py
$ curl http://server2.demo.local
curl: (7) Failed to connect to server2.demo.local port 80: No route to host

$ ssh -L 8080:server2.demo.local:80 server2.demo.local
server@server2.demo.local's password:
[server@server2 ~]$

[server@server1 ~]$ curl http://localhost:8080
hello from server2
</pre></table></code></div></div><h3 id="remote-desktop-control">remote desktop control</h3><h4 id="x11">X11</h4><p>x11 forwarding, the program, x11 was executing on server2, but the display is been forward to server1. server2</p><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>
<span class="mf">1.</span> <span class="n">install</span> <span class="n">x11</span>

<span class="err">$</span> <span class="n">dnf</span> <span class="n">config</span><span class="o">-</span><span class="n">manager</span> <span class="o">--</span><span class="n">enable</span> <span class="n">PowerTools</span>  <span class="c1"># if yum cannot find x11
</span><span class="err">$</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">xorg</span><span class="o">-</span><span class="n">x11</span><span class="o">-</span><span class="n">apps</span> <span class="o">-</span><span class="n">y</span>

<span class="mf">2.</span> <span class="n">display</span>

<span class="err">$</span> <span class="n">xeyes</span>

<span class="c1"># solution
</span><span class="n">No</span> <span class="n">protocol</span> <span class="n">specified</span>
<span class="n">xhost</span><span class="p">:</span>  <span class="n">unable</span> <span class="n">to</span> <span class="nb">open</span> <span class="n">display</span> <span class="s">":0"</span>
<span class="err">$</span> <span class="n">export</span> <span class="n">DISPLAY</span><span class="o">=</span><span class="p">:</span><span class="mf">0.0</span>
<span class="ow">or</span>
<span class="n">change</span> <span class="n">to</span> <span class="n">normal</span> <span class="n">user</span><span class="p">,</span> <span class="ow">not</span> <span class="n">root</span><span class="p">.</span>
</pre></table></code></div></div><h4 id="vnc">VNC</h4><p>server2:</p><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="mf">1.</span> <span class="n">install</span> <span class="n">the</span> <span class="n">vnc</span>
<span class="err">$</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">tigervnc</span><span class="o">-</span><span class="n">server</span> <span class="o">-</span><span class="n">y</span>



<span class="mf">2.</span> <span class="n">configure</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">cp</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">vncserver</span><span class="nd">@.service</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">vncserver</span><span class="nd">@.service</span>
<span class="c1"># Clean any existing files in /tmp/.X11-unix environment
</span><span class="n">ExecStartPre</span><span class="o">=/</span><span class="nb">bin</span><span class="o">/</span><span class="n">sh</span> <span class="o">-</span><span class="n">c</span> <span class="s">'/usr/bin/vncserver -kill %i &gt; /dev/null 2&gt;&amp;1 || :'</span>
<span class="n">ExecStart</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">vncserver_wrapper</span> <span class="n">server</span> <span class="o">%</span><span class="n">i</span>
<span class="n">ExecStop</span><span class="o">=/</span><span class="nb">bin</span><span class="o">/</span><span class="n">sh</span> <span class="o">-</span><span class="n">c</span> <span class="s">'/usr/bin/vncserver -kill %i &gt; /dev/null 2&gt;&amp;1 || :'</span>

<span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">daemon</span><span class="o">-</span><span class="nb">reload</span>


<span class="mf">3.</span> <span class="n">passwd</span>
<span class="err">$</span> <span class="n">vncpasswd</span>
<span class="n">Password</span><span class="p">:</span>
<span class="n">Verify</span><span class="p">:</span>


<span class="mf">4.</span> <span class="n">confirm</span> <span class="n">the</span> <span class="n">service</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">vncserver</span><span class="o">@</span><span class="p">:</span><span class="mf">1.</span><span class="n">service</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">status</span> <span class="n">vncserver</span><span class="o">@</span><span class="p">:</span><span class="mf">1.</span><span class="n">service</span>

<span class="err">$</span> <span class="n">ss</span> <span class="o">-</span><span class="n">lt4</span>
<span class="n">State</span>   <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span>   <span class="n">Send</span><span class="o">-</span><span class="n">Q</span>        <span class="n">Local</span> <span class="n">Address</span><span class="p">:</span><span class="n">Port</span>         <span class="n">Peer</span> <span class="n">Address</span><span class="p">:</span><span class="n">Port</span>
<span class="n">LISTEN</span>  <span class="mi">0</span>        <span class="mi">5</span>                   <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">5901</span>              <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="o">*</span>
<span class="n">LISTEN</span>  <span class="mi">0</span>        <span class="mi">128</span>                 <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="n">sunrpc</span>            <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="o">*</span>
<span class="n">LISTEN</span>  <span class="mi">0</span>        <span class="mi">32</span>            <span class="mf">192.168</span><span class="p">.</span><span class="mf">122.1</span><span class="p">:</span><span class="n">domain</span>            <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="o">*</span>
<span class="n">LISTEN</span>  <span class="mi">0</span>        <span class="mi">128</span>                 <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="n">ssh</span>               <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="o">*</span>
<span class="n">LISTEN</span>  <span class="mi">0</span>        <span class="mi">5</span>                 <span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span><span class="p">:</span><span class="n">ipp</span>               <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="o">*</span>
</pre></table></code></div></div><p>server1: client</p><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="mf">1.</span> <span class="n">install</span>
<span class="err">$</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">tigervnc</span> <span class="o">-</span><span class="n">y</span>


<span class="mf">2.</span> <span class="n">to</span> <span class="n">connect</span> <span class="n">to</span> <span class="n">unfirewall</span> <span class="n">server</span><span class="p">.</span>
<span class="err">$</span> <span class="n">vncviewer</span> <span class="n">server2</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">local</span><span class="p">:</span><span class="mi">1</span>


<span class="mf">3.</span> <span class="n">use</span> <span class="n">ssh</span> <span class="n">tunneling</span> <span class="n">to</span> <span class="n">firewelld</span> <span class="n">server</span><span class="p">.</span>
<span class="err">$</span> <span class="n">ssh</span> <span class="o">-</span><span class="n">L</span> <span class="mi">5901</span><span class="p">:</span><span class="n">server2</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">local</span><span class="p">:</span><span class="mi">5901</span> <span class="n">server2</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">local</span> <span class="o">-</span><span class="n">N</span>
<span class="c1"># not open a session, just open tunnel
# now start running
</span><span class="p">[</span><span class="n">control</span><span class="o">+</span><span class="n">z</span><span class="p">]</span> <span class="c1"># stop the processes
</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span>  <span class="n">Stopped</span>                 <span class="n">ssh</span> <span class="o">-</span><span class="n">L</span> <span class="mi">5901</span><span class="p">:</span><span class="n">server2</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">local</span><span class="p">:</span><span class="mi">5901</span> <span class="n">server2</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">local</span> <span class="o">-</span><span class="n">N</span>

<span class="err">$</span> <span class="n">bg</span>    <span class="c1"># background the tunnel, back and running, just a background task
</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="n">ssh</span> <span class="o">-</span><span class="n">L</span> <span class="mi">5901</span><span class="p">:</span><span class="n">server2</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">local</span><span class="p">:</span><span class="mi">5901</span> <span class="n">server2</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">local</span> <span class="o">-</span><span class="n">N</span> <span class="o">&amp;</span>

<span class="err">$</span> <span class="n">vncviewer</span> <span class="n">localhost</span><span class="p">:</span><span class="mi">5901</span>
<span class="c1"># login with vnc passwd
</span></pre></table></code></div></div><h2 id="solution">solution</h2><h3 id="server-0-iptable-vs-firewelld">server 0 iptable vs firewelld</h3><p>server0:</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="n">iptables</span> <span class="o">-</span><span class="n">L</span> <span class="o">-</span><span class="n">v</span>
<span class="n">Chain</span> <span class="n">INPUT</span> <span class="p">(</span><span class="n">policy</span> <span class="n">ACCEPT</span> <span class="mi">0</span> <span class="n">packets</span><span class="p">,</span> <span class="mi">0</span> <span class="n">bytes</span><span class="p">)</span>
 <span class="n">pkts</span> <span class="n">bytes</span> <span class="n">target</span>     <span class="n">prot</span> <span class="n">opt</span> <span class="n">in</span>     <span class="n">out</span>     <span class="n">source</span>               <span class="n">destination</span>
    <span class="mi">0</span>     <span class="mi">0</span> <span class="n">ACCEPT</span>     <span class="n">all</span>  <span class="o">--</span>  <span class="n">any</span>    <span class="n">any</span>     <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">25</span>       <span class="n">anywhere</span>
    <span class="mi">0</span>     <span class="mi">0</span> <span class="n">ACCEPT</span>     <span class="n">all</span>  <span class="o">--</span>  <span class="n">any</span>    <span class="n">any</span>     <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">24</span>       <span class="n">anywhere</span>
    <span class="mi">8</span>   <span class="mi">584</span> <span class="n">ACCEPT</span>     <span class="n">all</span>  <span class="o">--</span>  <span class="n">any</span>    <span class="n">any</span>     <span class="n">anywhere</span>             <span class="n">anywhere</span>             <span class="n">state</span> <span class="n">RELATED</span><span class="p">,</span><span class="n">ESTABLISHED</span>
    <span class="mi">0</span>     <span class="mi">0</span> <span class="n">ACCEPT</span>     <span class="n">icmp</span> <span class="o">--</span>  <span class="n">any</span>    <span class="n">any</span>     <span class="n">anywhere</span>             <span class="n">anywhere</span>
    <span class="mi">0</span>     <span class="mi">0</span> <span class="n">ACCEPT</span>     <span class="n">all</span>  <span class="o">--</span>  <span class="n">lo</span>     <span class="n">any</span>     <span class="n">anywhere</span>             <span class="n">anywhere</span>
    <span class="mi">0</span>     <span class="mi">0</span> <span class="n">ACCEPT</span>     <span class="n">tcp</span>  <span class="o">--</span>  <span class="n">any</span>    <span class="n">any</span>     <span class="n">anywhere</span>             <span class="n">anywhere</span>             <span class="n">state</span> <span class="n">NEW</span> <span class="n">tcp</span> <span class="n">dpt</span><span class="o">:</span><span class="n">ssh</span>
  <span class="mi">134</span> <span class="mi">38780</span> <span class="n">REJECT</span>     <span class="n">all</span>  <span class="o">--</span>  <span class="n">any</span>    <span class="n">any</span>     <span class="n">anywhere</span>             <span class="n">anywhere</span>             <span class="n">reject</span><span class="o">-</span><span class="n">with</span> <span class="n">icmp</span><span class="o">-</span><span class="n">host</span><span class="o">-</span><span class="n">prohibited</span>

<span class="n">Chain</span> <span class="n">FORWARD</span> <span class="p">(</span><span class="n">policy</span> <span class="n">ACCEPT</span> <span class="mi">0</span> <span class="n">packets</span><span class="p">,</span> <span class="mi">0</span> <span class="n">bytes</span><span class="p">)</span>
 <span class="n">pkts</span> <span class="n">bytes</span> <span class="n">target</span>     <span class="n">prot</span> <span class="n">opt</span> <span class="n">in</span>     <span class="n">out</span>     <span class="n">source</span>               <span class="n">destination</span>
    <span class="mi">2</span>   <span class="mi">142</span> <span class="n">ACCEPT</span>     <span class="n">all</span>  <span class="o">--</span>  <span class="n">any</span>    <span class="n">any</span>     <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">25</span>       <span class="n">anywhere</span>
    <span class="mi">0</span>     <span class="mi">0</span> <span class="n">ACCEPT</span>     <span class="n">all</span>  <span class="o">--</span>  <span class="n">any</span>    <span class="n">any</span>     <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">24</span>       <span class="n">anywhere</span>
  <span class="mi">127</span>  <span class="mi">9676</span> <span class="n">REJECT</span>     <span class="n">all</span>  <span class="o">--</span>  <span class="n">any</span>    <span class="n">any</span>     <span class="n">anywhere</span>             <span class="n">anywhere</span>             <span class="n">reject</span><span class="o">-</span><span class="n">with</span> <span class="n">icmp</span><span class="o">-</span><span class="n">host</span><span class="o">-</span><span class="n">prohibited</span>

<span class="n">Chain</span> <span class="n">OUTPUT</span> <span class="p">(</span><span class="n">policy</span> <span class="n">ACCEPT</span> <span class="mi">87</span> <span class="n">packets</span><span class="p">,</span> <span class="mi">8789</span> <span class="n">bytes</span><span class="p">)</span>
 <span class="n">pkts</span> <span class="n">bytes</span> <span class="n">target</span>     <span class="n">prot</span> <span class="n">opt</span> <span class="n">in</span>     <span class="n">out</span>     <span class="n">source</span>               <span class="n">destination</span>
</pre></table></code></div></div><p>after start firewalld</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="cp"># iptables -L -v
</span><span class="n">Chain</span> <span class="n">INPUT</span> <span class="p">(</span><span class="n">policy</span> <span class="n">ACCEPT</span> <span class="mi">24</span> <span class="n">packets</span><span class="p">,</span> <span class="mi">6684</span> <span class="n">bytes</span><span class="p">)</span>
 <span class="n">pkts</span> <span class="n">bytes</span> <span class="n">target</span>     <span class="n">prot</span> <span class="n">opt</span> <span class="n">in</span>     <span class="n">out</span>     <span class="n">source</span>               <span class="n">destination</span>
    <span class="mi">0</span>     <span class="mi">0</span> <span class="n">ACCEPT</span>     <span class="n">udp</span>  <span class="o">--</span>  <span class="n">virbr0</span> <span class="n">any</span>     <span class="n">anywhere</span>             <span class="n">anywhere</span>             <span class="n">udp</span> <span class="n">dpt</span><span class="o">:</span><span class="n">domain</span>
    <span class="mi">0</span>     <span class="mi">0</span> <span class="n">ACCEPT</span>     <span class="n">tcp</span>  <span class="o">--</span>  <span class="n">virbr0</span> <span class="n">any</span>     <span class="n">anywhere</span>             <span class="n">anywhere</span>             <span class="n">tcp</span> <span class="n">dpt</span><span class="o">:</span><span class="n">domain</span>
    <span class="mi">0</span>     <span class="mi">0</span> <span class="n">ACCEPT</span>     <span class="n">udp</span>  <span class="o">--</span>  <span class="n">virbr0</span> <span class="n">any</span>     <span class="n">anywhere</span>             <span class="n">anywhere</span>             <span class="n">udp</span> <span class="n">dpt</span><span class="o">:</span><span class="n">bootps</span>
    <span class="mi">0</span>     <span class="mi">0</span> <span class="n">ACCEPT</span>     <span class="n">tcp</span>  <span class="o">--</span>  <span class="n">virbr0</span> <span class="n">any</span>     <span class="n">anywhere</span>             <span class="n">anywhere</span>             <span class="n">tcp</span> <span class="n">dpt</span><span class="o">:</span><span class="n">bootps</span>

<span class="n">Chain</span> <span class="n">FORWARD</span> <span class="p">(</span><span class="n">policy</span> <span class="n">ACCEPT</span> <span class="mi">0</span> <span class="n">packets</span><span class="p">,</span> <span class="mi">0</span> <span class="n">bytes</span><span class="p">)</span>
 <span class="n">pkts</span> <span class="n">bytes</span> <span class="n">target</span>     <span class="n">prot</span> <span class="n">opt</span> <span class="n">in</span>     <span class="n">out</span>     <span class="n">source</span>               <span class="n">destination</span>
    <span class="mi">0</span>     <span class="mi">0</span> <span class="n">ACCEPT</span>     <span class="n">all</span>  <span class="o">--</span>  <span class="n">any</span>    <span class="n">virbr0</span>  <span class="n">anywhere</span>             <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">122</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">24</span>     <span class="n">ctstate</span> <span class="n">RELATED</span><span class="p">,</span><span class="n">ESTABLISHED</span>
    <span class="mi">0</span>     <span class="mi">0</span> <span class="n">ACCEPT</span>     <span class="n">all</span>  <span class="o">--</span>  <span class="n">virbr0</span> <span class="n">any</span>     <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">122</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">24</span>     <span class="n">anywhere</span>
    <span class="mi">0</span>     <span class="mi">0</span> <span class="n">ACCEPT</span>     <span class="n">all</span>  <span class="o">--</span>  <span class="n">virbr0</span> <span class="n">virbr0</span>  <span class="n">anywhere</span>             <span class="n">anywhere</span>
    <span class="mi">0</span>     <span class="mi">0</span> <span class="n">REJECT</span>     <span class="n">all</span>  <span class="o">--</span>  <span class="n">any</span>    <span class="n">virbr0</span>  <span class="n">anywhere</span>             <span class="n">anywhere</span>             <span class="n">reject</span><span class="o">-</span><span class="n">with</span> <span class="n">icmp</span><span class="o">-</span><span class="n">port</span><span class="o">-</span><span class="n">unreachable</span>
    <span class="mi">0</span>     <span class="mi">0</span> <span class="n">REJECT</span>     <span class="n">all</span>  <span class="o">--</span>  <span class="n">virbr0</span> <span class="n">any</span>     <span class="n">anywhere</span>             <span class="n">anywhere</span>             <span class="n">reject</span><span class="o">-</span><span class="n">with</span> <span class="n">icmp</span><span class="o">-</span><span class="n">port</span><span class="o">-</span><span class="n">unreachable</span>
    <span class="mi">0</span>     <span class="mi">0</span> <span class="n">ACCEPT</span>     <span class="n">all</span>  <span class="o">--</span>  <span class="n">any</span>    <span class="n">any</span>     <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">24</span>       <span class="n">anywhere</span>
    <span class="mi">0</span>     <span class="mi">0</span> <span class="n">ACCEPT</span>     <span class="n">all</span>  <span class="o">--</span>  <span class="n">any</span>    <span class="n">any</span>     <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">25</span>       <span class="n">anywhere</span>
    <span class="mi">1</span>    <span class="mi">60</span> <span class="n">ACCEPT</span>     <span class="n">all</span>  <span class="o">--</span>  <span class="n">any</span>    <span class="n">any</span>     <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">24</span>       <span class="n">anywhere</span>

<span class="n">Chain</span> <span class="n">OUTPUT</span> <span class="p">(</span><span class="n">policy</span> <span class="n">ACCEPT</span> <span class="mi">1</span> <span class="n">packets</span><span class="p">,</span> <span class="mi">88</span> <span class="n">bytes</span><span class="p">)</span>
 <span class="n">pkts</span> <span class="n">bytes</span> <span class="n">target</span>     <span class="n">prot</span> <span class="n">opt</span> <span class="n">in</span>     <span class="n">out</span>     <span class="n">source</span>               <span class="n">destination</span>
    <span class="mi">0</span>     <span class="mi">0</span> <span class="n">ACCEPT</span>     <span class="n">udp</span>  <span class="o">--</span>  <span class="n">any</span>    <span class="n">virbr0</span>  <span class="n">anywhere</span>             <span class="n">anywhere</span>             <span class="n">udp</span> <span class="n">dpt</span><span class="o">:</span><span class="n">bootpc</span>
</pre></table></code></div></div><p>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/00codenote/'>00CodeNote</a>, <a href='/categories/linuxnote/'>LinuxNote</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linux/" class="post-tag no-text-decoration" >Linux</a> <a href="/tags/lfce/" class="post-tag no-text-decoration" >LFCE</a> <a href="/tags/pluralsight/" class="post-tag no-text-decoration" >Pluralsight</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=LFCE.3 Network and Host Security - Grace&url=https://ocholuo.github.io//posts/LFCE.3.NetworkandHostSecurity/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=LFCE.3 Network and Host Security - Grace&u=https://ocholuo.github.io//posts/LFCE.3.NetworkandHostSecurity/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=LFCE.3 Network and Host Security - Grace&url=https://ocholuo.github.io//posts/LFCE.3.NetworkandHostSecurity/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Amazon-CloudFront/">AWS Lab - AWS CloudFront</a><li><a href="/posts/Alexa-1stSkill/">AWS Alex First Skill - RedVelvet Time</a><li><a href="/posts/NetworkProtocol-SSL-TLS-Handshake/">NetworkProtocol SSL/TLS Handshake</a><li><a href="/posts/pythonCrash/">Python Crash</a><li><a href="/posts/%E4%B8%80%E5%8F%A5%E8%AF%9D%E8%A7%A3%E9%87%8AAWS/">AWS - 一句话解释AWS</a><li><a href="/posts/GKE/">GCP - Google Cloud Computing - Kubernetes and Kubernetes Engine</a><li><a href="/posts/Go-Note/">Go Note</a><li><a href="/posts/SCPs/">AWS - IdenAccessManage - SCPs (Service Control Policies)</a><li><a href="/posts/CompanyBenefit/">Company Benefit</a><li><a href="/posts/Encryption-SSL&TLS/">Cryptography - SSL/TLS Encryption</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/CentOSEnterpriseLinuxUserandGroupManagement/"><div class="card-body"> <span class="timeago small" >Jul 16, 2020<i class="unloaded">2020-07-16T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Linux - CentOS Enterprise User and Group Management</h3><div class="text-muted small"><p> CentOS Enterprise Linux User and Group Management [toc] PAM PAM: pluggable authentictaion module user login (SSH, Condole, GUI…) -&gt; PAM (Authentication, limits, home directory) -&gt; access ...</p></div></div></a></div><div class="card"> <a href="/posts/LFCE.1.AdvancedLinuxNetworking/"><div class="card-body"> <span class="timeago small" >Jul 16, 2020<i class="unloaded">2020-07-16T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>LFCE.1 Advanced Linux Networking</h3><div class="text-muted small"><p> LFCE: Advanced Linux Networking [toc] virtual network Setup between centos make a virtual network things you gotta do first 1. virtubalbox. add network adapter. server0 &gt; adapter 1: ...</p></div></div></a></div><div class="card"> <a href="/posts/LFCE.2.AdvancedNetworkandSystemAdministration/"><div class="card-body"> <span class="timeago small" >Jul 16, 2020<i class="unloaded">2020-07-16T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>LFCE.2 Advanced Network and System Administration</h3><div class="text-muted small"><p> LFCE: Advanced Network and System Administration [toc] check the init daemons, Starting and Stopping Services server0: 1. command to switch between runlevels on initd-base Systems $ ls -la /s...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/LFCE.2.AdvancedNetworkandSystemAdministration/" class="btn btn-outline-primary" prompt="Older"><p>LFCE.2 Advanced Network and System Administration</p></a> <a href="/posts/LFCE.4.LinuxServiceManagement-HTTPServices/" class="btn btn-outline-primary" prompt="Newer"><p>LFCE.4 Linux Service Management - HTTP Services</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ocholuo">Grace JyL</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ocholuo.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script defer src="/assets/js/dist/pvreport.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-179830187-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-179830187-1'); }); </script>
