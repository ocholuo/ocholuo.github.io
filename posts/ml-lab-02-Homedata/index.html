<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="pv-proxy-endpoint" content="https://myochosite-291718.appspot.com/query?id=ahNwfm15b2Nob3NpdGUtMjkxNzE4chULEghBcGlRdWVyeRiAgIDo14eBCgw"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="ML lab 02 - Predict home prices in Iowa" /><meta property="og:locale" content="en" /><meta name="description" content="ML lab - Home data Basic Step 1: Evaluate several models Step 2: Generate test predictions Missing value Step 1: Preliminary investigation Step 2: Drop columns with missing values Step 3: Imputation Step 4: Generate test predictions Part A Part B" /><meta property="og:description" content="ML lab - Home data Basic Step 1: Evaluate several models Step 2: Generate test predictions Missing value Step 1: Preliminary investigation Step 2: Drop columns with missing values Step 3: Imputation Step 4: Generate test predictions Part A Part B" /><link rel="canonical" href="https://ocholuo.github.io//posts/ml-lab-02-Homedata/" /><meta property="og:url" content="https://ocholuo.github.io//posts/ml-lab-02-Homedata/" /><meta property="og:site_name" content="Grace" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-11T11:11:11-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="ML lab 02 - Predict home prices in Iowa" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-02T18:38:55-05:00","datePublished":"2021-08-11T11:11:11-04:00","description":"ML lab - Home data Basic Step 1: Evaluate several models Step 2: Generate test predictions Missing value Step 1: Preliminary investigation Step 2: Drop columns with missing values Step 3: Imputation Step 4: Generate test predictions Part A Part B","headline":"ML lab 02 - Predict home prices in Iowa","mainEntityOfPage":{"@type":"WebPage","@id":"https://ocholuo.github.io//posts/ml-lab-02-Homedata/"},"url":"https://ocholuo.github.io//posts/ml-lab-02-Homedata/"}</script><title>ML lab 02 - Predict home prices in Iowa | Grace</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Grace"><meta name="application-name" content="Grace"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://myochosite-291718.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://myochosite-291718.appspot.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/huoye.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Grace</a></div><div class="site-subtitle font-italic">2023 Mar 14 updated</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/ocholuo" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>ML lab 02 - Predict home prices in Iowa</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>ML lab 02 - Predict home prices in Iowa</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Grace JyL </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Aug 11, 2021, 11:11 AM -0400" >Aug 11, 2021<i class="unloaded">2021-08-11T11:11:11-04:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Jan 2, 2023, 3:38 PM -0800" >Jan 2<i class="unloaded">2023-01-02T18:38:55-05:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1939 words">10 min read</span> <span id="pv" class="pageviews"> <i class="fas fa-spinner fa-spin fa-fw"></i> </span> views</div></div><div class="post-content"><ul><li><a href="#ml-lab---home-data">ML lab - Home data</a><ul><li><a href="#basic">Basic</a><ul><li><a href="#step-1-evaluate-several-models">Step 1: Evaluate several models</a><li><a href="#step-2-generate-test-predictions">Step 2: Generate test predictions</a></ul><li><a href="#missing-value">Missing value</a><ul><li><a href="#step-1-preliminary-investigation">Step 1: Preliminary investigation</a><li><a href="#step-2-drop-columns-with-missing-values">Step 2: Drop columns with missing values</a><li><a href="#step-3-imputation">Step 3: Imputation</a><li><a href="#step-4-generate-test-predictions">Step 4: Generate test predictions</a><ul><li><a href="#part-a">Part A</a><li><a href="#part-b">Part B</a></ul></ul></ul><li>ref<ul><li>https://www.kaggle.com/learn/intermediate-machine-learning</ul></ul><hr /><h1 id="ml-lab---home-data">ML lab - Home data</h1><p>work with data from the Housing Prices Competition for Kaggle Learn Users to predict home prices in Iowa using 79 explanatory variables describing (almost) every aspect of the homes.</p><p>In this exercise, you will work with data from the <a href="https://www.kaggle.com/c/home-data-for-ml-course">Housing Prices Competition for Kaggle Learn Users</a>.</p><h2 id="basic">Basic</h2><p>basic approach for the ML</p><ol><li>Set up code checking<li>Read the data <code class="language-plaintext highlighter-rouge">X_data/test_full = pd.read_csv()</code><li>Obtain target <code class="language-plaintext highlighter-rouge">y_data = X_data_full.SalePrice</code><li>Obtain redictors <code class="language-plaintext highlighter-rouge">X_data/test = X_data_full[A,B,C,D].copy()</code><li>Break off validation set from training data <code class="language-plaintext highlighter-rouge">X_train, X_valid, y_train, y_valid = train_test_split()</code><li>test head <code class="language-plaintext highlighter-rouge">X_train.head()</code><li>defines different random forest models <code class="language-plaintext highlighter-rouge">model = RandomForestRegressor(n_estimators=50, random_state=0)</code><li>define a function returns the mean absolute error (MAE) from the validation set.</ol><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>  <span class="k">def</span> <span class="nf">score_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_t</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_v</span><span class="o">=</span><span class="n">X_valid</span><span class="p">,</span> <span class="n">y_t</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_v</span><span class="o">=</span><span class="n">y_valid</span><span class="p">):</span>
      <span class="n">model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_t</span><span class="p">,</span> <span class="n">y_t</span><span class="p">)</span>
      <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_v</span><span class="p">)</span>
      <span class="k">return</span> <span class="nf">mean_absolute_error</span><span class="p">(</span><span class="n">y_v</span><span class="p">,</span> <span class="n">preds</span><span class="p">)</span>
  <span class="err">​</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">models</span><span class="p">)):</span>
      <span class="n">mae</span> <span class="o">=</span> <span class="nf">score_model</span><span class="p">(</span><span class="n">models</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
      <span class="nf">print</span><span class="p">(</span><span class="s">"Model %d MAE: %d"</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">mae</span><span class="p">))</span>
</pre></table></code></div></div><ol><li>best_model <code class="language-plaintext highlighter-rouge">my_model = RandomForestRegressor(n_estimators=100, random_state=0]=56)</code><li><p>Generate test predictions</p><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">my_model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">preds_test</span> <span class="o">=</span> <span class="n">my_model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span><span class="s">'Id'</span><span class="p">:</span> <span class="n">X_test</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="s">'SalePrice'</span><span class="p">:</span> <span class="n">preds_test</span><span class="p">})</span>
<span class="n">output</span><span class="p">.</span><span class="nf">to_csv</span><span class="p">(</span><span class="s">'submission.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></table></code></div></div></ol><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
</pre><td class="rouge-code"><pre><span class="c1"># =============================== Set up code checking
</span><span class="kn">import</span> <span class="n">os</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">exists</span><span class="p">(</span><span class="s">"../input/train.csv"</span><span class="p">):</span>
    <span class="n">os</span><span class="p">.</span><span class="nf">symlink</span><span class="p">(</span><span class="s">"../input/home-data-for-ml-course/train.csv"</span><span class="p">,</span> <span class="s">"../input/train.csv"</span><span class="p">)</span>
    <span class="n">os</span><span class="p">.</span><span class="nf">symlink</span><span class="p">(</span><span class="s">"../input/home-data-for-ml-course/test.csv"</span><span class="p">,</span> <span class="s">"../input/test.csv"</span><span class="p">)</span>

<span class="kn">from</span> <span class="n">learntools.core</span> <span class="kn">import</span> <span class="n">binder</span>
<span class="n">binder</span><span class="p">.</span><span class="nf">bind</span><span class="p">(</span><span class="nf">globals</span><span class="p">())</span>
<span class="kn">from</span> <span class="n">learntools.ml_intermediate.ex1</span> <span class="kn">import</span> <span class="o">*</span>
<span class="nf">print</span><span class="p">(</span><span class="s">"Setup Complete"</span><span class="p">)</span>



<span class="c1"># =============================== setup ML module
</span><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># Read the data
</span><span class="n">X_data_full</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="s">'../input/train.csv'</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s">'Id'</span><span class="p">)</span>
<span class="n">X_test_full</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="s">'../input/test.csv'</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s">'Id'</span><span class="p">)</span>

<span class="c1"># Obtain target and predictors
</span><span class="n">y_data</span> <span class="o">=</span> <span class="n">X_data_full</span><span class="p">.</span><span class="n">SalePrice</span>

<span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s">'LotArea'</span><span class="p">,</span> <span class="s">'YearBuilt'</span><span class="p">,</span> <span class="s">'1stFlrSF'</span><span class="p">,</span> <span class="s">'2ndFlrSF'</span><span class="p">,</span> <span class="s">'FullBath'</span><span class="p">,</span> <span class="s">'BedroomAbvGr'</span><span class="p">,</span> <span class="s">'TotRmsAbvGrd'</span><span class="p">]</span>
<span class="n">X_data</span> <span class="o">=</span> <span class="n">X_data_full</span><span class="p">[</span><span class="n">features</span><span class="p">].</span><span class="nf">copy</span><span class="p">()</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test_full</span><span class="p">[</span><span class="n">features</span><span class="p">].</span><span class="nf">copy</span><span class="p">()</span>

<span class="c1"># Break off validation set from training data
</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="nf">train_test_split</span><span class="p">(</span>
    <span class="n">X_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">X_train</span><span class="p">.</span><span class="nf">head</span><span class="p">()</span>
<span class="c1">#      LotArea	YearBuilt	1stFlrSF	2ndFlrSF	FullBath	BedroomAbvGr	TotRmsAbvGrd
# Id
# 619	11694	2007	1828	0	2	3	9
# 871	6600	1962	894	0	1	2	5
# 93	13360	1921	964	0	1	2	5
# 818	13265	2002	1689	0	2	3	7
# 303	13704	2001	1541	0	2	3	6
</span>

<span class="c1"># =============================== defines five different random forest models
</span><span class="kn">from</span> <span class="n">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="c1"># Define the models
</span><span class="n">model_1</span> <span class="o">=</span> <span class="nc">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">model_2</span> <span class="o">=</span> <span class="nc">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">model_3</span> <span class="o">=</span> <span class="nc">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s">'mae'</span><span class="p">)</span>
<span class="n">model_4</span> <span class="o">=</span> <span class="nc">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">model_5</span> <span class="o">=</span> <span class="nc">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="n">model_1</span><span class="p">,</span> <span class="n">model_2</span><span class="p">,</span> <span class="n">model_3</span><span class="p">,</span> <span class="n">model_4</span><span class="p">,</span> <span class="n">model_5</span><span class="p">]</span>


<span class="c1"># =============================== select the best model out of the five
# define a function score_model(), returns the mean absolute error (MAE) from the validation set.
# the best model will obtain the lowest MAE.
</span><span class="kn">from</span> <span class="n">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span>
<span class="err">​</span>
<span class="c1"># Function for comparing different models
</span><span class="k">def</span> <span class="nf">score_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_t</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_v</span><span class="o">=</span><span class="n">X_valid</span><span class="p">,</span> <span class="n">y_t</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_v</span><span class="o">=</span><span class="n">y_valid</span><span class="p">):</span>
    <span class="n">model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_t</span><span class="p">,</span> <span class="n">y_t</span><span class="p">)</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_v</span><span class="p">)</span>
    <span class="k">return</span> <span class="nf">mean_absolute_error</span><span class="p">(</span><span class="n">y_v</span><span class="p">,</span> <span class="n">preds</span><span class="p">)</span>
<span class="err">​</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">models</span><span class="p">)):</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="nf">score_model</span><span class="p">(</span><span class="n">models</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Model %d MAE: %d"</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">mae</span><span class="p">))</span>
<span class="c1"># Model 1 MAE: 24015
# Model 2 MAE: 23740
# Model 3 MAE: 23528
# Model 4 MAE: 23996
# Model 5 MAE: 23706
</span></pre></table></code></div></div><h3 id="step-1-evaluate-several-models">Step 1: Evaluate several models</h3><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># Fill in the best model
</span><span class="n">best_model</span> <span class="o">=</span> <span class="n">model_3</span>
</pre></table></code></div></div><h3 id="step-2-generate-test-predictions">Step 2: Generate test predictions</h3><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="c1"># Define a model
</span><span class="n">my_model</span> <span class="o">=</span> <span class="nc">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Fit the model to the training data
</span><span class="n">my_model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Generate test predictions
</span><span class="n">preds_test</span> <span class="o">=</span> <span class="n">my_model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Save predictions in format used for competition scoring
</span><span class="n">output</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span><span class="s">'Id'</span><span class="p">:</span> <span class="n">X_test</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="s">'SalePrice'</span><span class="p">:</span> <span class="n">preds_test</span><span class="p">})</span>
<span class="n">output</span><span class="p">.</span><span class="nf">to_csv</span><span class="p">(</span><span class="s">'submission.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="missing-value">Missing value</h2><ol><li>Set up code checking<li>Read the data <code class="language-plaintext highlighter-rouge">X_data/test_full = pd.read_csv()</code><li>Remove rows with missing target, separate target from predictors</ol><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>  <span class="n">X_data_full</span><span class="p">.</span><span class="nf">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s">'SalePrice'</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
  <span class="n">y</span> <span class="o">=</span> <span class="n">X_data_full</span><span class="p">.</span><span class="n">SalePrice</span>

  <span class="n">X_data_full</span><span class="p">.</span><span class="nf">drop</span><span class="p">([</span><span class="s">'SalePrice'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
  <span class="n">X</span> <span class="o">=</span> <span class="n">X_data_full</span><span class="p">.</span><span class="nf">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s">'object'</span><span class="p">])</span>
  <span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test_full</span><span class="p">.</span><span class="nf">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s">'object'</span><span class="p">])</span>
</pre></table></code></div></div><ol><li>Break off validation set from training data <code class="language-plaintext highlighter-rouge">X_train, X_valid, y_train, y_valid = train_test_split()</code><li><p>test head <code class="language-plaintext highlighter-rouge">X_train.head()</code></p><li><strong>Preliminary investigation</strong><ol><li>Shape of training data (num_rows, num_columns) <code class="language-plaintext highlighter-rouge">print(X_train.shape)</code><li><p>check Number of missing values in each column of training data</p><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">missing_val_count_by_column</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_train</span><span class="p">.</span><span class="nf">isnull</span><span class="p">().</span><span class="nf">sum</span><span class="p">())</span>
<span class="nf">print</span><span class="p">(</span><span class="n">missing_val_count_by_column</span><span class="p">[</span><span class="n">missing_val_count_by_column</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
</pre></table></code></div></div><li><p>Function for comparing different approachesop054</p><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">score_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_t</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_v</span><span class="o">=</span><span class="n">X_valid</span><span class="p">,</span> <span class="n">y_t</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_v</span><span class="o">=</span><span class="n">y_valid</span><span class="p">):</span>
    <span class="n">model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_t</span><span class="p">,</span> <span class="n">y_t</span><span class="p">)</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_v</span><span class="p">)</span>
    <span class="k">return</span> <span class="nf">mean_absolute_error</span><span class="p">(</span><span class="n">y_v</span><span class="p">,</span> <span class="n">preds</span><span class="p">)</span>
</pre></table></code></div></div></ol><li><strong>Drop columns with missing values</strong></ol><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>  <span class="n">cols_missing</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">X_train</span><span class="p">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">X_train</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="nf">isnull</span><span class="p">().</span><span class="nf">any</span><span class="p">()]</span>
  <span class="n">reduced_X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">.</span><span class="nf">drop</span><span class="p">(</span><span class="n">cols_missing</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">reduced_X_valid</span> <span class="o">=</span> <span class="n">X_valid</span><span class="p">.</span><span class="nf">drop</span><span class="p">(</span><span class="n">cols_missing</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="nf">print</span><span class="p">(</span><span class="nf">score_dataset</span><span class="p">(</span><span class="n">reduced_X_train</span><span class="p">,</span> <span class="n">reduced_X_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">))</span>
  <span class="c1"># MAE (Drop columns with missing values): 17837.82570776256
</span></pre></table></code></div></div><ol><li><strong>Imputation</strong> impute missing values with the mean value along each column.</ol><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>  <span class="kn">from</span> <span class="n">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>
  <span class="n">my_imputer</span> <span class="o">=</span> <span class="nc">SimpleImputer</span><span class="p">()</span>
  <span class="n">imputed_X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">my_imputer</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span>
  <span class="n">imputed_X_valid</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">my_imputer</span><span class="p">.</span><span class="nf">transform</span><span class="p">(</span><span class="n">X_valid</span><span class="p">))</span>

  <span class="n">imputed_X_train</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">.</span><span class="n">columns</span>
  <span class="n">imputed_X_valid</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">X_valid</span><span class="p">.</span><span class="n">columns</span>

  <span class="nf">print</span><span class="p">(</span><span class="nf">score_dataset</span><span class="p">(</span><span class="n">imputed_X_train</span><span class="p">,</span> <span class="n">imputed_X_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">))</span>
  <span class="c1"># MAE (Imputation): 18062.894611872147
</span></pre></table></code></div></div><ol><li><strong>Generate test predictions</strong><ol><li>Part A: preprocess the training and validation data.<li><p>Part B: preprocess test data</p><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="n">final_imputer</span> <span class="o">=</span> <span class="nc">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s">'median'</span><span class="p">)</span>
<span class="n">final_X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">final_imputer</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span>
<span class="n">final_X_valid</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">final_imputer</span><span class="p">.</span><span class="nf">transform</span><span class="p">(</span><span class="n">X_valid</span><span class="p">))</span>

<span class="n">final_X_train</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">.</span><span class="n">columns</span>
<span class="n">final_X_valid</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">X_valid</span><span class="p">.</span><span class="n">columns</span>

<span class="n">final_X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">final_imputer</span><span class="p">.</span><span class="nf">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
<span class="n">preds_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">final_X_test</span><span class="p">)</span>

<span class="n">output</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span><span class="s">'Id'</span><span class="p">:</span> <span class="n">X_test</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="s">'SalePrice'</span><span class="p">:</span> <span class="n">preds_test</span><span class="p">})</span>
<span class="n">output</span><span class="p">.</span><span class="nf">to_csv</span><span class="p">(</span><span class="s">'submission.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></table></code></div></div></ol></ol><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre>
<span class="c1"># =============================== delete the columns
</span><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># Read the data
</span><span class="n">X_data_full</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="s">'../input/train.csv'</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s">'Id'</span><span class="p">)</span>
<span class="n">X_test_full</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="s">'../input/test.csv'</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s">'Id'</span><span class="p">)</span>

<span class="c1"># Remove rows with missing target, separate target from predictors
</span><span class="n">X_data_full</span><span class="p">.</span><span class="nf">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s">'SalePrice'</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">X_data_full</span><span class="p">.</span><span class="n">SalePrice</span>
<span class="n">X_data_full</span><span class="p">.</span><span class="nf">drop</span><span class="p">([</span><span class="s">'SalePrice'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># To keep things simple, we'll use only numerical predictors
</span><span class="n">X</span> <span class="o">=</span> <span class="n">X_data_full</span><span class="p">.</span><span class="nf">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s">'object'</span><span class="p">])</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test_full</span><span class="p">.</span><span class="nf">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s">'object'</span><span class="p">])</span>

<span class="c1"># Break off validation set from training data
</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="nf">train_test_split</span><span class="p">(</span>
  <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># print the first five rows of the data.
</span><span class="n">X_train</span><span class="p">.</span><span class="nf">head</span><span class="p">()</span>
<span class="c1">#   	MSSubClass	LotFrontage	LotArea	OverallQual	OverallCond	YearBuilt	YearRemodAdd	MasVnrArea	BsmtFinSF1	BsmtFinSF2	...	GarageArea	WoodDeckSF	OpenPorchSF	EnclosedPorch	3SsnPorch	ScreenPorch	PoolArea	MiscVal	MoSold	YrSold
# Id
# 619	20	90.0	11694	9	5	2007	2007	452.0	48	0	...	774	0	108	0	0	260	0	0	7	2007
# 871	20	60.0	6600	5	5	1962	1962	0.0	0	0	...	308	0	0	0	0	0	0	0	8	2009
# 93	30	80.0	13360	5	7	1921	2006	0.0	713	0	...	432	0	0	44	0	0	0	0	8	2009
# 818	20	NaN	13265	8	5	2002	2002	148.0	1218	0	...	857	150	59	0	0	0	0	0	7	2008
# 303	20	118.0	13704	7	5	2001	2002	150.0	0	0	...	843	468	81	0	0	0	0	0	1	2006
# 5 rows × 36 columns
</span></pre></table></code></div></div><h3 id="step-1-preliminary-investigation">Step 1: Preliminary investigation</h3><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="c1"># Shape of training data (num_rows, num_columns)
</span><span class="nf">print</span><span class="p">(</span><span class="n">X_train</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1"># (1168, 36)
</span><span class="err">​</span>
<span class="c1"># Number of missing values in each column of training data
</span><span class="n">missing_val_count_by_column</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_train</span><span class="p">.</span><span class="nf">isnull</span><span class="p">().</span><span class="nf">sum</span><span class="p">())</span>
<span class="nf">print</span><span class="p">(</span><span class="n">missing_val_count_by_column</span><span class="p">[</span><span class="n">missing_val_count_by_column</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
<span class="c1"># LotFrontage    212
# MasVnrArea       6
# GarageYrBlt     58
# dtype: int64
</span>
<span class="kn">from</span> <span class="n">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="n">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span>

<span class="c1"># Function for comparing different approaches
</span><span class="k">def</span> <span class="nf">score_dataset</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="nc">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_valid</span><span class="p">)</span>
    <span class="k">return</span> <span class="nf">mean_absolute_error</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">preds</span><span class="p">)</span>\
</pre></table></code></div></div><p>Since there are relatively few missing entries in the data</p><ul><li>(the column with the greatest percentage of missing values is missing less than 20% of its entries)<li>we can expect that dropping columns is unlikely to yield good results.<li>This is because we’d be throwing away a lot of valuable data, and so imputation will likely perform better.</ul><h3 id="step-2-drop-columns-with-missing-values">Step 2: Drop columns with missing values</h3><blockquote><p>preprocess the data in <code class="language-plaintext highlighter-rouge">X_train</code> and <code class="language-plaintext highlighter-rouge">X_valid</code> to remove columns with missing values. Set the preprocessed DataFrames to <code class="language-plaintext highlighter-rouge">reduced_X_train</code> and reduced_X_valid, respectively.</p></blockquote><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="c1"># get names of columns with missing values
</span><span class="n">cols_missing</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">X_train</span><span class="p">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">X_train</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="nf">isnull</span><span class="p">().</span><span class="nf">any</span><span class="p">()]</span>

<span class="c1"># drop columns in training and validation data
</span><span class="n">reduced_X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">.</span><span class="nf">drop</span><span class="p">(</span><span class="n">cols_missing</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">reduced_X_valid</span> <span class="o">=</span> <span class="n">X_valid</span><span class="p">.</span><span class="nf">drop</span><span class="p">(</span><span class="n">cols_missing</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="s">"MAE (Drop columns with missing values):"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">score_dataset</span><span class="p">(</span><span class="n">reduced_X_train</span><span class="p">,</span> <span class="n">reduced_X_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">))</span>
<span class="c1"># MAE (Drop columns with missing values):
# 17837.82570776256
</span></pre></table></code></div></div><h3 id="step-3-imputation">Step 3: Imputation</h3><blockquote><p>impute missing values with the mean value along each column. Set the preprocessed DataFrames to imputed_X_train and imputed_X_valid. Make sure that the column names match those in <code class="language-plaintext highlighter-rouge">X_train</code> and X_valid.</p></blockquote><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>

<span class="c1"># imputation
</span><span class="n">my_imputer</span> <span class="o">=</span> <span class="nc">SimpleImputer</span><span class="p">()</span>
<span class="n">imputed_X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">my_imputer</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span>
<span class="n">imputed_X_valid</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">my_imputer</span><span class="p">.</span><span class="nf">transform</span><span class="p">(</span><span class="n">X_valid</span><span class="p">))</span>

<span class="c1"># imputation removed column names; put them back
</span><span class="n">imputed_X_train</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">.</span><span class="n">columns</span>
<span class="n">imputed_X_valid</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">X_valid</span><span class="p">.</span><span class="n">columns</span>

<span class="nf">print</span><span class="p">(</span><span class="s">"MAE (Imputation):"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">score_dataset</span><span class="p">(</span><span class="n">imputed_X_train</span><span class="p">,</span> <span class="n">imputed_X_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">))</span>
<span class="c1"># MAE (Imputation):
# 18062.894611872147
</span></pre></table></code></div></div><p>there are so few missing values in the dataset, we’d expect imputation to perform better than dropping columns entirely.</p><ul><li>However, we see that dropping columns performs slightly better!<li>While this can probably partially be attributed to noise in the dataset, another potential explanation is that the imputation method is not a great match to this dataset.<li>That is, maybe instead of filling in the mean value, it makes more sense to set every missing value to a value of 0, to fill in the most frequently encountered value, or to use some other method.<li>For instance, consider the GarageYrBlt column (which indicates the year that the garage was built). It’s likely that in some cases, a missing value could indicate a house that does not have a garage.<li>Does it make more sense to fill in the median value along each column in this case? Or could we get better results by filling in the minimum value along each column?<li>It’s not quite clear what’s best in this case, but perhaps we can rule out some options immediately - for instance, setting missing values in this column to 0 is likely to yield horrible results!</ul><h3 id="step-4-generate-test-predictions">Step 4: Generate test predictions</h3><h4 id="part-a">Part A</h4><ul><li>Use the next code cell to preprocess the training and validation data.<li>Set the preprocessed DataFrames to final_X_train and final_X_valid.</ul><p>You can use any approach of your choosing here! in order for this step to be marked as correct, you need only ensure:</p><ul><li>the preprocessed DataFrames have the same number of columns,<li>the preprocessed DataFrames have no missing values,<li><code class="language-plaintext highlighter-rouge">final_X_train</code> and <code class="language-plaintext highlighter-rouge">y_train</code> have the same number of rows,<li><code class="language-plaintext highlighter-rouge">final_X_valid</code> and <code class="language-plaintext highlighter-rouge">y_valid</code> have the same number of rows.</ul><div class="language-py highlighter-rouge"><div class="code-header" text-data="py"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1"># Preprocessed training and validation features
</span><span class="n">final_X_train</span> <span class="o">=</span> <span class="n">reduced_X_train</span>
<span class="n">final_X_valid</span> <span class="o">=</span> <span class="n">reduced_X_valid</span>

<span class="c1"># Define and fit model
</span><span class="n">model</span> <span class="o">=</span> <span class="nc">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">final_X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Get validation predictions and MAE
</span><span class="n">preds_valid</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">final_X_valid</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="s">"MAE (Your approach):"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">mean_absolute_error</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">preds_valid</span><span class="p">))</span>
<span class="c1"># MAE (Your approach):
# 17837.82570776256
</span></pre></table></code></div></div><h4 id="part-b">Part B</h4><ul><li>Use the next code cell to preprocess your test data.<li>Make sure that you use a method that agrees with how you preprocessed the training and validation data, and set the preprocessed test features to final_X_test.</ul><p>Then, use the preprocessed test features and the trained model to generate test predictions in preds_test.</p><p>In order for this step to be marked correct, you need only ensure:</p><ul><li>the preprocessed test DataFrame has no missing values, and<li>final_X_test has the same number of rows as X_test.</ul><p>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/00codenote/'>00CodeNote</a>, <a href='/categories/mlnote/'>MLNote</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ml/" class="post-tag no-text-decoration" >ML</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=ML lab 02 - Predict home prices in Iowa - Grace&url=https://ocholuo.github.io//posts/ml-lab-02-Homedata/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=ML lab 02 - Predict home prices in Iowa - Grace&u=https://ocholuo.github.io//posts/ml-lab-02-Homedata/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=ML lab 02 - Predict home prices in Iowa - Grace&url=https://ocholuo.github.io//posts/ml-lab-02-Homedata/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Amazon-CloudFront/">AWS Lab - AWS CloudFront</a><li><a href="/posts/Alexa-1stSkill/">AWS Alex First Skill - RedVelvet Time</a><li><a href="/posts/NetworkProtocol-SSL-TLS-Handshake/">NetworkProtocol SSL/TLS Handshake</a><li><a href="/posts/pythonCrash/">Python Crash</a><li><a href="/posts/%E4%B8%80%E5%8F%A5%E8%AF%9D%E8%A7%A3%E9%87%8AAWS/">AWS - 一句话解释AWS</a><li><a href="/posts/GKE/">GCP - Google Cloud Computing - Kubernetes and Kubernetes Engine</a><li><a href="/posts/Go-Note/">Go Note</a><li><a href="/posts/SCPs/">AWS - IdenAccessManage - SCPs (Service Control Policies)</a><li><a href="/posts/CompanyBenefit/">Company Benefit</a><li><a href="/posts/Encryption-SSL&TLS/">Cryptography - SSL/TLS Encryption</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/ml-1/"><div class="card-body"> <span class="timeago small" >Aug 11, 2021<i class="unloaded">2021-08-11T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ML - 1st - Intro to Machine Learning</h3><div class="text-muted small"><p> Intro to Machine Learning How Models Work over all Your First Machine Learning Model - DecisionTreeRegressor Model Validation Mean Absolute Error ...</p></div></div></a></div><div class="card"> <a href="/posts/ml-2/"><div class="card-body"> <span class="timeago small" >Aug 11, 2021<i class="unloaded">2021-08-11T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ML - 2nd - Intermediate Machine Learning</h3><div class="text-muted small"><p> ML - Intermediate Machine Learning Missing Values Three Approaches Approach 1 (Drop Columns with Missing Values) 删除无数值列 Approach 2 (Imputation) ...</p></div></div></a></div><div class="card"> <a href="/posts/ml-lab-01-Titanic-ML-from-Disaster/"><div class="card-body"> <span class="timeago small" >Aug 11, 2021<i class="unloaded">2021-08-11T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ML lab 01 - Titanic-ML-from-Disaster</h3><div class="text-muted small"><p> ML Lab - Titanic - Machine Learning from Disaster ML Lab - Titanic - Machine Learning from Disaster the file # This Python 3 environment comes with many helpful analytics libraries ins...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/ml-lab-01-Titanic-ML-from-Disaster/" class="btn btn-outline-primary" prompt="Older"><p>ML lab 01 - Titanic-ML-from-Disaster</p></a> <a href="/posts/SecurityEvent-AWS-lambda/" class="btn btn-outline-primary" prompt="Newer"><p>Meow's SecurityEvent - 2022 Apr 6 AWS lambda</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ocholuo">Grace JyL</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ocholuo.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script defer src="/assets/js/dist/pvreport.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-179830187-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-179830187-1'); }); </script>
