<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="pv-proxy-endpoint" content="https://myochosite-291718.appspot.com/query?id=ahNwfm15b2Nob3NpdGUtMjkxNzE4chULEghBcGlRdWVyeRiAgIDo14eBCgw"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="NetworkSec - Calico" /><meta property="og:locale" content="en" /><meta name="description" content="[toc]" /><meta property="og:description" content="[toc]" /><link rel="canonical" href="https://ocholuo.github.io//posts/Calico/" /><meta property="og:url" content="https://ocholuo.github.io//posts/Calico/" /><meta property="og:site_name" content="Grace" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-05-18T11:11:11-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="NetworkSec - Calico" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-10-30T21:02:21-04:00","datePublished":"2018-05-18T11:11:11-04:00","description":"[toc]","headline":"NetworkSec - Calico","mainEntityOfPage":{"@type":"WebPage","@id":"https://ocholuo.github.io//posts/Calico/"},"url":"https://ocholuo.github.io//posts/Calico/"}</script><title>NetworkSec - Calico | Grace</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Grace"><meta name="application-name" content="Grace"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://myochosite-291718.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://myochosite-291718.appspot.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/huoye.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Grace</a></div><div class="site-subtitle font-italic">2023 Mar 14 updated</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/ocholuo" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>NetworkSec - Calico</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>NetworkSec - Calico</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Grace JyL </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, May 18, 2018, 11:11 AM -0400" >May 18, 2018<i class="unloaded">2018-05-18T11:11:11-04:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Oct 30, 2022, 6:02 PM -0700" >Oct 30, 2022<i class="unloaded">2022-10-30T21:02:21-04:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="5591 words">31 min read</span> <span id="pv" class="pageviews"> <i class="fas fa-spinner fa-spin fa-fw"></i> </span> views</div></div><div class="post-content"><p>[toc]</p><ul><li>ref<ul><li><a href="https://feisky.gitbooks.io/sdn/content/container/calico/">Calico</a><li><a href="https://xuxinkun.github.io/2016/07/22/cni-cnm/">https://xuxinkun.github.io/2016/07/22/cni-cnm/</a><li><a href="https://www.projectcalico.org/">https://www.projectcalico.org/</a><li><a href="http://blog.dataman-inc.com/shurenyun-docker-133/">http://blog.dataman-inc.com/shurenyun-docker-133/</a><li><a href="https://jimmysong.io/kubernetes-handbook/concepts/calico.html">calico</a><li><a href="https://cloud.tencent.com/developer/article/1638845">Calico 介绍. 原理与使用</a><li><a href="http://dockerone.com/article/10709">详细配置！！！</a><li><a href="https://qiankunli.github.io/2018/02/04/calico.html">1</a></ul></ul><hr /><h1 id="calico">Calico</h1><p><img data-proofer-ignore data-src="https://i.imgur.com/HoeTaXs.jpg" alt="006tNc79gy1fz65bt7ieej30c90bsgn2" /></p><hr /><h2 id="calico-basic">calico basic</h2><p><a href="https://www.projectcalico.org/">Calico</a></p><ul><li>一个纯三层的数据中心网络方案（不需要Overlay）<ul><li>每个容器会分配一个可路由的IP。由于通信时不需要解包和封包，网络性能损耗小，易于排查，且易于水平扩展。</ul><li><p>与OpenStack. Kubernetes. AWS. GCE等IaaS和容器平台都有良好的集成。</p><li>Calico在每一个计算节点利用Linux Kernel实现了一个高效的vRouter来负责数据转发<ul><li>每个vRouter通过BGP协议负责把自己上运行的workload的路由信息像整个Calico网络内传播<li>每个vRouter都通过BGP1协议把在本节点上运行的容器的路由信息向整个Calico网络广播，并自动设置到达其他节点的路由转发规则。</ul><li>Calico节点组网时可以直接利用数据中心的网络结构（L2或者L3）<ul><li>不需要额外的NAT、隧道或者Overlay Network<li>没有额外的封包解包，能够节约CPU运算，提高网络效率。<li><img data-proofer-ignore data-src="https://i.imgur.com/cfshmWs.png" alt="abf5c66ed068fce3192ff6f112b30a57" /></ul><li>Calico保证所有容器之间的数据流量都是通过IP路由的方式完成互联互通的。<ul><li>小规模部署可以通过BGP client直接互联<li>大规模下可通过指定的BGP route reflector来完成。<li><img data-proofer-ignore data-src="https://i.imgur.com/8eDh85a.png" alt="ee6da4769a5c9b5dfd3bcb21aec65e8a" /></ul><li>Calico基于iptables还提供了丰富而灵活的网络Policy<ul><li>保证通过各个节点上的ACLs来提供Workload的多租户隔离. 安全组以及其他可达性限制等功能。<li>提供了丰富的网络策略，实现了Kubernetes的Network Policy策略，提供容器间网络可达性限制的功能。</ul></ul><hr /><h2 id="calico-优势-与-劣势">Calico 优势 与 劣势</h2><p>优势</p><ul><li>没有封包和解包过程，完全基于两端宿主机的路由表进行转发<li>可以配合使用 Network Policy 做 pod 和 pod 之前的访问控制<li>细粒度网络访问控制<ul><li>flannel是不支持的，calico支持，<li>做多租户网络方面的控制ACL，选择 calico。</ul></ul><p>劣势</p><ul><li>Calico控制平面的设计要求物理网络得是L2 Fabric，这样vRouter间都是直接可达的<li>要求宿主机处于同一个2层网络下<ul><li>也就是连在一台交换机上</ul><li>路由的数目与容器数目相同，非常容易超过路由器、三层交换、甚至node的处理能力，从而限制了整个网络的扩张。(可以使用大规模方式解决)<li>三层实现，不支持VRF<li>每个node上会设置大量（海量)的iptables规则、路由，运维、排障难度大。<li>原理决定了它不可能支持VPC，容器只能从calico设置的网段中获取ip。<li>不支持多租户网络的隔离功能，在多租户场景下会有网络安全问题</ul><p>flannel vs calico</p><ul><li>网络性能<ul><li>选择 flannel host-gw 模式 和 calico BGP 模式</ul><li>集群规模<ul><li>如果规模不大，100以下节点可以使用flannel，优点是维护比较简单。</ul><li>维护能力<ul><li>calico的路由表很多，而且走BGP协议，一旦出现问题排查起来也比较困难，上百台的，路由表去排查也是很麻烦，这个具体需求需要根据自己的情况而定。</ul></ul><hr /><h2 id="calico架构">Calico架构</h2><p><img data-proofer-ignore data-src="https://i.imgur.com/lHfVmwk.png" alt="calico" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/M5Xtfdt.png" alt="Screen Shot 2021-03-29 at 22.38.39" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/EJowDvz.png" alt="x2crhv7hyj" /></p><p>Calico主要由Felix. etcd. BGP client, BGP Route Reflector组成</p><ol><li> <font color="red"> Felix </font><ul><li>Calico Agent<li>calico的核心组件，运行在每个节点上。跑在每台需要运行Workload的节点上<li>主要负责配置路由及ACLs等信息来确保Endpoint的连通状态；<li>主要的功能有接口管理. 路由规则. ACL规则和状态报告<ul><li><strong>接口管理</strong>：Felix为内核编写一些接口信息，以便让内核能正确的处理主机endpoint的流量。特别是主机之间的ARP请求和处理ip转发。<li><strong>路由规则</strong>：Felix负责主机之间路由信息写到linux内核的FIB（Forwarding Information Base）转发信息库，保证数据包可以在主机之间相互转发。<li><strong>ACL规则</strong>：Felix负责将ACL策略写入到linux内核中，保证主机endpoint的为有效流量不能绕过calico的安全措施。<li><strong>状态报告</strong>：Felix负责提供关于网络健康状况的数据。特别是，它报告配置主机时出现的错误和问题。这些数据被写入etcd，使其对网络的其他组件和操作人员可见。</ul></ul><li> <font color="red"> etcd </font><ul><li>分布式键值存储<li>负责存储网络信息<li>主要负责网络元数据一致性，确保Calico网络状态的准确性；<li>为保证数据的可靠和容错建议至少三个以上etcd节点。</ul><li><p>Bird：BGP客户端，Calico在每个节点上的都会部署一个BGP客户端，它的作用是将Felix的路由信息读入内核，并通过BGP协议在集群中分发。当Felix将路由插入到Linux内核FIB中时，BGP客户端将获取这些路由并将它们分发到部署中的其他节点。这可以确保在部署时有效地路由流量。</p><li> <font color="red"> BGP Client（BIRD） </font><ul><li>主要负责把Felix写入Kernel的路由信息分发到当前Calico网络<li>确保Workload间的通信的有效性；</ul><li> <font color="red"> BGP Route Reflector（BIRD）</font><ul><li>大规模部署时使用<li>摒弃所有节点互联的 mesh 模式<ul><li>大型网络仅仅使用 BGP client 形成 mesh 全网互联的方案就会导致规模限制<li>所有节点需要 N^2 个连接</ul><li>作为BGP client的中心连接点，可以避免每个节点互联<ul><li>通过一个或者多个BGP Route Reflector来完成集中式的路由分发。<li>使所有 BGP Client 仅与特定 RR 节点互联并做路由同步<li>大大减少连接数。</ul></ul><li> <font color="red"> calico/calico-ipam </font><ul><li>主要用作Kubernetes的CNI插件</ul><li><p>Calicoctl：calico 命令行管理工具。</p><li>Orchestrator plugin：协调器插件负责允许kubernetes或OpenStack等原生云平台方便管理Calico，可以通过各自的API来配置Calico网络实现无缝集成。如kubernetes的cni网络插件。</ol><p><img data-proofer-ignore data-src="https://i.imgur.com/2x3xypD.png" alt="calico2" /></p><hr /><h2 id="calico-网络模式">Calico 网络模式</h2><ul><li> <font color="red"> BGP 边界网关协议（Border Gateway Protocol, BGP） </font><ul><li>核心的去中心化自治路由协议。<li>BGP不使用传统的内部网关协议（IGP）的指标。<li>BGP两种模式<ul><li>全互联模式(node-to-node mesh)<li>路由反射模式Router Reflection（RR）</ul></ul><li> <font color="red"> IPIP模式 </font><ul><li>把 IP 层封装到 IP 层的一个 tunnel。<li>作用其实基本上就相当于一个基于IP层的网桥！<li>一般来说，普通的网桥是基于mac层的，不需 IP，而这个 ipip 则是通过两端的路由做一个 tunnel，把两个本来不通的网络通过点对点连接起来。</ul></ul><hr /><h3 id="bgp-概述">BGP 概述</h3><p>BGP（border gateway protocol）</p><ul><li>外部路由协议（边界网关路由协议）<ul><li>用来在AS之间传递路由信息<li>是一种增强的距离矢量路由协议（应用场景）<li>是一个边界路由器，在每个自治系统的最边界与其他自治系统的传输规则<li>而这些节点之间组成的BGP网络是一个全网通的网络，这个网络就称为一个BGP Peer</ul><li>基本功能是在 自治系统 间自动交换 无环路的路由信息<ul><li>无环路保证主要通过其AS-PATH实现<li>通过交换带有自治系统号序列属性的路径可达信息，来构造自治系统的拓扑图<li>从而消除路由环路并实施用户配置的路由策略。</ul><li>BGP是基于策略的路由协议<ul><li>其策略通过丰富的路径属性(attributes)进行控制。<li>BGP工作在应用层，在传输层采用可靠的TCP作为传输协议（BGP传输路由的邻居关系建立在可靠的TCP会话的基础之上）。<li>在路径传输方式上，BGP类似于距离矢量路由协议。<li>而BGP路由的好坏不是基于距离（多数路由协议选路都是基于带宽的），它的选路基于丰富的路径属性，而这些属性在路由传输时携带，所以我们可以把BGP称为路径矢量路由协议。<li>如果把自治系统浓缩成一个路由器来看待，BGP作为路径矢量路由协议这一特征便不难理解了。</ul><li>除此以外，BGP又具备很多链路状态（LS）路由协议的特征，比如触发式的增量更新机制，宣告路由时携带掩码等。）</ul><h4 id="calico-bgp-概述">Calico BGP 概述</h4><p>Calico 项目提供的 BGP 网络解决方案，与 Flannel 的 host-gw 模式几乎一样。</p><ul><li>也就是说，Calico也是基于路由表实现容器数据包转发，<li>但不同于Flannel使用flanneld进程来维护路由信息的做法，而Calico项目使用BGP协议来自动维护整个集群的路由信息。</ul><p>BGP 是怎么工作的？</p><ul><li>这个也是跨节点之间的通信，与flannel类似<li>其实这张图相比于flannel，通过一个路由器来路由，flannel.1 就相比于vxlan模式去掉，所以会发现这里是没有网桥存在，完全就是通过路由来实现<li>这个数据包也是先从veth设备对另一口发出，到达宿主机上的cali开头的虚拟网卡上，到达这一头也就到达了宿主机上的网络协议栈，另外就是当创建一个pod时帮你先起一个infra containers的容器，调用calico的二进制帮你去配置容器的网络，然后会根据路由表决定这个数据包到底发送到哪里去，可以从ip route看到路由表信息，这里显示是目的cni分配的子网络和目的宿主机的网络<li>当进行跨主机通信的时候之间转发到下一跳地址走宿主机的eth0网卡出去，也就是一个直接的静态路由，这个下一跳就跟host-gw的形式一样<ul><li>和host-gw最大的区别是<ul><li>calico使用BGP路由交换<li>而host-gw是使用自己的路由交换</ul></ul><li>BGP这个方案比较成熟，在大型网络中用的也比较多，所以要比flannel的方式好，而这些路由信息都是由BGP client传输。</ul><h4 id="bgp两种模式">BGP两种模式</h4><ul><li>全互联模式(node-to-node mesh)<ul><li>全互联模式 每一个BGP Speaker都需要和其他BGP Speaker建立BGP连接，这样BGP连接总数就是N^2，如果数量过大会消耗大量连接。<li>如果集群数量超过100台官方不建议使用此种模式。</ul><li>路由反射模式Router Reflection（RR）<ul><li>Calico 维护的网络在默认是（Node-to-Node Mesh）全互联模式，Calico集群中的节点之间都会相互建立连接，用于路由交换。<li>但是随着集群规模的扩大，mesh模式将形成一个巨大服务网格，连接数成倍增加。<li>这时就需要使用 Route Reflector（路由器反射）模式解决这个问题。<li>RR模式 中会指定一个或多个BGP Speaker为RouterReflection，它与网络中其他Speaker建立连接，每个Speaker只要与Router Reflection建立BGP就可以获得全网的路由信息。在calico中可以通过Global Peer实现RR模式。</ul></ul><p><img data-proofer-ignore data-src="https://i.imgur.com/R8DEq7n.png" alt="j41ngbry2b" /></p><p>Pod 1 访问 Pod 2 流程如下</p><ol><li>数据包从 Pod1 出到达Veth Pair另一端（宿主机上，以cali前缀开头）<li>宿主机根据路由规则，将数据包转发给下一跳（网关）<li>到达 Node2，根据路由规则将数据包转发给 cali 设备，从而到达 Pod2。<ul><li>最核心的 下一跳 路由规则，就是由 Calico 的 Felix 进程负责维护的。<ul><li>这些路由规则信息，通过 BGP Client 中 BIRD 组件，使用 BGP 协议来传输。<li>Calico 项目实际上将集群里的所有节点，都当作是边界路由器来处理，它们一起组成了一个全连通的网络，互相之间通过 BGP 协议交换路由规则。这些节点，我们称为 BGP Peer。</ul><li>Flannel host-gw 和 Calico 的唯一不一样的地方就是当数据包下一跳到达node2节点容器时发生变化，并且出数据包也发生变化，知道它是从veth的设备流出，容器里面的数据包到达宿主机上，这个数据包到达node2之后，它又根据一个特殊的路由规则，这个会记录目的通信地址的cni网络，然后通过cali设备进去容器，这个就跟网线一样，数据包通过这个网线发到容器中，这也是一个二层的网络互通才能实现。</ul></ol><h4 id="route-reflector-模式rr路由反射">Route Reflector 模式（RR）（路由反射）</h4><p>Calico 维护的网络默认是 （Node-to-Node Mesh）全互联模式，</p><ul><li>在BGP中可以通过calicoctl node status看到启动是 node-to-node mesh 网格的形式，<li>这种形式是一个全互联的模式<ul><li>默认的BGP在k8s的每个节点担任了一个BGP的一个喇叭，一直吆喝着扩散到其他节点<li>calico集群中的节点之间都会相互建立连接，用于路由交换。</ul><li>但是随着集群规模的扩大，mesh模式将形成一个巨大服务网格，连接数成倍增加。<ul><li>上百台节点就要构建上百台链接，就是全互联的方式，<li>要来回建立连接来保证网络的互通性，<li>增加一个节点就要成倍的增加这种链接保证网络的互通性，<li>大量的网络消耗</ul><li>这时就需要使用 Route Reflector（路由器反射）模式解决这个问题。<ul><li>确定一个或多个Calico节点充当路由反射器，让其他节点从这个RR节点获取路由信息。</ul></ul><h4 id="route-reflector-模式rr路由反射-1">Route Reflector 模式（RR）（路由反射）</h4><ul><li>使用Route reflector，也就是找几个大的节点，让他们去这个大的节点建立连接，也叫RR<li>所以要找节点或着多个节点充当路由反射器，建议至少是2到3个，一个做备用，一个在维护的时候不影响其他的使用。</ul><hr /><h3 id="ip-in-ip">IP-in-IP</h3><p>不过，考虑到并非所有的网络都能支持BGP，以及Calico控制平面的设计要求物理网络必须是二层网络, 以确保 vRouter间均直接可达，路由不能够将物理设备当作下一跳等原因，为了支持三层网络，Calico还推出了IP-in-IP叠加的模型，它也使用Overlay的方式来传输数据。</p><ul><li><p>IPIP的包头非常小，而且也是内置在内核中，因此理论上它的速度要比VxLAN快一点 ，但安全性更差。Calico 3.x的默认配置使用的是IPIP类型的传输方案而非BGP。</p><li>Calico控制平面的设计要求物理网络得是L2 Fabric，这样vRouter间都是直接可达的，路由不需要把物理设备当做下一跳。<li>为了支持L3 Fabric，Calico推出了IPinIP的选项。<li>IPIP 是linux内核的驱动程序，可以对数据包进行隧道</ul><p><img data-proofer-ignore data-src="https://i.imgur.com/aGhHpsk.png" alt="sx37u2c3y2" /></p><ul><li><p>上图可以看到两个不同的网络 vlan1 和 vlan2。基于现有的以太网将原始包中的原始IP进行一次封装，通过tunl0解包，这个tunl0类似于ipip模块，和Flannel vxlan的veth很类似。</p><li><p>Pod1 访问 Pod2 流程如下：</p><ol><li>数据包从 Pod1 出到达Veth Pair另一端（宿主机上，以cali前缀开头）。<li><p>进入IP隧道设备（tunl0），由Linux内核IPIP驱动封装，把源容器ip换成源宿主机ip，目的容器ip换成目的主机ip，这样就封装成 Node1 到 Node2 的数据包。</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>   此时包的类型：
   原始IP包：
   源IP：10.244.1.10
   目的IP：10.244.2.10

   TCP：
   源IP: 192.168.31.62
   目的iP：192.168.32.63
</pre></table></code></div></div><li><p>数据包经过路由器三层转发到 Node2。</p><li><p>Node2 收到数据包后，网络协议栈会使用IPIP驱动进行解包，从中拿到原始IP包。</p><li>然后根据路由规则，将数据包转发给cali设备，从而到达 Pod2。</ol></ul><p>实际查看路由情况</p><p>跨宿主机之间容器访问：</p><p>环境：</p><div class="table-wrapper"><table><thead><tr><th>Pod 名称<th>Pod IP<th>宿主机 IP<tbody><tr><td>zipkin-dependencies-production<td>10.20.169.155<td>192.168.162.248<tr><td>zipkin-production<td>10.20.36.85<td>192.168.163.40</table></div><p>zipkin-dependencies-production -&gt; zipkin-production 过程如下：</p><ol><li>登录 zipkin-dependencies-production 容器<ul><li>查看路由信息<li>0.0.0.0 指向了 169.254.1.1（eth0）<li>容器ip地址: <code class="language-plaintext highlighter-rouge">10.20.169.155/32</code><li>eth0@if1454 为在宿主机上创建的虚拟网桥的一端，另一端为 calic775b4c8175</ul></ol><p><img data-proofer-ignore data-src="https://i.imgur.com/ABSFeOg.png" alt="vs9udu13gv" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/pO8kObx.png" alt="pwn3q8srp0" /></p><ol><li>去往容器 zipkin-production 的数据包，由zipkin-dependencies-production 容器里经过网桥设备转发到 zipkin-dependencies-production 所在的宿主机上<ul><li>在宿主机上查看路由表。<li>可以看到 zipkin-production (pod-ip 10.20.36.85) 的下一跳是 <code class="language-plaintext highlighter-rouge">192.168.163.40</code>，也就是 zipkin-production 所在的宿主机ip地址，网络接口是 tunl0<li>tunl0 设备是一个ip隧道（ip tunnel）设备，技术原理是IPIP，ip包进入ip隧道后会被linux内核的IPIP驱动接管并重新封装（伪造）成去宿主机网络的ip包，然后发送出去。这样原始ip包经过封装后下一跳地址就是 192.168.163.40</ul></ol><p><img data-proofer-ignore data-src="https://i.imgur.com/efoI6F1.png" alt="gln9tu8bsa" /></p><ol><li>数据包到达 zipkin-production 的宿主机 <code class="language-plaintext highlighter-rouge">192.168.163.40</code><ul><li>经过解包查找 10.20.36.85 的路由为网桥设备 cali0393db3e4a6</ul></ol><p><img data-proofer-ignore data-src="https://i.imgur.com/mLHj2Gt.png" alt="brgcf5oibe" /></p><ol><li>最终 10.20.36.85 经过网桥设备 cali0393db3e4a6 被转发到容器 zipkin-production 内部，返回的数据包路径也是一样。</ol><p><img data-proofer-ignore data-src="https://i.imgur.com/GbhuLO4.png" alt="iyi1el56py" /></p><hr /><h2 id="calico-cni">Calico CNI</h2><p>见<a href="https://github.com/projectcalico/cni-plugin">https://github.com/projectcalico/cni-plugin</a>。</p><hr /><h2 id="calico-cnm">Calico CNM</h2><p>Calico通过Pool和Profile的方式实现了docker CNM网络：</p><ol><li>Pool<ul><li>定义可用于Docker Network的IP资源范围<li>比如：<code class="language-plaintext highlighter-rouge">10.0.0.0/8</code> 或者 <code class="language-plaintext highlighter-rouge">192.168.0.0/16</code>；</ul><li>Profile<ul><li>定义Docker Network Policy的集合，由tags和rules组成；<li>每个 Profile默认拥有一个和Profile名字相同的Tag，每个Profile可以有多个Tag，以List形式保存。</ul></ol><ul><li>具体实现见<a href="https://github.com/projectcalico/libnetwork-plugin">https://github.com/projectcalico/libnetwork-plugin</a>，<li>使用方法可以参考<a href="http://docs.projectcalico.org/v3.0/getting-started/docker/">http://docs.projectcalico.org/v3.0/getting-started/docker/</a>。</ul><hr /><h2 id="部署">部署</h2><p>运行下面的命令可以部署 calico 网络。</p><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nb">mkdir</span> /etc/cni/net.d/

kubectl apply <span class="nt">-f</span> https://docs.projectcalico.org/v3.0/getting-started/kubernetes/installation/rbac.yaml

wget https://docs.projectcalico.org/v3.0/getting-started/kubernetes/installation/hosted/calico.yaml

<span class="c"># 修改etcd_endpoints的值和默认的192.168.0.0/16(不能和已有网段冲突)</span>

kubectl apply <span class="nt">-f</span> calico.yaml
</pre></table></code></div></div><ol><li>calicoctl 工具安装</ol><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="c"># 下载工具：https://github.com/projectcalico/calicoctl/releases</span>
wget <span class="nt">-O</span> /usr/local/bin/calicoctl https://github.com/projectcalico/calicoctl/releases/download/v3.13.3/calicoctl
<span class="nb">chmod</span> +x /usr/local/bin/calicoctl

<span class="nb">export </span><span class="nv">CALICO_DATASTORE_TYPE</span><span class="o">=</span>kubernetes

<span class="nb">export </span><span class="nv">CALICO_KUBECONFIG</span><span class="o">=</span>~/.kube/config

calicoctl get ippool

calicoctl get node

<span class="c"># 查看集群节点状态</span>
<span class="c"># 使用calicoctl查看服务状态：</span>
<span class="nv">$ </span>./calicoctl node status
Calico process is running.
IPv4 BGP status
+--------------+-------------------+-------+----------+-------------+
| PEER ADDRESS |     PEER TYPE     | STATE |  SINCE   |    INFO     |
+--------------+-------------------+-------+----------+-------------+
| 192.168.2.62 | node-to-node mesh | up    | 02:58:05 | Established |
| 192.168.2.63 | node-to-node mesh | up    | 03:08:46 | Established |
+--------------+-------------------+-------+----------+-------------+
IPv6 BGP status
No IPv6 peers found.

<span class="c"># 实际上，使用calicoctl查看Node状态就是调用系统查看的，与netstat效果一样。</span>
<span class="nv">$ </span>netstat <span class="nt">-antp</span>|grep bird
tcp        0      0 0.0.0.0:179             0.0.0.0:<span class="k">*</span>               LISTEN      62709/bird
tcp        0      0 192.168.2.61:179        192.168.2.63:58963      ESTABLISHED 62709/bird
tcp        0      0 192.168.2.61:179        192.168.2.62:37390      ESTABLISHED 62709/bird
</pre></table></code></div></div><p>如果使用 calicoctl get node，需要指定 calicoctl 配置，默认使用 /etc/calico/calicoctl.cfg</p><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="c"># 设置 calicoctl 配置文件</span>
<span class="nv">$ </span>vim /etc/calico/calicoctl.cfg

apiVersion: projectcalico.org/v3
kind: CalicoAPIConfig
metadata:
spec:
  datastoreType: <span class="s2">"etcdv3"</span>
  etcdEndpoints: https://10.10.0.174:2379
  etcdKeyFile: /opt/kubernetes/ssl/server-key.pem
  etcdCertFile: /opt/kubernetes/ssl/server.pem
  etcdCACertFile: /opt/kubernetes/ssl/ca.pem

<span class="c"># 查看 calico 节点</span>
<span class="nv">$ </span>calicoctl get nodes

<span class="c"># 查看 IPAM的IP地址池</span>
<span class="nv">$ </span>calicoctl get ippool <span class="nt">-o</span> wide

<span class="c"># 查看bgp网络配置情况</span>
<span class="nv">$ </span>calicoctl get bgpconfig

<span class="c"># 查看ASN号，一个编号就是一个自治系统</span>
<span class="nv">$ </span>calicoctl get nodes <span class="nt">--output</span><span class="o">=</span>wide

<span class="c"># 查看 bgp peer</span>
<span class="nv">$ </span>calicoctl get bgppeer
</pre></table></code></div></div><hr /><h3 id="calico-kubernetes">Calico Kubernetes</h3><p>在Kubernetes中部署Calico的主要步骤如下：</p><ol><li>修改Kubernetes服务的 启动参数，并重启服务。<ol><li>设置Master上 <code class="language-plaintext highlighter-rouge">kube-apiserver</code> 服务的启动参数：<ul><li><code class="language-plaintext highlighter-rouge">--allowprivileged=true</code><li>因为calico-node需要以特权模式运行在各Node上</ul><li>设置各Node上 <code class="language-plaintext highlighter-rouge">kubelet</code> 服务的启动参数：<ul><li><code class="language-plaintext highlighter-rouge">--networkplugin=cni</code><li>使用CNI网络插件</ul></ol><li>创建Calico服务，主要包括calico-node和calico policy controller。需要创建的资源对象如下：<ol><li>创建 <code class="language-plaintext highlighter-rouge">ConfigMap calico-config</code>，包含Calico所需的配置参数<li>创建 <code class="language-plaintext highlighter-rouge">Secret calico-etcd-secrets</code>，用于使用TLS方式连接etcd。<li>在每个Node上都运行 <code class="language-plaintext highlighter-rouge">calico/node容器</code>，部署为DaemonSet<li>在每个Node上都安装 <code class="language-plaintext highlighter-rouge">Calico</code>（由install-cni容器完成）<li>部署一个名为 calico/kube-policy-controller 的Deployment，以对接Kubernetes集群中为Pod设置的Network Policy</ol></ol><p>对于使用 kubeadm 创建的 Kubernetes 集群，使用以下配置安装 calico 时需要配置</p><ul><li><code class="language-plaintext highlighter-rouge">--pod-network-cidr=192.168.0.0/16</code><li><code class="language-plaintext highlighter-rouge">--service-cidr=10.96.0.0/12</code> （不能与 Calico 网络重叠）</ul><p>各版本的安装方法:</p><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c"># - 对于 Kubernetes 1.7.x 或者更新的版本</span>
kubectl apply <span class="nt">-f</span> https://docs.projectcalico.org/v3.0/getting-started/kubernetes/installation/hosted/kubeadm/1.7/calico.yaml

<span class="c"># - 对于 Kubernetes 1.6.x:</span>
kubectl apply <span class="nt">-f</span> http://docs.projectcalico.org/v2.3/getting-started/kubernetes/installation/hosted/kubeadm/1.6/calico.yaml

<span class="c"># - 对于 Kubernetes 1.5.x:</span>
kubectl apply <span class="nt">-f</span> http://docs.projectcalico.org/v2.3/getting-started/kubernetes/installation/hosted/kubeadm/1.5/calico.yaml
</pre></table></code></div></div><ul><li><p>详细的自定义配置方法见<a href="https://docs.projectcalico.org/v3.0/getting-started/kubernetes">https://docs.projectcalico.org/v3.0/getting-started/kubernetes</a>。</p><li>在Pod中启动Calico-etcd，<li>在所有Node上启动bird6. felix以及confd，<li>并配置CNI网络为calico插件：</ul><p><img data-proofer-ignore data-src="https://i.imgur.com/hcUKcgH.png" alt="calico-components" /></p><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre><td class="rouge-code"><pre><span class="c"># Calico相关进程</span>
<span class="nv">$ </span>ps <span class="nt">-ef</span> | <span class="nb">grep </span>calico | <span class="nb">grep</span> <span class="nt">-v</span> <span class="nb">grep
</span>root      9012  8995  0 14:51 ?        00:00:00 /bin/sh <span class="nt">-c</span> /usr/local/bin/etcd <span class="nt">--name</span><span class="o">=</span>calico <span class="nt">--data-dir</span><span class="o">=</span>/var/etcd/calico-data <span class="nt">--advertise-client-urls</span><span class="o">=</span>http://<span class="nv">$CALICO_ETCD_IP</span>:6666 <span class="nt">--listen-client-urls</span><span class="o">=</span>http://0.0.0.0:6666 <span class="nt">--listen-peer-urls</span><span class="o">=</span>http://0.0.0.0:6667
root      9038  9012  0 14:51 ?        00:00:01 /usr/local/bin/etcd <span class="nt">--name</span><span class="o">=</span>calico <span class="nt">--data-dir</span><span class="o">=</span>/var/etcd/calico-data <span class="nt">--advertise-client-urls</span><span class="o">=</span>http://10.146.0.2:6666 <span class="nt">--listen-client-urls</span><span class="o">=</span>http://0.0.0.0:6666 <span class="nt">--listen-peer-urls</span><span class="o">=</span>http://0.0.0.0:6667
root      9326  9325  0 14:51 ?        00:00:00 bird6 <span class="nt">-R</span> <span class="nt">-s</span> /var/run/calico/bird6.ctl <span class="nt">-d</span> <span class="nt">-c</span> /etc/calico/confd/config/bird6.cfg
root      9327  9322  0 14:51 ?        00:00:00 confd <span class="nt">-confdir</span><span class="o">=</span>/etc/calico/confd <span class="nt">-interval</span><span class="o">=</span>5 <span class="nt">-watch</span> <span class="nt">--log-level</span><span class="o">=</span>debug <span class="nt">-node</span><span class="o">=</span>http://10.96.232.136:6666 <span class="nt">-client-key</span><span class="o">=</span> <span class="nt">-client-cert</span><span class="o">=</span> <span class="nt">-client-ca-keys</span><span class="o">=</span>
root      9328  9324  0 14:51 ?        00:00:00 bird <span class="nt">-R</span> <span class="nt">-s</span> /var/run/calico/bird.ctl <span class="nt">-d</span> <span class="nt">-c</span> /etc/calico/confd/config/bird.cfg
root      9329  9323  1 14:51 ?        00:00:04 calico-felix


<span class="c"># CNI网络插件配置</span>
<span class="nv">$ </span><span class="nb">cat</span> /etc/cni/net.d/10-calico.conf
<span class="o">{</span>
    <span class="s2">"name"</span>: <span class="s2">"k8s-pod-network"</span>,
    <span class="s2">"cniVersion"</span>: <span class="s2">"0.1.0"</span>,
    <span class="s2">"type"</span>: <span class="s2">"calico"</span>,
    <span class="s2">"etcd_endpoints"</span>: <span class="s2">"http://10.96.232.136:6666"</span>,
    <span class="s2">"log_level"</span>: <span class="s2">"info"</span>,
    <span class="s2">"ipam"</span>: <span class="o">{</span>
        <span class="s2">"type"</span>: <span class="s2">"calico-ipam"</span>
    <span class="o">}</span>,
    <span class="s2">"policy"</span>: <span class="o">{</span>
        <span class="s2">"type"</span>: <span class="s2">"k8s"</span>,
         <span class="s2">"k8s_api_root"</span>: <span class="s2">"https://10.96.0.1:443"</span>,
         <span class="s2">"k8s_auth_token"</span>: <span class="s2">"&lt;token&gt;"</span>
    <span class="o">}</span>,
    <span class="s2">"kubernetes"</span>: <span class="o">{</span>
        <span class="s2">"kubeconfig"</span>: <span class="s2">"/etc/cni/net.d/calico-kubeconfig"</span>
    <span class="o">}</span>
<span class="o">}</span>


<span class="nv">$ </span><span class="nb">cat</span> /etc/cni/net.d/calico-kubeconfig
<span class="c"># Kubeconfig file for Calico CNI plugin.</span>
apiVersion: v1
kind: Config
clusters:
- name: <span class="nb">local
  </span>cluster:
    insecure-skip-tls-verify: <span class="nb">true
users</span>:
- name: calico
contexts:
- name: calico-context
  context:
    cluster: <span class="nb">local
    </span>user: calico
current-context: calico-context
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://i.imgur.com/ldPbGZJ.png" alt="calico-flow" /></p><hr /></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/15networksec/'>15NetworkSec</a>, <a href='/categories/advanceddev/'>AdvancedDev</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/networksec/" class="post-tag no-text-decoration" >NetworkSec</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=NetworkSec - Calico - Grace&url=https://ocholuo.github.io//posts/Calico/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=NetworkSec - Calico - Grace&u=https://ocholuo.github.io//posts/Calico/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=NetworkSec - Calico - Grace&url=https://ocholuo.github.io//posts/Calico/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Amazon-CloudFront/">AWS Lab - AWS CloudFront</a><li><a href="/posts/Alexa-1stSkill/">AWS Alex First Skill - RedVelvet Time</a><li><a href="/posts/NetworkProtocol-SSL-TLS-Handshake/">NetworkProtocol SSL/TLS Handshake</a><li><a href="/posts/pythonCrash/">Python Crash</a><li><a href="/posts/%E4%B8%80%E5%8F%A5%E8%AF%9D%E8%A7%A3%E9%87%8AAWS/">AWS - 一句话解释AWS</a><li><a href="/posts/GKE/">GCP - Google Cloud Computing - Kubernetes and Kubernetes Engine</a><li><a href="/posts/Go-Note/">Go Note</a><li><a href="/posts/SCPs/">AWS - IdenAccessManage - SCPs (Service Control Policies)</a><li><a href="/posts/CompanyBenefit/">Company Benefit</a><li><a href="/posts/Encryption-SSL&TLS/">Cryptography - SSL/TLS Encryption</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/IDS-Evasion-Techniques/"><div class="card-body"> <span class="timeago small" >May 18, 2018<i class="unloaded">2018-05-18T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>NetworkSec - Advanced SecDevices - IDS Evasion Techniques</h3><div class="text-muted small"><p> [toc] IDS Evasion Techniques “A look at whisker’s anti-IDS tactics” by Rain Forest Puppy (http://www.apachesecurity.net/archive/whiskerids.html) “IDS Evasion Techniques and Tactics” by Kevin...</p></div></div></a></div><div class="card"> <a href="/posts/IDS-IPS/"><div class="card-body"> <span class="timeago small" >May 18, 2018<i class="unloaded">2018-05-18T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>NetworkSec - Advanced SecDevices - IDSs and IPSs</h3><div class="text-muted small"><p> [toc] IDSs and IPSs basic When attacker launches an attack against a network, intrusion detection system (IDS) and intrusion prevention system (IPS) technologies are often able to recogni...</p></div></div></a></div><div class="card"> <a href="/posts/IDS/"><div class="card-body"> <span class="timeago small" >May 18, 2018<i class="unloaded">2018-05-18T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>NetworkSec - Advanced SecDevices - IDSs</h3><div class="text-muted small"><p> [toc] Intrusion detection system (IDS) IDS basic software / hardware system detect signs of malicious activity on network or individual computer. IDS is designed to detect: threats...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/BGP/" class="btn btn-outline-primary" prompt="Older"><p>NetworkSec - Layer 3 - Border Gateway Protocol (BGP)</p></a> <a href="/posts/IDS-Evasion-Techniques/" class="btn btn-outline-primary" prompt="Newer"><p>NetworkSec - Advanced SecDevices - IDS Evasion Techniques</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ocholuo">Grace JyL</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/soc/">SOC</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ocholuo.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script defer src="/assets/js/dist/pvreport.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-179830187-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-179830187-1'); }); </script>
